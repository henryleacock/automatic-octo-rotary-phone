if (!String.prototype.startsWith) {
    Object.defineProperty(String.prototype, 'startsWith', {
        value: function(search, rawPos) {
            var pos = rawPos > 0 ? rawPos|0 : 0;
            return this.substring(pos, pos + search.length) === search;
        }
    });
}
// Production steps of ECMA-262, Edition 5, 15.4.4.18
// Reference: http://es5.github.io/#x15.4.4.18

if (!Array.prototype['forEach']) {

    Array.prototype.forEach = function(callback, thisArg) {
  
      if (this == null) { throw new TypeError('Array.prototype.forEach called on null or undefined'); }
  
      var T, k;
      // 1. Let O be the result of calling toObject() passing the
      // |this| value as the argument.
      var O = Object(this);
  
      // 2. Let lenValue be the result of calling the Get() internal
      // method of O with the argument "length".
      // 3. Let len be toUint32(lenValue).
      var len = O.length >>> 0;
  
      // 4. If isCallable(callback) is false, throw a TypeError exception. 
      // See: http://es5.github.com/#x9.11
      if (typeof callback !== "function") { throw new TypeError(callback + ' is not a function'); }
  
      // 5. If thisArg was supplied, let T be thisArg; else let
      // T be undefined.
      if (arguments.length > 1) { T = thisArg; }
  
      // 6. Let k be 0
      k = 0;
  
      // 7. Repeat, while k < len
      while (k < len) {
  
        var kValue;
  
        // a. Let Pk be ToString(k).
        //    This is implicit for LHS operands of the in operator
        // b. Let kPresent be the result of calling the HasProperty
        //    internal method of O with argument Pk.
        //    This step can be combined with c
        // c. If kPresent is true, then
        if (k in O) {
  
          // i. Let kValue be the result of calling the Get internal
          // method of O with argument Pk.
          kValue = O[k];
  
          // ii. Call the Call internal method of callback with T as
          // the this value and argument list containing kValue, k, and O.
          callback.call(T, kValue, k, O);
        }
        // d. Increase k by 1.
        k++;
      }
      // 8. return undefined
    };
}
if (window.NodeList && !NodeList.prototype.forEach) {
    NodeList.prototype.forEach = function (callback, thisArg) {
        thisArg = thisArg || window;
        for (var i = 0; i < this.length; i++) {
            callback.call(thisArg, this[i], i, this);
        }
    };
}
// Polyfill for 'matches' method - https://developer.mozilla.org/en-US/docs/Web/API/Element/matches 
if (!Element.prototype.matches) {
    Element.prototype.matches = 
        Element.prototype.matchesSelector || 
        Element.prototype.mozMatchesSelector ||
        Element.prototype.msMatchesSelector || 
        Element.prototype.oMatchesSelector || 
        Element.prototype.webkitMatchesSelector ||
        function(s) {
          var matches = (this.document || this.ownerDocument).querySelectorAll(s),
              i = matches.length;
          while (--i >= 0 && matches.item(i) !== this) {}
          return i > -1;            
        };
}
/* Taken from: http://tosbourn.com/a-fix-for-window-location-origin-in-internet-explorer/ */

if (!window.location.origin) {
  window.location.origin = window.location.protocol + "//" + window.location.hostname + (window.location.port ? ':' + window.location.port: '');
}

if (!Array.prototype.filter)
{
  Array.prototype.filter = function(fun /*, thisp */)
  {
    "use strict";

    if (this === void 0 || this === null)
      throw new TypeError();

    var t = Object(this);
    var len = t.length >>> 0;
    if (typeof fun !== "function")
      throw new TypeError();

    var res = [];
    var thisp = arguments[1];
    for (var i = 0; i < len; i++)
    {
      if (i in t)
      {
        var val = t[i]; // in case fun mutates this
        if (fun.call(thisp, val, i, t))
          res.push(val);
      }
    }

    return res;
  };
}
window.$xa = function () {
    var xaJquery, xaJqueryUI;
    /*! jQuery v3.3.1 | (c) JS Foundation and other contributors | jquery.org/license */
    !function (e, t) { "use strict"; "object" == typeof module && "object" == typeof module.exports ? module.exports = e.document ? t(e, !0) : function (e) { if (!e.document) throw new Error("jQuery requires a window with a document"); return t(e) } : t(e) }("undefined" != typeof window ? window : this, function (e, t) { "use strict"; var n = [], r = e.document, i = Object.getPrototypeOf, o = n.slice, a = n.concat, s = n.push, u = n.indexOf, l = {}, c = l.toString, f = l.hasOwnProperty, p = f.toString, d = p.call(Object), h = {}, g = function e(t) { return "function" == typeof t && "number" != typeof t.nodeType }, y = function e(t) { return null != t && t === t.window }, v = { type: !0, src: !0, noModule: !0 }; function m(e, t, n) { var i, o = (t = t || r).createElement("script"); if (o.text = e, n) for (i in v) n[i] && (o[i] = n[i]); t.head.appendChild(o).parentNode.removeChild(o) } function x(e) { return null == e ? e + "" : "object" == typeof e || "function" == typeof e ? l[c.call(e)] || "object" : typeof e } var b = "3.3.1", w = function (e, t) { return new w.fn.init(e, t) }, T = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g; w.fn = w.prototype = { jquery: "3.3.1", constructor: w, length: 0, toArray: function () { return o.call(this) }, get: function (e) { return null == e ? o.call(this) : e < 0 ? this[e + this.length] : this[e] }, pushStack: function (e) { var t = w.merge(this.constructor(), e); return t.prevObject = this, t }, each: function (e) { return w.each(this, e) }, map: function (e) { return this.pushStack(w.map(this, function (t, n) { return e.call(t, n, t) })) }, slice: function () { return this.pushStack(o.apply(this, arguments)) }, first: function () { return this.eq(0) }, last: function () { return this.eq(-1) }, eq: function (e) { var t = this.length, n = +e + (e < 0 ? t : 0); return this.pushStack(n >= 0 && n < t ? [this[n]] : []) }, end: function () { return this.prevObject || this.constructor() }, push: s, sort: n.sort, splice: n.splice }, w.extend = w.fn.extend = function () { var e, t, n, r, i, o, a = arguments[0] || {}, s = 1, u = arguments.length, l = !1; for ("boolean" == typeof a && (l = a, a = arguments[s] || {}, s++), "object" == typeof a || g(a) || (a = {}), s === u && (a = this, s--); s < u; s++)if (null != (e = arguments[s])) for (t in e) n = a[t], a !== (r = e[t]) && (l && r && (w.isPlainObject(r) || (i = Array.isArray(r))) ? (i ? (i = !1, o = n && Array.isArray(n) ? n : []) : o = n && w.isPlainObject(n) ? n : {}, a[t] = w.extend(l, o, r)) : void 0 !== r && (a[t] = r)); return a }, w.extend({ expando: "jQuery" + ("3.3.1" + Math.random()).replace(/\D/g, ""), isReady: !0, error: function (e) { throw new Error(e) }, noop: function () { }, isPlainObject: function (e) { var t, n; return !(!e || "[object Object]" !== c.call(e)) && (!(t = i(e)) || "function" == typeof (n = f.call(t, "constructor") && t.constructor) && p.call(n) === d) }, isEmptyObject: function (e) { var t; for (t in e) return !1; return !0 }, globalEval: function (e) { m(e) }, each: function (e, t) { var n, r = 0; if (C(e)) { for (n = e.length; r < n; r++)if (!1 === t.call(e[r], r, e[r])) break } else for (r in e) if (!1 === t.call(e[r], r, e[r])) break; return e }, trim: function (e) { return null == e ? "" : (e + "").replace(T, "") }, makeArray: function (e, t) { var n = t || []; return null != e && (C(Object(e)) ? w.merge(n, "string" == typeof e ? [e] : e) : s.call(n, e)), n }, inArray: function (e, t, n) { return null == t ? -1 : u.call(t, e, n) }, merge: function (e, t) { for (var n = +t.length, r = 0, i = e.length; r < n; r++)e[i++] = t[r]; return e.length = i, e }, grep: function (e, t, n) { for (var r, i = [], o = 0, a = e.length, s = !n; o < a; o++)(r = !t(e[o], o)) !== s && i.push(e[o]); return i }, map: function (e, t, n) { var r, i, o = 0, s = []; if (C(e)) for (r = e.length; o < r; o++)null != (i = t(e[o], o, n)) && s.push(i); else for (o in e) null != (i = t(e[o], o, n)) && s.push(i); return a.apply([], s) }, guid: 1, support: h }), "function" == typeof Symbol && (w.fn[Symbol.iterator] = n[Symbol.iterator]), w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function (e, t) { l["[object " + t + "]"] = t.toLowerCase() }); function C(e) { var t = !!e && "length" in e && e.length, n = x(e); return !g(e) && !y(e) && ("array" === n || 0 === t || "number" == typeof t && t > 0 && t - 1 in e) } var E = function (e) { var t, n, r, i, o, a, s, u, l, c, f, p, d, h, g, y, v, m, x, b = "sizzle" + 1 * new Date, w = e.document, T = 0, C = 0, E = ae(), k = ae(), S = ae(), D = function (e, t) { return e === t && (f = !0), 0 }, N = {}.hasOwnProperty, A = [], j = A.pop, q = A.push, L = A.push, H = A.slice, O = function (e, t) { for (var n = 0, r = e.length; n < r; n++)if (e[n] === t) return n; return -1 }, P = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", M = "[\\x20\\t\\r\\n\\f]", R = "(?:\\\\.|[\\w-]|[^\0-\\xa0])+", I = "\\[" + M + "*(" + R + ")(?:" + M + "*([*^$|!~]?=)" + M + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + R + "))|)" + M + "*\\]", W = ":(" + R + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + I + ")*)|.*)\\)|)", $ = new RegExp(M + "+", "g"), B = new RegExp("^" + M + "+|((?:^|[^\\\\])(?:\\\\.)*)" + M + "+$", "g"), F = new RegExp("^" + M + "*," + M + "*"), _ = new RegExp("^" + M + "*([>+~]|" + M + ")" + M + "*"), z = new RegExp("=" + M + "*([^\\]'\"]*?)" + M + "*\\]", "g"), X = new RegExp(W), U = new RegExp("^" + R + "$"), V = { ID: new RegExp("^#(" + R + ")"), CLASS: new RegExp("^\\.(" + R + ")"), TAG: new RegExp("^(" + R + "|[*])"), ATTR: new RegExp("^" + I), PSEUDO: new RegExp("^" + W), CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + M + "*(even|odd|(([+-]|)(\\d*)n|)" + M + "*(?:([+-]|)" + M + "*(\\d+)|))" + M + "*\\)|)", "i"), bool: new RegExp("^(?:" + P + ")$", "i"), needsContext: new RegExp("^" + M + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + M + "*((?:-\\d)?\\d*)" + M + "*\\)|)(?=[^-]|$)", "i") }, G = /^(?:input|select|textarea|button)$/i, Y = /^h\d$/i, Q = /^[^{]+\{\s*\[native \w/, J = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, K = /[+~]/, Z = new RegExp("\\\\([\\da-f]{1,6}" + M + "?|(" + M + ")|.)", "ig"), ee = function (e, t, n) { var r = "0x" + t - 65536; return r !== r || n ? t : r < 0 ? String.fromCharCode(r + 65536) : String.fromCharCode(r >> 10 | 55296, 1023 & r | 56320) }, te = /([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g, ne = function (e, t) { return t ? "\0" === e ? "\ufffd" : e.slice(0, -1) + "\\" + e.charCodeAt(e.length - 1).toString(16) + " " : "\\" + e }, re = function () { p() }, ie = me(function (e) { return !0 === e.disabled && ("form" in e || "label" in e) }, { dir: "parentNode", next: "legend" }); try { L.apply(A = H.call(w.childNodes), w.childNodes), A[w.childNodes.length].nodeType } catch (e) { L = { apply: A.length ? function (e, t) { q.apply(e, H.call(t)) } : function (e, t) { var n = e.length, r = 0; while (e[n++] = t[r++]); e.length = n - 1 } } } function oe(e, t, r, i) { var o, s, l, c, f, h, v, m = t && t.ownerDocument, T = t ? t.nodeType : 9; if (r = r || [], "string" != typeof e || !e || 1 !== T && 9 !== T && 11 !== T) return r; if (!i && ((t ? t.ownerDocument || t : w) !== d && p(t), t = t || d, g)) { if (11 !== T && (f = J.exec(e))) if (o = f[1]) { if (9 === T) { if (!(l = t.getElementById(o))) return r; if (l.id === o) return r.push(l), r } else if (m && (l = m.getElementById(o)) && x(t, l) && l.id === o) return r.push(l), r } else { if (f[2]) return L.apply(r, t.getElementsByTagName(e)), r; if ((o = f[3]) && n.getElementsByClassName && t.getElementsByClassName) return L.apply(r, t.getElementsByClassName(o)), r } if (n.qsa && !S[e + " "] && (!y || !y.test(e))) { if (1 !== T) m = t, v = e; else if ("object" !== t.nodeName.toLowerCase()) { (c = t.getAttribute("id")) ? c = c.replace(te, ne) : t.setAttribute("id", c = b), s = (h = a(e)).length; while (s--) h[s] = "#" + c + " " + ve(h[s]); v = h.join(","), m = K.test(e) && ge(t.parentNode) || t } if (v) try { return L.apply(r, m.querySelectorAll(v)), r } catch (e) { } finally { c === b && t.removeAttribute("id") } } } return u(e.replace(B, "$1"), t, r, i) } function ae() { var e = []; function t(n, i) { return e.push(n + " ") > r.cacheLength && delete t[e.shift()], t[n + " "] = i } return t } function se(e) { return e[b] = !0, e } function ue(e) { var t = d.createElement("fieldset"); try { return !!e(t) } catch (e) { return !1 } finally { t.parentNode && t.parentNode.removeChild(t), t = null } } function le(e, t) { var n = e.split("|"), i = n.length; while (i--) r.attrHandle[n[i]] = t } function ce(e, t) { var n = t && e, r = n && 1 === e.nodeType && 1 === t.nodeType && e.sourceIndex - t.sourceIndex; if (r) return r; if (n) while (n = n.nextSibling) if (n === t) return -1; return e ? 1 : -1 } function fe(e) { return function (t) { return "input" === t.nodeName.toLowerCase() && t.type === e } } function pe(e) { return function (t) { var n = t.nodeName.toLowerCase(); return ("input" === n || "button" === n) && t.type === e } } function de(e) { return function (t) { return "form" in t ? t.parentNode && !1 === t.disabled ? "label" in t ? "label" in t.parentNode ? t.parentNode.disabled === e : t.disabled === e : t.isDisabled === e || t.isDisabled !== !e && ie(t) === e : t.disabled === e : "label" in t && t.disabled === e } } function he(e) { return se(function (t) { return t = +t, se(function (n, r) { var i, o = e([], n.length, t), a = o.length; while (a--) n[i = o[a]] && (n[i] = !(r[i] = n[i])) }) }) } function ge(e) { return e && "undefined" != typeof e.getElementsByTagName && e } n = oe.support = {}, o = oe.isXML = function (e) { var t = e && (e.ownerDocument || e).documentElement; return !!t && "HTML" !== t.nodeName }, p = oe.setDocument = function (e) { var t, i, a = e ? e.ownerDocument || e : w; return a !== d && 9 === a.nodeType && a.documentElement ? (d = a, h = d.documentElement, g = !o(d), w !== d && (i = d.defaultView) && i.top !== i && (i.addEventListener ? i.addEventListener("unload", re, !1) : i.attachEvent && i.attachEvent("onunload", re)), n.attributes = ue(function (e) { return e.className = "i", !e.getAttribute("className") }), n.getElementsByTagName = ue(function (e) { return e.appendChild(d.createComment("")), !e.getElementsByTagName("*").length }), n.getElementsByClassName = Q.test(d.getElementsByClassName), n.getById = ue(function (e) { return h.appendChild(e).id = b, !d.getElementsByName || !d.getElementsByName(b).length }), n.getById ? (r.filter.ID = function (e) { var t = e.replace(Z, ee); return function (e) { return e.getAttribute("id") === t } }, r.find.ID = function (e, t) { if ("undefined" != typeof t.getElementById && g) { var n = t.getElementById(e); return n ? [n] : [] } }) : (r.filter.ID = function (e) { var t = e.replace(Z, ee); return function (e) { var n = "undefined" != typeof e.getAttributeNode && e.getAttributeNode("id"); return n && n.value === t } }, r.find.ID = function (e, t) { if ("undefined" != typeof t.getElementById && g) { var n, r, i, o = t.getElementById(e); if (o) { if ((n = o.getAttributeNode("id")) && n.value === e) return [o]; i = t.getElementsByName(e), r = 0; while (o = i[r++]) if ((n = o.getAttributeNode("id")) && n.value === e) return [o] } return [] } }), r.find.TAG = n.getElementsByTagName ? function (e, t) { return "undefined" != typeof t.getElementsByTagName ? t.getElementsByTagName(e) : n.qsa ? t.querySelectorAll(e) : void 0 } : function (e, t) { var n, r = [], i = 0, o = t.getElementsByTagName(e); if ("*" === e) { while (n = o[i++]) 1 === n.nodeType && r.push(n); return r } return o }, r.find.CLASS = n.getElementsByClassName && function (e, t) { if ("undefined" != typeof t.getElementsByClassName && g) return t.getElementsByClassName(e) }, v = [], y = [], (n.qsa = Q.test(d.querySelectorAll)) && (ue(function (e) { h.appendChild(e).innerHTML = "<a id='" + b + "'></a><select id='" + b + "-\r\\' msallowcapture=''><option selected=''></option></select>", e.querySelectorAll("[msallowcapture^='']").length && y.push("[*^$]=" + M + "*(?:''|\"\")"), e.querySelectorAll("[selected]").length || y.push("\\[" + M + "*(?:value|" + P + ")"), e.querySelectorAll("[id~=" + b + "-]").length || y.push("~="), e.querySelectorAll(":checked").length || y.push(":checked"), e.querySelectorAll("a#" + b + "+*").length || y.push(".#.+[+~]") }), ue(function (e) { e.innerHTML = "<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>"; var t = d.createElement("input"); t.setAttribute("type", "hidden"), e.appendChild(t).setAttribute("name", "D"), e.querySelectorAll("[name=d]").length && y.push("name" + M + "*[*^$|!~]?="), 2 !== e.querySelectorAll(":enabled").length && y.push(":enabled", ":disabled"), h.appendChild(e).disabled = !0, 2 !== e.querySelectorAll(":disabled").length && y.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), y.push(",.*:") })), (n.matchesSelector = Q.test(m = h.matches || h.webkitMatchesSelector || h.mozMatchesSelector || h.oMatchesSelector || h.msMatchesSelector)) && ue(function (e) { n.disconnectedMatch = m.call(e, "*"), m.call(e, "[s!='']:x"), v.push("!=", W) }), y = y.length && new RegExp(y.join("|")), v = v.length && new RegExp(v.join("|")), t = Q.test(h.compareDocumentPosition), x = t || Q.test(h.contains) ? function (e, t) { var n = 9 === e.nodeType ? e.documentElement : e, r = t && t.parentNode; return e === r || !(!r || 1 !== r.nodeType || !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r))) } : function (e, t) { if (t) while (t = t.parentNode) if (t === e) return !0; return !1 }, D = t ? function (e, t) { if (e === t) return f = !0, 0; var r = !e.compareDocumentPosition - !t.compareDocumentPosition; return r || (1 & (r = (e.ownerDocument || e) === (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1) || !n.sortDetached && t.compareDocumentPosition(e) === r ? e === d || e.ownerDocument === w && x(w, e) ? -1 : t === d || t.ownerDocument === w && x(w, t) ? 1 : c ? O(c, e) - O(c, t) : 0 : 4 & r ? -1 : 1) } : function (e, t) { if (e === t) return f = !0, 0; var n, r = 0, i = e.parentNode, o = t.parentNode, a = [e], s = [t]; if (!i || !o) return e === d ? -1 : t === d ? 1 : i ? -1 : o ? 1 : c ? O(c, e) - O(c, t) : 0; if (i === o) return ce(e, t); n = e; while (n = n.parentNode) a.unshift(n); n = t; while (n = n.parentNode) s.unshift(n); while (a[r] === s[r]) r++; return r ? ce(a[r], s[r]) : a[r] === w ? -1 : s[r] === w ? 1 : 0 }, d) : d }, oe.matches = function (e, t) { return oe(e, null, null, t) }, oe.matchesSelector = function (e, t) { if ((e.ownerDocument || e) !== d && p(e), t = t.replace(z, "='$1']"), n.matchesSelector && g && !S[t + " "] && (!v || !v.test(t)) && (!y || !y.test(t))) try { var r = m.call(e, t); if (r || n.disconnectedMatch || e.document && 11 !== e.document.nodeType) return r } catch (e) { } return oe(t, d, null, [e]).length > 0 }, oe.contains = function (e, t) { return (e.ownerDocument || e) !== d && p(e), x(e, t) }, oe.attr = function (e, t) { (e.ownerDocument || e) !== d && p(e); var i = r.attrHandle[t.toLowerCase()], o = i && N.call(r.attrHandle, t.toLowerCase()) ? i(e, t, !g) : void 0; return void 0 !== o ? o : n.attributes || !g ? e.getAttribute(t) : (o = e.getAttributeNode(t)) && o.specified ? o.value : null }, oe.escape = function (e) { return (e + "").replace(te, ne) }, oe.error = function (e) { throw new Error("Syntax error, unrecognized expression: " + e) }, oe.uniqueSort = function (e) { var t, r = [], i = 0, o = 0; if (f = !n.detectDuplicates, c = !n.sortStable && e.slice(0), e.sort(D), f) { while (t = e[o++]) t === e[o] && (i = r.push(o)); while (i--) e.splice(r[i], 1) } return c = null, e }, i = oe.getText = function (e) { var t, n = "", r = 0, o = e.nodeType; if (o) { if (1 === o || 9 === o || 11 === o) { if ("string" == typeof e.textContent) return e.textContent; for (e = e.firstChild; e; e = e.nextSibling)n += i(e) } else if (3 === o || 4 === o) return e.nodeValue } else while (t = e[r++]) n += i(t); return n }, (r = oe.selectors = { cacheLength: 50, createPseudo: se, match: V, attrHandle: {}, find: {}, relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling" } }, preFilter: { ATTR: function (e) { return e[1] = e[1].replace(Z, ee), e[3] = (e[3] || e[4] || e[5] || "").replace(Z, ee), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4) }, CHILD: function (e) { return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || oe.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && oe.error(e[0]), e }, PSEUDO: function (e) { var t, n = !e[6] && e[2]; return V.CHILD.test(e[0]) ? null : (e[3] ? e[2] = e[4] || e[5] || "" : n && X.test(n) && (t = a(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && (e[0] = e[0].slice(0, t), e[2] = n.slice(0, t)), e.slice(0, 3)) } }, filter: { TAG: function (e) { var t = e.replace(Z, ee).toLowerCase(); return "*" === e ? function () { return !0 } : function (e) { return e.nodeName && e.nodeName.toLowerCase() === t } }, CLASS: function (e) { var t = E[e + " "]; return t || (t = new RegExp("(^|" + M + ")" + e + "(" + M + "|$)")) && E(e, function (e) { return t.test("string" == typeof e.className && e.className || "undefined" != typeof e.getAttribute && e.getAttribute("class") || "") }) }, ATTR: function (e, t, n) { return function (r) { var i = oe.attr(r, e); return null == i ? "!=" === t : !t || (i += "", "=" === t ? i === n : "!=" === t ? i !== n : "^=" === t ? n && 0 === i.indexOf(n) : "*=" === t ? n && i.indexOf(n) > -1 : "$=" === t ? n && i.slice(-n.length) === n : "~=" === t ? (" " + i.replace($, " ") + " ").indexOf(n) > -1 : "|=" === t && (i === n || i.slice(0, n.length + 1) === n + "-")) } }, CHILD: function (e, t, n, r, i) { var o = "nth" !== e.slice(0, 3), a = "last" !== e.slice(-4), s = "of-type" === t; return 1 === r && 0 === i ? function (e) { return !!e.parentNode } : function (t, n, u) { var l, c, f, p, d, h, g = o !== a ? "nextSibling" : "previousSibling", y = t.parentNode, v = s && t.nodeName.toLowerCase(), m = !u && !s, x = !1; if (y) { if (o) { while (g) { p = t; while (p = p[g]) if (s ? p.nodeName.toLowerCase() === v : 1 === p.nodeType) return !1; h = g = "only" === e && !h && "nextSibling" } return !0 } if (h = [a ? y.firstChild : y.lastChild], a && m) { x = (d = (l = (c = (f = (p = y)[b] || (p[b] = {}))[p.uniqueID] || (f[p.uniqueID] = {}))[e] || [])[0] === T && l[1]) && l[2], p = d && y.childNodes[d]; while (p = ++d && p && p[g] || (x = d = 0) || h.pop()) if (1 === p.nodeType && ++x && p === t) { c[e] = [T, d, x]; break } } else if (m && (x = d = (l = (c = (f = (p = t)[b] || (p[b] = {}))[p.uniqueID] || (f[p.uniqueID] = {}))[e] || [])[0] === T && l[1]), !1 === x) while (p = ++d && p && p[g] || (x = d = 0) || h.pop()) if ((s ? p.nodeName.toLowerCase() === v : 1 === p.nodeType) && ++x && (m && ((c = (f = p[b] || (p[b] = {}))[p.uniqueID] || (f[p.uniqueID] = {}))[e] = [T, x]), p === t)) break; return (x -= i) === r || x % r == 0 && x / r >= 0 } } }, PSEUDO: function (e, t) { var n, i = r.pseudos[e] || r.setFilters[e.toLowerCase()] || oe.error("unsupported pseudo: " + e); return i[b] ? i(t) : i.length > 1 ? (n = [e, e, "", t], r.setFilters.hasOwnProperty(e.toLowerCase()) ? se(function (e, n) { var r, o = i(e, t), a = o.length; while (a--) e[r = O(e, o[a])] = !(n[r] = o[a]) }) : function (e) { return i(e, 0, n) }) : i } }, pseudos: { not: se(function (e) { var t = [], n = [], r = s(e.replace(B, "$1")); return r[b] ? se(function (e, t, n, i) { var o, a = r(e, null, i, []), s = e.length; while (s--) (o = a[s]) && (e[s] = !(t[s] = o)) }) : function (e, i, o) { return t[0] = e, r(t, null, o, n), t[0] = null, !n.pop() } }), has: se(function (e) { return function (t) { return oe(e, t).length > 0 } }), contains: se(function (e) { return e = e.replace(Z, ee), function (t) { return (t.textContent || t.innerText || i(t)).indexOf(e) > -1 } }), lang: se(function (e) { return U.test(e || "") || oe.error("unsupported lang: " + e), e = e.replace(Z, ee).toLowerCase(), function (t) { var n; do { if (n = g ? t.lang : t.getAttribute("xml:lang") || t.getAttribute("lang")) return (n = n.toLowerCase()) === e || 0 === n.indexOf(e + "-") } while ((t = t.parentNode) && 1 === t.nodeType); return !1 } }), target: function (t) { var n = e.location && e.location.hash; return n && n.slice(1) === t.id }, root: function (e) { return e === h }, focus: function (e) { return e === d.activeElement && (!d.hasFocus || d.hasFocus()) && !!(e.type || e.href || ~e.tabIndex) }, enabled: de(!1), disabled: de(!0), checked: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && !!e.checked || "option" === t && !!e.selected }, selected: function (e) { return e.parentNode && e.parentNode.selectedIndex, !0 === e.selected }, empty: function (e) { for (e = e.firstChild; e; e = e.nextSibling)if (e.nodeType < 6) return !1; return !0 }, parent: function (e) { return !r.pseudos.empty(e) }, header: function (e) { return Y.test(e.nodeName) }, input: function (e) { return G.test(e.nodeName) }, button: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && "button" === e.type || "button" === t }, text: function (e) { var t; return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || "text" === t.toLowerCase()) }, first: he(function () { return [0] }), last: he(function (e, t) { return [t - 1] }), eq: he(function (e, t, n) { return [n < 0 ? n + t : n] }), even: he(function (e, t) { for (var n = 0; n < t; n += 2)e.push(n); return e }), odd: he(function (e, t) { for (var n = 1; n < t; n += 2)e.push(n); return e }), lt: he(function (e, t, n) { for (var r = n < 0 ? n + t : n; --r >= 0;)e.push(r); return e }), gt: he(function (e, t, n) { for (var r = n < 0 ? n + t : n; ++r < t;)e.push(r); return e }) } }).pseudos.nth = r.pseudos.eq; for (t in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) r.pseudos[t] = fe(t); for (t in { submit: !0, reset: !0 }) r.pseudos[t] = pe(t); function ye() { } ye.prototype = r.filters = r.pseudos, r.setFilters = new ye, a = oe.tokenize = function (e, t) { var n, i, o, a, s, u, l, c = k[e + " "]; if (c) return t ? 0 : c.slice(0); s = e, u = [], l = r.preFilter; while (s) { n && !(i = F.exec(s)) || (i && (s = s.slice(i[0].length) || s), u.push(o = [])), n = !1, (i = _.exec(s)) && (n = i.shift(), o.push({ value: n, type: i[0].replace(B, " ") }), s = s.slice(n.length)); for (a in r.filter) !(i = V[a].exec(s)) || l[a] && !(i = l[a](i)) || (n = i.shift(), o.push({ value: n, type: a, matches: i }), s = s.slice(n.length)); if (!n) break } return t ? s.length : s ? oe.error(e) : k(e, u).slice(0) }; function ve(e) { for (var t = 0, n = e.length, r = ""; t < n; t++)r += e[t].value; return r } function me(e, t, n) { var r = t.dir, i = t.next, o = i || r, a = n && "parentNode" === o, s = C++; return t.first ? function (t, n, i) { while (t = t[r]) if (1 === t.nodeType || a) return e(t, n, i); return !1 } : function (t, n, u) { var l, c, f, p = [T, s]; if (u) { while (t = t[r]) if ((1 === t.nodeType || a) && e(t, n, u)) return !0 } else while (t = t[r]) if (1 === t.nodeType || a) if (f = t[b] || (t[b] = {}), c = f[t.uniqueID] || (f[t.uniqueID] = {}), i && i === t.nodeName.toLowerCase()) t = t[r] || t; else { if ((l = c[o]) && l[0] === T && l[1] === s) return p[2] = l[2]; if (c[o] = p, p[2] = e(t, n, u)) return !0 } return !1 } } function xe(e) { return e.length > 1 ? function (t, n, r) { var i = e.length; while (i--) if (!e[i](t, n, r)) return !1; return !0 } : e[0] } function be(e, t, n) { for (var r = 0, i = t.length; r < i; r++)oe(e, t[r], n); return n } function we(e, t, n, r, i) { for (var o, a = [], s = 0, u = e.length, l = null != t; s < u; s++)(o = e[s]) && (n && !n(o, r, i) || (a.push(o), l && t.push(s))); return a } function Te(e, t, n, r, i, o) { return r && !r[b] && (r = Te(r)), i && !i[b] && (i = Te(i, o)), se(function (o, a, s, u) { var l, c, f, p = [], d = [], h = a.length, g = o || be(t || "*", s.nodeType ? [s] : s, []), y = !e || !o && t ? g : we(g, p, e, s, u), v = n ? i || (o ? e : h || r) ? [] : a : y; if (n && n(y, v, s, u), r) { l = we(v, d), r(l, [], s, u), c = l.length; while (c--) (f = l[c]) && (v[d[c]] = !(y[d[c]] = f)) } if (o) { if (i || e) { if (i) { l = [], c = v.length; while (c--) (f = v[c]) && l.push(y[c] = f); i(null, v = [], l, u) } c = v.length; while (c--) (f = v[c]) && (l = i ? O(o, f) : p[c]) > -1 && (o[l] = !(a[l] = f)) } } else v = we(v === a ? v.splice(h, v.length) : v), i ? i(null, a, v, u) : L.apply(a, v) }) } function Ce(e) { for (var t, n, i, o = e.length, a = r.relative[e[0].type], s = a || r.relative[" "], u = a ? 1 : 0, c = me(function (e) { return e === t }, s, !0), f = me(function (e) { return O(t, e) > -1 }, s, !0), p = [function (e, n, r) { var i = !a && (r || n !== l) || ((t = n).nodeType ? c(e, n, r) : f(e, n, r)); return t = null, i }]; u < o; u++)if (n = r.relative[e[u].type]) p = [me(xe(p), n)]; else { if ((n = r.filter[e[u].type].apply(null, e[u].matches))[b]) { for (i = ++u; i < o; i++)if (r.relative[e[i].type]) break; return Te(u > 1 && xe(p), u > 1 && ve(e.slice(0, u - 1).concat({ value: " " === e[u - 2].type ? "*" : "" })).replace(B, "$1"), n, u < i && Ce(e.slice(u, i)), i < o && Ce(e = e.slice(i)), i < o && ve(e)) } p.push(n) } return xe(p) } function Ee(e, t) { var n = t.length > 0, i = e.length > 0, o = function (o, a, s, u, c) { var f, h, y, v = 0, m = "0", x = o && [], b = [], w = l, C = o || i && r.find.TAG("*", c), E = T += null == w ? 1 : Math.random() || .1, k = C.length; for (c && (l = a === d || a || c); m !== k && null != (f = C[m]); m++) { if (i && f) { h = 0, a || f.ownerDocument === d || (p(f), s = !g); while (y = e[h++]) if (y(f, a || d, s)) { u.push(f); break } c && (T = E) } n && ((f = !y && f) && v-- , o && x.push(f)) } if (v += m, n && m !== v) { h = 0; while (y = t[h++]) y(x, b, a, s); if (o) { if (v > 0) while (m--) x[m] || b[m] || (b[m] = j.call(u)); b = we(b) } L.apply(u, b), c && !o && b.length > 0 && v + t.length > 1 && oe.uniqueSort(u) } return c && (T = E, l = w), x }; return n ? se(o) : o } return s = oe.compile = function (e, t) { var n, r = [], i = [], o = S[e + " "]; if (!o) { t || (t = a(e)), n = t.length; while (n--) (o = Ce(t[n]))[b] ? r.push(o) : i.push(o); (o = S(e, Ee(i, r))).selector = e } return o }, u = oe.select = function (e, t, n, i) { var o, u, l, c, f, p = "function" == typeof e && e, d = !i && a(e = p.selector || e); if (n = n || [], 1 === d.length) { if ((u = d[0] = d[0].slice(0)).length > 2 && "ID" === (l = u[0]).type && 9 === t.nodeType && g && r.relative[u[1].type]) { if (!(t = (r.find.ID(l.matches[0].replace(Z, ee), t) || [])[0])) return n; p && (t = t.parentNode), e = e.slice(u.shift().value.length) } o = V.needsContext.test(e) ? 0 : u.length; while (o--) { if (l = u[o], r.relative[c = l.type]) break; if ((f = r.find[c]) && (i = f(l.matches[0].replace(Z, ee), K.test(u[0].type) && ge(t.parentNode) || t))) { if (u.splice(o, 1), !(e = i.length && ve(u))) return L.apply(n, i), n; break } } } return (p || s(e, d))(i, t, !g, n, !t || K.test(e) && ge(t.parentNode) || t), n }, n.sortStable = b.split("").sort(D).join("") === b, n.detectDuplicates = !!f, p(), n.sortDetached = ue(function (e) { return 1 & e.compareDocumentPosition(d.createElement("fieldset")) }), ue(function (e) { return e.innerHTML = "<a href='#'></a>", "#" === e.firstChild.getAttribute("href") }) || le("type|href|height|width", function (e, t, n) { if (!n) return e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2) }), n.attributes && ue(function (e) { return e.innerHTML = "<input/>", e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value") }) || le("value", function (e, t, n) { if (!n && "input" === e.nodeName.toLowerCase()) return e.defaultValue }), ue(function (e) { return null == e.getAttribute("disabled") }) || le(P, function (e, t, n) { var r; if (!n) return !0 === e[t] ? t.toLowerCase() : (r = e.getAttributeNode(t)) && r.specified ? r.value : null }), oe }(e); w.find = E, w.expr = E.selectors, w.expr[":"] = w.expr.pseudos, w.uniqueSort = w.unique = E.uniqueSort, w.text = E.getText, w.isXMLDoc = E.isXML, w.contains = E.contains, w.escapeSelector = E.escape; var k = function (e, t, n) { var r = [], i = void 0 !== n; while ((e = e[t]) && 9 !== e.nodeType) if (1 === e.nodeType) { if (i && w(e).is(n)) break; r.push(e) } return r }, S = function (e, t) { for (var n = []; e; e = e.nextSibling)1 === e.nodeType && e !== t && n.push(e); return n }, D = w.expr.match.needsContext; function N(e, t) { return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase() } var A = /^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i; function j(e, t, n) { return g(t) ? w.grep(e, function (e, r) { return !!t.call(e, r, e) !== n }) : t.nodeType ? w.grep(e, function (e) { return e === t !== n }) : "string" != typeof t ? w.grep(e, function (e) { return u.call(t, e) > -1 !== n }) : w.filter(t, e, n) } w.filter = function (e, t, n) { var r = t[0]; return n && (e = ":not(" + e + ")"), 1 === t.length && 1 === r.nodeType ? w.find.matchesSelector(r, e) ? [r] : [] : w.find.matches(e, w.grep(t, function (e) { return 1 === e.nodeType })) }, w.fn.extend({ find: function (e) { var t, n, r = this.length, i = this; if ("string" != typeof e) return this.pushStack(w(e).filter(function () { for (t = 0; t < r; t++)if (w.contains(i[t], this)) return !0 })); for (n = this.pushStack([]), t = 0; t < r; t++)w.find(e, i[t], n); return r > 1 ? w.uniqueSort(n) : n }, filter: function (e) { return this.pushStack(j(this, e || [], !1)) }, not: function (e) { return this.pushStack(j(this, e || [], !0)) }, is: function (e) { return !!j(this, "string" == typeof e && D.test(e) ? w(e) : e || [], !1).length } }); var q, L = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/; (w.fn.init = function (e, t, n) { var i, o; if (!e) return this; if (n = n || q, "string" == typeof e) { if (!(i = "<" === e[0] && ">" === e[e.length - 1] && e.length >= 3 ? [null, e, null] : L.exec(e)) || !i[1] && t) return !t || t.jquery ? (t || n).find(e) : this.constructor(t).find(e); if (i[1]) { if (t = t instanceof w ? t[0] : t, w.merge(this, w.parseHTML(i[1], t && t.nodeType ? t.ownerDocument || t : r, !0)), A.test(i[1]) && w.isPlainObject(t)) for (i in t) g(this[i]) ? this[i](t[i]) : this.attr(i, t[i]); return this } return (o = r.getElementById(i[2])) && (this[0] = o, this.length = 1), this } return e.nodeType ? (this[0] = e, this.length = 1, this) : g(e) ? void 0 !== n.ready ? n.ready(e) : e(w) : w.makeArray(e, this) }).prototype = w.fn, q = w(r); var H = /^(?:parents|prev(?:Until|All))/, O = { children: !0, contents: !0, next: !0, prev: !0 }; w.fn.extend({ has: function (e) { var t = w(e, this), n = t.length; return this.filter(function () { for (var e = 0; e < n; e++)if (w.contains(this, t[e])) return !0 }) }, closest: function (e, t) { var n, r = 0, i = this.length, o = [], a = "string" != typeof e && w(e); if (!D.test(e)) for (; r < i; r++)for (n = this[r]; n && n !== t; n = n.parentNode)if (n.nodeType < 11 && (a ? a.index(n) > -1 : 1 === n.nodeType && w.find.matchesSelector(n, e))) { o.push(n); break } return this.pushStack(o.length > 1 ? w.uniqueSort(o) : o) }, index: function (e) { return e ? "string" == typeof e ? u.call(w(e), this[0]) : u.call(this, e.jquery ? e[0] : e) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1 }, add: function (e, t) { return this.pushStack(w.uniqueSort(w.merge(this.get(), w(e, t)))) }, addBack: function (e) { return this.add(null == e ? this.prevObject : this.prevObject.filter(e)) } }); function P(e, t) { while ((e = e[t]) && 1 !== e.nodeType); return e } w.each({ parent: function (e) { var t = e.parentNode; return t && 11 !== t.nodeType ? t : null }, parents: function (e) { return k(e, "parentNode") }, parentsUntil: function (e, t, n) { return k(e, "parentNode", n) }, next: function (e) { return P(e, "nextSibling") }, prev: function (e) { return P(e, "previousSibling") }, nextAll: function (e) { return k(e, "nextSibling") }, prevAll: function (e) { return k(e, "previousSibling") }, nextUntil: function (e, t, n) { return k(e, "nextSibling", n) }, prevUntil: function (e, t, n) { return k(e, "previousSibling", n) }, siblings: function (e) { return S((e.parentNode || {}).firstChild, e) }, children: function (e) { return S(e.firstChild) }, contents: function (e) { return N(e, "iframe") ? e.contentDocument : (N(e, "template") && (e = e.content || e), w.merge([], e.childNodes)) } }, function (e, t) { w.fn[e] = function (n, r) { var i = w.map(this, t, n); return "Until" !== e.slice(-5) && (r = n), r && "string" == typeof r && (i = w.filter(r, i)), this.length > 1 && (O[e] || w.uniqueSort(i), H.test(e) && i.reverse()), this.pushStack(i) } }); var M = /[^\x20\t\r\n\f]+/g; function R(e) { var t = {}; return w.each(e.match(M) || [], function (e, n) { t[n] = !0 }), t } w.Callbacks = function (e) { e = "string" == typeof e ? R(e) : w.extend({}, e); var t, n, r, i, o = [], a = [], s = -1, u = function () { for (i = i || e.once, r = t = !0; a.length; s = -1) { n = a.shift(); while (++s < o.length) !1 === o[s].apply(n[0], n[1]) && e.stopOnFalse && (s = o.length, n = !1) } e.memory || (n = !1), t = !1, i && (o = n ? [] : "") }, l = { add: function () { return o && (n && !t && (s = o.length - 1, a.push(n)), function t(n) { w.each(n, function (n, r) { g(r) ? e.unique && l.has(r) || o.push(r) : r && r.length && "string" !== x(r) && t(r) }) }(arguments), n && !t && u()), this }, remove: function () { return w.each(arguments, function (e, t) { var n; while ((n = w.inArray(t, o, n)) > -1) o.splice(n, 1), n <= s && s-- }), this }, has: function (e) { return e ? w.inArray(e, o) > -1 : o.length > 0 }, empty: function () { return o && (o = []), this }, disable: function () { return i = a = [], o = n = "", this }, disabled: function () { return !o }, lock: function () { return i = a = [], n || t || (o = n = ""), this }, locked: function () { return !!i }, fireWith: function (e, n) { return i || (n = [e, (n = n || []).slice ? n.slice() : n], a.push(n), t || u()), this }, fire: function () { return l.fireWith(this, arguments), this }, fired: function () { return !!r } }; return l }; function I(e) { return e } function W(e) { throw e } function $(e, t, n, r) { var i; try { e && g(i = e.promise) ? i.call(e).done(t).fail(n) : e && g(i = e.then) ? i.call(e, t, n) : t.apply(void 0, [e].slice(r)) } catch (e) { n.apply(void 0, [e]) } } w.extend({ Deferred: function (t) { var n = [["notify", "progress", w.Callbacks("memory"), w.Callbacks("memory"), 2], ["resolve", "done", w.Callbacks("once memory"), w.Callbacks("once memory"), 0, "resolved"], ["reject", "fail", w.Callbacks("once memory"), w.Callbacks("once memory"), 1, "rejected"]], r = "pending", i = { state: function () { return r }, always: function () { return o.done(arguments).fail(arguments), this }, "catch": function (e) { return i.then(null, e) }, pipe: function () { var e = arguments; return w.Deferred(function (t) { w.each(n, function (n, r) { var i = g(e[r[4]]) && e[r[4]]; o[r[1]](function () { var e = i && i.apply(this, arguments); e && g(e.promise) ? e.promise().progress(t.notify).done(t.resolve).fail(t.reject) : t[r[0] + "With"](this, i ? [e] : arguments) }) }), e = null }).promise() }, then: function (t, r, i) { var o = 0; function a(t, n, r, i) { return function () { var s = this, u = arguments, l = function () { var e, l; if (!(t < o)) { if ((e = r.apply(s, u)) === n.promise()) throw new TypeError("Thenable self-resolution"); l = e && ("object" == typeof e || "function" == typeof e) && e.then, g(l) ? i ? l.call(e, a(o, n, I, i), a(o, n, W, i)) : (o++ , l.call(e, a(o, n, I, i), a(o, n, W, i), a(o, n, I, n.notifyWith))) : (r !== I && (s = void 0, u = [e]), (i || n.resolveWith)(s, u)) } }, c = i ? l : function () { try { l() } catch (e) { w.Deferred.exceptionHook && w.Deferred.exceptionHook(e, c.stackTrace), t + 1 >= o && (r !== W && (s = void 0, u = [e]), n.rejectWith(s, u)) } }; t ? c() : (w.Deferred.getStackHook && (c.stackTrace = w.Deferred.getStackHook()), e.setTimeout(c)) } } return w.Deferred(function (e) { n[0][3].add(a(0, e, g(i) ? i : I, e.notifyWith)), n[1][3].add(a(0, e, g(t) ? t : I)), n[2][3].add(a(0, e, g(r) ? r : W)) }).promise() }, promise: function (e) { return null != e ? w.extend(e, i) : i } }, o = {}; return w.each(n, function (e, t) { var a = t[2], s = t[5]; i[t[1]] = a.add, s && a.add(function () { r = s }, n[3 - e][2].disable, n[3 - e][3].disable, n[0][2].lock, n[0][3].lock), a.add(t[3].fire), o[t[0]] = function () { return o[t[0] + "With"](this === o ? void 0 : this, arguments), this }, o[t[0] + "With"] = a.fireWith }), i.promise(o), t && t.call(o, o), o }, when: function (e) { var t = arguments.length, n = t, r = Array(n), i = o.call(arguments), a = w.Deferred(), s = function (e) { return function (n) { r[e] = this, i[e] = arguments.length > 1 ? o.call(arguments) : n, --t || a.resolveWith(r, i) } }; if (t <= 1 && ($(e, a.done(s(n)).resolve, a.reject, !t), "pending" === a.state() || g(i[n] && i[n].then))) return a.then(); while (n--) $(i[n], s(n), a.reject); return a.promise() } }); var B = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/; w.Deferred.exceptionHook = function (t, n) { e.console && e.console.warn && t && B.test(t.name) && e.console.warn("jQuery.Deferred exception: " + t.message, t.stack, n) }, w.readyException = function (t) { e.setTimeout(function () { throw t }) }; var F = w.Deferred(); w.fn.ready = function (e) { return F.then(e)["catch"](function (e) { w.readyException(e) }), this }, w.extend({ isReady: !1, readyWait: 1, ready: function (e) { (!0 === e ? --w.readyWait : w.isReady) || (w.isReady = !0, !0 !== e && --w.readyWait > 0 || F.resolveWith(r, [w])) } }), w.ready.then = F.then; function _() { r.removeEventListener("DOMContentLoaded", _), e.removeEventListener("load", _), w.ready() } "complete" === r.readyState || "loading" !== r.readyState && !r.documentElement.doScroll ? e.setTimeout(w.ready) : (r.addEventListener("DOMContentLoaded", _), e.addEventListener("load", _)); var z = function (e, t, n, r, i, o, a) { var s = 0, u = e.length, l = null == n; if ("object" === x(n)) { i = !0; for (s in n) z(e, t, s, n[s], !0, o, a) } else if (void 0 !== r && (i = !0, g(r) || (a = !0), l && (a ? (t.call(e, r), t = null) : (l = t, t = function (e, t, n) { return l.call(w(e), n) })), t)) for (; s < u; s++)t(e[s], n, a ? r : r.call(e[s], s, t(e[s], n))); return i ? e : l ? t.call(e) : u ? t(e[0], n) : o }, X = /^-ms-/, U = /-([a-z])/g; function V(e, t) { return t.toUpperCase() } function G(e) { return e.replace(X, "ms-").replace(U, V) } var Y = function (e) { return 1 === e.nodeType || 9 === e.nodeType || !+e.nodeType }; function Q() { this.expando = w.expando + Q.uid++ } Q.uid = 1, Q.prototype = { cache: function (e) { var t = e[this.expando]; return t || (t = {}, Y(e) && (e.nodeType ? e[this.expando] = t : Object.defineProperty(e, this.expando, { value: t, configurable: !0 }))), t }, set: function (e, t, n) { var r, i = this.cache(e); if ("string" == typeof t) i[G(t)] = n; else for (r in t) i[G(r)] = t[r]; return i }, get: function (e, t) { return void 0 === t ? this.cache(e) : e[this.expando] && e[this.expando][G(t)] }, access: function (e, t, n) { return void 0 === t || t && "string" == typeof t && void 0 === n ? this.get(e, t) : (this.set(e, t, n), void 0 !== n ? n : t) }, remove: function (e, t) { var n, r = e[this.expando]; if (void 0 !== r) { if (void 0 !== t) { n = (t = Array.isArray(t) ? t.map(G) : (t = G(t)) in r ? [t] : t.match(M) || []).length; while (n--) delete r[t[n]] } (void 0 === t || w.isEmptyObject(r)) && (e.nodeType ? e[this.expando] = void 0 : delete e[this.expando]) } }, hasData: function (e) { var t = e[this.expando]; return void 0 !== t && !w.isEmptyObject(t) } }; var J = new Q, K = new Q, Z = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/, ee = /[A-Z]/g; function te(e) { return "true" === e || "false" !== e && ("null" === e ? null : e === +e + "" ? +e : Z.test(e) ? JSON.parse(e) : e) } function ne(e, t, n) { var r; if (void 0 === n && 1 === e.nodeType) if (r = "data-" + t.replace(ee, "-$&").toLowerCase(), "string" == typeof (n = e.getAttribute(r))) { try { n = te(n) } catch (e) { } K.set(e, t, n) } else n = void 0; return n } w.extend({ hasData: function (e) { return K.hasData(e) || J.hasData(e) }, data: function (e, t, n) { return K.access(e, t, n) }, removeData: function (e, t) { K.remove(e, t) }, _data: function (e, t, n) { return J.access(e, t, n) }, _removeData: function (e, t) { J.remove(e, t) } }), w.fn.extend({ data: function (e, t) { var n, r, i, o = this[0], a = o && o.attributes; if (void 0 === e) { if (this.length && (i = K.get(o), 1 === o.nodeType && !J.get(o, "hasDataAttrs"))) { n = a.length; while (n--) a[n] && 0 === (r = a[n].name).indexOf("data-") && (r = G(r.slice(5)), ne(o, r, i[r])); J.set(o, "hasDataAttrs", !0) } return i } return "object" == typeof e ? this.each(function () { K.set(this, e) }) : z(this, function (t) { var n; if (o && void 0 === t) { if (void 0 !== (n = K.get(o, e))) return n; if (void 0 !== (n = ne(o, e))) return n } else this.each(function () { K.set(this, e, t) }) }, null, t, arguments.length > 1, null, !0) }, removeData: function (e) { return this.each(function () { K.remove(this, e) }) } }), w.extend({ queue: function (e, t, n) { var r; if (e) return t = (t || "fx") + "queue", r = J.get(e, t), n && (!r || Array.isArray(n) ? r = J.access(e, t, w.makeArray(n)) : r.push(n)), r || [] }, dequeue: function (e, t) { t = t || "fx"; var n = w.queue(e, t), r = n.length, i = n.shift(), o = w._queueHooks(e, t), a = function () { w.dequeue(e, t) }; "inprogress" === i && (i = n.shift(), r--), i && ("fx" === t && n.unshift("inprogress"), delete o.stop, i.call(e, a, o)), !r && o && o.empty.fire() }, _queueHooks: function (e, t) { var n = t + "queueHooks"; return J.get(e, n) || J.access(e, n, { empty: w.Callbacks("once memory").add(function () { J.remove(e, [t + "queue", n]) }) }) } }), w.fn.extend({ queue: function (e, t) { var n = 2; return "string" != typeof e && (t = e, e = "fx", n--), arguments.length < n ? w.queue(this[0], e) : void 0 === t ? this : this.each(function () { var n = w.queue(this, e, t); w._queueHooks(this, e), "fx" === e && "inprogress" !== n[0] && w.dequeue(this, e) }) }, dequeue: function (e) { return this.each(function () { w.dequeue(this, e) }) }, clearQueue: function (e) { return this.queue(e || "fx", []) }, promise: function (e, t) { var n, r = 1, i = w.Deferred(), o = this, a = this.length, s = function () { --r || i.resolveWith(o, [o]) }; "string" != typeof e && (t = e, e = void 0), e = e || "fx"; while (a--) (n = J.get(o[a], e + "queueHooks")) && n.empty && (r++ , n.empty.add(s)); return s(), i.promise(t) } }); var re = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, ie = new RegExp("^(?:([+-])=|)(" + re + ")([a-z%]*)$", "i"), oe = ["Top", "Right", "Bottom", "Left"], ae = function (e, t) { return "none" === (e = t || e).style.display || "" === e.style.display && w.contains(e.ownerDocument, e) && "none" === w.css(e, "display") }, se = function (e, t, n, r) { var i, o, a = {}; for (o in t) a[o] = e.style[o], e.style[o] = t[o]; i = n.apply(e, r || []); for (o in t) e.style[o] = a[o]; return i }; function ue(e, t, n, r) { var i, o, a = 20, s = r ? function () { return r.cur() } : function () { return w.css(e, t, "") }, u = s(), l = n && n[3] || (w.cssNumber[t] ? "" : "px"), c = (w.cssNumber[t] || "px" !== l && +u) && ie.exec(w.css(e, t)); if (c && c[3] !== l) { u /= 2, l = l || c[3], c = +u || 1; while (a--) w.style(e, t, c + l), (1 - o) * (1 - (o = s() / u || .5)) <= 0 && (a = 0), c /= o; c *= 2, w.style(e, t, c + l), n = n || [] } return n && (c = +c || +u || 0, i = n[1] ? c + (n[1] + 1) * n[2] : +n[2], r && (r.unit = l, r.start = c, r.end = i)), i } var le = {}; function ce(e) { var t, n = e.ownerDocument, r = e.nodeName, i = le[r]; return i || (t = n.body.appendChild(n.createElement(r)), i = w.css(t, "display"), t.parentNode.removeChild(t), "none" === i && (i = "block"), le[r] = i, i) } function fe(e, t) { for (var n, r, i = [], o = 0, a = e.length; o < a; o++)(r = e[o]).style && (n = r.style.display, t ? ("none" === n && (i[o] = J.get(r, "display") || null, i[o] || (r.style.display = "")), "" === r.style.display && ae(r) && (i[o] = ce(r))) : "none" !== n && (i[o] = "none", J.set(r, "display", n))); for (o = 0; o < a; o++)null != i[o] && (e[o].style.display = i[o]); return e } w.fn.extend({ show: function () { return fe(this, !0) }, hide: function () { return fe(this) }, toggle: function (e) { return "boolean" == typeof e ? e ? this.show() : this.hide() : this.each(function () { ae(this) ? w(this).show() : w(this).hide() }) } }); var pe = /^(?:checkbox|radio)$/i, de = /<([a-z][^\/\0>\x20\t\r\n\f]+)/i, he = /^$|^module$|\/(?:java|ecma)script/i, ge = { option: [1, "<select multiple='multiple'>", "</select>"], thead: [1, "<table>", "</table>"], col: [2, "<table><colgroup>", "</colgroup></table>"], tr: [2, "<table><tbody>", "</tbody></table>"], td: [3, "<table><tbody><tr>", "</tr></tbody></table>"], _default: [0, "", ""] }; ge.optgroup = ge.option, ge.tbody = ge.tfoot = ge.colgroup = ge.caption = ge.thead, ge.th = ge.td; function ye(e, t) { var n; return n = "undefined" != typeof e.getElementsByTagName ? e.getElementsByTagName(t || "*") : "undefined" != typeof e.querySelectorAll ? e.querySelectorAll(t || "*") : [], void 0 === t || t && N(e, t) ? w.merge([e], n) : n } function ve(e, t) { for (var n = 0, r = e.length; n < r; n++)J.set(e[n], "globalEval", !t || J.get(t[n], "globalEval")) } var me = /<|&#?\w+;/; function xe(e, t, n, r, i) { for (var o, a, s, u, l, c, f = t.createDocumentFragment(), p = [], d = 0, h = e.length; d < h; d++)if ((o = e[d]) || 0 === o) if ("object" === x(o)) w.merge(p, o.nodeType ? [o] : o); else if (me.test(o)) { a = a || f.appendChild(t.createElement("div")), s = (de.exec(o) || ["", ""])[1].toLowerCase(), u = ge[s] || ge._default, a.innerHTML = u[1] + w.htmlPrefilter(o) + u[2], c = u[0]; while (c--) a = a.lastChild; w.merge(p, a.childNodes), (a = f.firstChild).textContent = "" } else p.push(t.createTextNode(o)); f.textContent = "", d = 0; while (o = p[d++]) if (r && w.inArray(o, r) > -1) i && i.push(o); else if (l = w.contains(o.ownerDocument, o), a = ye(f.appendChild(o), "script"), l && ve(a), n) { c = 0; while (o = a[c++]) he.test(o.type || "") && n.push(o) } return f } !function () { var e = r.createDocumentFragment().appendChild(r.createElement("div")), t = r.createElement("input"); t.setAttribute("type", "radio"), t.setAttribute("checked", "checked"), t.setAttribute("name", "t"), e.appendChild(t), h.checkClone = e.cloneNode(!0).cloneNode(!0).lastChild.checked, e.innerHTML = "<textarea>x</textarea>", h.noCloneChecked = !!e.cloneNode(!0).lastChild.defaultValue }(); var be = r.documentElement, we = /^key/, Te = /^(?:mouse|pointer|contextmenu|drag|drop)|click/, Ce = /^([^.]*)(?:\.(.+)|)/; function Ee() { return !0 } function ke() { return !1 } function Se() { try { return r.activeElement } catch (e) { } } function De(e, t, n, r, i, o) { var a, s; if ("object" == typeof t) { "string" != typeof n && (r = r || n, n = void 0); for (s in t) De(e, s, n, r, t[s], o); return e } if (null == r && null == i ? (i = n, r = n = void 0) : null == i && ("string" == typeof n ? (i = r, r = void 0) : (i = r, r = n, n = void 0)), !1 === i) i = ke; else if (!i) return e; return 1 === o && (a = i, (i = function (e) { return w().off(e), a.apply(this, arguments) }).guid = a.guid || (a.guid = w.guid++)), e.each(function () { w.event.add(this, t, i, r, n) }) } w.event = { global: {}, add: function (e, t, n, r, i) { var o, a, s, u, l, c, f, p, d, h, g, y = J.get(e); if (y) { n.handler && (n = (o = n).handler, i = o.selector), i && w.find.matchesSelector(be, i), n.guid || (n.guid = w.guid++), (u = y.events) || (u = y.events = {}), (a = y.handle) || (a = y.handle = function (t) { return "undefined" != typeof w && w.event.triggered !== t.type ? w.event.dispatch.apply(e, arguments) : void 0 }), l = (t = (t || "").match(M) || [""]).length; while (l--) d = g = (s = Ce.exec(t[l]) || [])[1], h = (s[2] || "").split(".").sort(), d && (f = w.event.special[d] || {}, d = (i ? f.delegateType : f.bindType) || d, f = w.event.special[d] || {}, c = w.extend({ type: d, origType: g, data: r, handler: n, guid: n.guid, selector: i, needsContext: i && w.expr.match.needsContext.test(i), namespace: h.join(".") }, o), (p = u[d]) || ((p = u[d] = []).delegateCount = 0, f.setup && !1 !== f.setup.call(e, r, h, a) || e.addEventListener && e.addEventListener(d, a)), f.add && (f.add.call(e, c), c.handler.guid || (c.handler.guid = n.guid)), i ? p.splice(p.delegateCount++, 0, c) : p.push(c), w.event.global[d] = !0) } }, remove: function (e, t, n, r, i) { var o, a, s, u, l, c, f, p, d, h, g, y = J.hasData(e) && J.get(e); if (y && (u = y.events)) { l = (t = (t || "").match(M) || [""]).length; while (l--) if (s = Ce.exec(t[l]) || [], d = g = s[1], h = (s[2] || "").split(".").sort(), d) { f = w.event.special[d] || {}, p = u[d = (r ? f.delegateType : f.bindType) || d] || [], s = s[2] && new RegExp("(^|\\.)" + h.join("\\.(?:.*\\.|)") + "(\\.|$)"), a = o = p.length; while (o--) c = p[o], !i && g !== c.origType || n && n.guid !== c.guid || s && !s.test(c.namespace) || r && r !== c.selector && ("**" !== r || !c.selector) || (p.splice(o, 1), c.selector && p.delegateCount-- , f.remove && f.remove.call(e, c)); a && !p.length && (f.teardown && !1 !== f.teardown.call(e, h, y.handle) || w.removeEvent(e, d, y.handle), delete u[d]) } else for (d in u) w.event.remove(e, d + t[l], n, r, !0); w.isEmptyObject(u) && J.remove(e, "handle events") } }, dispatch: function (e) { var t = w.event.fix(e), n, r, i, o, a, s, u = new Array(arguments.length), l = (J.get(this, "events") || {})[t.type] || [], c = w.event.special[t.type] || {}; for (u[0] = t, n = 1; n < arguments.length; n++)u[n] = arguments[n]; if (t.delegateTarget = this, !c.preDispatch || !1 !== c.preDispatch.call(this, t)) { s = w.event.handlers.call(this, t, l), n = 0; while ((o = s[n++]) && !t.isPropagationStopped()) { t.currentTarget = o.elem, r = 0; while ((a = o.handlers[r++]) && !t.isImmediatePropagationStopped()) t.rnamespace && !t.rnamespace.test(a.namespace) || (t.handleObj = a, t.data = a.data, void 0 !== (i = ((w.event.special[a.origType] || {}).handle || a.handler).apply(o.elem, u)) && !1 === (t.result = i) && (t.preventDefault(), t.stopPropagation())) } return c.postDispatch && c.postDispatch.call(this, t), t.result } }, handlers: function (e, t) { var n, r, i, o, a, s = [], u = t.delegateCount, l = e.target; if (u && l.nodeType && !("click" === e.type && e.button >= 1)) for (; l !== this; l = l.parentNode || this)if (1 === l.nodeType && ("click" !== e.type || !0 !== l.disabled)) { for (o = [], a = {}, n = 0; n < u; n++)void 0 === a[i = (r = t[n]).selector + " "] && (a[i] = r.needsContext ? w(i, this).index(l) > -1 : w.find(i, this, null, [l]).length), a[i] && o.push(r); o.length && s.push({ elem: l, handlers: o }) } return l = this, u < t.length && s.push({ elem: l, handlers: t.slice(u) }), s }, addProp: function (e, t) { Object.defineProperty(w.Event.prototype, e, { enumerable: !0, configurable: !0, get: g(t) ? function () { if (this.originalEvent) return t(this.originalEvent) } : function () { if (this.originalEvent) return this.originalEvent[e] }, set: function (t) { Object.defineProperty(this, e, { enumerable: !0, configurable: !0, writable: !0, value: t }) } }) }, fix: function (e) { return e[w.expando] ? e : new w.Event(e) }, special: { load: { noBubble: !0 }, focus: { trigger: function () { if (this !== Se() && this.focus) return this.focus(), !1 }, delegateType: "focusin" }, blur: { trigger: function () { if (this === Se() && this.blur) return this.blur(), !1 }, delegateType: "focusout" }, click: { trigger: function () { if ("checkbox" === this.type && this.click && N(this, "input")) return this.click(), !1 }, _default: function (e) { return N(e.target, "a") } }, beforeunload: { postDispatch: function (e) { void 0 !== e.result && e.originalEvent && (e.originalEvent.returnValue = e.result) } } } }, w.removeEvent = function (e, t, n) { e.removeEventListener && e.removeEventListener(t, n) }, w.Event = function (e, t) { if (!(this instanceof w.Event)) return new w.Event(e, t); e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || void 0 === e.defaultPrevented && !1 === e.returnValue ? Ee : ke, this.target = e.target && 3 === e.target.nodeType ? e.target.parentNode : e.target, this.currentTarget = e.currentTarget, this.relatedTarget = e.relatedTarget) : this.type = e, t && w.extend(this, t), this.timeStamp = e && e.timeStamp || Date.now(), this[w.expando] = !0 }, w.Event.prototype = { constructor: w.Event, isDefaultPrevented: ke, isPropagationStopped: ke, isImmediatePropagationStopped: ke, isSimulated: !1, preventDefault: function () { var e = this.originalEvent; this.isDefaultPrevented = Ee, e && !this.isSimulated && e.preventDefault() }, stopPropagation: function () { var e = this.originalEvent; this.isPropagationStopped = Ee, e && !this.isSimulated && e.stopPropagation() }, stopImmediatePropagation: function () { var e = this.originalEvent; this.isImmediatePropagationStopped = Ee, e && !this.isSimulated && e.stopImmediatePropagation(), this.stopPropagation() } }, w.each({ altKey: !0, bubbles: !0, cancelable: !0, changedTouches: !0, ctrlKey: !0, detail: !0, eventPhase: !0, metaKey: !0, pageX: !0, pageY: !0, shiftKey: !0, view: !0, "char": !0, charCode: !0, key: !0, keyCode: !0, button: !0, buttons: !0, clientX: !0, clientY: !0, offsetX: !0, offsetY: !0, pointerId: !0, pointerType: !0, screenX: !0, screenY: !0, targetTouches: !0, toElement: !0, touches: !0, which: function (e) { var t = e.button; return null == e.which && we.test(e.type) ? null != e.charCode ? e.charCode : e.keyCode : !e.which && void 0 !== t && Te.test(e.type) ? 1 & t ? 1 : 2 & t ? 3 : 4 & t ? 2 : 0 : e.which } }, w.event.addProp), w.each({ mouseenter: "mouseover", mouseleave: "mouseout", pointerenter: "pointerover", pointerleave: "pointerout" }, function (e, t) { w.event.special[e] = { delegateType: t, bindType: t, handle: function (e) { var n, r = this, i = e.relatedTarget, o = e.handleObj; return i && (i === r || w.contains(r, i)) || (e.type = o.origType, n = o.handler.apply(this, arguments), e.type = t), n } } }), w.fn.extend({ on: function (e, t, n, r) { return De(this, e, t, n, r) }, one: function (e, t, n, r) { return De(this, e, t, n, r, 1) }, off: function (e, t, n) { var r, i; if (e && e.preventDefault && e.handleObj) return r = e.handleObj, w(e.delegateTarget).off(r.namespace ? r.origType + "." + r.namespace : r.origType, r.selector, r.handler), this; if ("object" == typeof e) { for (i in e) this.off(i, t, e[i]); return this } return !1 !== t && "function" != typeof t || (n = t, t = void 0), !1 === n && (n = ke), this.each(function () { w.event.remove(this, e, n, t) }) } }); var Ne = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi, Ae = /<script|<style|<link/i, je = /checked\s*(?:[^=]|=\s*.checked.)/i, qe = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g; function Le(e, t) { return N(e, "table") && N(11 !== t.nodeType ? t : t.firstChild, "tr") ? w(e).children("tbody")[0] || e : e } function He(e) { return e.type = (null !== e.getAttribute("type")) + "/" + e.type, e } function Oe(e) { return "true/" === (e.type || "").slice(0, 5) ? e.type = e.type.slice(5) : e.removeAttribute("type"), e } function Pe(e, t) { var n, r, i, o, a, s, u, l; if (1 === t.nodeType) { if (J.hasData(e) && (o = J.access(e), a = J.set(t, o), l = o.events)) { delete a.handle, a.events = {}; for (i in l) for (n = 0, r = l[i].length; n < r; n++)w.event.add(t, i, l[i][n]) } K.hasData(e) && (s = K.access(e), u = w.extend({}, s), K.set(t, u)) } } function Me(e, t) { var n = t.nodeName.toLowerCase(); "input" === n && pe.test(e.type) ? t.checked = e.checked : "input" !== n && "textarea" !== n || (t.defaultValue = e.defaultValue) } function Re(e, t, n, r) { t = a.apply([], t); var i, o, s, u, l, c, f = 0, p = e.length, d = p - 1, y = t[0], v = g(y); if (v || p > 1 && "string" == typeof y && !h.checkClone && je.test(y)) return e.each(function (i) { var o = e.eq(i); v && (t[0] = y.call(this, i, o.html())), Re(o, t, n, r) }); if (p && (i = xe(t, e[0].ownerDocument, !1, e, r), o = i.firstChild, 1 === i.childNodes.length && (i = o), o || r)) { for (u = (s = w.map(ye(i, "script"), He)).length; f < p; f++)l = i, f !== d && (l = w.clone(l, !0, !0), u && w.merge(s, ye(l, "script"))), n.call(e[f], l, f); if (u) for (c = s[s.length - 1].ownerDocument, w.map(s, Oe), f = 0; f < u; f++)l = s[f], he.test(l.type || "") && !J.access(l, "globalEval") && w.contains(c, l) && (l.src && "module" !== (l.type || "").toLowerCase() ? w._evalUrl && w._evalUrl(l.src) : m(l.textContent.replace(qe, ""), c, l)) } return e } function Ie(e, t, n) { for (var r, i = t ? w.filter(t, e) : e, o = 0; null != (r = i[o]); o++)n || 1 !== r.nodeType || w.cleanData(ye(r)), r.parentNode && (n && w.contains(r.ownerDocument, r) && ve(ye(r, "script")), r.parentNode.removeChild(r)); return e } w.extend({ htmlPrefilter: function (e) { return e.replace(Ne, "<$1></$2>") }, clone: function (e, t, n) { var r, i, o, a, s = e.cloneNode(!0), u = w.contains(e.ownerDocument, e); if (!(h.noCloneChecked || 1 !== e.nodeType && 11 !== e.nodeType || w.isXMLDoc(e))) for (a = ye(s), r = 0, i = (o = ye(e)).length; r < i; r++)Me(o[r], a[r]); if (t) if (n) for (o = o || ye(e), a = a || ye(s), r = 0, i = o.length; r < i; r++)Pe(o[r], a[r]); else Pe(e, s); return (a = ye(s, "script")).length > 0 && ve(a, !u && ye(e, "script")), s }, cleanData: function (e) { for (var t, n, r, i = w.event.special, o = 0; void 0 !== (n = e[o]); o++)if (Y(n)) { if (t = n[J.expando]) { if (t.events) for (r in t.events) i[r] ? w.event.remove(n, r) : w.removeEvent(n, r, t.handle); n[J.expando] = void 0 } n[K.expando] && (n[K.expando] = void 0) } } }), w.fn.extend({ detach: function (e) { return Ie(this, e, !0) }, remove: function (e) { return Ie(this, e) }, text: function (e) { return z(this, function (e) { return void 0 === e ? w.text(this) : this.empty().each(function () { 1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || (this.textContent = e) }) }, null, e, arguments.length) }, append: function () { return Re(this, arguments, function (e) { 1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || Le(this, e).appendChild(e) }) }, prepend: function () { return Re(this, arguments, function (e) { if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) { var t = Le(this, e); t.insertBefore(e, t.firstChild) } }) }, before: function () { return Re(this, arguments, function (e) { this.parentNode && this.parentNode.insertBefore(e, this) }) }, after: function () { return Re(this, arguments, function (e) { this.parentNode && this.parentNode.insertBefore(e, this.nextSibling) }) }, empty: function () { for (var e, t = 0; null != (e = this[t]); t++)1 === e.nodeType && (w.cleanData(ye(e, !1)), e.textContent = ""); return this }, clone: function (e, t) { return e = null != e && e, t = null == t ? e : t, this.map(function () { return w.clone(this, e, t) }) }, html: function (e) { return z(this, function (e) { var t = this[0] || {}, n = 0, r = this.length; if (void 0 === e && 1 === t.nodeType) return t.innerHTML; if ("string" == typeof e && !Ae.test(e) && !ge[(de.exec(e) || ["", ""])[1].toLowerCase()]) { e = w.htmlPrefilter(e); try { for (; n < r; n++)1 === (t = this[n] || {}).nodeType && (w.cleanData(ye(t, !1)), t.innerHTML = e); t = 0 } catch (e) { } } t && this.empty().append(e) }, null, e, arguments.length) }, replaceWith: function () { var e = []; return Re(this, arguments, function (t) { var n = this.parentNode; w.inArray(this, e) < 0 && (w.cleanData(ye(this)), n && n.replaceChild(t, this)) }, e) } }), w.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function (e, t) { w.fn[e] = function (e) { for (var n, r = [], i = w(e), o = i.length - 1, a = 0; a <= o; a++)n = a === o ? this : this.clone(!0), w(i[a])[t](n), s.apply(r, n.get()); return this.pushStack(r) } }); var We = new RegExp("^(" + re + ")(?!px)[a-z%]+$", "i"), $e = function (t) { var n = t.ownerDocument.defaultView; return n && n.opener || (n = e), n.getComputedStyle(t) }, Be = new RegExp(oe.join("|"), "i"); !function () { function t() { if (c) { l.style.cssText = "position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0", c.style.cssText = "position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%", be.appendChild(l).appendChild(c); var t = e.getComputedStyle(c); i = "1%" !== t.top, u = 12 === n(t.marginLeft), c.style.right = "60%", s = 36 === n(t.right), o = 36 === n(t.width), c.style.position = "absolute", a = 36 === c.offsetWidth || "absolute", be.removeChild(l), c = null } } function n(e) { return Math.round(parseFloat(e)) } var i, o, a, s, u, l = r.createElement("div"), c = r.createElement("div"); c.style && (c.style.backgroundClip = "content-box", c.cloneNode(!0).style.backgroundClip = "", h.clearCloneStyle = "content-box" === c.style.backgroundClip, w.extend(h, { boxSizingReliable: function () { return t(), o }, pixelBoxStyles: function () { return t(), s }, pixelPosition: function () { return t(), i }, reliableMarginLeft: function () { return t(), u }, scrollboxSize: function () { return t(), a } })) }(); function Fe(e, t, n) { var r, i, o, a, s = e.style; return (n = n || $e(e)) && ("" !== (a = n.getPropertyValue(t) || n[t]) || w.contains(e.ownerDocument, e) || (a = w.style(e, t)), !h.pixelBoxStyles() && We.test(a) && Be.test(t) && (r = s.width, i = s.minWidth, o = s.maxWidth, s.minWidth = s.maxWidth = s.width = a, a = n.width, s.width = r, s.minWidth = i, s.maxWidth = o)), void 0 !== a ? a + "" : a } function _e(e, t) { return { get: function () { if (!e()) return (this.get = t).apply(this, arguments); delete this.get } } } var ze = /^(none|table(?!-c[ea]).+)/, Xe = /^--/, Ue = { position: "absolute", visibility: "hidden", display: "block" }, Ve = { letterSpacing: "0", fontWeight: "400" }, Ge = ["Webkit", "Moz", "ms"], Ye = r.createElement("div").style; function Qe(e) { if (e in Ye) return e; var t = e[0].toUpperCase() + e.slice(1), n = Ge.length; while (n--) if ((e = Ge[n] + t) in Ye) return e } function Je(e) { var t = w.cssProps[e]; return t || (t = w.cssProps[e] = Qe(e) || e), t } function Ke(e, t, n) { var r = ie.exec(t); return r ? Math.max(0, r[2] - (n || 0)) + (r[3] || "px") : t } function Ze(e, t, n, r, i, o) { var a = "width" === t ? 1 : 0, s = 0, u = 0; if (n === (r ? "border" : "content")) return 0; for (; a < 4; a += 2)"margin" === n && (u += w.css(e, n + oe[a], !0, i)), r ? ("content" === n && (u -= w.css(e, "padding" + oe[a], !0, i)), "margin" !== n && (u -= w.css(e, "border" + oe[a] + "Width", !0, i))) : (u += w.css(e, "padding" + oe[a], !0, i), "padding" !== n ? u += w.css(e, "border" + oe[a] + "Width", !0, i) : s += w.css(e, "border" + oe[a] + "Width", !0, i)); return !r && o >= 0 && (u += Math.max(0, Math.ceil(e["offset" + t[0].toUpperCase() + t.slice(1)] - o - u - s - .5))), u } function et(e, t, n) { var r = $e(e), i = Fe(e, t, r), o = "border-box" === w.css(e, "boxSizing", !1, r), a = o; if (We.test(i)) { if (!n) return i; i = "auto" } return a = a && (h.boxSizingReliable() || i === e.style[t]), ("auto" === i || !parseFloat(i) && "inline" === w.css(e, "display", !1, r)) && (i = e["offset" + t[0].toUpperCase() + t.slice(1)], a = !0), (i = parseFloat(i) || 0) + Ze(e, t, n || (o ? "border" : "content"), a, r, i) + "px" } w.extend({ cssHooks: { opacity: { get: function (e, t) { if (t) { var n = Fe(e, "opacity"); return "" === n ? "1" : n } } } }, cssNumber: { animationIterationCount: !0, columnCount: !0, fillOpacity: !0, flexGrow: !0, flexShrink: !0, fontWeight: !0, lineHeight: !0, opacity: !0, order: !0, orphans: !0, widows: !0, zIndex: !0, zoom: !0 }, cssProps: {}, style: function (e, t, n, r) { if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) { var i, o, a, s = G(t), u = Xe.test(t), l = e.style; if (u || (t = Je(s)), a = w.cssHooks[t] || w.cssHooks[s], void 0 === n) return a && "get" in a && void 0 !== (i = a.get(e, !1, r)) ? i : l[t]; "string" == (o = typeof n) && (i = ie.exec(n)) && i[1] && (n = ue(e, t, i), o = "number"), null != n && n === n && ("number" === o && (n += i && i[3] || (w.cssNumber[s] ? "" : "px")), h.clearCloneStyle || "" !== n || 0 !== t.indexOf("background") || (l[t] = "inherit"), a && "set" in a && void 0 === (n = a.set(e, n, r)) || (u ? l.setProperty(t, n) : l[t] = n)) } }, css: function (e, t, n, r) { var i, o, a, s = G(t); return Xe.test(t) || (t = Je(s)), (a = w.cssHooks[t] || w.cssHooks[s]) && "get" in a && (i = a.get(e, !0, n)), void 0 === i && (i = Fe(e, t, r)), "normal" === i && t in Ve && (i = Ve[t]), "" === n || n ? (o = parseFloat(i), !0 === n || isFinite(o) ? o || 0 : i) : i } }), w.each(["height", "width"], function (e, t) { w.cssHooks[t] = { get: function (e, n, r) { if (n) return !ze.test(w.css(e, "display")) || e.getClientRects().length && e.getBoundingClientRect().width ? et(e, t, r) : se(e, Ue, function () { return et(e, t, r) }) }, set: function (e, n, r) { var i, o = $e(e), a = "border-box" === w.css(e, "boxSizing", !1, o), s = r && Ze(e, t, r, a, o); return a && h.scrollboxSize() === o.position && (s -= Math.ceil(e["offset" + t[0].toUpperCase() + t.slice(1)] - parseFloat(o[t]) - Ze(e, t, "border", !1, o) - .5)), s && (i = ie.exec(n)) && "px" !== (i[3] || "px") && (e.style[t] = n, n = w.css(e, t)), Ke(e, n, s) } } }), w.cssHooks.marginLeft = _e(h.reliableMarginLeft, function (e, t) { if (t) return (parseFloat(Fe(e, "marginLeft")) || e.getBoundingClientRect().left - se(e, { marginLeft: 0 }, function () { return e.getBoundingClientRect().left })) + "px" }), w.each({ margin: "", padding: "", border: "Width" }, function (e, t) { w.cssHooks[e + t] = { expand: function (n) { for (var r = 0, i = {}, o = "string" == typeof n ? n.split(" ") : [n]; r < 4; r++)i[e + oe[r] + t] = o[r] || o[r - 2] || o[0]; return i } }, "margin" !== e && (w.cssHooks[e + t].set = Ke) }), w.fn.extend({ css: function (e, t) { return z(this, function (e, t, n) { var r, i, o = {}, a = 0; if (Array.isArray(t)) { for (r = $e(e), i = t.length; a < i; a++)o[t[a]] = w.css(e, t[a], !1, r); return o } return void 0 !== n ? w.style(e, t, n) : w.css(e, t) }, e, t, arguments.length > 1) } }); function tt(e, t, n, r, i) { return new tt.prototype.init(e, t, n, r, i) } w.Tween = tt, tt.prototype = { constructor: tt, init: function (e, t, n, r, i, o) { this.elem = e, this.prop = n, this.easing = i || w.easing._default, this.options = t, this.start = this.now = this.cur(), this.end = r, this.unit = o || (w.cssNumber[n] ? "" : "px") }, cur: function () { var e = tt.propHooks[this.prop]; return e && e.get ? e.get(this) : tt.propHooks._default.get(this) }, run: function (e) { var t, n = tt.propHooks[this.prop]; return this.options.duration ? this.pos = t = w.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration) : this.pos = t = e, this.now = (this.end - this.start) * t + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), n && n.set ? n.set(this) : tt.propHooks._default.set(this), this } }, tt.prototype.init.prototype = tt.prototype, tt.propHooks = { _default: { get: function (e) { var t; return 1 !== e.elem.nodeType || null != e.elem[e.prop] && null == e.elem.style[e.prop] ? e.elem[e.prop] : (t = w.css(e.elem, e.prop, "")) && "auto" !== t ? t : 0 }, set: function (e) { w.fx.step[e.prop] ? w.fx.step[e.prop](e) : 1 !== e.elem.nodeType || null == e.elem.style[w.cssProps[e.prop]] && !w.cssHooks[e.prop] ? e.elem[e.prop] = e.now : w.style(e.elem, e.prop, e.now + e.unit) } } }, tt.propHooks.scrollTop = tt.propHooks.scrollLeft = { set: function (e) { e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now) } }, w.easing = { linear: function (e) { return e }, swing: function (e) { return .5 - Math.cos(e * Math.PI) / 2 }, _default: "swing" }, w.fx = tt.prototype.init, w.fx.step = {}; var nt, rt, it = /^(?:toggle|show|hide)$/, ot = /queueHooks$/; function at() { rt && (!1 === r.hidden && e.requestAnimationFrame ? e.requestAnimationFrame(at) : e.setTimeout(at, w.fx.interval), w.fx.tick()) } function st() { return e.setTimeout(function () { nt = void 0 }), nt = Date.now() } function ut(e, t) { var n, r = 0, i = { height: e }; for (t = t ? 1 : 0; r < 4; r += 2 - t)i["margin" + (n = oe[r])] = i["padding" + n] = e; return t && (i.opacity = i.width = e), i } function lt(e, t, n) { for (var r, i = (pt.tweeners[t] || []).concat(pt.tweeners["*"]), o = 0, a = i.length; o < a; o++)if (r = i[o].call(n, t, e)) return r } function ct(e, t, n) { var r, i, o, a, s, u, l, c, f = "width" in t || "height" in t, p = this, d = {}, h = e.style, g = e.nodeType && ae(e), y = J.get(e, "fxshow"); n.queue || (null == (a = w._queueHooks(e, "fx")).unqueued && (a.unqueued = 0, s = a.empty.fire, a.empty.fire = function () { a.unqueued || s() }), a.unqueued++ , p.always(function () { p.always(function () { a.unqueued-- , w.queue(e, "fx").length || a.empty.fire() }) })); for (r in t) if (i = t[r], it.test(i)) { if (delete t[r], o = o || "toggle" === i, i === (g ? "hide" : "show")) { if ("show" !== i || !y || void 0 === y[r]) continue; g = !0 } d[r] = y && y[r] || w.style(e, r) } if ((u = !w.isEmptyObject(t)) || !w.isEmptyObject(d)) { f && 1 === e.nodeType && (n.overflow = [h.overflow, h.overflowX, h.overflowY], null == (l = y && y.display) && (l = J.get(e, "display")), "none" === (c = w.css(e, "display")) && (l ? c = l : (fe([e], !0), l = e.style.display || l, c = w.css(e, "display"), fe([e]))), ("inline" === c || "inline-block" === c && null != l) && "none" === w.css(e, "float") && (u || (p.done(function () { h.display = l }), null == l && (c = h.display, l = "none" === c ? "" : c)), h.display = "inline-block")), n.overflow && (h.overflow = "hidden", p.always(function () { h.overflow = n.overflow[0], h.overflowX = n.overflow[1], h.overflowY = n.overflow[2] })), u = !1; for (r in d) u || (y ? "hidden" in y && (g = y.hidden) : y = J.access(e, "fxshow", { display: l }), o && (y.hidden = !g), g && fe([e], !0), p.done(function () { g || fe([e]), J.remove(e, "fxshow"); for (r in d) w.style(e, r, d[r]) })), u = lt(g ? y[r] : 0, r, p), r in y || (y[r] = u.start, g && (u.end = u.start, u.start = 0)) } } function ft(e, t) { var n, r, i, o, a; for (n in e) if (r = G(n), i = t[r], o = e[n], Array.isArray(o) && (i = o[1], o = e[n] = o[0]), n !== r && (e[r] = o, delete e[n]), (a = w.cssHooks[r]) && "expand" in a) { o = a.expand(o), delete e[r]; for (n in o) n in e || (e[n] = o[n], t[n] = i) } else t[r] = i } function pt(e, t, n) { var r, i, o = 0, a = pt.prefilters.length, s = w.Deferred().always(function () { delete u.elem }), u = function () { if (i) return !1; for (var t = nt || st(), n = Math.max(0, l.startTime + l.duration - t), r = 1 - (n / l.duration || 0), o = 0, a = l.tweens.length; o < a; o++)l.tweens[o].run(r); return s.notifyWith(e, [l, r, n]), r < 1 && a ? n : (a || s.notifyWith(e, [l, 1, 0]), s.resolveWith(e, [l]), !1) }, l = s.promise({ elem: e, props: w.extend({}, t), opts: w.extend(!0, { specialEasing: {}, easing: w.easing._default }, n), originalProperties: t, originalOptions: n, startTime: nt || st(), duration: n.duration, tweens: [], createTween: function (t, n) { var r = w.Tween(e, l.opts, t, n, l.opts.specialEasing[t] || l.opts.easing); return l.tweens.push(r), r }, stop: function (t) { var n = 0, r = t ? l.tweens.length : 0; if (i) return this; for (i = !0; n < r; n++)l.tweens[n].run(1); return t ? (s.notifyWith(e, [l, 1, 0]), s.resolveWith(e, [l, t])) : s.rejectWith(e, [l, t]), this } }), c = l.props; for (ft(c, l.opts.specialEasing); o < a; o++)if (r = pt.prefilters[o].call(l, e, c, l.opts)) return g(r.stop) && (w._queueHooks(l.elem, l.opts.queue).stop = r.stop.bind(r)), r; return w.map(c, lt, l), g(l.opts.start) && l.opts.start.call(e, l), l.progress(l.opts.progress).done(l.opts.done, l.opts.complete).fail(l.opts.fail).always(l.opts.always), w.fx.timer(w.extend(u, { elem: e, anim: l, queue: l.opts.queue })), l } w.Animation = w.extend(pt, { tweeners: { "*": [function (e, t) { var n = this.createTween(e, t); return ue(n.elem, e, ie.exec(t), n), n }] }, tweener: function (e, t) { g(e) ? (t = e, e = ["*"]) : e = e.match(M); for (var n, r = 0, i = e.length; r < i; r++)n = e[r], pt.tweeners[n] = pt.tweeners[n] || [], pt.tweeners[n].unshift(t) }, prefilters: [ct], prefilter: function (e, t) { t ? pt.prefilters.unshift(e) : pt.prefilters.push(e) } }), w.speed = function (e, t, n) { var r = e && "object" == typeof e ? w.extend({}, e) : { complete: n || !n && t || g(e) && e, duration: e, easing: n && t || t && !g(t) && t }; return w.fx.off ? r.duration = 0 : "number" != typeof r.duration && (r.duration in w.fx.speeds ? r.duration = w.fx.speeds[r.duration] : r.duration = w.fx.speeds._default), null != r.queue && !0 !== r.queue || (r.queue = "fx"), r.old = r.complete, r.complete = function () { g(r.old) && r.old.call(this), r.queue && w.dequeue(this, r.queue) }, r }, w.fn.extend({ fadeTo: function (e, t, n, r) { return this.filter(ae).css("opacity", 0).show().end().animate({ opacity: t }, e, n, r) }, animate: function (e, t, n, r) { var i = w.isEmptyObject(e), o = w.speed(t, n, r), a = function () { var t = pt(this, w.extend({}, e), o); (i || J.get(this, "finish")) && t.stop(!0) }; return a.finish = a, i || !1 === o.queue ? this.each(a) : this.queue(o.queue, a) }, stop: function (e, t, n) { var r = function (e) { var t = e.stop; delete e.stop, t(n) }; return "string" != typeof e && (n = t, t = e, e = void 0), t && !1 !== e && this.queue(e || "fx", []), this.each(function () { var t = !0, i = null != e && e + "queueHooks", o = w.timers, a = J.get(this); if (i) a[i] && a[i].stop && r(a[i]); else for (i in a) a[i] && a[i].stop && ot.test(i) && r(a[i]); for (i = o.length; i--;)o[i].elem !== this || null != e && o[i].queue !== e || (o[i].anim.stop(n), t = !1, o.splice(i, 1)); !t && n || w.dequeue(this, e) }) }, finish: function (e) { return !1 !== e && (e = e || "fx"), this.each(function () { var t, n = J.get(this), r = n[e + "queue"], i = n[e + "queueHooks"], o = w.timers, a = r ? r.length : 0; for (n.finish = !0, w.queue(this, e, []), i && i.stop && i.stop.call(this, !0), t = o.length; t--;)o[t].elem === this && o[t].queue === e && (o[t].anim.stop(!0), o.splice(t, 1)); for (t = 0; t < a; t++)r[t] && r[t].finish && r[t].finish.call(this); delete n.finish }) } }), w.each(["toggle", "show", "hide"], function (e, t) { var n = w.fn[t]; w.fn[t] = function (e, r, i) { return null == e || "boolean" == typeof e ? n.apply(this, arguments) : this.animate(ut(t, !0), e, r, i) } }), w.each({ slideDown: ut("show"), slideUp: ut("hide"), slideToggle: ut("toggle"), fadeIn: { opacity: "show" }, fadeOut: { opacity: "hide" }, fadeToggle: { opacity: "toggle" } }, function (e, t) { w.fn[e] = function (e, n, r) { return this.animate(t, e, n, r) } }), w.timers = [], w.fx.tick = function () { var e, t = 0, n = w.timers; for (nt = Date.now(); t < n.length; t++)(e = n[t])() || n[t] !== e || n.splice(t--, 1); n.length || w.fx.stop(), nt = void 0 }, w.fx.timer = function (e) { w.timers.push(e), w.fx.start() }, w.fx.interval = 13, w.fx.start = function () { rt || (rt = !0, at()) }, w.fx.stop = function () { rt = null }, w.fx.speeds = { slow: 600, fast: 200, _default: 400 }, w.fn.delay = function (t, n) { return t = w.fx ? w.fx.speeds[t] || t : t, n = n || "fx", this.queue(n, function (n, r) { var i = e.setTimeout(n, t); r.stop = function () { e.clearTimeout(i) } }) }, function () { var e = r.createElement("input"), t = r.createElement("select").appendChild(r.createElement("option")); e.type = "checkbox", h.checkOn = "" !== e.value, h.optSelected = t.selected, (e = r.createElement("input")).value = "t", e.type = "radio", h.radioValue = "t" === e.value }(); var dt, ht = w.expr.attrHandle; w.fn.extend({ attr: function (e, t) { return z(this, w.attr, e, t, arguments.length > 1) }, removeAttr: function (e) { return this.each(function () { w.removeAttr(this, e) }) } }), w.extend({ attr: function (e, t, n) { var r, i, o = e.nodeType; if (3 !== o && 8 !== o && 2 !== o) return "undefined" == typeof e.getAttribute ? w.prop(e, t, n) : (1 === o && w.isXMLDoc(e) || (i = w.attrHooks[t.toLowerCase()] || (w.expr.match.bool.test(t) ? dt : void 0)), void 0 !== n ? null === n ? void w.removeAttr(e, t) : i && "set" in i && void 0 !== (r = i.set(e, n, t)) ? r : (e.setAttribute(t, n + ""), n) : i && "get" in i && null !== (r = i.get(e, t)) ? r : null == (r = w.find.attr(e, t)) ? void 0 : r) }, attrHooks: { type: { set: function (e, t) { if (!h.radioValue && "radio" === t && N(e, "input")) { var n = e.value; return e.setAttribute("type", t), n && (e.value = n), t } } } }, removeAttr: function (e, t) { var n, r = 0, i = t && t.match(M); if (i && 1 === e.nodeType) while (n = i[r++]) e.removeAttribute(n) } }), dt = { set: function (e, t, n) { return !1 === t ? w.removeAttr(e, n) : e.setAttribute(n, n), n } }, w.each(w.expr.match.bool.source.match(/\w+/g), function (e, t) { var n = ht[t] || w.find.attr; ht[t] = function (e, t, r) { var i, o, a = t.toLowerCase(); return r || (o = ht[a], ht[a] = i, i = null != n(e, t, r) ? a : null, ht[a] = o), i } }); var gt = /^(?:input|select|textarea|button)$/i, yt = /^(?:a|area)$/i; w.fn.extend({ prop: function (e, t) { return z(this, w.prop, e, t, arguments.length > 1) }, removeProp: function (e) { return this.each(function () { delete this[w.propFix[e] || e] }) } }), w.extend({ prop: function (e, t, n) { var r, i, o = e.nodeType; if (3 !== o && 8 !== o && 2 !== o) return 1 === o && w.isXMLDoc(e) || (t = w.propFix[t] || t, i = w.propHooks[t]), void 0 !== n ? i && "set" in i && void 0 !== (r = i.set(e, n, t)) ? r : e[t] = n : i && "get" in i && null !== (r = i.get(e, t)) ? r : e[t] }, propHooks: { tabIndex: { get: function (e) { var t = w.find.attr(e, "tabindex"); return t ? parseInt(t, 10) : gt.test(e.nodeName) || yt.test(e.nodeName) && e.href ? 0 : -1 } } }, propFix: { "for": "htmlFor", "class": "className" } }), h.optSelected || (w.propHooks.selected = { get: function (e) { var t = e.parentNode; return t && t.parentNode && t.parentNode.selectedIndex, null }, set: function (e) { var t = e.parentNode; t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex) } }), w.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () { w.propFix[this.toLowerCase()] = this }); function vt(e) { return (e.match(M) || []).join(" ") } function mt(e) { return e.getAttribute && e.getAttribute("class") || "" } function xt(e) { return Array.isArray(e) ? e : "string" == typeof e ? e.match(M) || [] : [] } w.fn.extend({ addClass: function (e) { var t, n, r, i, o, a, s, u = 0; if (g(e)) return this.each(function (t) { w(this).addClass(e.call(this, t, mt(this))) }); if ((t = xt(e)).length) while (n = this[u++]) if (i = mt(n), r = 1 === n.nodeType && " " + vt(i) + " ") { a = 0; while (o = t[a++]) r.indexOf(" " + o + " ") < 0 && (r += o + " "); i !== (s = vt(r)) && n.setAttribute("class", s) } return this }, removeClass: function (e) { var t, n, r, i, o, a, s, u = 0; if (g(e)) return this.each(function (t) { w(this).removeClass(e.call(this, t, mt(this))) }); if (!arguments.length) return this.attr("class", ""); if ((t = xt(e)).length) while (n = this[u++]) if (i = mt(n), r = 1 === n.nodeType && " " + vt(i) + " ") { a = 0; while (o = t[a++]) while (r.indexOf(" " + o + " ") > -1) r = r.replace(" " + o + " ", " "); i !== (s = vt(r)) && n.setAttribute("class", s) } return this }, toggleClass: function (e, t) { var n = typeof e, r = "string" === n || Array.isArray(e); return "boolean" == typeof t && r ? t ? this.addClass(e) : this.removeClass(e) : g(e) ? this.each(function (n) { w(this).toggleClass(e.call(this, n, mt(this), t), t) }) : this.each(function () { var t, i, o, a; if (r) { i = 0, o = w(this), a = xt(e); while (t = a[i++]) o.hasClass(t) ? o.removeClass(t) : o.addClass(t) } else void 0 !== e && "boolean" !== n || ((t = mt(this)) && J.set(this, "__className__", t), this.setAttribute && this.setAttribute("class", t || !1 === e ? "" : J.get(this, "__className__") || "")) }) }, hasClass: function (e) { var t, n, r = 0; t = " " + e + " "; while (n = this[r++]) if (1 === n.nodeType && (" " + vt(mt(n)) + " ").indexOf(t) > -1) return !0; return !1 } }); var bt = /\r/g; w.fn.extend({ val: function (e) { var t, n, r, i = this[0]; { if (arguments.length) return r = g(e), this.each(function (n) { var i; 1 === this.nodeType && (null == (i = r ? e.call(this, n, w(this).val()) : e) ? i = "" : "number" == typeof i ? i += "" : Array.isArray(i) && (i = w.map(i, function (e) { return null == e ? "" : e + "" })), (t = w.valHooks[this.type] || w.valHooks[this.nodeName.toLowerCase()]) && "set" in t && void 0 !== t.set(this, i, "value") || (this.value = i)) }); if (i) return (t = w.valHooks[i.type] || w.valHooks[i.nodeName.toLowerCase()]) && "get" in t && void 0 !== (n = t.get(i, "value")) ? n : "string" == typeof (n = i.value) ? n.replace(bt, "") : null == n ? "" : n } } }), w.extend({ valHooks: { option: { get: function (e) { var t = w.find.attr(e, "value"); return null != t ? t : vt(w.text(e)) } }, select: { get: function (e) { var t, n, r, i = e.options, o = e.selectedIndex, a = "select-one" === e.type, s = a ? null : [], u = a ? o + 1 : i.length; for (r = o < 0 ? u : a ? o : 0; r < u; r++)if (((n = i[r]).selected || r === o) && !n.disabled && (!n.parentNode.disabled || !N(n.parentNode, "optgroup"))) { if (t = w(n).val(), a) return t; s.push(t) } return s }, set: function (e, t) { var n, r, i = e.options, o = w.makeArray(t), a = i.length; while (a--) ((r = i[a]).selected = w.inArray(w.valHooks.option.get(r), o) > -1) && (n = !0); return n || (e.selectedIndex = -1), o } } } }), w.each(["radio", "checkbox"], function () { w.valHooks[this] = { set: function (e, t) { if (Array.isArray(t)) return e.checked = w.inArray(w(e).val(), t) > -1 } }, h.checkOn || (w.valHooks[this].get = function (e) { return null === e.getAttribute("value") ? "on" : e.value }) }), h.focusin = "onfocusin" in e; var wt = /^(?:focusinfocus|focusoutblur)$/, Tt = function (e) { e.stopPropagation() }; w.extend(w.event, { trigger: function (t, n, i, o) { var a, s, u, l, c, p, d, h, v = [i || r], m = f.call(t, "type") ? t.type : t, x = f.call(t, "namespace") ? t.namespace.split(".") : []; if (s = h = u = i = i || r, 3 !== i.nodeType && 8 !== i.nodeType && !wt.test(m + w.event.triggered) && (m.indexOf(".") > -1 && (m = (x = m.split(".")).shift(), x.sort()), c = m.indexOf(":") < 0 && "on" + m, t = t[w.expando] ? t : new w.Event(m, "object" == typeof t && t), t.isTrigger = o ? 2 : 3, t.namespace = x.join("."), t.rnamespace = t.namespace ? new RegExp("(^|\\.)" + x.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, t.result = void 0, t.target || (t.target = i), n = null == n ? [t] : w.makeArray(n, [t]), d = w.event.special[m] || {}, o || !d.trigger || !1 !== d.trigger.apply(i, n))) { if (!o && !d.noBubble && !y(i)) { for (l = d.delegateType || m, wt.test(l + m) || (s = s.parentNode); s; s = s.parentNode)v.push(s), u = s; u === (i.ownerDocument || r) && v.push(u.defaultView || u.parentWindow || e) } a = 0; while ((s = v[a++]) && !t.isPropagationStopped()) h = s, t.type = a > 1 ? l : d.bindType || m, (p = (J.get(s, "events") || {})[t.type] && J.get(s, "handle")) && p.apply(s, n), (p = c && s[c]) && p.apply && Y(s) && (t.result = p.apply(s, n), !1 === t.result && t.preventDefault()); return t.type = m, o || t.isDefaultPrevented() || d._default && !1 !== d._default.apply(v.pop(), n) || !Y(i) || c && g(i[m]) && !y(i) && ((u = i[c]) && (i[c] = null), w.event.triggered = m, t.isPropagationStopped() && h.addEventListener(m, Tt), i[m](), t.isPropagationStopped() && h.removeEventListener(m, Tt), w.event.triggered = void 0, u && (i[c] = u)), t.result } }, simulate: function (e, t, n) { var r = w.extend(new w.Event, n, { type: e, isSimulated: !0 }); w.event.trigger(r, null, t) } }), w.fn.extend({ trigger: function (e, t) { return this.each(function () { w.event.trigger(e, t, this) }) }, triggerHandler: function (e, t) { var n = this[0]; if (n) return w.event.trigger(e, t, n, !0) } }), h.focusin || w.each({ focus: "focusin", blur: "focusout" }, function (e, t) { var n = function (e) { w.event.simulate(t, e.target, w.event.fix(e)) }; w.event.special[t] = { setup: function () { var r = this.ownerDocument || this, i = J.access(r, t); i || r.addEventListener(e, n, !0), J.access(r, t, (i || 0) + 1) }, teardown: function () { var r = this.ownerDocument || this, i = J.access(r, t) - 1; i ? J.access(r, t, i) : (r.removeEventListener(e, n, !0), J.remove(r, t)) } } }); var Ct = e.location, Et = Date.now(), kt = /\?/; w.parseXML = function (t) { var n; if (!t || "string" != typeof t) return null; try { n = (new e.DOMParser).parseFromString(t, "text/xml") } catch (e) { n = void 0 } return n && !n.getElementsByTagName("parsererror").length || w.error("Invalid XML: " + t), n }; var St = /\[\]$/, Dt = /\r?\n/g, Nt = /^(?:submit|button|image|reset|file)$/i, At = /^(?:input|select|textarea|keygen)/i; function jt(e, t, n, r) { var i; if (Array.isArray(t)) w.each(t, function (t, i) { n || St.test(e) ? r(e, i) : jt(e + "[" + ("object" == typeof i && null != i ? t : "") + "]", i, n, r) }); else if (n || "object" !== x(t)) r(e, t); else for (i in t) jt(e + "[" + i + "]", t[i], n, r) } w.param = function (e, t) { var n, r = [], i = function (e, t) { var n = g(t) ? t() : t; r[r.length] = encodeURIComponent(e) + "=" + encodeURIComponent(null == n ? "" : n) }; if (Array.isArray(e) || e.jquery && !w.isPlainObject(e)) w.each(e, function () { i(this.name, this.value) }); else for (n in e) jt(n, e[n], t, i); return r.join("&") }, w.fn.extend({ serialize: function () { return w.param(this.serializeArray()) }, serializeArray: function () { return this.map(function () { var e = w.prop(this, "elements"); return e ? w.makeArray(e) : this }).filter(function () { var e = this.type; return this.name && !w(this).is(":disabled") && At.test(this.nodeName) && !Nt.test(e) && (this.checked || !pe.test(e)) }).map(function (e, t) { var n = w(this).val(); return null == n ? null : Array.isArray(n) ? w.map(n, function (e) { return { name: t.name, value: e.replace(Dt, "\r\n") } }) : { name: t.name, value: n.replace(Dt, "\r\n") } }).get() } }); var qt = /%20/g, Lt = /#.*$/, Ht = /([?&])_=[^&]*/, Ot = /^(.*?):[ \t]*([^\r\n]*)$/gm, Pt = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/, Mt = /^(?:GET|HEAD)$/, Rt = /^\/\//, It = {}, Wt = {}, $t = "*/".concat("*"), Bt = r.createElement("a"); Bt.href = Ct.href; function Ft(e) { return function (t, n) { "string" != typeof t && (n = t, t = "*"); var r, i = 0, o = t.toLowerCase().match(M) || []; if (g(n)) while (r = o[i++]) "+" === r[0] ? (r = r.slice(1) || "*", (e[r] = e[r] || []).unshift(n)) : (e[r] = e[r] || []).push(n) } } function _t(e, t, n, r) { var i = {}, o = e === Wt; function a(s) { var u; return i[s] = !0, w.each(e[s] || [], function (e, s) { var l = s(t, n, r); return "string" != typeof l || o || i[l] ? o ? !(u = l) : void 0 : (t.dataTypes.unshift(l), a(l), !1) }), u } return a(t.dataTypes[0]) || !i["*"] && a("*") } function zt(e, t) { var n, r, i = w.ajaxSettings.flatOptions || {}; for (n in t) void 0 !== t[n] && ((i[n] ? e : r || (r = {}))[n] = t[n]); return r && w.extend(!0, e, r), e } function Xt(e, t, n) { var r, i, o, a, s = e.contents, u = e.dataTypes; while ("*" === u[0]) u.shift(), void 0 === r && (r = e.mimeType || t.getResponseHeader("Content-Type")); if (r) for (i in s) if (s[i] && s[i].test(r)) { u.unshift(i); break } if (u[0] in n) o = u[0]; else { for (i in n) { if (!u[0] || e.converters[i + " " + u[0]]) { o = i; break } a || (a = i) } o = o || a } if (o) return o !== u[0] && u.unshift(o), n[o] } function Ut(e, t, n, r) { var i, o, a, s, u, l = {}, c = e.dataTypes.slice(); if (c[1]) for (a in e.converters) l[a.toLowerCase()] = e.converters[a]; o = c.shift(); while (o) if (e.responseFields[o] && (n[e.responseFields[o]] = t), !u && r && e.dataFilter && (t = e.dataFilter(t, e.dataType)), u = o, o = c.shift()) if ("*" === o) o = u; else if ("*" !== u && u !== o) { if (!(a = l[u + " " + o] || l["* " + o])) for (i in l) if ((s = i.split(" "))[1] === o && (a = l[u + " " + s[0]] || l["* " + s[0]])) { !0 === a ? a = l[i] : !0 !== l[i] && (o = s[0], c.unshift(s[1])); break } if (!0 !== a) if (a && e["throws"]) t = a(t); else try { t = a(t) } catch (e) { return { state: "parsererror", error: a ? e : "No conversion from " + u + " to " + o } } } return { state: "success", data: t } } w.extend({ active: 0, lastModified: {}, etag: {}, ajaxSettings: { url: Ct.href, type: "GET", isLocal: Pt.test(Ct.protocol), global: !0, processData: !0, async: !0, contentType: "application/x-www-form-urlencoded; charset=UTF-8", accepts: { "*": $t, text: "text/plain", html: "text/html", xml: "application/xml, text/xml", json: "application/json, text/javascript" }, contents: { xml: /\bxml\b/, html: /\bhtml/, json: /\bjson\b/ }, responseFields: { xml: "responseXML", text: "responseText", json: "responseJSON" }, converters: { "* text": String, "text html": !0, "text json": JSON.parse, "text xml": w.parseXML }, flatOptions: { url: !0, context: !0 } }, ajaxSetup: function (e, t) { return t ? zt(zt(e, w.ajaxSettings), t) : zt(w.ajaxSettings, e) }, ajaxPrefilter: Ft(It), ajaxTransport: Ft(Wt), ajax: function (t, n) { "object" == typeof t && (n = t, t = void 0), n = n || {}; var i, o, a, s, u, l, c, f, p, d, h = w.ajaxSetup({}, n), g = h.context || h, y = h.context && (g.nodeType || g.jquery) ? w(g) : w.event, v = w.Deferred(), m = w.Callbacks("once memory"), x = h.statusCode || {}, b = {}, T = {}, C = "canceled", E = { readyState: 0, getResponseHeader: function (e) { var t; if (c) { if (!s) { s = {}; while (t = Ot.exec(a)) s[t[1].toLowerCase()] = t[2] } t = s[e.toLowerCase()] } return null == t ? null : t }, getAllResponseHeaders: function () { return c ? a : null }, setRequestHeader: function (e, t) { return null == c && (e = T[e.toLowerCase()] = T[e.toLowerCase()] || e, b[e] = t), this }, overrideMimeType: function (e) { return null == c && (h.mimeType = e), this }, statusCode: function (e) { var t; if (e) if (c) E.always(e[E.status]); else for (t in e) x[t] = [x[t], e[t]]; return this }, abort: function (e) { var t = e || C; return i && i.abort(t), k(0, t), this } }; if (v.promise(E), h.url = ((t || h.url || Ct.href) + "").replace(Rt, Ct.protocol + "//"), h.type = n.method || n.type || h.method || h.type, h.dataTypes = (h.dataType || "*").toLowerCase().match(M) || [""], null == h.crossDomain) { l = r.createElement("a"); try { l.href = h.url, l.href = l.href, h.crossDomain = Bt.protocol + "//" + Bt.host != l.protocol + "//" + l.host } catch (e) { h.crossDomain = !0 } } if (h.data && h.processData && "string" != typeof h.data && (h.data = w.param(h.data, h.traditional)), _t(It, h, n, E), c) return E; (f = w.event && h.global) && 0 == w.active++ && w.event.trigger("ajaxStart"), h.type = h.type.toUpperCase(), h.hasContent = !Mt.test(h.type), o = h.url.replace(Lt, ""), h.hasContent ? h.data && h.processData && 0 === (h.contentType || "").indexOf("application/x-www-form-urlencoded") && (h.data = h.data.replace(qt, "+")) : (d = h.url.slice(o.length), h.data && (h.processData || "string" == typeof h.data) && (o += (kt.test(o) ? "&" : "?") + h.data, delete h.data), !1 === h.cache && (o = o.replace(Ht, "$1"), d = (kt.test(o) ? "&" : "?") + "_=" + Et++ + d), h.url = o + d), h.ifModified && (w.lastModified[o] && E.setRequestHeader("If-Modified-Since", w.lastModified[o]), w.etag[o] && E.setRequestHeader("If-None-Match", w.etag[o])), (h.data && h.hasContent && !1 !== h.contentType || n.contentType) && E.setRequestHeader("Content-Type", h.contentType), E.setRequestHeader("Accept", h.dataTypes[0] && h.accepts[h.dataTypes[0]] ? h.accepts[h.dataTypes[0]] + ("*" !== h.dataTypes[0] ? ", " + $t + "; q=0.01" : "") : h.accepts["*"]); for (p in h.headers) E.setRequestHeader(p, h.headers[p]); if (h.beforeSend && (!1 === h.beforeSend.call(g, E, h) || c)) return E.abort(); if (C = "abort", m.add(h.complete), E.done(h.success), E.fail(h.error), i = _t(Wt, h, n, E)) { if (E.readyState = 1, f && y.trigger("ajaxSend", [E, h]), c) return E; h.async && h.timeout > 0 && (u = e.setTimeout(function () { E.abort("timeout") }, h.timeout)); try { c = !1, i.send(b, k) } catch (e) { if (c) throw e; k(-1, e) } } else k(-1, "No Transport"); function k(t, n, r, s) { var l, p, d, b, T, C = n; c || (c = !0, u && e.clearTimeout(u), i = void 0, a = s || "", E.readyState = t > 0 ? 4 : 0, l = t >= 200 && t < 300 || 304 === t, r && (b = Xt(h, E, r)), b = Ut(h, b, E, l), l ? (h.ifModified && ((T = E.getResponseHeader("Last-Modified")) && (w.lastModified[o] = T), (T = E.getResponseHeader("etag")) && (w.etag[o] = T)), 204 === t || "HEAD" === h.type ? C = "nocontent" : 304 === t ? C = "notmodified" : (C = b.state, p = b.data, l = !(d = b.error))) : (d = C, !t && C || (C = "error", t < 0 && (t = 0))), E.status = t, E.statusText = (n || C) + "", l ? v.resolveWith(g, [p, C, E]) : v.rejectWith(g, [E, C, d]), E.statusCode(x), x = void 0, f && y.trigger(l ? "ajaxSuccess" : "ajaxError", [E, h, l ? p : d]), m.fireWith(g, [E, C]), f && (y.trigger("ajaxComplete", [E, h]), --w.active || w.event.trigger("ajaxStop"))) } return E }, getJSON: function (e, t, n) { return w.get(e, t, n, "json") }, getScript: function (e, t) { return w.get(e, void 0, t, "script") } }), w.each(["get", "post"], function (e, t) { w[t] = function (e, n, r, i) { return g(n) && (i = i || r, r = n, n = void 0), w.ajax(w.extend({ url: e, type: t, dataType: i, data: n, success: r }, w.isPlainObject(e) && e)) } }), w._evalUrl = function (e) { return w.ajax({ url: e, type: "GET", dataType: "script", cache: !0, async: !1, global: !1, "throws": !0 }) }, w.fn.extend({ wrapAll: function (e) { var t; return this[0] && (g(e) && (e = e.call(this[0])), t = w(e, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && t.insertBefore(this[0]), t.map(function () { var e = this; while (e.firstElementChild) e = e.firstElementChild; return e }).append(this)), this }, wrapInner: function (e) { return g(e) ? this.each(function (t) { w(this).wrapInner(e.call(this, t)) }) : this.each(function () { var t = w(this), n = t.contents(); n.length ? n.wrapAll(e) : t.append(e) }) }, wrap: function (e) { var t = g(e); return this.each(function (n) { w(this).wrapAll(t ? e.call(this, n) : e) }) }, unwrap: function (e) { return this.parent(e).not("body").each(function () { w(this).replaceWith(this.childNodes) }), this } }), w.expr.pseudos.hidden = function (e) { return !w.expr.pseudos.visible(e) }, w.expr.pseudos.visible = function (e) { return !!(e.offsetWidth || e.offsetHeight || e.getClientRects().length) }, w.ajaxSettings.xhr = function () { try { return new e.XMLHttpRequest } catch (e) { } }; var Vt = { 0: 200, 1223: 204 }, Gt = w.ajaxSettings.xhr(); h.cors = !!Gt && "withCredentials" in Gt, h.ajax = Gt = !!Gt, w.ajaxTransport(function (t) { var n, r; if (h.cors || Gt && !t.crossDomain) return { send: function (i, o) { var a, s = t.xhr(); if (s.open(t.type, t.url, t.async, t.username, t.password), t.xhrFields) for (a in t.xhrFields) s[a] = t.xhrFields[a]; t.mimeType && s.overrideMimeType && s.overrideMimeType(t.mimeType), t.crossDomain || i["X-Requested-With"] || (i["X-Requested-With"] = "XMLHttpRequest"); for (a in i) s.setRequestHeader(a, i[a]); n = function (e) { return function () { n && (n = r = s.onload = s.onerror = s.onabort = s.ontimeout = s.onreadystatechange = null, "abort" === e ? s.abort() : "error" === e ? "number" != typeof s.status ? o(0, "error") : o(s.status, s.statusText) : o(Vt[s.status] || s.status, s.statusText, "text" !== (s.responseType || "text") || "string" != typeof s.responseText ? { binary: s.response } : { text: s.responseText }, s.getAllResponseHeaders())) } }, s.onload = n(), r = s.onerror = s.ontimeout = n("error"), void 0 !== s.onabort ? s.onabort = r : s.onreadystatechange = function () { 4 === s.readyState && e.setTimeout(function () { n && r() }) }, n = n("abort"); try { s.send(t.hasContent && t.data || null) } catch (e) { if (n) throw e } }, abort: function () { n && n() } } }), w.ajaxPrefilter(function (e) { e.crossDomain && (e.contents.script = !1) }), w.ajaxSetup({ accepts: { script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript" }, contents: { script: /\b(?:java|ecma)script\b/ }, converters: { "text script": function (e) { return w.globalEval(e), e } } }), w.ajaxPrefilter("script", function (e) { void 0 === e.cache && (e.cache = !1), e.crossDomain && (e.type = "GET") }), w.ajaxTransport("script", function (e) { if (e.crossDomain) { var t, n; return { send: function (i, o) { t = w("<script>").prop({ charset: e.scriptCharset, src: e.url }).on("load error", n = function (e) { t.remove(), n = null, e && o("error" === e.type ? 404 : 200, e.type) }), r.head.appendChild(t[0]) }, abort: function () { n && n() } } } }); var Yt = [], Qt = /(=)\?(?=&|$)|\?\?/; w.ajaxSetup({ jsonp: "callback", jsonpCallback: function () { var e = Yt.pop() || w.expando + "_" + Et++; return this[e] = !0, e } }), w.ajaxPrefilter("json jsonp", function (t, n, r) { var i, o, a, s = !1 !== t.jsonp && (Qt.test(t.url) ? "url" : "string" == typeof t.data && 0 === (t.contentType || "").indexOf("application/x-www-form-urlencoded") && Qt.test(t.data) && "data"); if (s || "jsonp" === t.dataTypes[0]) return i = t.jsonpCallback = g(t.jsonpCallback) ? t.jsonpCallback() : t.jsonpCallback, s ? t[s] = t[s].replace(Qt, "$1" + i) : !1 !== t.jsonp && (t.url += (kt.test(t.url) ? "&" : "?") + t.jsonp + "=" + i), t.converters["script json"] = function () { return a || w.error(i + " was not called"), a[0] }, t.dataTypes[0] = "json", o = e[i], e[i] = function () { a = arguments }, r.always(function () { void 0 === o ? w(e).removeProp(i) : e[i] = o, t[i] && (t.jsonpCallback = n.jsonpCallback, Yt.push(i)), a && g(o) && o(a[0]), a = o = void 0 }), "script" }), h.createHTMLDocument = function () { var e = r.implementation.createHTMLDocument("").body; return e.innerHTML = "<form></form><form></form>", 2 === e.childNodes.length }(), w.parseHTML = function (e, t, n) { if ("string" != typeof e) return []; "boolean" == typeof t && (n = t, t = !1); var i, o, a; return t || (h.createHTMLDocument ? ((i = (t = r.implementation.createHTMLDocument("")).createElement("base")).href = r.location.href, t.head.appendChild(i)) : t = r), o = A.exec(e), a = !n && [], o ? [t.createElement(o[1])] : (o = xe([e], t, a), a && a.length && w(a).remove(), w.merge([], o.childNodes)) }, w.fn.load = function (e, t, n) { var r, i, o, a = this, s = e.indexOf(" "); return s > -1 && (r = vt(e.slice(s)), e = e.slice(0, s)), g(t) ? (n = t, t = void 0) : t && "object" == typeof t && (i = "POST"), a.length > 0 && w.ajax({ url: e, type: i || "GET", dataType: "html", data: t }).done(function (e) { o = arguments, a.html(r ? w("<div>").append(w.parseHTML(e)).find(r) : e) }).always(n && function (e, t) { a.each(function () { n.apply(this, o || [e.responseText, t, e]) }) }), this }, w.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function (e, t) { w.fn[t] = function (e) { return this.on(t, e) } }), w.expr.pseudos.animated = function (e) { return w.grep(w.timers, function (t) { return e === t.elem }).length }, w.offset = { setOffset: function (e, t, n) { var r, i, o, a, s, u, l, c = w.css(e, "position"), f = w(e), p = {}; "static" === c && (e.style.position = "relative"), s = f.offset(), o = w.css(e, "top"), u = w.css(e, "left"), (l = ("absolute" === c || "fixed" === c) && (o + u).indexOf("auto") > -1) ? (a = (r = f.position()).top, i = r.left) : (a = parseFloat(o) || 0, i = parseFloat(u) || 0), g(t) && (t = t.call(e, n, w.extend({}, s))), null != t.top && (p.top = t.top - s.top + a), null != t.left && (p.left = t.left - s.left + i), "using" in t ? t.using.call(e, p) : f.css(p) } }, w.fn.extend({ offset: function (e) { if (arguments.length) return void 0 === e ? this : this.each(function (t) { w.offset.setOffset(this, e, t) }); var t, n, r = this[0]; if (r) return r.getClientRects().length ? (t = r.getBoundingClientRect(), n = r.ownerDocument.defaultView, { top: t.top + n.pageYOffset, left: t.left + n.pageXOffset }) : { top: 0, left: 0 } }, position: function () { if (this[0]) { var e, t, n, r = this[0], i = { top: 0, left: 0 }; if ("fixed" === w.css(r, "position")) t = r.getBoundingClientRect(); else { t = this.offset(), n = r.ownerDocument, e = r.offsetParent || n.documentElement; while (e && (e === n.body || e === n.documentElement) && "static" === w.css(e, "position")) e = e.parentNode; e && e !== r && 1 === e.nodeType && ((i = w(e).offset()).top += w.css(e, "borderTopWidth", !0), i.left += w.css(e, "borderLeftWidth", !0)) } return { top: t.top - i.top - w.css(r, "marginTop", !0), left: t.left - i.left - w.css(r, "marginLeft", !0) } } }, offsetParent: function () { return this.map(function () { var e = this.offsetParent; while (e && "static" === w.css(e, "position")) e = e.offsetParent; return e || be }) } }), w.each({ scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function (e, t) { var n = "pageYOffset" === t; w.fn[e] = function (r) { return z(this, function (e, r, i) { var o; if (y(e) ? o = e : 9 === e.nodeType && (o = e.defaultView), void 0 === i) return o ? o[t] : e[r]; o ? o.scrollTo(n ? o.pageXOffset : i, n ? i : o.pageYOffset) : e[r] = i }, e, r, arguments.length) } }), w.each(["top", "left"], function (e, t) { w.cssHooks[t] = _e(h.pixelPosition, function (e, n) { if (n) return n = Fe(e, t), We.test(n) ? w(e).position()[t] + "px" : n }) }), w.each({ Height: "height", Width: "width" }, function (e, t) { w.each({ padding: "inner" + e, content: t, "": "outer" + e }, function (n, r) { w.fn[r] = function (i, o) { var a = arguments.length && (n || "boolean" != typeof i), s = n || (!0 === i || !0 === o ? "margin" : "border"); return z(this, function (t, n, i) { var o; return y(t) ? 0 === r.indexOf("outer") ? t["inner" + e] : t.document.documentElement["client" + e] : 9 === t.nodeType ? (o = t.documentElement, Math.max(t.body["scroll" + e], o["scroll" + e], t.body["offset" + e], o["offset" + e], o["client" + e])) : void 0 === i ? w.css(t, n, s) : w.style(t, n, i, s) }, t, a ? i : void 0, a) } }) }), w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "), function (e, t) { w.fn[t] = function (e, n) { return arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t) } }), w.fn.extend({ hover: function (e, t) { return this.mouseenter(e).mouseleave(t || e) } }), w.fn.extend({ bind: function (e, t, n) { return this.on(e, null, t, n) }, unbind: function (e, t) { return this.off(e, null, t) }, delegate: function (e, t, n, r) { return this.on(t, e, n, r) }, undelegate: function (e, t, n) { return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", n) } }), w.proxy = function (e, t) { var n, r, i; if ("string" == typeof t && (n = e[t], t = e, e = n), g(e)) return r = o.call(arguments, 2), i = function () { return e.apply(t || this, r.concat(o.call(arguments))) }, i.guid = e.guid = e.guid || w.guid++ , i }, w.holdReady = function (e) { e ? w.readyWait++ : w.ready(!0) }, w.isArray = Array.isArray, w.parseJSON = JSON.parse, w.nodeName = N, w.isFunction = g, w.isWindow = y, w.camelCase = G, w.type = x, w.now = Date.now, w.isNumeric = function (e) { var t = w.type(e); return ("number" === t || "string" === t) && !isNaN(e - parseFloat(e)) }, "function" == typeof define && define.amd && define("jquery", [], function () { return w }); var Jt = e.jQuery, Kt = e.$; return w.noConflict = function (t) { return e.$ === w && (e.$ = Kt), t && e.jQuery === w && (e.jQuery = Jt), w }, t || (e.jQuery = e.$ = w), w });

    xaJquery = jQuery;

    xaJqueryUI = function (jQuery) {
		/*! jQuery UI - v1.12.1 - 2018-02-11
		* http://jqueryui.com
		* Includes: widget.js, position.js, data.js, disable-selection.js, focusable.js, form-reset-mixin.js, jquery-1-7.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/draggable.js, widgets/droppable.js, widgets/resizable.js, widgets/selectable.js, widgets/sortable.js, widgets/accordion.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/selectmenu.js, widgets/slider.js, widgets/spinner.js, widgets/tabs.js, widgets/tooltip.js, effect.js, effects/effect-blind.js, effects/effect-bounce.js, effects/effect-clip.js, effects/effect-drop.js, effects/effect-explode.js, effects/effect-fade.js, effects/effect-fold.js, effects/effect-highlight.js, effects/effect-puff.js, effects/effect-pulsate.js, effects/effect-scale.js, effects/effect-shake.js, effects/effect-size.js, effects/effect-slide.js, effects/effect-transfer.js
		* Copyright jQuery Foundation and other contributors; Licensed MIT */

        (function (e) { "function" == typeof define && define.amd ? define(["jquery"], e) : e(jQuery) })(function (e) {
            function t(e) { for (var t = e.css("visibility"); "inherit" === t;)e = e.parent(), t = e.css("visibility"); return "hidden" !== t } function i(e) { for (var t, i; e.length && e[0] !== document;) { if (t = e.css("position"), ("absolute" === t || "relative" === t || "fixed" === t) && (i = parseInt(e.css("zIndex"), 10), !isNaN(i) && 0 !== i)) return i; e = e.parent() } return 0 } function s() { this._curInst = null, this._keyEvent = !1, this._disabledInputs = [], this._datepickerShowing = !1, this._inDialog = !1, this._mainDivId = "ui-datepicker-div", this._inlineClass = "ui-datepicker-inline", this._appendClass = "ui-datepicker-append", this._triggerClass = "ui-datepicker-trigger", this._dialogClass = "ui-datepicker-dialog", this._disableClass = "ui-datepicker-disabled", this._unselectableClass = "ui-datepicker-unselectable", this._currentClass = "ui-datepicker-current-day", this._dayOverClass = "ui-datepicker-days-cell-over", this.regional = [], this.regional[""] = { closeText: "Done", prevText: "Prev", nextText: "Next", currentText: "Today", monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"], weekHeader: "Wk", dateFormat: "mm/dd/yy", firstDay: 0, isRTL: !1, showMonthAfterYear: !1, yearSuffix: "" }, this._defaults = { showOn: "focus", showAnim: "fadeIn", showOptions: {}, defaultDate: null, appendText: "", buttonText: "...", buttonImage: "", buttonImageOnly: !1, hideIfNoPrevNext: !1, navigationAsDateFormat: !1, gotoCurrent: !1, changeMonth: !1, changeYear: !1, yearRange: "c-10:c+10", showOtherMonths: !1, selectOtherMonths: !1, showWeek: !1, calculateWeek: this.iso8601Week, shortYearCutoff: "+10", minDate: null, maxDate: null, duration: "fast", beforeShowDay: null, beforeShow: null, onSelect: null, onChangeMonthYear: null, onClose: null, numberOfMonths: 1, showCurrentAtPos: 0, stepMonths: 1, stepBigMonths: 12, altField: "", altFormat: "", constrainInput: !0, showButtonPanel: !1, autoSize: !1, disabled: !1 }, e.extend(this._defaults, this.regional[""]), this.regional.en = e.extend(!0, {}, this.regional[""]), this.regional["en-US"] = e.extend(!0, {}, this.regional.en), this.dpDiv = a(e("<div id='" + this._mainDivId + "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")) } function a(t) { var i = "button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a"; return t.on("mouseout", i, function () { e(this).removeClass("ui-state-hover"), -1 !== this.className.indexOf("ui-datepicker-prev") && e(this).removeClass("ui-datepicker-prev-hover"), -1 !== this.className.indexOf("ui-datepicker-next") && e(this).removeClass("ui-datepicker-next-hover") }).on("mouseover", i, n) } function n() { e.datepicker._isDisabledDatepicker(p.inline ? p.dpDiv.parent()[0] : p.input[0]) || (e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"), e(this).addClass("ui-state-hover"), -1 !== this.className.indexOf("ui-datepicker-prev") && e(this).addClass("ui-datepicker-prev-hover"), -1 !== this.className.indexOf("ui-datepicker-next") && e(this).addClass("ui-datepicker-next-hover")) } function r(t, i) { e.extend(t, i); for (var s in i) null == i[s] && (t[s] = i[s]); return t } function o(e) { return function () { var t = this.element.val(); e.apply(this, arguments), this._refresh(), t !== this.element.val() && this._trigger("change") } } e.ui = e.ui || {}, e.ui.version = "1.12.1"; var l = 0, h = Array.prototype.slice; e.cleanData = function (t) { return function (i) { var s, a, n; for (n = 0; null != (a = i[n]); n++)try { s = e._data(a, "events"), s && s.remove && e(a).triggerHandler("remove") } catch (r) { } t(i) } }(e.cleanData), e.widget = function (t, i, s) { var a, n, r, o = {}, l = t.split(".")[0]; t = t.split(".")[1]; var h = l + "-" + t; return s || (s = i, i = e.Widget), e.isArray(s) && (s = e.extend.apply(null, [{}].concat(s))), e.expr[":"][h.toLowerCase()] = function (t) { return !!e.data(t, h) }, e[l] = e[l] || {}, a = e[l][t], n = e[l][t] = function (e, t) { return this._createWidget ? (arguments.length && this._createWidget(e, t), void 0) : new n(e, t) }, e.extend(n, a, { version: s.version, _proto: e.extend({}, s), _childConstructors: [] }), r = new i, r.options = e.widget.extend({}, r.options), e.each(s, function (t, s) { return e.isFunction(s) ? (o[t] = function () { function e() { return i.prototype[t].apply(this, arguments) } function a(e) { return i.prototype[t].apply(this, e) } return function () { var t, i = this._super, n = this._superApply; return this._super = e, this._superApply = a, t = s.apply(this, arguments), this._super = i, this._superApply = n, t } }(), void 0) : (o[t] = s, void 0) }), n.prototype = e.widget.extend(r, { widgetEventPrefix: a ? r.widgetEventPrefix || t : t }, o, { constructor: n, namespace: l, widgetName: t, widgetFullName: h }), a ? (e.each(a._childConstructors, function (t, i) { var s = i.prototype; e.widget(s.namespace + "." + s.widgetName, n, i._proto) }), delete a._childConstructors) : i._childConstructors.push(n), e.widget.bridge(t, n), n }, e.widget.extend = function (t) { for (var i, s, a = h.call(arguments, 1), n = 0, r = a.length; r > n; n++)for (i in a[n]) s = a[n][i], a[n].hasOwnProperty(i) && void 0 !== s && (t[i] = e.isPlainObject(s) ? e.isPlainObject(t[i]) ? e.widget.extend({}, t[i], s) : e.widget.extend({}, s) : s); return t }, e.widget.bridge = function (t, i) { var s = i.prototype.widgetFullName || t; e.fn[t] = function (a) { var n = "string" == typeof a, r = h.call(arguments, 1), o = this; return n ? this.length || "instance" !== a ? this.each(function () { var i, n = e.data(this, s); return "instance" === a ? (o = n, !1) : n ? e.isFunction(n[a]) && "_" !== a.charAt(0) ? (i = n[a].apply(n, r), i !== n && void 0 !== i ? (o = i && i.jquery ? o.pushStack(i.get()) : i, !1) : void 0) : e.error("no such method '" + a + "' for " + t + " widget instance") : e.error("cannot call methods on " + t + " prior to initialization; " + "attempted to call method '" + a + "'") }) : o = void 0 : (r.length && (a = e.widget.extend.apply(null, [a].concat(r))), this.each(function () { var t = e.data(this, s); t ? (t.option(a || {}), t._init && t._init()) : e.data(this, s, new i(a, this)) })), o } }, e.Widget = function () { }, e.Widget._childConstructors = [], e.Widget.prototype = { widgetName: "widget", widgetEventPrefix: "", defaultElement: "<div>", options: { classes: {}, disabled: !1, create: null }, _createWidget: function (t, i) { i = e(i || this.defaultElement || this)[0], this.element = e(i), this.uuid = l++ , this.eventNamespace = "." + this.widgetName + this.uuid, this.bindings = e(), this.hoverable = e(), this.focusable = e(), this.classesElementLookup = {}, i !== this && (e.data(i, this.widgetFullName, this), this._on(!0, this.element, { remove: function (e) { e.target === i && this.destroy() } }), this.document = e(i.style ? i.ownerDocument : i.document || i), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this._create(), this.options.disabled && this._setOptionDisabled(this.options.disabled), this._trigger("create", null, this._getCreateEventData()), this._init() }, _getCreateOptions: function () { return {} }, _getCreateEventData: e.noop, _create: e.noop, _init: e.noop, destroy: function () { var t = this; this._destroy(), e.each(this.classesElementLookup, function (e, i) { t._removeClass(i, e) }), this.element.off(this.eventNamespace).removeData(this.widgetFullName), this.widget().off(this.eventNamespace).removeAttr("aria-disabled"), this.bindings.off(this.eventNamespace) }, _destroy: e.noop, widget: function () { return this.element }, option: function (t, i) { var s, a, n, r = t; if (0 === arguments.length) return e.widget.extend({}, this.options); if ("string" == typeof t) if (r = {}, s = t.split("."), t = s.shift(), s.length) { for (a = r[t] = e.widget.extend({}, this.options[t]), n = 0; s.length - 1 > n; n++)a[s[n]] = a[s[n]] || {}, a = a[s[n]]; if (t = s.pop(), 1 === arguments.length) return void 0 === a[t] ? null : a[t]; a[t] = i } else { if (1 === arguments.length) return void 0 === this.options[t] ? null : this.options[t]; r[t] = i } return this._setOptions(r), this }, _setOptions: function (e) { var t; for (t in e) this._setOption(t, e[t]); return this }, _setOption: function (e, t) { return "classes" === e && this._setOptionClasses(t), this.options[e] = t, "disabled" === e && this._setOptionDisabled(t), this }, _setOptionClasses: function (t) { var i, s, a; for (i in t) a = this.classesElementLookup[i], t[i] !== this.options.classes[i] && a && a.length && (s = e(a.get()), this._removeClass(a, i), s.addClass(this._classes({ element: s, keys: i, classes: t, add: !0 }))) }, _setOptionDisabled: function (e) { this._toggleClass(this.widget(), this.widgetFullName + "-disabled", null, !!e), e && (this._removeClass(this.hoverable, null, "ui-state-hover"), this._removeClass(this.focusable, null, "ui-state-focus")) }, enable: function () { return this._setOptions({ disabled: !1 }) }, disable: function () { return this._setOptions({ disabled: !0 }) }, _classes: function (t) { function i(i, n) { var r, o; for (o = 0; i.length > o; o++)r = a.classesElementLookup[i[o]] || e(), r = t.add ? e(e.unique(r.get().concat(t.element.get()))) : e(r.not(t.element).get()), a.classesElementLookup[i[o]] = r, s.push(i[o]), n && t.classes[i[o]] && s.push(t.classes[i[o]]) } var s = [], a = this; return t = e.extend({ element: this.element, classes: this.options.classes || {} }, t), this._on(t.element, { remove: "_untrackClassesElement" }), t.keys && i(t.keys.match(/\S+/g) || [], !0), t.extra && i(t.extra.match(/\S+/g) || []), s.join(" ") }, _untrackClassesElement: function (t) { var i = this; e.each(i.classesElementLookup, function (s, a) { -1 !== e.inArray(t.target, a) && (i.classesElementLookup[s] = e(a.not(t.target).get())) }) }, _removeClass: function (e, t, i) { return this._toggleClass(e, t, i, !1) }, _addClass: function (e, t, i) { return this._toggleClass(e, t, i, !0) }, _toggleClass: function (e, t, i, s) { s = "boolean" == typeof s ? s : i; var a = "string" == typeof e || null === e, n = { extra: a ? t : i, keys: a ? e : t, element: a ? this.element : e, add: s }; return n.element.toggleClass(this._classes(n), s), this }, _on: function (t, i, s) { var a, n = this; "boolean" != typeof t && (s = i, i = t, t = !1), s ? (i = a = e(i), this.bindings = this.bindings.add(i)) : (s = i, i = this.element, a = this.widget()), e.each(s, function (s, r) { function o() { return t || n.options.disabled !== !0 && !e(this).hasClass("ui-state-disabled") ? ("string" == typeof r ? n[r] : r).apply(n, arguments) : void 0 } "string" != typeof r && (o.guid = r.guid = r.guid || o.guid || e.guid++); var l = s.match(/^([\w:-]*)\s*(.*)$/), h = l[1] + n.eventNamespace, u = l[2]; u ? a.on(h, u, o) : i.on(h, o) }) }, _off: function (t, i) { i = (i || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, t.off(i).off(i), this.bindings = e(this.bindings.not(t).get()), this.focusable = e(this.focusable.not(t).get()), this.hoverable = e(this.hoverable.not(t).get()) }, _delay: function (e, t) { function i() { return ("string" == typeof e ? s[e] : e).apply(s, arguments) } var s = this; return setTimeout(i, t || 0) }, _hoverable: function (t) { this.hoverable = this.hoverable.add(t), this._on(t, { mouseenter: function (t) { this._addClass(e(t.currentTarget), null, "ui-state-hover") }, mouseleave: function (t) { this._removeClass(e(t.currentTarget), null, "ui-state-hover") } }) }, _focusable: function (t) { this.focusable = this.focusable.add(t), this._on(t, { focusin: function (t) { this._addClass(e(t.currentTarget), null, "ui-state-focus") }, focusout: function (t) { this._removeClass(e(t.currentTarget), null, "ui-state-focus") } }) }, _trigger: function (t, i, s) { var a, n, r = this.options[t]; if (s = s || {}, i = e.Event(i), i.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), i.target = this.element[0], n = i.originalEvent) for (a in n) a in i || (i[a] = n[a]); return this.element.trigger(i, s), !(e.isFunction(r) && r.apply(this.element[0], [i].concat(s)) === !1 || i.isDefaultPrevented()) } }, e.each({ show: "fadeIn", hide: "fadeOut" }, function (t, i) { e.Widget.prototype["_" + t] = function (s, a, n) { "string" == typeof a && (a = { effect: a }); var r, o = a ? a === !0 || "number" == typeof a ? i : a.effect || i : t; a = a || {}, "number" == typeof a && (a = { duration: a }), r = !e.isEmptyObject(a), a.complete = n, a.delay && s.delay(a.delay), r && e.effects && e.effects.effect[o] ? s[t](a) : o !== t && s[o] ? s[o](a.duration, a.easing, n) : s.queue(function (i) { e(this)[t](), n && n.call(s[0]), i() }) } }), e.widget, function () { function t(e, t, i) { return [parseFloat(e[0]) * (d.test(e[0]) ? t / 100 : 1), parseFloat(e[1]) * (d.test(e[1]) ? i / 100 : 1)] } function i(t, i) { return parseInt(e.css(t, i), 10) || 0 } function s(t) { var i = t[0]; return 9 === i.nodeType ? { width: t.width(), height: t.height(), offset: { top: 0, left: 0 } } : e.isWindow(i) ? { width: t.width(), height: t.height(), offset: { top: t.scrollTop(), left: t.scrollLeft() } } : i.preventDefault ? { width: 0, height: 0, offset: { top: i.pageY, left: i.pageX } } : { width: t.outerWidth(), height: t.outerHeight(), offset: t.offset() } } var a, n = Math.max, r = Math.abs, o = /left|center|right/, l = /top|center|bottom/, h = /[\+\-]\d+(\.[\d]+)?%?/, u = /^\w+/, d = /%$/, c = e.fn.position; e.position = { scrollbarWidth: function () { if (void 0 !== a) return a; var t, i, s = e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"), n = s.children()[0]; return e("body").append(s), t = n.offsetWidth, s.css("overflow", "scroll"), i = n.offsetWidth, t === i && (i = s[0].clientWidth), s.remove(), a = t - i }, getScrollInfo: function (t) { var i = t.isWindow || t.isDocument ? "" : t.element.css("overflow-x"), s = t.isWindow || t.isDocument ? "" : t.element.css("overflow-y"), a = "scroll" === i || "auto" === i && t.width < t.element[0].scrollWidth, n = "scroll" === s || "auto" === s && t.height < t.element[0].scrollHeight; return { width: n ? e.position.scrollbarWidth() : 0, height: a ? e.position.scrollbarWidth() : 0 } }, getWithinInfo: function (t) { var i = e(t || window), s = e.isWindow(i[0]), a = !!i[0] && 9 === i[0].nodeType, n = !s && !a; return { element: i, isWindow: s, isDocument: a, offset: n ? e(t).offset() : { left: 0, top: 0 }, scrollLeft: i.scrollLeft(), scrollTop: i.scrollTop(), width: i.outerWidth(), height: i.outerHeight() } } }, e.fn.position = function (a) { if (!a || !a.of) return c.apply(this, arguments); a = e.extend({}, a); var d, p, m, f, g, v, y = e(a.of), _ = e.position.getWithinInfo(a.within), b = e.position.getScrollInfo(_), k = (a.collision || "flip").split(" "), x = {}; return v = s(y), y[0].preventDefault && (a.at = "left top"), p = v.width, m = v.height, f = v.offset, g = e.extend({}, f), e.each(["my", "at"], function () { var e, t, i = (a[this] || "").split(" "); 1 === i.length && (i = o.test(i[0]) ? i.concat(["center"]) : l.test(i[0]) ? ["center"].concat(i) : ["center", "center"]), i[0] = o.test(i[0]) ? i[0] : "center", i[1] = l.test(i[1]) ? i[1] : "center", e = h.exec(i[0]), t = h.exec(i[1]), x[this] = [e ? e[0] : 0, t ? t[0] : 0], a[this] = [u.exec(i[0])[0], u.exec(i[1])[0]] }), 1 === k.length && (k[1] = k[0]), "right" === a.at[0] ? g.left += p : "center" === a.at[0] && (g.left += p / 2), "bottom" === a.at[1] ? g.top += m : "center" === a.at[1] && (g.top += m / 2), d = t(x.at, p, m), g.left += d[0], g.top += d[1], this.each(function () { var s, o, l = e(this), h = l.outerWidth(), u = l.outerHeight(), c = i(this, "marginLeft"), v = i(this, "marginTop"), D = h + c + i(this, "marginRight") + b.width, w = u + v + i(this, "marginBottom") + b.height, T = e.extend({}, g), S = t(x.my, l.outerWidth(), l.outerHeight()); "right" === a.my[0] ? T.left -= h : "center" === a.my[0] && (T.left -= h / 2), "bottom" === a.my[1] ? T.top -= u : "center" === a.my[1] && (T.top -= u / 2), T.left += S[0], T.top += S[1], s = { marginLeft: c, marginTop: v }, e.each(["left", "top"], function (t, i) { e.ui.position[k[t]] && e.ui.position[k[t]][i](T, { targetWidth: p, targetHeight: m, elemWidth: h, elemHeight: u, collisionPosition: s, collisionWidth: D, collisionHeight: w, offset: [d[0] + S[0], d[1] + S[1]], my: a.my, at: a.at, within: _, elem: l }) }), a.using && (o = function (e) { var t = f.left - T.left, i = t + p - h, s = f.top - T.top, o = s + m - u, d = { target: { element: y, left: f.left, top: f.top, width: p, height: m }, element: { element: l, left: T.left, top: T.top, width: h, height: u }, horizontal: 0 > i ? "left" : t > 0 ? "right" : "center", vertical: 0 > o ? "top" : s > 0 ? "bottom" : "middle" }; h > p && p > r(t + i) && (d.horizontal = "center"), u > m && m > r(s + o) && (d.vertical = "middle"), d.important = n(r(t), r(i)) > n(r(s), r(o)) ? "horizontal" : "vertical", a.using.call(this, e, d) }), l.offset(e.extend(T, { using: o })) }) }, e.ui.position = { fit: { left: function (e, t) { var i, s = t.within, a = s.isWindow ? s.scrollLeft : s.offset.left, r = s.width, o = e.left - t.collisionPosition.marginLeft, l = a - o, h = o + t.collisionWidth - r - a; t.collisionWidth > r ? l > 0 && 0 >= h ? (i = e.left + l + t.collisionWidth - r - a, e.left += l - i) : e.left = h > 0 && 0 >= l ? a : l > h ? a + r - t.collisionWidth : a : l > 0 ? e.left += l : h > 0 ? e.left -= h : e.left = n(e.left - o, e.left) }, top: function (e, t) { var i, s = t.within, a = s.isWindow ? s.scrollTop : s.offset.top, r = t.within.height, o = e.top - t.collisionPosition.marginTop, l = a - o, h = o + t.collisionHeight - r - a; t.collisionHeight > r ? l > 0 && 0 >= h ? (i = e.top + l + t.collisionHeight - r - a, e.top += l - i) : e.top = h > 0 && 0 >= l ? a : l > h ? a + r - t.collisionHeight : a : l > 0 ? e.top += l : h > 0 ? e.top -= h : e.top = n(e.top - o, e.top) } }, flip: { left: function (e, t) { var i, s, a = t.within, n = a.offset.left + a.scrollLeft, o = a.width, l = a.isWindow ? a.scrollLeft : a.offset.left, h = e.left - t.collisionPosition.marginLeft, u = h - l, d = h + t.collisionWidth - o - l, c = "left" === t.my[0] ? -t.elemWidth : "right" === t.my[0] ? t.elemWidth : 0, p = "left" === t.at[0] ? t.targetWidth : "right" === t.at[0] ? -t.targetWidth : 0, m = -2 * t.offset[0]; 0 > u ? (i = e.left + c + p + m + t.collisionWidth - o - n, (0 > i || r(u) > i) && (e.left += c + p + m)) : d > 0 && (s = e.left - t.collisionPosition.marginLeft + c + p + m - l, (s > 0 || d > r(s)) && (e.left += c + p + m)) }, top: function (e, t) { var i, s, a = t.within, n = a.offset.top + a.scrollTop, o = a.height, l = a.isWindow ? a.scrollTop : a.offset.top, h = e.top - t.collisionPosition.marginTop, u = h - l, d = h + t.collisionHeight - o - l, c = "top" === t.my[1], p = c ? -t.elemHeight : "bottom" === t.my[1] ? t.elemHeight : 0, m = "top" === t.at[1] ? t.targetHeight : "bottom" === t.at[1] ? -t.targetHeight : 0, f = -2 * t.offset[1]; 0 > u ? (s = e.top + p + m + f + t.collisionHeight - o - n, (0 > s || r(u) > s) && (e.top += p + m + f)) : d > 0 && (i = e.top - t.collisionPosition.marginTop + p + m + f - l, (i > 0 || d > r(i)) && (e.top += p + m + f)) } }, flipfit: { left: function () { e.ui.position.flip.left.apply(this, arguments), e.ui.position.fit.left.apply(this, arguments) }, top: function () { e.ui.position.flip.top.apply(this, arguments), e.ui.position.fit.top.apply(this, arguments) } } } }(), e.ui.position, e.extend(e.expr[":"], { data: e.expr.createPseudo ? e.expr.createPseudo(function (t) { return function (i) { return !!e.data(i, t) } }) : function (t, i, s) { return !!e.data(t, s[3]) } }), e.fn.extend({ disableSelection: function () { var e = "onselectstart" in document.createElement("div") ? "selectstart" : "mousedown"; return function () { return this.on(e + ".ui-disableSelection", function (e) { e.preventDefault() }) } }(), enableSelection: function () { return this.off(".ui-disableSelection") } }), e.ui.focusable = function (i, s) { var a, n, r, o, l, h = i.nodeName.toLowerCase(); return "area" === h ? (a = i.parentNode, n = a.name, i.href && n && "map" === a.nodeName.toLowerCase() ? (r = e("img[usemap='#" + n + "']"), r.length > 0 && r.is(":visible")) : !1) : (/^(input|select|textarea|button|object)$/.test(h) ? (o = !i.disabled, o && (l = e(i).closest("fieldset")[0], l && (o = !l.disabled))) : o = "a" === h ? i.href || s : s, o && e(i).is(":visible") && t(e(i))) }, e.extend(e.expr[":"], { focusable: function (t) { return e.ui.focusable(t, null != e.attr(t, "tabindex")) } }), e.ui.focusable, e.fn.form = function () { return "string" == typeof this[0].form ? this.closest("form") : e(this[0].form) }, e.ui.formResetMixin = { _formResetHandler: function () { var t = e(this); setTimeout(function () { var i = t.data("ui-form-reset-instances"); e.each(i, function () { this.refresh() }) }) }, _bindFormResetHandler: function () { if (this.form = this.element.form(), this.form.length) { var e = this.form.data("ui-form-reset-instances") || []; e.length || this.form.on("reset.ui-form-reset", this._formResetHandler), e.push(this), this.form.data("ui-form-reset-instances", e) } }, _unbindFormResetHandler: function () { if (this.form.length) { var t = this.form.data("ui-form-reset-instances"); t.splice(e.inArray(this, t), 1), t.length ? this.form.data("ui-form-reset-instances", t) : this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset") } } }, "1.7" === e.fn.jquery.substring(0, 3) && (e.each(["Width", "Height"], function (t, i) { function s(t, i, s, n) { return e.each(a, function () { i -= parseFloat(e.css(t, "padding" + this)) || 0, s && (i -= parseFloat(e.css(t, "border" + this + "Width")) || 0), n && (i -= parseFloat(e.css(t, "margin" + this)) || 0) }), i } var a = "Width" === i ? ["Left", "Right"] : ["Top", "Bottom"], n = i.toLowerCase(), r = { innerWidth: e.fn.innerWidth, innerHeight: e.fn.innerHeight, outerWidth: e.fn.outerWidth, outerHeight: e.fn.outerHeight }; e.fn["inner" + i] = function (t) { return void 0 === t ? r["inner" + i].call(this) : this.each(function () { e(this).css(n, s(this, t) + "px") }) }, e.fn["outer" + i] = function (t, a) { return "number" != typeof t ? r["outer" + i].call(this, t) : this.each(function () { e(this).css(n, s(this, t, !0, a) + "px") }) } }), e.fn.addBack = function (e) { return this.add(null == e ? this.prevObject : this.prevObject.filter(e)) }), e.ui.keyCode = { BACKSPACE: 8, COMMA: 188, DELETE: 46, DOWN: 40, END: 35, ENTER: 13, ESCAPE: 27, HOME: 36, LEFT: 37, PAGE_DOWN: 34, PAGE_UP: 33, PERIOD: 190, RIGHT: 39, SPACE: 32, TAB: 9, UP: 38 }, e.ui.escapeSelector = function () { var e = /([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g; return function (t) { return t.replace(e, "\\$1") } }(), e.fn.labels = function () { var t, i, s, a, n; return this[0].labels && this[0].labels.length ? this.pushStack(this[0].labels) : (a = this.eq(0).parents("label"), s = this.attr("id"), s && (t = this.eq(0).parents().last(), n = t.add(t.length ? t.siblings() : this.siblings()), i = "label[for='" + e.ui.escapeSelector(s) + "']", a = a.add(n.find(i).addBack(i))), this.pushStack(a)) }, e.fn.scrollParent = function (t) { var i = this.css("position"), s = "absolute" === i, a = t ? /(auto|scroll|hidden)/ : /(auto|scroll)/, n = this.parents().filter(function () { var t = e(this); return s && "static" === t.css("position") ? !1 : a.test(t.css("overflow") + t.css("overflow-y") + t.css("overflow-x")) }).eq(0); return "fixed" !== i && n.length ? n : e(this[0].ownerDocument || document) }, e.extend(e.expr[":"], { tabbable: function (t) { var i = e.attr(t, "tabindex"), s = null != i; return (!s || i >= 0) && e.ui.focusable(t, s) } }), e.fn.extend({ uniqueId: function () { var e = 0; return function () { return this.each(function () { this.id || (this.id = "ui-id-" + ++e) }) } }(), removeUniqueId: function () { return this.each(function () { /^ui-id-\d+$/.test(this.id) && e(this).removeAttr("id") }) } }), e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()); var u = !1; e(document).on("mouseup", function () { u = !1 }), e.widget("ui.mouse", { version: "1.12.1", options: { cancel: "input, textarea, button, select, option", distance: 1, delay: 0 }, _mouseInit: function () { var t = this; this.element.on("mousedown." + this.widgetName, function (e) { return t._mouseDown(e) }).on("click." + this.widgetName, function (i) { return !0 === e.data(i.target, t.widgetName + ".preventClickEvent") ? (e.removeData(i.target, t.widgetName + ".preventClickEvent"), i.stopImmediatePropagation(), !1) : void 0 }), this.started = !1 }, _mouseDestroy: function () { this.element.off("." + this.widgetName), this._mouseMoveDelegate && this.document.off("mousemove." + this.widgetName, this._mouseMoveDelegate).off("mouseup." + this.widgetName, this._mouseUpDelegate) }, _mouseDown: function (t) { if (!u) { this._mouseMoved = !1, this._mouseStarted && this._mouseUp(t), this._mouseDownEvent = t; var i = this, s = 1 === t.which, a = "string" == typeof this.options.cancel && t.target.nodeName ? e(t.target).closest(this.options.cancel).length : !1; return s && !a && this._mouseCapture(t) ? (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () { i.mouseDelayMet = !0 }, this.options.delay)), this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(t) !== !1, !this._mouseStarted) ? (t.preventDefault(), !0) : (!0 === e.data(t.target, this.widgetName + ".preventClickEvent") && e.removeData(t.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function (e) { return i._mouseMove(e) }, this._mouseUpDelegate = function (e) { return i._mouseUp(e) }, this.document.on("mousemove." + this.widgetName, this._mouseMoveDelegate).on("mouseup." + this.widgetName, this._mouseUpDelegate), t.preventDefault(), u = !0, !0)) : !0 } }, _mouseMove: function (t) { if (this._mouseMoved) { if (e.ui.ie && (!document.documentMode || 9 > document.documentMode) && !t.button) return this._mouseUp(t); if (!t.which) if (t.originalEvent.altKey || t.originalEvent.ctrlKey || t.originalEvent.metaKey || t.originalEvent.shiftKey) this.ignoreMissingWhich = !0; else if (!this.ignoreMissingWhich) return this._mouseUp(t) } return (t.which || t.button) && (this._mouseMoved = !0), this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted) }, _mouseUp: function (t) { this.document.off("mousemove." + this.widgetName, this._mouseMoveDelegate).off("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), this._mouseDelayTimer && (clearTimeout(this._mouseDelayTimer), delete this._mouseDelayTimer), this.ignoreMissingWhich = !1, u = !1, t.preventDefault() }, _mouseDistanceMet: function (e) { return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance }, _mouseDelayMet: function () { return this.mouseDelayMet }, _mouseStart: function () { }, _mouseDrag: function () { }, _mouseStop: function () { }, _mouseCapture: function () { return !0 } }), e.ui.plugin = { add: function (t, i, s) { var a, n = e.ui[t].prototype; for (a in s) n.plugins[a] = n.plugins[a] || [], n.plugins[a].push([i, s[a]]) }, call: function (e, t, i, s) { var a, n = e.plugins[t]; if (n && (s || e.element[0].parentNode && 11 !== e.element[0].parentNode.nodeType)) for (a = 0; n.length > a; a++)e.options[n[a][0]] && n[a][1].apply(e.element, i) } }, e.ui.safeActiveElement = function (e) { var t; try { t = e.activeElement } catch (i) { t = e.body } return t || (t = e.body), t.nodeName || (t = e.body), t }, e.ui.safeBlur = function (t) { t && "body" !== t.nodeName.toLowerCase() && e(t).trigger("blur") }, e.widget("ui.draggable", e.ui.mouse, {
                version: "1.12.1", widgetEventPrefix: "drag", options: { addClasses: !0, appendTo: "parent", axis: !1, connectToSortable: !1, containment: !1, cursor: "auto", cursorAt: !1, grid: !1, handle: !1, helper: "original", iframeFix: !1, opacity: !1, refreshPositions: !1, revert: !1, revertDuration: 500, scope: "default", scroll: !0, scrollSensitivity: 20, scrollSpeed: 20, snap: !1, snapMode: "both", snapTolerance: 20, stack: !1, zIndex: !1, drag: null, start: null, stop: null }, _create: function () { "original" === this.options.helper && this._setPositionRelative(), this.options.addClasses && this._addClass("ui-draggable"), this._setHandleClassName(), this._mouseInit() }, _setOption: function (e, t) { this._super(e, t), "handle" === e && (this._removeHandleClassName(), this._setHandleClassName()) }, _destroy: function () { return (this.helper || this.element).is(".ui-draggable-dragging") ? (this.destroyOnClear = !0, void 0) : (this._removeHandleClassName(), this._mouseDestroy(), void 0) }, _mouseCapture: function (t) { var i = this.options; return this.helper || i.disabled || e(t.target).closest(".ui-resizable-handle").length > 0 ? !1 : (this.handle = this._getHandle(t), this.handle ? (this._blurActiveElement(t), this._blockFrames(i.iframeFix === !0 ? "iframe" : i.iframeFix), !0) : !1) }, _blockFrames: function (t) { this.iframeBlocks = this.document.find(t).map(function () { var t = e(this); return e("<div>").css("position", "absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0] }) }, _unblockFrames: function () { this.iframeBlocks && (this.iframeBlocks.remove(), delete this.iframeBlocks) }, _blurActiveElement: function (t) { var i = e.ui.safeActiveElement(this.document[0]), s = e(t.target); s.closest(i).length || e.ui.safeBlur(i) }, _mouseStart: function (t) { var i = this.options; return this.helper = this._createHelper(t), this._addClass(this.helper, "ui-draggable-dragging"), this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(!0), this.offsetParent = this.helper.offsetParent(), this.hasFixedAncestor = this.helper.parents().filter(function () { return "fixed" === e(this).css("position") }).length > 0, this.positionAbs = this.element.offset(), this._refreshOffsets(t), this.originalPosition = this.position = this._generatePosition(t, !1), this.originalPageX = t.pageX, this.originalPageY = t.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), this._setContainment(), this._trigger("start", t) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && !i.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this._mouseDrag(t, !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0) }, _refreshOffsets: function (e) { this.offset = { top: this.positionAbs.top - this.margins.top, left: this.positionAbs.left - this.margins.left, scroll: !1, parent: this._getParentOffset(), relative: this._getRelativeOffset() }, this.offset.click = { left: e.pageX - this.offset.left, top: e.pageY - this.offset.top } }, _mouseDrag: function (t, i) { if (this.hasFixedAncestor && (this.offset.parent = this._getParentOffset()), this.position = this._generatePosition(t, !0), this.positionAbs = this._convertPositionTo("absolute"), !i) { var s = this._uiHash(); if (this._trigger("drag", t, s) === !1) return this._mouseUp(new e.Event("mouseup", t)), !1; this.position = s.position } return this.helper[0].style.left = this.position.left + "px", this.helper[0].style.top = this.position.top + "px", e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1 }, _mouseStop: function (t) { var i = this, s = !1; return e.ui.ddmanager && !this.options.dropBehaviour && (s = e.ui.ddmanager.drop(this, t)), this.dropped && (s = this.dropped, this.dropped = !1), "invalid" === this.options.revert && !s || "valid" === this.options.revert && s || this.options.revert === !0 || e.isFunction(this.options.revert) && this.options.revert.call(this.element, s) ? e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function () { i._trigger("stop", t) !== !1 && i._clear() }) : this._trigger("stop", t) !== !1 && this._clear(), !1 }, _mouseUp: function (t) { return this._unblockFrames(), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), this.handleElement.is(t.target) && this.element.trigger("focus"), e.ui.mouse.prototype._mouseUp.call(this, t) }, cancel: function () { return this.helper.is(".ui-draggable-dragging") ? this._mouseUp(new e.Event("mouseup", { target: this.element[0] })) : this._clear(), this }, _getHandle: function (t) { return this.options.handle ? !!e(t.target).closest(this.element.find(this.options.handle)).length : !0 }, _setHandleClassName: function () { this.handleElement = this.options.handle ? this.element.find(this.options.handle) : this.element, this._addClass(this.handleElement, "ui-draggable-handle") }, _removeHandleClassName: function () { this._removeClass(this.handleElement, "ui-draggable-handle") }, _createHelper: function (t) { var i = this.options, s = e.isFunction(i.helper), a = s ? e(i.helper.apply(this.element[0], [t])) : "clone" === i.helper ? this.element.clone().removeAttr("id") : this.element; return a.parents("body").length || a.appendTo("parent" === i.appendTo ? this.element[0].parentNode : i.appendTo), s && a[0] === this.element[0] && this._setPositionRelative(), a[0] === this.element[0] || /(fixed|absolute)/.test(a.css("position")) || a.css("position", "absolute"), a }, _setPositionRelative: function () { /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative") }, _adjustOffsetFromHelper: function (t) { "string" == typeof t && (t = t.split(" ")), e.isArray(t) && (t = { left: +t[0], top: +t[1] || 0 }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top) }, _isRootNode: function (e) { return /(html|body)/i.test(e.tagName) || e === this.document[0] }, _getParentOffset: function () { var t = this.offsetParent.offset(), i = this.document[0]; return "absolute" === this.cssPosition && this.scrollParent[0] !== i && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), this._isRootNode(this.offsetParent[0]) && (t = { top: 0, left: 0 }), { top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0) } }, _getRelativeOffset: function () { if ("relative" !== this.cssPosition) return { top: 0, left: 0 }; var e = this.element.position(), t = this._isRootNode(this.scrollParent[0]); return { top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + (t ? 0 : this.scrollParent.scrollTop()), left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + (t ? 0 : this.scrollParent.scrollLeft()) } }, _cacheMargins: function () { this.margins = { left: parseInt(this.element.css("marginLeft"), 10) || 0, top: parseInt(this.element.css("marginTop"), 10) || 0, right: parseInt(this.element.css("marginRight"), 10) || 0, bottom: parseInt(this.element.css("marginBottom"), 10) || 0 } }, _cacheHelperProportions: function () { this.helperProportions = { width: this.helper.outerWidth(), height: this.helper.outerHeight() } }, _setContainment: function () {
                    var t, i, s, a = this.options, n = this.document[0]; return this.relativeContainer = null, a.containment ? "window" === a.containment ? (this.containment = [e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, e(window).scrollLeft() + e(window).width() - this.helperProportions.width - this.margins.left, e(window).scrollTop() + (e(window).height() || n.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top], void 0) : "document" === a.containment ? (this.containment = [0, 0, e(n).width() - this.helperProportions.width - this.margins.left, (e(n).height() || n.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top], void 0) : a.containment.constructor === Array ? (this.containment = a.containment, void 0) : ("parent" === a.containment && (a.containment = this.helper[0].parentNode), i = e(a.containment), s = i[0], s && (t = /(scroll|auto)/.test(i.css("overflow")), this.containment = [(parseInt(i.css("borderLeftWidth"), 10) || 0) + (parseInt(i.css("paddingLeft"), 10) || 0), (parseInt(i.css("borderTopWidth"), 10) || 0) + (parseInt(i.css("paddingTop"), 10) || 0), (t ? Math.max(s.scrollWidth, s.offsetWidth) : s.offsetWidth) - (parseInt(i.css("borderRightWidth"), 10) || 0) - (parseInt(i.css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (t ? Math.max(s.scrollHeight, s.offsetHeight) : s.offsetHeight) - (parseInt(i.css("borderBottomWidth"), 10) || 0) - (parseInt(i.css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relativeContainer = i), void 0) : (this.containment = null, void 0)
                }, _convertPositionTo: function (e, t) { t || (t = this.position); var i = "absolute" === e ? 1 : -1, s = this._isRootNode(this.scrollParent[0]); return { top: t.top + this.offset.relative.top * i + this.offset.parent.top * i - ("fixed" === this.cssPosition ? -this.offset.scroll.top : s ? 0 : this.offset.scroll.top) * i, left: t.left + this.offset.relative.left * i + this.offset.parent.left * i - ("fixed" === this.cssPosition ? -this.offset.scroll.left : s ? 0 : this.offset.scroll.left) * i } }, _generatePosition: function (e, t) { var i, s, a, n, r = this.options, o = this._isRootNode(this.scrollParent[0]), l = e.pageX, h = e.pageY; return o && this.offset.scroll || (this.offset.scroll = { top: this.scrollParent.scrollTop(), left: this.scrollParent.scrollLeft() }), t && (this.containment && (this.relativeContainer ? (s = this.relativeContainer.offset(), i = [this.containment[0] + s.left, this.containment[1] + s.top, this.containment[2] + s.left, this.containment[3] + s.top]) : i = this.containment, e.pageX - this.offset.click.left < i[0] && (l = i[0] + this.offset.click.left), e.pageY - this.offset.click.top < i[1] && (h = i[1] + this.offset.click.top), e.pageX - this.offset.click.left > i[2] && (l = i[2] + this.offset.click.left), e.pageY - this.offset.click.top > i[3] && (h = i[3] + this.offset.click.top)), r.grid && (a = r.grid[1] ? this.originalPageY + Math.round((h - this.originalPageY) / r.grid[1]) * r.grid[1] : this.originalPageY, h = i ? a - this.offset.click.top >= i[1] || a - this.offset.click.top > i[3] ? a : a - this.offset.click.top >= i[1] ? a - r.grid[1] : a + r.grid[1] : a, n = r.grid[0] ? this.originalPageX + Math.round((l - this.originalPageX) / r.grid[0]) * r.grid[0] : this.originalPageX, l = i ? n - this.offset.click.left >= i[0] || n - this.offset.click.left > i[2] ? n : n - this.offset.click.left >= i[0] ? n - r.grid[0] : n + r.grid[0] : n), "y" === r.axis && (l = this.originalPageX), "x" === r.axis && (h = this.originalPageY)), { top: h - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.offset.scroll.top : o ? 0 : this.offset.scroll.top), left: l - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.offset.scroll.left : o ? 0 : this.offset.scroll.left) } }, _clear: function () { this._removeClass(this.helper, "ui-draggable-dragging"), this.helper[0] === this.element[0] || this.cancelHelperRemoval || this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1, this.destroyOnClear && this.destroy() }, _trigger: function (t, i, s) { return s = s || this._uiHash(), e.ui.plugin.call(this, t, [i, s, this], !0), /^(drag|start|stop)/.test(t) && (this.positionAbs = this._convertPositionTo("absolute"), s.offset = this.positionAbs), e.Widget.prototype._trigger.call(this, t, i, s) }, plugins: {}, _uiHash: function () { return { helper: this.helper, position: this.position, originalPosition: this.originalPosition, offset: this.positionAbs } }
            }), e.ui.plugin.add("draggable", "connectToSortable", { start: function (t, i, s) { var a = e.extend({}, i, { item: s.element }); s.sortables = [], e(s.options.connectToSortable).each(function () { var i = e(this).sortable("instance"); i && !i.options.disabled && (s.sortables.push(i), i.refreshPositions(), i._trigger("activate", t, a)) }) }, stop: function (t, i, s) { var a = e.extend({}, i, { item: s.element }); s.cancelHelperRemoval = !1, e.each(s.sortables, function () { var e = this; e.isOver ? (e.isOver = 0, s.cancelHelperRemoval = !0, e.cancelHelperRemoval = !1, e._storedCSS = { position: e.placeholder.css("position"), top: e.placeholder.css("top"), left: e.placeholder.css("left") }, e._mouseStop(t), e.options.helper = e.options._helper) : (e.cancelHelperRemoval = !0, e._trigger("deactivate", t, a)) }) }, drag: function (t, i, s) { e.each(s.sortables, function () { var a = !1, n = this; n.positionAbs = s.positionAbs, n.helperProportions = s.helperProportions, n.offset.click = s.offset.click, n._intersectsWith(n.containerCache) && (a = !0, e.each(s.sortables, function () { return this.positionAbs = s.positionAbs, this.helperProportions = s.helperProportions, this.offset.click = s.offset.click, this !== n && this._intersectsWith(this.containerCache) && e.contains(n.element[0], this.element[0]) && (a = !1), a })), a ? (n.isOver || (n.isOver = 1, s._parent = i.helper.parent(), n.currentItem = i.helper.appendTo(n.element).data("ui-sortable-item", !0), n.options._helper = n.options.helper, n.options.helper = function () { return i.helper[0] }, t.target = n.currentItem[0], n._mouseCapture(t, !0), n._mouseStart(t, !0, !0), n.offset.click.top = s.offset.click.top, n.offset.click.left = s.offset.click.left, n.offset.parent.left -= s.offset.parent.left - n.offset.parent.left, n.offset.parent.top -= s.offset.parent.top - n.offset.parent.top, s._trigger("toSortable", t), s.dropped = n.element, e.each(s.sortables, function () { this.refreshPositions() }), s.currentItem = s.element, n.fromOutside = s), n.currentItem && (n._mouseDrag(t), i.position = n.position)) : n.isOver && (n.isOver = 0, n.cancelHelperRemoval = !0, n.options._revert = n.options.revert, n.options.revert = !1, n._trigger("out", t, n._uiHash(n)), n._mouseStop(t, !0), n.options.revert = n.options._revert, n.options.helper = n.options._helper, n.placeholder && n.placeholder.remove(), i.helper.appendTo(s._parent), s._refreshOffsets(t), i.position = s._generatePosition(t, !0), s._trigger("fromSortable", t), s.dropped = !1, e.each(s.sortables, function () { this.refreshPositions() })) }) } }), e.ui.plugin.add("draggable", "cursor", { start: function (t, i, s) { var a = e("body"), n = s.options; a.css("cursor") && (n._cursor = a.css("cursor")), a.css("cursor", n.cursor) }, stop: function (t, i, s) { var a = s.options; a._cursor && e("body").css("cursor", a._cursor) } }), e.ui.plugin.add("draggable", "opacity", { start: function (t, i, s) { var a = e(i.helper), n = s.options; a.css("opacity") && (n._opacity = a.css("opacity")), a.css("opacity", n.opacity) }, stop: function (t, i, s) { var a = s.options; a._opacity && e(i.helper).css("opacity", a._opacity) } }), e.ui.plugin.add("draggable", "scroll", { start: function (e, t, i) { i.scrollParentNotHidden || (i.scrollParentNotHidden = i.helper.scrollParent(!1)), i.scrollParentNotHidden[0] !== i.document[0] && "HTML" !== i.scrollParentNotHidden[0].tagName && (i.overflowOffset = i.scrollParentNotHidden.offset()) }, drag: function (t, i, s) { var a = s.options, n = !1, r = s.scrollParentNotHidden[0], o = s.document[0]; r !== o && "HTML" !== r.tagName ? (a.axis && "x" === a.axis || (s.overflowOffset.top + r.offsetHeight - t.pageY < a.scrollSensitivity ? r.scrollTop = n = r.scrollTop + a.scrollSpeed : t.pageY - s.overflowOffset.top < a.scrollSensitivity && (r.scrollTop = n = r.scrollTop - a.scrollSpeed)), a.axis && "y" === a.axis || (s.overflowOffset.left + r.offsetWidth - t.pageX < a.scrollSensitivity ? r.scrollLeft = n = r.scrollLeft + a.scrollSpeed : t.pageX - s.overflowOffset.left < a.scrollSensitivity && (r.scrollLeft = n = r.scrollLeft - a.scrollSpeed))) : (a.axis && "x" === a.axis || (t.pageY - e(o).scrollTop() < a.scrollSensitivity ? n = e(o).scrollTop(e(o).scrollTop() - a.scrollSpeed) : e(window).height() - (t.pageY - e(o).scrollTop()) < a.scrollSensitivity && (n = e(o).scrollTop(e(o).scrollTop() + a.scrollSpeed))), a.axis && "y" === a.axis || (t.pageX - e(o).scrollLeft() < a.scrollSensitivity ? n = e(o).scrollLeft(e(o).scrollLeft() - a.scrollSpeed) : e(window).width() - (t.pageX - e(o).scrollLeft()) < a.scrollSensitivity && (n = e(o).scrollLeft(e(o).scrollLeft() + a.scrollSpeed)))), n !== !1 && e.ui.ddmanager && !a.dropBehaviour && e.ui.ddmanager.prepareOffsets(s, t) } }), e.ui.plugin.add("draggable", "snap", { start: function (t, i, s) { var a = s.options; s.snapElements = [], e(a.snap.constructor !== String ? a.snap.items || ":data(ui-draggable)" : a.snap).each(function () { var t = e(this), i = t.offset(); this !== s.element[0] && s.snapElements.push({ item: this, width: t.outerWidth(), height: t.outerHeight(), top: i.top, left: i.left }) }) }, drag: function (t, i, s) { var a, n, r, o, l, h, u, d, c, p, m = s.options, f = m.snapTolerance, g = i.offset.left, v = g + s.helperProportions.width, y = i.offset.top, _ = y + s.helperProportions.height; for (c = s.snapElements.length - 1; c >= 0; c--)l = s.snapElements[c].left - s.margins.left, h = l + s.snapElements[c].width, u = s.snapElements[c].top - s.margins.top, d = u + s.snapElements[c].height, l - f > v || g > h + f || u - f > _ || y > d + f || !e.contains(s.snapElements[c].item.ownerDocument, s.snapElements[c].item) ? (s.snapElements[c].snapping && s.options.snap.release && s.options.snap.release.call(s.element, t, e.extend(s._uiHash(), { snapItem: s.snapElements[c].item })), s.snapElements[c].snapping = !1) : ("inner" !== m.snapMode && (a = f >= Math.abs(u - _), n = f >= Math.abs(d - y), r = f >= Math.abs(l - v), o = f >= Math.abs(h - g), a && (i.position.top = s._convertPositionTo("relative", { top: u - s.helperProportions.height, left: 0 }).top), n && (i.position.top = s._convertPositionTo("relative", { top: d, left: 0 }).top), r && (i.position.left = s._convertPositionTo("relative", { top: 0, left: l - s.helperProportions.width }).left), o && (i.position.left = s._convertPositionTo("relative", { top: 0, left: h }).left)), p = a || n || r || o, "outer" !== m.snapMode && (a = f >= Math.abs(u - y), n = f >= Math.abs(d - _), r = f >= Math.abs(l - g), o = f >= Math.abs(h - v), a && (i.position.top = s._convertPositionTo("relative", { top: u, left: 0 }).top), n && (i.position.top = s._convertPositionTo("relative", { top: d - s.helperProportions.height, left: 0 }).top), r && (i.position.left = s._convertPositionTo("relative", { top: 0, left: l }).left), o && (i.position.left = s._convertPositionTo("relative", { top: 0, left: h - s.helperProportions.width }).left)), !s.snapElements[c].snapping && (a || n || r || o || p) && s.options.snap.snap && s.options.snap.snap.call(s.element, t, e.extend(s._uiHash(), { snapItem: s.snapElements[c].item })), s.snapElements[c].snapping = a || n || r || o || p) } }), e.ui.plugin.add("draggable", "stack", { start: function (t, i, s) { var a, n = s.options, r = e.makeArray(e(n.stack)).sort(function (t, i) { return (parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(i).css("zIndex"), 10) || 0) }); r.length && (a = parseInt(e(r[0]).css("zIndex"), 10) || 0, e(r).each(function (t) { e(this).css("zIndex", a + t) }), this.css("zIndex", a + r.length)) } }), e.ui.plugin.add("draggable", "zIndex", { start: function (t, i, s) { var a = e(i.helper), n = s.options; a.css("zIndex") && (n._zIndex = a.css("zIndex")), a.css("zIndex", n.zIndex) }, stop: function (t, i, s) { var a = s.options; a._zIndex && e(i.helper).css("zIndex", a._zIndex) } }), e.ui.draggable, e.widget("ui.droppable", { version: "1.12.1", widgetEventPrefix: "drop", options: { accept: "*", addClasses: !0, greedy: !1, scope: "default", tolerance: "intersect", activate: null, deactivate: null, drop: null, out: null, over: null }, _create: function () { var t, i = this.options, s = i.accept; this.isover = !1, this.isout = !0, this.accept = e.isFunction(s) ? s : function (e) { return e.is(s) }, this.proportions = function () { return arguments.length ? (t = arguments[0], void 0) : t ? t : t = { width: this.element[0].offsetWidth, height: this.element[0].offsetHeight } }, this._addToManager(i.scope), i.addClasses && this._addClass("ui-droppable") }, _addToManager: function (t) { e.ui.ddmanager.droppables[t] = e.ui.ddmanager.droppables[t] || [], e.ui.ddmanager.droppables[t].push(this) }, _splice: function (e) { for (var t = 0; e.length > t; t++)e[t] === this && e.splice(t, 1) }, _destroy: function () { var t = e.ui.ddmanager.droppables[this.options.scope]; this._splice(t) }, _setOption: function (t, i) { if ("accept" === t) this.accept = e.isFunction(i) ? i : function (e) { return e.is(i) }; else if ("scope" === t) { var s = e.ui.ddmanager.droppables[this.options.scope]; this._splice(s), this._addToManager(i) } this._super(t, i) }, _activate: function (t) { var i = e.ui.ddmanager.current; this._addActiveClass(), i && this._trigger("activate", t, this.ui(i)) }, _deactivate: function (t) { var i = e.ui.ddmanager.current; this._removeActiveClass(), i && this._trigger("deactivate", t, this.ui(i)) }, _over: function (t) { var i = e.ui.ddmanager.current; i && (i.currentItem || i.element)[0] !== this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this._addHoverClass(), this._trigger("over", t, this.ui(i))) }, _out: function (t) { var i = e.ui.ddmanager.current; i && (i.currentItem || i.element)[0] !== this.element[0] && this.accept.call(this.element[0], i.currentItem || i.element) && (this._removeHoverClass(), this._trigger("out", t, this.ui(i))) }, _drop: function (t, i) { var s = i || e.ui.ddmanager.current, a = !1; return s && (s.currentItem || s.element)[0] !== this.element[0] ? (this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function () { var i = e(this).droppable("instance"); return i.options.greedy && !i.options.disabled && i.options.scope === s.options.scope && i.accept.call(i.element[0], s.currentItem || s.element) && d(s, e.extend(i, { offset: i.element.offset() }), i.options.tolerance, t) ? (a = !0, !1) : void 0 }), a ? !1 : this.accept.call(this.element[0], s.currentItem || s.element) ? (this._removeActiveClass(), this._removeHoverClass(), this._trigger("drop", t, this.ui(s)), this.element) : !1) : !1 }, ui: function (e) { return { draggable: e.currentItem || e.element, helper: e.helper, position: e.position, offset: e.positionAbs } }, _addHoverClass: function () { this._addClass("ui-droppable-hover") }, _removeHoverClass: function () { this._removeClass("ui-droppable-hover") }, _addActiveClass: function () { this._addClass("ui-droppable-active") }, _removeActiveClass: function () { this._removeClass("ui-droppable-active") } }); var d = e.ui.intersect = function () { function e(e, t, i) { return e >= t && t + i > e } return function (t, i, s, a) { if (!i.offset) return !1; var n = (t.positionAbs || t.position.absolute).left + t.margins.left, r = (t.positionAbs || t.position.absolute).top + t.margins.top, o = n + t.helperProportions.width, l = r + t.helperProportions.height, h = i.offset.left, u = i.offset.top, d = h + i.proportions().width, c = u + i.proportions().height; switch (s) { case "fit": return n >= h && d >= o && r >= u && c >= l; case "intersect": return n + t.helperProportions.width / 2 > h && d > o - t.helperProportions.width / 2 && r + t.helperProportions.height / 2 > u && c > l - t.helperProportions.height / 2; case "pointer": return e(a.pageY, u, i.proportions().height) && e(a.pageX, h, i.proportions().width); case "touch": return (r >= u && c >= r || l >= u && c >= l || u > r && l > c) && (n >= h && d >= n || o >= h && d >= o || h > n && o > d); default: return !1 } } }(); e.ui.ddmanager = { current: null, droppables: { "default": [] }, prepareOffsets: function (t, i) { var s, a, n = e.ui.ddmanager.droppables[t.options.scope] || [], r = i ? i.type : null, o = (t.currentItem || t.element).find(":data(ui-droppable)").addBack(); e: for (s = 0; n.length > s; s++)if (!(n[s].options.disabled || t && !n[s].accept.call(n[s].element[0], t.currentItem || t.element))) { for (a = 0; o.length > a; a++)if (o[a] === n[s].element[0]) { n[s].proportions().height = 0; continue e } n[s].visible = "none" !== n[s].element.css("display"), n[s].visible && ("mousedown" === r && n[s]._activate.call(n[s], i), n[s].offset = n[s].element.offset(), n[s].proportions({ width: n[s].element[0].offsetWidth, height: n[s].element[0].offsetHeight })) } }, drop: function (t, i) { var s = !1; return e.each((e.ui.ddmanager.droppables[t.options.scope] || []).slice(), function () { this.options && (!this.options.disabled && this.visible && d(t, this, this.options.tolerance, i) && (s = this._drop.call(this, i) || s), !this.options.disabled && this.visible && this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = !0, this.isover = !1, this._deactivate.call(this, i))) }), s }, dragStart: function (t, i) { t.element.parentsUntil("body").on("scroll.droppable", function () { t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, i) }) }, drag: function (t, i) { t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, i), e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function () { if (!this.options.disabled && !this.greedyChild && this.visible) { var s, a, n, r = d(t, this, this.options.tolerance, i), o = !r && this.isover ? "isout" : r && !this.isover ? "isover" : null; o && (this.options.greedy && (a = this.options.scope, n = this.element.parents(":data(ui-droppable)").filter(function () { return e(this).droppable("instance").options.scope === a }), n.length && (s = e(n[0]).droppable("instance"), s.greedyChild = "isover" === o)), s && "isover" === o && (s.isover = !1, s.isout = !0, s._out.call(s, i)), this[o] = !0, this["isout" === o ? "isover" : "isout"] = !1, this["isover" === o ? "_over" : "_out"].call(this, i), s && "isout" === o && (s.isout = !1, s.isover = !0, s._over.call(s, i))) } }) }, dragStop: function (t, i) { t.element.parentsUntil("body").off("scroll.droppable"), t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, i) } }, e.uiBackCompat !== !1 && e.widget("ui.droppable", e.ui.droppable, { options: { hoverClass: !1, activeClass: !1 }, _addActiveClass: function () { this._super(), this.options.activeClass && this.element.addClass(this.options.activeClass) }, _removeActiveClass: function () { this._super(), this.options.activeClass && this.element.removeClass(this.options.activeClass) }, _addHoverClass: function () { this._super(), this.options.hoverClass && this.element.addClass(this.options.hoverClass) }, _removeHoverClass: function () { this._super(), this.options.hoverClass && this.element.removeClass(this.options.hoverClass) } }), e.ui.droppable, e.widget("ui.resizable", e.ui.mouse, { version: "1.12.1", widgetEventPrefix: "resize", options: { alsoResize: !1, animate: !1, animateDuration: "slow", animateEasing: "swing", aspectRatio: !1, autoHide: !1, classes: { "ui-resizable-se": "ui-icon ui-icon-gripsmall-diagonal-se" }, containment: !1, ghost: !1, grid: !1, handles: "e,s,se", helper: !1, maxHeight: null, maxWidth: null, minHeight: 10, minWidth: 10, zIndex: 90, resize: null, start: null, stop: null }, _num: function (e) { return parseFloat(e) || 0 }, _isNumber: function (e) { return !isNaN(parseFloat(e)) }, _hasScroll: function (t, i) { if ("hidden" === e(t).css("overflow")) return !1; var s = i && "left" === i ? "scrollLeft" : "scrollTop", a = !1; return t[s] > 0 ? !0 : (t[s] = 1, a = t[s] > 0, t[s] = 0, a) }, _create: function () { var t, i = this.options, s = this; this._addClass("ui-resizable"), e.extend(this, { _aspectRatio: !!i.aspectRatio, aspectRatio: i.aspectRatio, originalElement: this.element, _proportionallyResizeElements: [], _helper: i.helper || i.ghost || i.animate ? i.helper || "ui-resizable-helper" : null }), this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i) && (this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({ position: this.element.css("position"), width: this.element.outerWidth(), height: this.element.outerHeight(), top: this.element.css("top"), left: this.element.css("left") })), this.element = this.element.parent().data("ui-resizable", this.element.resizable("instance")), this.elementIsWrapper = !0, t = { marginTop: this.originalElement.css("marginTop"), marginRight: this.originalElement.css("marginRight"), marginBottom: this.originalElement.css("marginBottom"), marginLeft: this.originalElement.css("marginLeft") }, this.element.css(t), this.originalElement.css("margin", 0), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({ position: "static", zoom: 1, display: "block" })), this.originalElement.css(t), this._proportionallyResize()), this._setupHandles(), i.autoHide && e(this.element).on("mouseenter", function () { i.disabled || (s._removeClass("ui-resizable-autohide"), s._handles.show()) }).on("mouseleave", function () { i.disabled || s.resizing || (s._addClass("ui-resizable-autohide"), s._handles.hide()) }), this._mouseInit() }, _destroy: function () { this._mouseDestroy(); var t, i = function (t) { e(t).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove() }; return this.elementIsWrapper && (i(this.element), t = this.element, this.originalElement.css({ position: t.css("position"), width: t.outerWidth(), height: t.outerHeight(), top: t.css("top"), left: t.css("left") }).insertAfter(t), t.remove()), this.originalElement.css("resize", this.originalResizeStyle), i(this.originalElement), this }, _setOption: function (e, t) { switch (this._super(e, t), e) { case "handles": this._removeHandles(), this._setupHandles(); break; default: } }, _setupHandles: function () { var t, i, s, a, n, r = this.options, o = this; if (this.handles = r.handles || (e(".ui-resizable-handle", this.element).length ? { n: ".ui-resizable-n", e: ".ui-resizable-e", s: ".ui-resizable-s", w: ".ui-resizable-w", se: ".ui-resizable-se", sw: ".ui-resizable-sw", ne: ".ui-resizable-ne", nw: ".ui-resizable-nw" } : "e,s,se"), this._handles = e(), this.handles.constructor === String) for ("all" === this.handles && (this.handles = "n,e,s,w,se,sw,ne,nw"), s = this.handles.split(","), this.handles = {}, i = 0; s.length > i; i++)t = e.trim(s[i]), a = "ui-resizable-" + t, n = e("<div>"), this._addClass(n, "ui-resizable-handle " + a), n.css({ zIndex: r.zIndex }), this.handles[t] = ".ui-resizable-" + t, this.element.append(n); this._renderAxis = function (t) { var i, s, a, n; t = t || this.element; for (i in this.handles) this.handles[i].constructor === String ? this.handles[i] = this.element.children(this.handles[i]).first().show() : (this.handles[i].jquery || this.handles[i].nodeType) && (this.handles[i] = e(this.handles[i]), this._on(this.handles[i], { mousedown: o._mouseDown })), this.elementIsWrapper && this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i) && (s = e(this.handles[i], this.element), n = /sw|ne|nw|se|n|s/.test(i) ? s.outerHeight() : s.outerWidth(), a = ["padding", /ne|nw|n/.test(i) ? "Top" : /se|sw|s/.test(i) ? "Bottom" : /^e$/.test(i) ? "Right" : "Left"].join(""), t.css(a, n), this._proportionallyResize()), this._handles = this._handles.add(this.handles[i]) }, this._renderAxis(this.element), this._handles = this._handles.add(this.element.find(".ui-resizable-handle")), this._handles.disableSelection(), this._handles.on("mouseover", function () { o.resizing || (this.className && (n = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)), o.axis = n && n[1] ? n[1] : "se") }), r.autoHide && (this._handles.hide(), this._addClass("ui-resizable-autohide")) }, _removeHandles: function () { this._handles.remove() }, _mouseCapture: function (t) { var i, s, a = !1; for (i in this.handles) s = e(this.handles[i])[0], (s === t.target || e.contains(s, t.target)) && (a = !0); return !this.options.disabled && a }, _mouseStart: function (t) { var i, s, a, n = this.options, r = this.element; return this.resizing = !0, this._renderProxy(), i = this._num(this.helper.css("left")), s = this._num(this.helper.css("top")), n.containment && (i += e(n.containment).scrollLeft() || 0, s += e(n.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = { left: i, top: s }, this.size = this._helper ? { width: this.helper.width(), height: this.helper.height() } : { width: r.width(), height: r.height() }, this.originalSize = this._helper ? { width: r.outerWidth(), height: r.outerHeight() } : { width: r.width(), height: r.height() }, this.sizeDiff = { width: r.outerWidth() - r.width(), height: r.outerHeight() - r.height() }, this.originalPosition = { left: i, top: s }, this.originalMousePosition = { left: t.pageX, top: t.pageY }, this.aspectRatio = "number" == typeof n.aspectRatio ? n.aspectRatio : this.originalSize.width / this.originalSize.height || 1, a = e(".ui-resizable-" + this.axis).css("cursor"), e("body").css("cursor", "auto" === a ? this.axis + "-resize" : a), this._addClass("ui-resizable-resizing"), this._propagate("start", t), !0 }, _mouseDrag: function (t) { var i, s, a = this.originalMousePosition, n = this.axis, r = t.pageX - a.left || 0, o = t.pageY - a.top || 0, l = this._change[n]; return this._updatePrevProperties(), l ? (i = l.apply(this, [t, r, o]), this._updateVirtualBoundaries(t.shiftKey), (this._aspectRatio || t.shiftKey) && (i = this._updateRatio(i, t)), i = this._respectSize(i, t), this._updateCache(i), this._propagate("resize", t), s = this._applyChanges(), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), e.isEmptyObject(s) || (this._updatePrevProperties(), this._trigger("resize", t, this.ui()), this._applyChanges()), !1) : !1 }, _mouseStop: function (t) { this.resizing = !1; var i, s, a, n, r, o, l, h = this.options, u = this; return this._helper && (i = this._proportionallyResizeElements, s = i.length && /textarea/i.test(i[0].nodeName), a = s && this._hasScroll(i[0], "left") ? 0 : u.sizeDiff.height, n = s ? 0 : u.sizeDiff.width, r = { width: u.helper.width() - n, height: u.helper.height() - a }, o = parseFloat(u.element.css("left")) + (u.position.left - u.originalPosition.left) || null, l = parseFloat(u.element.css("top")) + (u.position.top - u.originalPosition.top) || null, h.animate || this.element.css(e.extend(r, { top: l, left: o })), u.helper.height(u.size.height), u.helper.width(u.size.width), this._helper && !h.animate && this._proportionallyResize()), e("body").css("cursor", "auto"), this._removeClass("ui-resizable-resizing"), this._propagate("stop", t), this._helper && this.helper.remove(), !1 }, _updatePrevProperties: function () { this.prevPosition = { top: this.position.top, left: this.position.left }, this.prevSize = { width: this.size.width, height: this.size.height } }, _applyChanges: function () { var e = {}; return this.position.top !== this.prevPosition.top && (e.top = this.position.top + "px"), this.position.left !== this.prevPosition.left && (e.left = this.position.left + "px"), this.size.width !== this.prevSize.width && (e.width = this.size.width + "px"), this.size.height !== this.prevSize.height && (e.height = this.size.height + "px"), this.helper.css(e), e }, _updateVirtualBoundaries: function (e) { var t, i, s, a, n, r = this.options; n = { minWidth: this._isNumber(r.minWidth) ? r.minWidth : 0, maxWidth: this._isNumber(r.maxWidth) ? r.maxWidth : 1 / 0, minHeight: this._isNumber(r.minHeight) ? r.minHeight : 0, maxHeight: this._isNumber(r.maxHeight) ? r.maxHeight : 1 / 0 }, (this._aspectRatio || e) && (t = n.minHeight * this.aspectRatio, s = n.minWidth / this.aspectRatio, i = n.maxHeight * this.aspectRatio, a = n.maxWidth / this.aspectRatio, t > n.minWidth && (n.minWidth = t), s > n.minHeight && (n.minHeight = s), n.maxWidth > i && (n.maxWidth = i), n.maxHeight > a && (n.maxHeight = a)), this._vBoundaries = n }, _updateCache: function (e) { this.offset = this.helper.offset(), this._isNumber(e.left) && (this.position.left = e.left), this._isNumber(e.top) && (this.position.top = e.top), this._isNumber(e.height) && (this.size.height = e.height), this._isNumber(e.width) && (this.size.width = e.width) }, _updateRatio: function (e) { var t = this.position, i = this.size, s = this.axis; return this._isNumber(e.height) ? e.width = e.height * this.aspectRatio : this._isNumber(e.width) && (e.height = e.width / this.aspectRatio), "sw" === s && (e.left = t.left + (i.width - e.width), e.top = null), "nw" === s && (e.top = t.top + (i.height - e.height), e.left = t.left + (i.width - e.width)), e }, _respectSize: function (e) { var t = this._vBoundaries, i = this.axis, s = this._isNumber(e.width) && t.maxWidth && t.maxWidth < e.width, a = this._isNumber(e.height) && t.maxHeight && t.maxHeight < e.height, n = this._isNumber(e.width) && t.minWidth && t.minWidth > e.width, r = this._isNumber(e.height) && t.minHeight && t.minHeight > e.height, o = this.originalPosition.left + this.originalSize.width, l = this.originalPosition.top + this.originalSize.height, h = /sw|nw|w/.test(i), u = /nw|ne|n/.test(i); return n && (e.width = t.minWidth), r && (e.height = t.minHeight), s && (e.width = t.maxWidth), a && (e.height = t.maxHeight), n && h && (e.left = o - t.minWidth), s && h && (e.left = o - t.maxWidth), r && u && (e.top = l - t.minHeight), a && u && (e.top = l - t.maxHeight), e.width || e.height || e.left || !e.top ? e.width || e.height || e.top || !e.left || (e.left = null) : e.top = null, e }, _getPaddingPlusBorderDimensions: function (e) { for (var t = 0, i = [], s = [e.css("borderTopWidth"), e.css("borderRightWidth"), e.css("borderBottomWidth"), e.css("borderLeftWidth")], a = [e.css("paddingTop"), e.css("paddingRight"), e.css("paddingBottom"), e.css("paddingLeft")]; 4 > t; t++)i[t] = parseFloat(s[t]) || 0, i[t] += parseFloat(a[t]) || 0; return { height: i[0] + i[2], width: i[1] + i[3] } }, _proportionallyResize: function () { if (this._proportionallyResizeElements.length) for (var e, t = 0, i = this.helper || this.element; this._proportionallyResizeElements.length > t; t++)e = this._proportionallyResizeElements[t], this.outerDimensions || (this.outerDimensions = this._getPaddingPlusBorderDimensions(e)), e.css({ height: i.height() - this.outerDimensions.height || 0, width: i.width() - this.outerDimensions.width || 0 }) }, _renderProxy: function () { var t = this.element, i = this.options; this.elementOffset = t.offset(), this._helper ? (this.helper = this.helper || e("<div style='overflow:hidden;'></div>"), this._addClass(this.helper, this._helper), this.helper.css({ width: this.element.outerWidth(), height: this.element.outerHeight(), position: "absolute", left: this.elementOffset.left + "px", top: this.elementOffset.top + "px", zIndex: ++i.zIndex }), this.helper.appendTo("body").disableSelection()) : this.helper = this.element }, _change: { e: function (e, t) { return { width: this.originalSize.width + t } }, w: function (e, t) { var i = this.originalSize, s = this.originalPosition; return { left: s.left + t, width: i.width - t } }, n: function (e, t, i) { var s = this.originalSize, a = this.originalPosition; return { top: a.top + i, height: s.height - i } }, s: function (e, t, i) { return { height: this.originalSize.height + i } }, se: function (t, i, s) { return e.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [t, i, s])) }, sw: function (t, i, s) { return e.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [t, i, s])) }, ne: function (t, i, s) { return e.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [t, i, s])) }, nw: function (t, i, s) { return e.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [t, i, s])) } }, _propagate: function (t, i) { e.ui.plugin.call(this, t, [i, this.ui()]), "resize" !== t && this._trigger(t, i, this.ui()) }, plugins: {}, ui: function () { return { originalElement: this.originalElement, element: this.element, helper: this.helper, position: this.position, size: this.size, originalSize: this.originalSize, originalPosition: this.originalPosition } } }), e.ui.plugin.add("resizable", "animate", { stop: function (t) { var i = e(this).resizable("instance"), s = i.options, a = i._proportionallyResizeElements, n = a.length && /textarea/i.test(a[0].nodeName), r = n && i._hasScroll(a[0], "left") ? 0 : i.sizeDiff.height, o = n ? 0 : i.sizeDiff.width, l = { width: i.size.width - o, height: i.size.height - r }, h = parseFloat(i.element.css("left")) + (i.position.left - i.originalPosition.left) || null, u = parseFloat(i.element.css("top")) + (i.position.top - i.originalPosition.top) || null; i.element.animate(e.extend(l, u && h ? { top: u, left: h } : {}), { duration: s.animateDuration, easing: s.animateEasing, step: function () { var s = { width: parseFloat(i.element.css("width")), height: parseFloat(i.element.css("height")), top: parseFloat(i.element.css("top")), left: parseFloat(i.element.css("left")) }; a && a.length && e(a[0]).css({ width: s.width, height: s.height }), i._updateCache(s), i._propagate("resize", t) } }) } }), e.ui.plugin.add("resizable", "containment", { start: function () { var t, i, s, a, n, r, o, l = e(this).resizable("instance"), h = l.options, u = l.element, d = h.containment, c = d instanceof e ? d.get(0) : /parent/.test(d) ? u.parent().get(0) : d; c && (l.containerElement = e(c), /document/.test(d) || d === document ? (l.containerOffset = { left: 0, top: 0 }, l.containerPosition = { left: 0, top: 0 }, l.parentData = { element: e(document), left: 0, top: 0, width: e(document).width(), height: e(document).height() || document.body.parentNode.scrollHeight }) : (t = e(c), i = [], e(["Top", "Right", "Left", "Bottom"]).each(function (e, s) { i[e] = l._num(t.css("padding" + s)) }), l.containerOffset = t.offset(), l.containerPosition = t.position(), l.containerSize = { height: t.innerHeight() - i[3], width: t.innerWidth() - i[1] }, s = l.containerOffset, a = l.containerSize.height, n = l.containerSize.width, r = l._hasScroll(c, "left") ? c.scrollWidth : n, o = l._hasScroll(c) ? c.scrollHeight : a, l.parentData = { element: c, left: s.left, top: s.top, width: r, height: o })) }, resize: function (t) { var i, s, a, n, r = e(this).resizable("instance"), o = r.options, l = r.containerOffset, h = r.position, u = r._aspectRatio || t.shiftKey, d = { top: 0, left: 0 }, c = r.containerElement, p = !0; c[0] !== document && /static/.test(c.css("position")) && (d = l), h.left < (r._helper ? l.left : 0) && (r.size.width = r.size.width + (r._helper ? r.position.left - l.left : r.position.left - d.left), u && (r.size.height = r.size.width / r.aspectRatio, p = !1), r.position.left = o.helper ? l.left : 0), h.top < (r._helper ? l.top : 0) && (r.size.height = r.size.height + (r._helper ? r.position.top - l.top : r.position.top), u && (r.size.width = r.size.height * r.aspectRatio, p = !1), r.position.top = r._helper ? l.top : 0), a = r.containerElement.get(0) === r.element.parent().get(0), n = /relative|absolute/.test(r.containerElement.css("position")), a && n ? (r.offset.left = r.parentData.left + r.position.left, r.offset.top = r.parentData.top + r.position.top) : (r.offset.left = r.element.offset().left, r.offset.top = r.element.offset().top), i = Math.abs(r.sizeDiff.width + (r._helper ? r.offset.left - d.left : r.offset.left - l.left)), s = Math.abs(r.sizeDiff.height + (r._helper ? r.offset.top - d.top : r.offset.top - l.top)), i + r.size.width >= r.parentData.width && (r.size.width = r.parentData.width - i, u && (r.size.height = r.size.width / r.aspectRatio, p = !1)), s + r.size.height >= r.parentData.height && (r.size.height = r.parentData.height - s, u && (r.size.width = r.size.height * r.aspectRatio, p = !1)), p || (r.position.left = r.prevPosition.left, r.position.top = r.prevPosition.top, r.size.width = r.prevSize.width, r.size.height = r.prevSize.height) }, stop: function () { var t = e(this).resizable("instance"), i = t.options, s = t.containerOffset, a = t.containerPosition, n = t.containerElement, r = e(t.helper), o = r.offset(), l = r.outerWidth() - t.sizeDiff.width, h = r.outerHeight() - t.sizeDiff.height; t._helper && !i.animate && /relative/.test(n.css("position")) && e(this).css({ left: o.left - a.left - s.left, width: l, height: h }), t._helper && !i.animate && /static/.test(n.css("position")) && e(this).css({ left: o.left - a.left - s.left, width: l, height: h }) } }), e.ui.plugin.add("resizable", "alsoResize", {
                start: function () { var t = e(this).resizable("instance"), i = t.options; e(i.alsoResize).each(function () { var t = e(this); t.data("ui-resizable-alsoresize", { width: parseFloat(t.width()), height: parseFloat(t.height()), left: parseFloat(t.css("left")), top: parseFloat(t.css("top")) }) }) }, resize: function (t, i) {
                    var s = e(this).resizable("instance"), a = s.options, n = s.originalSize, r = s.originalPosition, o = { height: s.size.height - n.height || 0, width: s.size.width - n.width || 0, top: s.position.top - r.top || 0, left: s.position.left - r.left || 0 };
                    e(a.alsoResize).each(function () { var t = e(this), s = e(this).data("ui-resizable-alsoresize"), a = {}, n = t.parents(i.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"]; e.each(n, function (e, t) { var i = (s[t] || 0) + (o[t] || 0); i && i >= 0 && (a[t] = i || null) }), t.css(a) })
                }, stop: function () { e(this).removeData("ui-resizable-alsoresize") }
            }), e.ui.plugin.add("resizable", "ghost", { start: function () { var t = e(this).resizable("instance"), i = t.size; t.ghost = t.originalElement.clone(), t.ghost.css({ opacity: .25, display: "block", position: "relative", height: i.height, width: i.width, margin: 0, left: 0, top: 0 }), t._addClass(t.ghost, "ui-resizable-ghost"), e.uiBackCompat !== !1 && "string" == typeof t.options.ghost && t.ghost.addClass(this.options.ghost), t.ghost.appendTo(t.helper) }, resize: function () { var t = e(this).resizable("instance"); t.ghost && t.ghost.css({ position: "relative", height: t.size.height, width: t.size.width }) }, stop: function () { var t = e(this).resizable("instance"); t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0)) } }), e.ui.plugin.add("resizable", "grid", { resize: function () { var t, i = e(this).resizable("instance"), s = i.options, a = i.size, n = i.originalSize, r = i.originalPosition, o = i.axis, l = "number" == typeof s.grid ? [s.grid, s.grid] : s.grid, h = l[0] || 1, u = l[1] || 1, d = Math.round((a.width - n.width) / h) * h, c = Math.round((a.height - n.height) / u) * u, p = n.width + d, m = n.height + c, f = s.maxWidth && p > s.maxWidth, g = s.maxHeight && m > s.maxHeight, v = s.minWidth && s.minWidth > p, y = s.minHeight && s.minHeight > m; s.grid = l, v && (p += h), y && (m += u), f && (p -= h), g && (m -= u), /^(se|s|e)$/.test(o) ? (i.size.width = p, i.size.height = m) : /^(ne)$/.test(o) ? (i.size.width = p, i.size.height = m, i.position.top = r.top - c) : /^(sw)$/.test(o) ? (i.size.width = p, i.size.height = m, i.position.left = r.left - d) : ((0 >= m - u || 0 >= p - h) && (t = i._getPaddingPlusBorderDimensions(this)), m - u > 0 ? (i.size.height = m, i.position.top = r.top - c) : (m = u - t.height, i.size.height = m, i.position.top = r.top + n.height - m), p - h > 0 ? (i.size.width = p, i.position.left = r.left - d) : (p = h - t.width, i.size.width = p, i.position.left = r.left + n.width - p)) } }), e.ui.resizable, e.widget("ui.selectable", e.ui.mouse, { version: "1.12.1", options: { appendTo: "body", autoRefresh: !0, distance: 0, filter: "*", tolerance: "touch", selected: null, selecting: null, start: null, stop: null, unselected: null, unselecting: null }, _create: function () { var t = this; this._addClass("ui-selectable"), this.dragged = !1, this.refresh = function () { t.elementPos = e(t.element[0]).offset(), t.selectees = e(t.options.filter, t.element[0]), t._addClass(t.selectees, "ui-selectee"), t.selectees.each(function () { var i = e(this), s = i.offset(), a = { left: s.left - t.elementPos.left, top: s.top - t.elementPos.top }; e.data(this, "selectable-item", { element: this, $element: i, left: a.left, top: a.top, right: a.left + i.outerWidth(), bottom: a.top + i.outerHeight(), startselected: !1, selected: i.hasClass("ui-selected"), selecting: i.hasClass("ui-selecting"), unselecting: i.hasClass("ui-unselecting") }) }) }, this.refresh(), this._mouseInit(), this.helper = e("<div>"), this._addClass(this.helper, "ui-selectable-helper") }, _destroy: function () { this.selectees.removeData("selectable-item"), this._mouseDestroy() }, _mouseStart: function (t) { var i = this, s = this.options; this.opos = [t.pageX, t.pageY], this.elementPos = e(this.element[0]).offset(), this.options.disabled || (this.selectees = e(s.filter, this.element[0]), this._trigger("start", t), e(s.appendTo).append(this.helper), this.helper.css({ left: t.pageX, top: t.pageY, width: 0, height: 0 }), s.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function () { var s = e.data(this, "selectable-item"); s.startselected = !0, t.metaKey || t.ctrlKey || (i._removeClass(s.$element, "ui-selected"), s.selected = !1, i._addClass(s.$element, "ui-unselecting"), s.unselecting = !0, i._trigger("unselecting", t, { unselecting: s.element })) }), e(t.target).parents().addBack().each(function () { var s, a = e.data(this, "selectable-item"); return a ? (s = !t.metaKey && !t.ctrlKey || !a.$element.hasClass("ui-selected"), i._removeClass(a.$element, s ? "ui-unselecting" : "ui-selected")._addClass(a.$element, s ? "ui-selecting" : "ui-unselecting"), a.unselecting = !s, a.selecting = s, a.selected = s, s ? i._trigger("selecting", t, { selecting: a.element }) : i._trigger("unselecting", t, { unselecting: a.element }), !1) : void 0 })) }, _mouseDrag: function (t) { if (this.dragged = !0, !this.options.disabled) { var i, s = this, a = this.options, n = this.opos[0], r = this.opos[1], o = t.pageX, l = t.pageY; return n > o && (i = o, o = n, n = i), r > l && (i = l, l = r, r = i), this.helper.css({ left: n, top: r, width: o - n, height: l - r }), this.selectees.each(function () { var i = e.data(this, "selectable-item"), h = !1, u = {}; i && i.element !== s.element[0] && (u.left = i.left + s.elementPos.left, u.right = i.right + s.elementPos.left, u.top = i.top + s.elementPos.top, u.bottom = i.bottom + s.elementPos.top, "touch" === a.tolerance ? h = !(u.left > o || n > u.right || u.top > l || r > u.bottom) : "fit" === a.tolerance && (h = u.left > n && o > u.right && u.top > r && l > u.bottom), h ? (i.selected && (s._removeClass(i.$element, "ui-selected"), i.selected = !1), i.unselecting && (s._removeClass(i.$element, "ui-unselecting"), i.unselecting = !1), i.selecting || (s._addClass(i.$element, "ui-selecting"), i.selecting = !0, s._trigger("selecting", t, { selecting: i.element }))) : (i.selecting && ((t.metaKey || t.ctrlKey) && i.startselected ? (s._removeClass(i.$element, "ui-selecting"), i.selecting = !1, s._addClass(i.$element, "ui-selected"), i.selected = !0) : (s._removeClass(i.$element, "ui-selecting"), i.selecting = !1, i.startselected && (s._addClass(i.$element, "ui-unselecting"), i.unselecting = !0), s._trigger("unselecting", t, { unselecting: i.element }))), i.selected && (t.metaKey || t.ctrlKey || i.startselected || (s._removeClass(i.$element, "ui-selected"), i.selected = !1, s._addClass(i.$element, "ui-unselecting"), i.unselecting = !0, s._trigger("unselecting", t, { unselecting: i.element }))))) }), !1 } }, _mouseStop: function (t) { var i = this; return this.dragged = !1, e(".ui-unselecting", this.element[0]).each(function () { var s = e.data(this, "selectable-item"); i._removeClass(s.$element, "ui-unselecting"), s.unselecting = !1, s.startselected = !1, i._trigger("unselected", t, { unselected: s.element }) }), e(".ui-selecting", this.element[0]).each(function () { var s = e.data(this, "selectable-item"); i._removeClass(s.$element, "ui-selecting")._addClass(s.$element, "ui-selected"), s.selecting = !1, s.selected = !0, s.startselected = !0, i._trigger("selected", t, { selected: s.element }) }), this._trigger("stop", t), this.helper.remove(), !1 } }), e.widget("ui.sortable", e.ui.mouse, { version: "1.12.1", widgetEventPrefix: "sort", ready: !1, options: { appendTo: "parent", axis: !1, connectWith: !1, containment: !1, cursor: "auto", cursorAt: !1, dropOnEmpty: !0, forcePlaceholderSize: !1, forceHelperSize: !1, grid: !1, handle: !1, helper: "original", items: "> *", opacity: !1, placeholder: !1, revert: !1, scroll: !0, scrollSensitivity: 20, scrollSpeed: 20, scope: "default", tolerance: "intersect", zIndex: 1e3, activate: null, beforeStop: null, change: null, deactivate: null, out: null, over: null, receive: null, remove: null, sort: null, start: null, stop: null, update: null }, _isOverAxis: function (e, t, i) { return e >= t && t + i > e }, _isFloating: function (e) { return /left|right/.test(e.css("float")) || /inline|table-cell/.test(e.css("display")) }, _create: function () { this.containerCache = {}, this._addClass("ui-sortable"), this.refresh(), this.offset = this.element.offset(), this._mouseInit(), this._setHandleClassName(), this.ready = !0 }, _setOption: function (e, t) { this._super(e, t), "handle" === e && this._setHandleClassName() }, _setHandleClassName: function () { var t = this; this._removeClass(this.element.find(".ui-sortable-handle"), "ui-sortable-handle"), e.each(this.items, function () { t._addClass(this.instance.options.handle ? this.item.find(this.instance.options.handle) : this.item, "ui-sortable-handle") }) }, _destroy: function () { this._mouseDestroy(); for (var e = this.items.length - 1; e >= 0; e--)this.items[e].item.removeData(this.widgetName + "-item"); return this }, _mouseCapture: function (t, i) { var s = null, a = !1, n = this; return this.reverting ? !1 : this.options.disabled || "static" === this.options.type ? !1 : (this._refreshItems(t), e(t.target).parents().each(function () { return e.data(this, n.widgetName + "-item") === n ? (s = e(this), !1) : void 0 }), e.data(t.target, n.widgetName + "-item") === n && (s = e(t.target)), s ? !this.options.handle || i || (e(this.options.handle, s).find("*").addBack().each(function () { this === t.target && (a = !0) }), a) ? (this.currentItem = s, this._removeCurrentsFromItems(), !0) : !1 : !1) }, _mouseStart: function (t, i, s) { var a, n, r = this.options; if (this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = { top: this.offset.top - this.margins.top, left: this.offset.left - this.margins.left }, e.extend(this.offset, { click: { left: t.pageX - this.offset.left, top: t.pageY - this.offset.top }, parent: this._getParentOffset(), relative: this._getRelativeOffset() }), this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, r.cursorAt && this._adjustOffsetFromHelper(r.cursorAt), this.domPosition = { prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0] }, this.helper[0] !== this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), r.containment && this._setContainment(), r.cursor && "auto" !== r.cursor && (n = this.document.find("body"), this.storedCursor = n.css("cursor"), n.css("cursor", r.cursor), this.storedStylesheet = e("<style>*{ cursor: " + r.cursor + " !important; }</style>").appendTo(n)), r.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", r.opacity)), r.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", r.zIndex)), this.scrollParent[0] !== this.document[0] && "HTML" !== this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), !s) for (a = this.containers.length - 1; a >= 0; a--)this.containers[a]._trigger("activate", t, this._uiHash(this)); return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !r.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this._addClass(this.helper, "ui-sortable-helper"), this._mouseDrag(t), !0 }, _mouseDrag: function (t) { var i, s, a, n, r = this.options, o = !1; for (this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (this.scrollParent[0] !== this.document[0] && "HTML" !== this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < r.scrollSensitivity ? this.scrollParent[0].scrollTop = o = this.scrollParent[0].scrollTop + r.scrollSpeed : t.pageY - this.overflowOffset.top < r.scrollSensitivity && (this.scrollParent[0].scrollTop = o = this.scrollParent[0].scrollTop - r.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < r.scrollSensitivity ? this.scrollParent[0].scrollLeft = o = this.scrollParent[0].scrollLeft + r.scrollSpeed : t.pageX - this.overflowOffset.left < r.scrollSensitivity && (this.scrollParent[0].scrollLeft = o = this.scrollParent[0].scrollLeft - r.scrollSpeed)) : (t.pageY - this.document.scrollTop() < r.scrollSensitivity ? o = this.document.scrollTop(this.document.scrollTop() - r.scrollSpeed) : this.window.height() - (t.pageY - this.document.scrollTop()) < r.scrollSensitivity && (o = this.document.scrollTop(this.document.scrollTop() + r.scrollSpeed)), t.pageX - this.document.scrollLeft() < r.scrollSensitivity ? o = this.document.scrollLeft(this.document.scrollLeft() - r.scrollSpeed) : this.window.width() - (t.pageX - this.document.scrollLeft()) < r.scrollSensitivity && (o = this.document.scrollLeft(this.document.scrollLeft() + r.scrollSpeed))), o !== !1 && e.ui.ddmanager && !r.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px"), i = this.items.length - 1; i >= 0; i--)if (s = this.items[i], a = s.item[0], n = this._intersectsWithPointer(s), n && s.instance === this.currentContainer && a !== this.currentItem[0] && this.placeholder[1 === n ? "next" : "prev"]()[0] !== a && !e.contains(this.placeholder[0], a) && ("semi-dynamic" === this.options.type ? !e.contains(this.element[0], a) : !0)) { if (this.direction = 1 === n ? "down" : "up", "pointer" !== this.options.tolerance && !this._intersectsWithSides(s)) break; this._rearrange(t, s), this._trigger("change", t, this._uiHash()); break } return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1 }, _mouseStop: function (t, i) { if (t) { if (e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t), this.options.revert) { var s = this, a = this.placeholder.offset(), n = this.options.axis, r = {}; n && "x" !== n || (r.left = a.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollLeft)), n && "y" !== n || (r.top = a.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollTop)), this.reverting = !0, e(this.helper).animate(r, parseInt(this.options.revert, 10) || 500, function () { s._clear(t) }) } else this._clear(t, i); return !1 } }, cancel: function () { if (this.dragging) { this._mouseUp(new e.Event("mouseup", { target: null })), "original" === this.options.helper ? (this.currentItem.css(this._storedCSS), this._removeClass(this.currentItem, "ui-sortable-helper")) : this.currentItem.show(); for (var t = this.containers.length - 1; t >= 0; t--)this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0) } return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" !== this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, { helper: null, dragging: !1, reverting: !1, _noFinalSort: null }), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this }, serialize: function (t) { var i = this._getItemsAsjQuery(t && t.connected), s = []; return t = t || {}, e(i).each(function () { var i = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[\-=_](.+)/); i && s.push((t.key || i[1] + "[]") + "=" + (t.key && t.expression ? i[1] : i[2])) }), !s.length && t.key && s.push(t.key + "="), s.join("&") }, toArray: function (t) { var i = this._getItemsAsjQuery(t && t.connected), s = []; return t = t || {}, i.each(function () { s.push(e(t.item || this).attr(t.attribute || "id") || "") }), s }, _intersectsWith: function (e) { var t = this.positionAbs.left, i = t + this.helperProportions.width, s = this.positionAbs.top, a = s + this.helperProportions.height, n = e.left, r = n + e.width, o = e.top, l = o + e.height, h = this.offset.click.top, u = this.offset.click.left, d = "x" === this.options.axis || s + h > o && l > s + h, c = "y" === this.options.axis || t + u > n && r > t + u, p = d && c; return "pointer" === this.options.tolerance || this.options.forcePointerForContainers || "pointer" !== this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? p : t + this.helperProportions.width / 2 > n && r > i - this.helperProportions.width / 2 && s + this.helperProportions.height / 2 > o && l > a - this.helperProportions.height / 2 }, _intersectsWithPointer: function (e) { var t, i, s = "x" === this.options.axis || this._isOverAxis(this.positionAbs.top + this.offset.click.top, e.top, e.height), a = "y" === this.options.axis || this._isOverAxis(this.positionAbs.left + this.offset.click.left, e.left, e.width), n = s && a; return n ? (t = this._getDragVerticalDirection(), i = this._getDragHorizontalDirection(), this.floating ? "right" === i || "down" === t ? 2 : 1 : t && ("down" === t ? 2 : 1)) : !1 }, _intersectsWithSides: function (e) { var t = this._isOverAxis(this.positionAbs.top + this.offset.click.top, e.top + e.height / 2, e.height), i = this._isOverAxis(this.positionAbs.left + this.offset.click.left, e.left + e.width / 2, e.width), s = this._getDragVerticalDirection(), a = this._getDragHorizontalDirection(); return this.floating && a ? "right" === a && i || "left" === a && !i : s && ("down" === s && t || "up" === s && !t) }, _getDragVerticalDirection: function () { var e = this.positionAbs.top - this.lastPositionAbs.top; return 0 !== e && (e > 0 ? "down" : "up") }, _getDragHorizontalDirection: function () { var e = this.positionAbs.left - this.lastPositionAbs.left; return 0 !== e && (e > 0 ? "right" : "left") }, refresh: function (e) { return this._refreshItems(e), this._setHandleClassName(), this.refreshPositions(), this }, _connectWith: function () { var e = this.options; return e.connectWith.constructor === String ? [e.connectWith] : e.connectWith }, _getItemsAsjQuery: function (t) { function i() { o.push(this) } var s, a, n, r, o = [], l = [], h = this._connectWith(); if (h && t) for (s = h.length - 1; s >= 0; s--)for (n = e(h[s], this.document[0]), a = n.length - 1; a >= 0; a--)r = e.data(n[a], this.widgetFullName), r && r !== this && !r.options.disabled && l.push([e.isFunction(r.options.items) ? r.options.items.call(r.element) : e(r.options.items, r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), r]); for (l.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, { options: this.options, item: this.currentItem }) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]), s = l.length - 1; s >= 0; s--)l[s][0].each(i); return e(o) }, _removeCurrentsFromItems: function () { var t = this.currentItem.find(":data(" + this.widgetName + "-item)"); this.items = e.grep(this.items, function (e) { for (var i = 0; t.length > i; i++)if (t[i] === e.item[0]) return !1; return !0 }) }, _refreshItems: function (t) { this.items = [], this.containers = [this]; var i, s, a, n, r, o, l, h, u = this.items, d = [[e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, { item: this.currentItem }) : e(this.options.items, this.element), this]], c = this._connectWith(); if (c && this.ready) for (i = c.length - 1; i >= 0; i--)for (a = e(c[i], this.document[0]), s = a.length - 1; s >= 0; s--)n = e.data(a[s], this.widgetFullName), n && n !== this && !n.options.disabled && (d.push([e.isFunction(n.options.items) ? n.options.items.call(n.element[0], t, { item: this.currentItem }) : e(n.options.items, n.element), n]), this.containers.push(n)); for (i = d.length - 1; i >= 0; i--)for (r = d[i][1], o = d[i][0], s = 0, h = o.length; h > s; s++)l = e(o[s]), l.data(this.widgetName + "-item", r), u.push({ item: l, instance: r, width: 0, height: 0, left: 0, top: 0 }) }, refreshPositions: function (t) { this.floating = this.items.length ? "x" === this.options.axis || this._isFloating(this.items[0].item) : !1, this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset()); var i, s, a, n; for (i = this.items.length - 1; i >= 0; i--)s = this.items[i], s.instance !== this.currentContainer && this.currentContainer && s.item[0] !== this.currentItem[0] || (a = this.options.toleranceElement ? e(this.options.toleranceElement, s.item) : s.item, t || (s.width = a.outerWidth(), s.height = a.outerHeight()), n = a.offset(), s.left = n.left, s.top = n.top); if (this.options.custom && this.options.custom.refreshContainers) this.options.custom.refreshContainers.call(this); else for (i = this.containers.length - 1; i >= 0; i--)n = this.containers[i].element.offset(), this.containers[i].containerCache.left = n.left, this.containers[i].containerCache.top = n.top, this.containers[i].containerCache.width = this.containers[i].element.outerWidth(), this.containers[i].containerCache.height = this.containers[i].element.outerHeight(); return this }, _createPlaceholder: function (t) { t = t || this; var i, s = t.options; s.placeholder && s.placeholder.constructor !== String || (i = s.placeholder, s.placeholder = { element: function () { var s = t.currentItem[0].nodeName.toLowerCase(), a = e("<" + s + ">", t.document[0]); return t._addClass(a, "ui-sortable-placeholder", i || t.currentItem[0].className)._removeClass(a, "ui-sortable-helper"), "tbody" === s ? t._createTrPlaceholder(t.currentItem.find("tr").eq(0), e("<tr>", t.document[0]).appendTo(a)) : "tr" === s ? t._createTrPlaceholder(t.currentItem, a) : "img" === s && a.attr("src", t.currentItem.attr("src")), i || a.css("visibility", "hidden"), a }, update: function (e, a) { (!i || s.forcePlaceholderSize) && (a.height() || a.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), a.width() || a.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10))) } }), t.placeholder = e(s.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), s.placeholder.update(t, t.placeholder) }, _createTrPlaceholder: function (t, i) { var s = this; t.children().each(function () { e("<td>&#160;</td>", s.document[0]).attr("colspan", e(this).attr("colspan") || 1).appendTo(i) }) }, _contactContainers: function (t) { var i, s, a, n, r, o, l, h, u, d, c = null, p = null; for (i = this.containers.length - 1; i >= 0; i--)if (!e.contains(this.currentItem[0], this.containers[i].element[0])) if (this._intersectsWith(this.containers[i].containerCache)) { if (c && e.contains(this.containers[i].element[0], c.element[0])) continue; c = this.containers[i], p = i } else this.containers[i].containerCache.over && (this.containers[i]._trigger("out", t, this._uiHash(this)), this.containers[i].containerCache.over = 0); if (c) if (1 === this.containers.length) this.containers[p].containerCache.over || (this.containers[p]._trigger("over", t, this._uiHash(this)), this.containers[p].containerCache.over = 1); else { for (a = 1e4, n = null, u = c.floating || this._isFloating(this.currentItem), r = u ? "left" : "top", o = u ? "width" : "height", d = u ? "pageX" : "pageY", s = this.items.length - 1; s >= 0; s--)e.contains(this.containers[p].element[0], this.items[s].item[0]) && this.items[s].item[0] !== this.currentItem[0] && (l = this.items[s].item.offset()[r], h = !1, t[d] - l > this.items[s][o] / 2 && (h = !0), a > Math.abs(t[d] - l) && (a = Math.abs(t[d] - l), n = this.items[s], this.direction = h ? "up" : "down")); if (!n && !this.options.dropOnEmpty) return; if (this.currentContainer === this.containers[p]) return this.currentContainer.containerCache.over || (this.containers[p]._trigger("over", t, this._uiHash()), this.currentContainer.containerCache.over = 1), void 0; n ? this._rearrange(t, n, null, !0) : this._rearrange(t, null, this.containers[p].element, !0), this._trigger("change", t, this._uiHash()), this.containers[p]._trigger("change", t, this._uiHash(this)), this.currentContainer = this.containers[p], this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[p]._trigger("over", t, this._uiHash(this)), this.containers[p].containerCache.over = 1 } }, _createHelper: function (t) { var i = this.options, s = e.isFunction(i.helper) ? e(i.helper.apply(this.element[0], [t, this.currentItem])) : "clone" === i.helper ? this.currentItem.clone() : this.currentItem; return s.parents("body").length || e("parent" !== i.appendTo ? i.appendTo : this.currentItem[0].parentNode)[0].appendChild(s[0]), s[0] === this.currentItem[0] && (this._storedCSS = { width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css("position"), top: this.currentItem.css("top"), left: this.currentItem.css("left") }), (!s[0].style.width || i.forceHelperSize) && s.width(this.currentItem.width()), (!s[0].style.height || i.forceHelperSize) && s.height(this.currentItem.height()), s }, _adjustOffsetFromHelper: function (t) { "string" == typeof t && (t = t.split(" ")), e.isArray(t) && (t = { left: +t[0], top: +t[1] || 0 }), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top) }, _getParentOffset: function () { this.offsetParent = this.helper.offsetParent(); var t = this.offsetParent.offset(); return "absolute" === this.cssPosition && this.scrollParent[0] !== this.document[0] && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), (this.offsetParent[0] === this.document[0].body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && e.ui.ie) && (t = { top: 0, left: 0 }), { top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0) } }, _getRelativeOffset: function () { if ("relative" === this.cssPosition) { var e = this.currentItem.position(); return { top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft() } } return { top: 0, left: 0 } }, _cacheMargins: function () { this.margins = { left: parseInt(this.currentItem.css("marginLeft"), 10) || 0, top: parseInt(this.currentItem.css("marginTop"), 10) || 0 } }, _cacheHelperProportions: function () { this.helperProportions = { width: this.helper.outerWidth(), height: this.helper.outerHeight() } }, _setContainment: function () { var t, i, s, a = this.options; "parent" === a.containment && (a.containment = this.helper[0].parentNode), ("document" === a.containment || "window" === a.containment) && (this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, "document" === a.containment ? this.document.width() : this.window.width() - this.helperProportions.width - this.margins.left, ("document" === a.containment ? this.document.height() || document.body.parentNode.scrollHeight : this.window.height() || this.document[0].body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]), /^(document|window|parent)$/.test(a.containment) || (t = e(a.containment)[0], i = e(a.containment).offset(), s = "hidden" !== e(t).css("overflow"), this.containment = [i.left + (parseInt(e(t).css("borderLeftWidth"), 10) || 0) + (parseInt(e(t).css("paddingLeft"), 10) || 0) - this.margins.left, i.top + (parseInt(e(t).css("borderTopWidth"), 10) || 0) + (parseInt(e(t).css("paddingTop"), 10) || 0) - this.margins.top, i.left + (s ? Math.max(t.scrollWidth, t.offsetWidth) : t.offsetWidth) - (parseInt(e(t).css("borderLeftWidth"), 10) || 0) - (parseInt(e(t).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, i.top + (s ? Math.max(t.scrollHeight, t.offsetHeight) : t.offsetHeight) - (parseInt(e(t).css("borderTopWidth"), 10) || 0) - (parseInt(e(t).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]) }, _convertPositionTo: function (t, i) { i || (i = this.position); var s = "absolute" === t ? 1 : -1, a = "absolute" !== this.cssPosition || this.scrollParent[0] !== this.document[0] && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, n = /(html|body)/i.test(a[0].tagName); return { top: i.top + this.offset.relative.top * s + this.offset.parent.top * s - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : n ? 0 : a.scrollTop()) * s, left: i.left + this.offset.relative.left * s + this.offset.parent.left * s - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : n ? 0 : a.scrollLeft()) * s } }, _generatePosition: function (t) { var i, s, a = this.options, n = t.pageX, r = t.pageY, o = "absolute" !== this.cssPosition || this.scrollParent[0] !== this.document[0] && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, l = /(html|body)/i.test(o[0].tagName); return "relative" !== this.cssPosition || this.scrollParent[0] !== this.document[0] && this.scrollParent[0] !== this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset()), this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (n = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (r = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (n = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (r = this.containment[3] + this.offset.click.top)), a.grid && (i = this.originalPageY + Math.round((r - this.originalPageY) / a.grid[1]) * a.grid[1], r = this.containment ? i - this.offset.click.top >= this.containment[1] && i - this.offset.click.top <= this.containment[3] ? i : i - this.offset.click.top >= this.containment[1] ? i - a.grid[1] : i + a.grid[1] : i, s = this.originalPageX + Math.round((n - this.originalPageX) / a.grid[0]) * a.grid[0], n = this.containment ? s - this.offset.click.left >= this.containment[0] && s - this.offset.click.left <= this.containment[2] ? s : s - this.offset.click.left >= this.containment[0] ? s - a.grid[0] : s + a.grid[0] : s)), { top: r - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : l ? 0 : o.scrollTop()), left: n - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : l ? 0 : o.scrollLeft()) } }, _rearrange: function (e, t, i, s) { i ? i[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], "down" === this.direction ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1; var a = this.counter; this._delay(function () { a === this.counter && this.refreshPositions(!s) }) }, _clear: function (e, t) { function i(e, t, i) { return function (s) { i._trigger(e, s, t._uiHash(t)) } } this.reverting = !1; var s, a = []; if (!this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null, this.helper[0] === this.currentItem[0]) { for (s in this._storedCSS) ("auto" === this._storedCSS[s] || "static" === this._storedCSS[s]) && (this._storedCSS[s] = ""); this.currentItem.css(this._storedCSS), this._removeClass(this.currentItem, "ui-sortable-helper") } else this.currentItem.show(); for (this.fromOutside && !t && a.push(function (e) { this._trigger("receive", e, this._uiHash(this.fromOutside)) }), !this.fromOutside && this.domPosition.prev === this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent === this.currentItem.parent()[0] || t || a.push(function (e) { this._trigger("update", e, this._uiHash()) }), this !== this.currentContainer && (t || (a.push(function (e) { this._trigger("remove", e, this._uiHash()) }), a.push(function (e) { return function (t) { e._trigger("receive", t, this._uiHash(this)) } }.call(this, this.currentContainer)), a.push(function (e) { return function (t) { e._trigger("update", t, this._uiHash(this)) } }.call(this, this.currentContainer)))), s = this.containers.length - 1; s >= 0; s--)t || a.push(i("deactivate", this, this.containers[s])), this.containers[s].containerCache.over && (a.push(i("out", this, this.containers[s])), this.containers[s].containerCache.over = 0); if (this.storedCursor && (this.document.find("body").css("cursor", this.storedCursor), this.storedStylesheet.remove()), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", "auto" === this._storedZIndex ? "" : this._storedZIndex), this.dragging = !1, t || this._trigger("beforeStop", e, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.cancelHelperRemoval || (this.helper[0] !== this.currentItem[0] && this.helper.remove(), this.helper = null), !t) { for (s = 0; a.length > s; s++)a[s].call(this, e); this._trigger("stop", e, this._uiHash()) } return this.fromOutside = !1, !this.cancelHelperRemoval }, _trigger: function () { e.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel() }, _uiHash: function (t) { var i = t || this; return { helper: i.helper, placeholder: i.placeholder || e([]), position: i.position, originalPosition: i.originalPosition, offset: i.positionAbs, item: i.currentItem, sender: t ? t.element : null } } }), e.widget("ui.accordion", {
                version: "1.12.1", options: { active: 0, animate: {}, classes: { "ui-accordion-header": "ui-corner-top", "ui-accordion-header-collapsed": "ui-corner-all", "ui-accordion-content": "ui-corner-bottom" }, collapsible: !1, event: "click", header: "> li > :first-child, > :not(li):even", heightStyle: "auto", icons: { activeHeader: "ui-icon-triangle-1-s", header: "ui-icon-triangle-1-e" }, activate: null, beforeActivate: null }, hideProps: { borderTopWidth: "hide", borderBottomWidth: "hide", paddingTop: "hide", paddingBottom: "hide", height: "hide" }, showProps: { borderTopWidth: "show", borderBottomWidth: "show", paddingTop: "show", paddingBottom: "show", height: "show" }, _create: function () { var t = this.options; this.prevShow = this.prevHide = e(), this._addClass("ui-accordion", "ui-widget ui-helper-reset"), this.element.attr("role", "tablist"), t.collapsible || t.active !== !1 && null != t.active || (t.active = 0), this._processPanels(), 0 > t.active && (t.active += this.headers.length), this._refresh() }, _getCreateEventData: function () { return { header: this.active, panel: this.active.length ? this.active.next() : e() } }, _createIcons: function () {
                    var t, i, s = this.options.icons; s && (t = e("<span>"), this._addClass(t, "ui-accordion-header-icon", "ui-icon " + s.header), t.prependTo(this.headers), i = this.active.children(".ui-accordion-header-icon"), this._removeClass(i, s.header)._addClass(i, null, s.activeHeader)._addClass(this.headers, "ui-accordion-icons"))
                }, _destroyIcons: function () { this._removeClass(this.headers, "ui-accordion-icons"), this.headers.children(".ui-accordion-header-icon").remove() }, _destroy: function () { var e; this.element.removeAttr("role"), this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(), this._destroyIcons(), e = this.headers.next().css("display", "").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(), "content" !== this.options.heightStyle && e.css("height", "") }, _setOption: function (e, t) { return "active" === e ? (this._activate(t), void 0) : ("event" === e && (this.options.event && this._off(this.headers, this.options.event), this._setupEvents(t)), this._super(e, t), "collapsible" !== e || t || this.options.active !== !1 || this._activate(0), "icons" === e && (this._destroyIcons(), t && this._createIcons()), void 0) }, _setOptionDisabled: function (e) { this._super(e), this.element.attr("aria-disabled", e), this._toggleClass(null, "ui-state-disabled", !!e), this._toggleClass(this.headers.add(this.headers.next()), null, "ui-state-disabled", !!e) }, _keydown: function (t) { if (!t.altKey && !t.ctrlKey) { var i = e.ui.keyCode, s = this.headers.length, a = this.headers.index(t.target), n = !1; switch (t.keyCode) { case i.RIGHT: case i.DOWN: n = this.headers[(a + 1) % s]; break; case i.LEFT: case i.UP: n = this.headers[(a - 1 + s) % s]; break; case i.SPACE: case i.ENTER: this._eventHandler(t); break; case i.HOME: n = this.headers[0]; break; case i.END: n = this.headers[s - 1] }n && (e(t.target).attr("tabIndex", -1), e(n).attr("tabIndex", 0), e(n).trigger("focus"), t.preventDefault()) } }, _panelKeyDown: function (t) { t.keyCode === e.ui.keyCode.UP && t.ctrlKey && e(t.currentTarget).prev().trigger("focus") }, refresh: function () { var t = this.options; this._processPanels(), t.active === !1 && t.collapsible === !0 || !this.headers.length ? (t.active = !1, this.active = e()) : t.active === !1 ? this._activate(0) : this.active.length && !e.contains(this.element[0], this.active[0]) ? this.headers.length === this.headers.find(".ui-state-disabled").length ? (t.active = !1, this.active = e()) : this._activate(Math.max(0, t.active - 1)) : t.active = this.headers.index(this.active), this._destroyIcons(), this._refresh() }, _processPanels: function () { var e = this.headers, t = this.panels; this.headers = this.element.find(this.options.header), this._addClass(this.headers, "ui-accordion-header ui-accordion-header-collapsed", "ui-state-default"), this.panels = this.headers.next().filter(":not(.ui-accordion-content-active)").hide(), this._addClass(this.panels, "ui-accordion-content", "ui-helper-reset ui-widget-content"), t && (this._off(e.not(this.headers)), this._off(t.not(this.panels))) }, _refresh: function () { var t, i = this.options, s = i.heightStyle, a = this.element.parent(); this.active = this._findActive(i.active), this._addClass(this.active, "ui-accordion-header-active", "ui-state-active")._removeClass(this.active, "ui-accordion-header-collapsed"), this._addClass(this.active.next(), "ui-accordion-content-active"), this.active.next().show(), this.headers.attr("role", "tab").each(function () { var t = e(this), i = t.uniqueId().attr("id"), s = t.next(), a = s.uniqueId().attr("id"); t.attr("aria-controls", a), s.attr("aria-labelledby", i) }).next().attr("role", "tabpanel"), this.headers.not(this.active).attr({ "aria-selected": "false", "aria-expanded": "false", tabIndex: -1 }).next().attr({ "aria-hidden": "true" }).hide(), this.active.length ? this.active.attr({ "aria-selected": "true", "aria-expanded": "true", tabIndex: 0 }).next().attr({ "aria-hidden": "false" }) : this.headers.eq(0).attr("tabIndex", 0), this._createIcons(), this._setupEvents(i.event), "fill" === s ? (t = a.height(), this.element.siblings(":visible").each(function () { var i = e(this), s = i.css("position"); "absolute" !== s && "fixed" !== s && (t -= i.outerHeight(!0)) }), this.headers.each(function () { t -= e(this).outerHeight(!0) }), this.headers.next().each(function () { e(this).height(Math.max(0, t - e(this).innerHeight() + e(this).height())) }).css("overflow", "auto")) : "auto" === s && (t = 0, this.headers.next().each(function () { var i = e(this).is(":visible"); i || e(this).show(), t = Math.max(t, e(this).css("height", "").height()), i || e(this).hide() }).height(t)) }, _activate: function (t) { var i = this._findActive(t)[0]; i !== this.active[0] && (i = i || this.active[0], this._eventHandler({ target: i, currentTarget: i, preventDefault: e.noop })) }, _findActive: function (t) { return "number" == typeof t ? this.headers.eq(t) : e() }, _setupEvents: function (t) { var i = { keydown: "_keydown" }; t && e.each(t.split(" "), function (e, t) { i[t] = "_eventHandler" }), this._off(this.headers.add(this.headers.next())), this._on(this.headers, i), this._on(this.headers.next(), { keydown: "_panelKeyDown" }), this._hoverable(this.headers), this._focusable(this.headers) }, _eventHandler: function (t) { var i, s, a = this.options, n = this.active, r = e(t.currentTarget), o = r[0] === n[0], l = o && a.collapsible, h = l ? e() : r.next(), u = n.next(), d = { oldHeader: n, oldPanel: u, newHeader: l ? e() : r, newPanel: h }; t.preventDefault(), o && !a.collapsible || this._trigger("beforeActivate", t, d) === !1 || (a.active = l ? !1 : this.headers.index(r), this.active = o ? e() : r, this._toggle(d), this._removeClass(n, "ui-accordion-header-active", "ui-state-active"), a.icons && (i = n.children(".ui-accordion-header-icon"), this._removeClass(i, null, a.icons.activeHeader)._addClass(i, null, a.icons.header)), o || (this._removeClass(r, "ui-accordion-header-collapsed")._addClass(r, "ui-accordion-header-active", "ui-state-active"), a.icons && (s = r.children(".ui-accordion-header-icon"), this._removeClass(s, null, a.icons.header)._addClass(s, null, a.icons.activeHeader)), this._addClass(r.next(), "ui-accordion-content-active"))) }, _toggle: function (t) { var i = t.newPanel, s = this.prevShow.length ? this.prevShow : t.oldPanel; this.prevShow.add(this.prevHide).stop(!0, !0), this.prevShow = i, this.prevHide = s, this.options.animate ? this._animate(i, s, t) : (s.hide(), i.show(), this._toggleComplete(t)), s.attr({ "aria-hidden": "true" }), s.prev().attr({ "aria-selected": "false", "aria-expanded": "false" }), i.length && s.length ? s.prev().attr({ tabIndex: -1, "aria-expanded": "false" }) : i.length && this.headers.filter(function () { return 0 === parseInt(e(this).attr("tabIndex"), 10) }).attr("tabIndex", -1), i.attr("aria-hidden", "false").prev().attr({ "aria-selected": "true", "aria-expanded": "true", tabIndex: 0 }) }, _animate: function (e, t, i) { var s, a, n, r = this, o = 0, l = e.css("box-sizing"), h = e.length && (!t.length || e.index() < t.index()), u = this.options.animate || {}, d = h && u.down || u, c = function () { r._toggleComplete(i) }; return "number" == typeof d && (n = d), "string" == typeof d && (a = d), a = a || d.easing || u.easing, n = n || d.duration || u.duration, t.length ? e.length ? (s = e.show().outerHeight(), t.animate(this.hideProps, { duration: n, easing: a, step: function (e, t) { t.now = Math.round(e) } }), e.hide().animate(this.showProps, { duration: n, easing: a, complete: c, step: function (e, i) { i.now = Math.round(e), "height" !== i.prop ? "content-box" === l && (o += i.now) : "content" !== r.options.heightStyle && (i.now = Math.round(s - t.outerHeight() - o), o = 0) } }), void 0) : t.animate(this.hideProps, n, a, c) : e.animate(this.showProps, n, a, c) }, _toggleComplete: function (e) { var t = e.oldPanel, i = t.prev(); this._removeClass(t, "ui-accordion-content-active"), this._removeClass(i, "ui-accordion-header-active")._addClass(i, "ui-accordion-header-collapsed"), t.length && (t.parent()[0].className = t.parent()[0].className), this._trigger("activate", null, e) }
            }), e.widget("ui.menu", { version: "1.12.1", defaultElement: "<ul>", delay: 300, options: { icons: { submenu: "ui-icon-caret-1-e" }, items: "> *", menus: "ul", position: { my: "left top", at: "right top" }, role: "menu", blur: null, focus: null, select: null }, _create: function () { this.activeMenu = this.element, this.mouseHandled = !1, this.element.uniqueId().attr({ role: this.options.role, tabIndex: 0 }), this._addClass("ui-menu", "ui-widget ui-widget-content"), this._on({ "mousedown .ui-menu-item": function (e) { e.preventDefault() }, "click .ui-menu-item": function (t) { var i = e(t.target), s = e(e.ui.safeActiveElement(this.document[0])); !this.mouseHandled && i.not(".ui-state-disabled").length && (this.select(t), t.isPropagationStopped() || (this.mouseHandled = !0), i.has(".ui-menu").length ? this.expand(t) : !this.element.is(":focus") && s.closest(".ui-menu").length && (this.element.trigger("focus", [!0]), this.active && 1 === this.active.parents(".ui-menu").length && clearTimeout(this.timer))) }, "mouseenter .ui-menu-item": function (t) { if (!this.previousFilter) { var i = e(t.target).closest(".ui-menu-item"), s = e(t.currentTarget); i[0] === s[0] && (this._removeClass(s.siblings().children(".ui-state-active"), null, "ui-state-active"), this.focus(t, s)) } }, mouseleave: "collapseAll", "mouseleave .ui-menu": "collapseAll", focus: function (e, t) { var i = this.active || this.element.find(this.options.items).eq(0); t || this.focus(e, i) }, blur: function (t) { this._delay(function () { var i = !e.contains(this.element[0], e.ui.safeActiveElement(this.document[0])); i && this.collapseAll(t) }) }, keydown: "_keydown" }), this.refresh(), this._on(this.document, { click: function (e) { this._closeOnDocumentClick(e) && this.collapseAll(e), this.mouseHandled = !1 } }) }, _destroy: function () { var t = this.element.find(".ui-menu-item").removeAttr("role aria-disabled"), i = t.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup"); this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(), i.children().each(function () { var t = e(this); t.data("ui-menu-submenu-caret") && t.remove() }) }, _keydown: function (t) { var i, s, a, n, r = !0; switch (t.keyCode) { case e.ui.keyCode.PAGE_UP: this.previousPage(t); break; case e.ui.keyCode.PAGE_DOWN: this.nextPage(t); break; case e.ui.keyCode.HOME: this._move("first", "first", t); break; case e.ui.keyCode.END: this._move("last", "last", t); break; case e.ui.keyCode.UP: this.previous(t); break; case e.ui.keyCode.DOWN: this.next(t); break; case e.ui.keyCode.LEFT: this.collapse(t); break; case e.ui.keyCode.RIGHT: this.active && !this.active.is(".ui-state-disabled") && this.expand(t); break; case e.ui.keyCode.ENTER: case e.ui.keyCode.SPACE: this._activate(t); break; case e.ui.keyCode.ESCAPE: this.collapse(t); break; default: r = !1, s = this.previousFilter || "", n = !1, a = t.keyCode >= 96 && 105 >= t.keyCode ? "" + (t.keyCode - 96) : String.fromCharCode(t.keyCode), clearTimeout(this.filterTimer), a === s ? n = !0 : a = s + a, i = this._filterMenuItems(a), i = n && -1 !== i.index(this.active.next()) ? this.active.nextAll(".ui-menu-item") : i, i.length || (a = String.fromCharCode(t.keyCode), i = this._filterMenuItems(a)), i.length ? (this.focus(t, i), this.previousFilter = a, this.filterTimer = this._delay(function () { delete this.previousFilter }, 1e3)) : delete this.previousFilter }r && t.preventDefault() }, _activate: function (e) { this.active && !this.active.is(".ui-state-disabled") && (this.active.children("[aria-haspopup='true']").length ? this.expand(e) : this.select(e)) }, refresh: function () { var t, i, s, a, n, r = this, o = this.options.icons.submenu, l = this.element.find(this.options.menus); this._toggleClass("ui-menu-icons", null, !!this.element.find(".ui-icon").length), s = l.filter(":not(.ui-menu)").hide().attr({ role: this.options.role, "aria-hidden": "true", "aria-expanded": "false" }).each(function () { var t = e(this), i = t.prev(), s = e("<span>").data("ui-menu-submenu-caret", !0); r._addClass(s, "ui-menu-icon", "ui-icon " + o), i.attr("aria-haspopup", "true").prepend(s), t.attr("aria-labelledby", i.attr("id")) }), this._addClass(s, "ui-menu", "ui-widget ui-widget-content ui-front"), t = l.add(this.element), i = t.find(this.options.items), i.not(".ui-menu-item").each(function () { var t = e(this); r._isDivider(t) && r._addClass(t, "ui-menu-divider", "ui-widget-content") }), a = i.not(".ui-menu-item, .ui-menu-divider"), n = a.children().not(".ui-menu").uniqueId().attr({ tabIndex: -1, role: this._itemRole() }), this._addClass(a, "ui-menu-item")._addClass(n, "ui-menu-item-wrapper"), i.filter(".ui-state-disabled").attr("aria-disabled", "true"), this.active && !e.contains(this.element[0], this.active[0]) && this.blur() }, _itemRole: function () { return { menu: "menuitem", listbox: "option" }[this.options.role] }, _setOption: function (e, t) { if ("icons" === e) { var i = this.element.find(".ui-menu-icon"); this._removeClass(i, null, this.options.icons.submenu)._addClass(i, null, t.submenu) } this._super(e, t) }, _setOptionDisabled: function (e) { this._super(e), this.element.attr("aria-disabled", e + ""), this._toggleClass(null, "ui-state-disabled", !!e) }, focus: function (e, t) { var i, s, a; this.blur(e, e && "focus" === e.type), this._scrollIntoView(t), this.active = t.first(), s = this.active.children(".ui-menu-item-wrapper"), this._addClass(s, null, "ui-state-active"), this.options.role && this.element.attr("aria-activedescendant", s.attr("id")), a = this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"), this._addClass(a, null, "ui-state-active"), e && "keydown" === e.type ? this._close() : this.timer = this._delay(function () { this._close() }, this.delay), i = t.children(".ui-menu"), i.length && e && /^mouse/.test(e.type) && this._startOpening(i), this.activeMenu = t.parent(), this._trigger("focus", e, { item: t }) }, _scrollIntoView: function (t) { var i, s, a, n, r, o; this._hasScroll() && (i = parseFloat(e.css(this.activeMenu[0], "borderTopWidth")) || 0, s = parseFloat(e.css(this.activeMenu[0], "paddingTop")) || 0, a = t.offset().top - this.activeMenu.offset().top - i - s, n = this.activeMenu.scrollTop(), r = this.activeMenu.height(), o = t.outerHeight(), 0 > a ? this.activeMenu.scrollTop(n + a) : a + o > r && this.activeMenu.scrollTop(n + a - r + o)) }, blur: function (e, t) { t || clearTimeout(this.timer), this.active && (this._removeClass(this.active.children(".ui-menu-item-wrapper"), null, "ui-state-active"), this._trigger("blur", e, { item: this.active }), this.active = null) }, _startOpening: function (e) { clearTimeout(this.timer), "true" === e.attr("aria-hidden") && (this.timer = this._delay(function () { this._close(), this._open(e) }, this.delay)) }, _open: function (t) { var i = e.extend({ of: this.active }, this.options.position); clearTimeout(this.timer), this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"), t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(i) }, collapseAll: function (t, i) { clearTimeout(this.timer), this.timer = this._delay(function () { var s = i ? this.element : e(t && t.target).closest(this.element.find(".ui-menu")); s.length || (s = this.element), this._close(s), this.blur(t), this._removeClass(s.find(".ui-state-active"), null, "ui-state-active"), this.activeMenu = s }, this.delay) }, _close: function (e) { e || (e = this.active ? this.active.parent() : this.element), e.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false") }, _closeOnDocumentClick: function (t) { return !e(t.target).closest(".ui-menu").length }, _isDivider: function (e) { return !/[^\-\u2014\u2013\s]/.test(e.text()) }, collapse: function (e) { var t = this.active && this.active.parent().closest(".ui-menu-item", this.element); t && t.length && (this._close(), this.focus(e, t)) }, expand: function (e) { var t = this.active && this.active.children(".ui-menu ").find(this.options.items).first(); t && t.length && (this._open(t.parent()), this._delay(function () { this.focus(e, t) })) }, next: function (e) { this._move("next", "first", e) }, previous: function (e) { this._move("prev", "last", e) }, isFirstItem: function () { return this.active && !this.active.prevAll(".ui-menu-item").length }, isLastItem: function () { return this.active && !this.active.nextAll(".ui-menu-item").length }, _move: function (e, t, i) { var s; this.active && (s = "first" === e || "last" === e ? this.active["first" === e ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : this.active[e + "All"](".ui-menu-item").eq(0)), s && s.length && this.active || (s = this.activeMenu.find(this.options.items)[t]()), this.focus(i, s) }, nextPage: function (t) { var i, s, a; return this.active ? (this.isLastItem() || (this._hasScroll() ? (s = this.active.offset().top, a = this.element.height(), this.active.nextAll(".ui-menu-item").each(function () { return i = e(this), 0 > i.offset().top - s - a }), this.focus(t, i)) : this.focus(t, this.activeMenu.find(this.options.items)[this.active ? "last" : "first"]())), void 0) : (this.next(t), void 0) }, previousPage: function (t) { var i, s, a; return this.active ? (this.isFirstItem() || (this._hasScroll() ? (s = this.active.offset().top, a = this.element.height(), this.active.prevAll(".ui-menu-item").each(function () { return i = e(this), i.offset().top - s + a > 0 }), this.focus(t, i)) : this.focus(t, this.activeMenu.find(this.options.items).first())), void 0) : (this.next(t), void 0) }, _hasScroll: function () { return this.element.outerHeight() < this.element.prop("scrollHeight") }, select: function (t) { this.active = this.active || e(t.target).closest(".ui-menu-item"); var i = { item: this.active }; this.active.has(".ui-menu").length || this.collapseAll(t, !0), this._trigger("select", t, i) }, _filterMenuItems: function (t) { var i = t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&"), s = RegExp("^" + i, "i"); return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function () { return s.test(e.trim(e(this).children(".ui-menu-item-wrapper").text())) }) } }), e.widget("ui.autocomplete", { version: "1.12.1", defaultElement: "<input>", options: { appendTo: null, autoFocus: !1, delay: 300, minLength: 1, position: { my: "left top", at: "left bottom", collision: "none" }, source: null, change: null, close: null, focus: null, open: null, response: null, search: null, select: null }, requestIndex: 0, pending: 0, _create: function () { var t, i, s, a = this.element[0].nodeName.toLowerCase(), n = "textarea" === a, r = "input" === a; this.isMultiLine = n || !r && this._isContentEditable(this.element), this.valueMethod = this.element[n || r ? "val" : "text"], this.isNewMenu = !0, this._addClass("ui-autocomplete-input"), this.element.attr("autocomplete", "off"), this._on(this.element, { keydown: function (a) { if (this.element.prop("readOnly")) return t = !0, s = !0, i = !0, void 0; t = !1, s = !1, i = !1; var n = e.ui.keyCode; switch (a.keyCode) { case n.PAGE_UP: t = !0, this._move("previousPage", a); break; case n.PAGE_DOWN: t = !0, this._move("nextPage", a); break; case n.UP: t = !0, this._keyEvent("previous", a); break; case n.DOWN: t = !0, this._keyEvent("next", a); break; case n.ENTER: this.menu.active && (t = !0, a.preventDefault(), this.menu.select(a)); break; case n.TAB: this.menu.active && this.menu.select(a); break; case n.ESCAPE: this.menu.element.is(":visible") && (this.isMultiLine || this._value(this.term), this.close(a), a.preventDefault()); break; default: i = !0, this._searchTimeout(a) } }, keypress: function (s) { if (t) return t = !1, (!this.isMultiLine || this.menu.element.is(":visible")) && s.preventDefault(), void 0; if (!i) { var a = e.ui.keyCode; switch (s.keyCode) { case a.PAGE_UP: this._move("previousPage", s); break; case a.PAGE_DOWN: this._move("nextPage", s); break; case a.UP: this._keyEvent("previous", s); break; case a.DOWN: this._keyEvent("next", s) } } }, input: function (e) { return s ? (s = !1, e.preventDefault(), void 0) : (this._searchTimeout(e), void 0) }, focus: function () { this.selectedItem = null, this.previous = this._value() }, blur: function (e) { return this.cancelBlur ? (delete this.cancelBlur, void 0) : (clearTimeout(this.searching), this.close(e), this._change(e), void 0) } }), this._initSource(), this.menu = e("<ul>").appendTo(this._appendTo()).menu({ role: null }).hide().menu("instance"), this._addClass(this.menu.element, "ui-autocomplete", "ui-front"), this._on(this.menu.element, { mousedown: function (t) { t.preventDefault(), this.cancelBlur = !0, this._delay(function () { delete this.cancelBlur, this.element[0] !== e.ui.safeActiveElement(this.document[0]) && this.element.trigger("focus") }) }, menufocus: function (t, i) { var s, a; return this.isNewMenu && (this.isNewMenu = !1, t.originalEvent && /^mouse/.test(t.originalEvent.type)) ? (this.menu.blur(), this.document.one("mousemove", function () { e(t.target).trigger(t.originalEvent) }), void 0) : (a = i.item.data("ui-autocomplete-item"), !1 !== this._trigger("focus", t, { item: a }) && t.originalEvent && /^key/.test(t.originalEvent.type) && this._value(a.value), s = i.item.attr("aria-label") || a.value, s && e.trim(s).length && (this.liveRegion.children().hide(), e("<div>").text(s).appendTo(this.liveRegion)), void 0) }, menuselect: function (t, i) { var s = i.item.data("ui-autocomplete-item"), a = this.previous; this.element[0] !== e.ui.safeActiveElement(this.document[0]) && (this.element.trigger("focus"), this.previous = a, this._delay(function () { this.previous = a, this.selectedItem = s })), !1 !== this._trigger("select", t, { item: s }) && this._value(s.value), this.term = this._value(), this.close(t), this.selectedItem = s } }), this.liveRegion = e("<div>", { role: "status", "aria-live": "assertive", "aria-relevant": "additions" }).appendTo(this.document[0].body), this._addClass(this.liveRegion, null, "ui-helper-hidden-accessible"), this._on(this.window, { beforeunload: function () { this.element.removeAttr("autocomplete") } }) }, _destroy: function () { clearTimeout(this.searching), this.element.removeAttr("autocomplete"), this.menu.element.remove(), this.liveRegion.remove() }, _setOption: function (e, t) { this._super(e, t), "source" === e && this._initSource(), "appendTo" === e && this.menu.element.appendTo(this._appendTo()), "disabled" === e && t && this.xhr && this.xhr.abort() }, _isEventTargetInWidget: function (t) { var i = this.menu.element[0]; return t.target === this.element[0] || t.target === i || e.contains(i, t.target) }, _closeOnClickOutside: function (e) { this._isEventTargetInWidget(e) || this.close() }, _appendTo: function () { var t = this.options.appendTo; return t && (t = t.jquery || t.nodeType ? e(t) : this.document.find(t).eq(0)), t && t[0] || (t = this.element.closest(".ui-front, dialog")), t.length || (t = this.document[0].body), t }, _initSource: function () { var t, i, s = this; e.isArray(this.options.source) ? (t = this.options.source, this.source = function (i, s) { s(e.ui.autocomplete.filter(t, i.term)) }) : "string" == typeof this.options.source ? (i = this.options.source, this.source = function (t, a) { s.xhr && s.xhr.abort(), s.xhr = e.ajax({ url: i, data: t, dataType: "json", success: function (e) { a(e) }, error: function () { a([]) } }) }) : this.source = this.options.source }, _searchTimeout: function (e) { clearTimeout(this.searching), this.searching = this._delay(function () { var t = this.term === this._value(), i = this.menu.element.is(":visible"), s = e.altKey || e.ctrlKey || e.metaKey || e.shiftKey; (!t || t && !i && !s) && (this.selectedItem = null, this.search(null, e)) }, this.options.delay) }, search: function (e, t) { return e = null != e ? e : this._value(), this.term = this._value(), e.length < this.options.minLength ? this.close(t) : this._trigger("search", t) !== !1 ? this._search(e) : void 0 }, _search: function (e) { this.pending++ , this._addClass("ui-autocomplete-loading"), this.cancelSearch = !1, this.source({ term: e }, this._response()) }, _response: function () { var t = ++this.requestIndex; return e.proxy(function (e) { t === this.requestIndex && this.__response(e), this.pending-- , this.pending || this._removeClass("ui-autocomplete-loading") }, this) }, __response: function (e) { e && (e = this._normalize(e)), this._trigger("response", null, { content: e }), !this.options.disabled && e && e.length && !this.cancelSearch ? (this._suggest(e), this._trigger("open")) : this._close() }, close: function (e) { this.cancelSearch = !0, this._close(e) }, _close: function (e) { this._off(this.document, "mousedown"), this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", e)) }, _change: function (e) { this.previous !== this._value() && this._trigger("change", e, { item: this.selectedItem }) }, _normalize: function (t) { return t.length && t[0].label && t[0].value ? t : e.map(t, function (t) { return "string" == typeof t ? { label: t, value: t } : e.extend({}, t, { label: t.label || t.value, value: t.value || t.label }) }) }, _suggest: function (t) { var i = this.menu.element.empty(); this._renderMenu(i, t), this.isNewMenu = !0, this.menu.refresh(), i.show(), this._resizeMenu(), i.position(e.extend({ of: this.element }, this.options.position)), this.options.autoFocus && this.menu.next(), this._on(this.document, { mousedown: "_closeOnClickOutside" }) }, _resizeMenu: function () { var e = this.menu.element; e.outerWidth(Math.max(e.width("").outerWidth() + 1, this.element.outerWidth())) }, _renderMenu: function (t, i) { var s = this; e.each(i, function (e, i) { s._renderItemData(t, i) }) }, _renderItemData: function (e, t) { return this._renderItem(e, t).data("ui-autocomplete-item", t) }, _renderItem: function (t, i) { return e("<li>").append(e("<div>").text(i.label)).appendTo(t) }, _move: function (e, t) { return this.menu.element.is(":visible") ? this.menu.isFirstItem() && /^previous/.test(e) || this.menu.isLastItem() && /^next/.test(e) ? (this.isMultiLine || this._value(this.term), this.menu.blur(), void 0) : (this.menu[e](t), void 0) : (this.search(null, t), void 0) }, widget: function () { return this.menu.element }, _value: function () { return this.valueMethod.apply(this.element, arguments) }, _keyEvent: function (e, t) { (!this.isMultiLine || this.menu.element.is(":visible")) && (this._move(e, t), t.preventDefault()) }, _isContentEditable: function (e) { if (!e.length) return !1; var t = e.prop("contentEditable"); return "inherit" === t ? this._isContentEditable(e.parent()) : "true" === t } }), e.extend(e.ui.autocomplete, { escapeRegex: function (e) { return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&") }, filter: function (t, i) { var s = RegExp(e.ui.autocomplete.escapeRegex(i), "i"); return e.grep(t, function (e) { return s.test(e.label || e.value || e) }) } }), e.widget("ui.autocomplete", e.ui.autocomplete, { options: { messages: { noResults: "No search results.", results: function (e) { return e + (e > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate." } } }, __response: function (t) { var i; this._superApply(arguments), this.options.disabled || this.cancelSearch || (i = t && t.length ? this.options.messages.results(t.length) : this.options.messages.noResults, this.liveRegion.children().hide(), e("<div>").text(i).appendTo(this.liveRegion)) } }), e.ui.autocomplete; var c = /ui-corner-([a-z]){2,6}/g; e.widget("ui.controlgroup", { version: "1.12.1", defaultElement: "<div>", options: { direction: "horizontal", disabled: null, onlyVisible: !0, items: { button: "input[type=button], input[type=submit], input[type=reset], button, a", controlgroupLabel: ".ui-controlgroup-label", checkboxradio: "input[type='checkbox'], input[type='radio']", selectmenu: "select", spinner: ".ui-spinner-input" } }, _create: function () { this._enhance() }, _enhance: function () { this.element.attr("role", "toolbar"), this.refresh() }, _destroy: function () { this._callChildMethod("destroy"), this.childWidgets.removeData("ui-controlgroup-data"), this.element.removeAttr("role"), this.options.items.controlgroupLabel && this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap() }, _initWidgets: function () { var t = this, i = []; e.each(this.options.items, function (s, a) { var n, r = {}; return a ? "controlgroupLabel" === s ? (n = t.element.find(a), n.each(function () { var t = e(this); t.children(".ui-controlgroup-label-contents").length || t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>") }), t._addClass(n, null, "ui-widget ui-widget-content ui-state-default"), i = i.concat(n.get()), void 0) : (e.fn[s] && (r = t["_" + s + "Options"] ? t["_" + s + "Options"]("middle") : { classes: {} }, t.element.find(a).each(function () { var a = e(this), n = a[s]("instance"), o = e.widget.extend({}, r); if ("button" !== s || !a.parent(".ui-spinner").length) { n || (n = a[s]()[s]("instance")), n && (o.classes = t._resolveClassesValues(o.classes, n)), a[s](o); var l = a[s]("widget"); e.data(l[0], "ui-controlgroup-data", n ? n : a[s]("instance")), i.push(l[0]) } })), void 0) : void 0 }), this.childWidgets = e(e.unique(i)), this._addClass(this.childWidgets, "ui-controlgroup-item") }, _callChildMethod: function (t) { this.childWidgets.each(function () { var i = e(this), s = i.data("ui-controlgroup-data"); s && s[t] && s[t]() }) }, _updateCornerClass: function (e, t) { var i = "ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all", s = this._buildSimpleOptions(t, "label").classes.label; this._removeClass(e, null, i), this._addClass(e, null, s) }, _buildSimpleOptions: function (e, t) { var i = "vertical" === this.options.direction, s = { classes: {} }; return s.classes[t] = { middle: "", first: "ui-corner-" + (i ? "top" : "left"), last: "ui-corner-" + (i ? "bottom" : "right"), only: "ui-corner-all" }[e], s }, _spinnerOptions: function (e) { var t = this._buildSimpleOptions(e, "ui-spinner"); return t.classes["ui-spinner-up"] = "", t.classes["ui-spinner-down"] = "", t }, _buttonOptions: function (e) { return this._buildSimpleOptions(e, "ui-button") }, _checkboxradioOptions: function (e) { return this._buildSimpleOptions(e, "ui-checkboxradio-label") }, _selectmenuOptions: function (e) { var t = "vertical" === this.options.direction; return { width: t ? "auto" : !1, classes: { middle: { "ui-selectmenu-button-open": "", "ui-selectmenu-button-closed": "" }, first: { "ui-selectmenu-button-open": "ui-corner-" + (t ? "top" : "tl"), "ui-selectmenu-button-closed": "ui-corner-" + (t ? "top" : "left") }, last: { "ui-selectmenu-button-open": t ? "" : "ui-corner-tr", "ui-selectmenu-button-closed": "ui-corner-" + (t ? "bottom" : "right") }, only: { "ui-selectmenu-button-open": "ui-corner-top", "ui-selectmenu-button-closed": "ui-corner-all" } }[e] } }, _resolveClassesValues: function (t, i) { var s = {}; return e.each(t, function (a) { var n = i.options.classes[a] || ""; n = e.trim(n.replace(c, "")), s[a] = (n + " " + t[a]).replace(/\s+/g, " ") }), s }, _setOption: function (e, t) { return "direction" === e && this._removeClass("ui-controlgroup-" + this.options.direction), this._super(e, t), "disabled" === e ? (this._callChildMethod(t ? "disable" : "enable"), void 0) : (this.refresh(), void 0) }, refresh: function () { var t, i = this; this._addClass("ui-controlgroup ui-controlgroup-" + this.options.direction), "horizontal" === this.options.direction && this._addClass(null, "ui-helper-clearfix"), this._initWidgets(), t = this.childWidgets, this.options.onlyVisible && (t = t.filter(":visible")), t.length && (e.each(["first", "last"], function (e, s) { var a = t[s]().data("ui-controlgroup-data"); if (a && i["_" + a.widgetName + "Options"]) { var n = i["_" + a.widgetName + "Options"](1 === t.length ? "only" : s); n.classes = i._resolveClassesValues(n.classes, a), a.element[a.widgetName](n) } else i._updateCornerClass(t[s](), s) }), this._callChildMethod("refresh")) } }), e.widget("ui.checkboxradio", [e.ui.formResetMixin, {
                version: "1.12.1", options: { disabled: null, label: null, icon: !0, classes: { "ui-checkboxradio-label": "ui-corner-all", "ui-checkboxradio-icon": "ui-corner-all" } }, _getCreateOptions: function () { var t, i, s = this, a = this._super() || {}; return this._readType(), i = this.element.labels(), this.label = e(i[i.length - 1]), this.label.length || e.error("No label found for checkboxradio widget"), this.originalLabel = "", this.label.contents().not(this.element[0]).each(function () { s.originalLabel += 3 === this.nodeType ? e(this).text() : this.outerHTML }), this.originalLabel && (a.label = this.originalLabel), t = this.element[0].disabled, null != t && (a.disabled = t), a }, _create: function () { var e = this.element[0].checked; this._bindFormResetHandler(), null == this.options.disabled && (this.options.disabled = this.element[0].disabled), this._setOption("disabled", this.options.disabled), this._addClass("ui-checkboxradio", "ui-helper-hidden-accessible"), this._addClass(this.label, "ui-checkboxradio-label", "ui-button ui-widget"), "radio" === this.type && this._addClass(this.label, "ui-checkboxradio-radio-label"), this.options.label && this.options.label !== this.originalLabel ? this._updateLabel() : this.originalLabel && (this.options.label = this.originalLabel), this._enhance(), e && (this._addClass(this.label, "ui-checkboxradio-checked", "ui-state-active"), this.icon && this._addClass(this.icon, null, "ui-state-hover")), this._on({ change: "_toggleClasses", focus: function () { this._addClass(this.label, null, "ui-state-focus ui-visual-focus") }, blur: function () { this._removeClass(this.label, null, "ui-state-focus ui-visual-focus") } }) }, _readType: function () { var t = this.element[0].nodeName.toLowerCase(); this.type = this.element[0].type, "input" === t && /radio|checkbox/.test(this.type) || e.error("Can't create checkboxradio on element.nodeName=" + t + " and element.type=" + this.type) }, _enhance: function () { this._updateIcon(this.element[0].checked) }, widget: function () { return this.label }, _getRadioGroup: function () { var t, i = this.element[0].name, s = "input[name='" + e.ui.escapeSelector(i) + "']"; return i ? (t = this.form.length ? e(this.form[0].elements).filter(s) : e(s).filter(function () { return 0 === e(this).form().length }), t.not(this.element)) : e([]) }, _toggleClasses: function () { var t = this.element[0].checked; this._toggleClass(this.label, "ui-checkboxradio-checked", "ui-state-active", t), this.options.icon && "checkbox" === this.type && this._toggleClass(this.icon, null, "ui-icon-check ui-state-checked", t)._toggleClass(this.icon, null, "ui-icon-blank", !t), "radio" === this.type && this._getRadioGroup().each(function () { var t = e(this).checkboxradio("instance"); t && t._removeClass(t.label, "ui-checkboxradio-checked", "ui-state-active") }) }, _destroy: function () { this._unbindFormResetHandler(), this.icon && (this.icon.remove(), this.iconSpace.remove()) }, _setOption: function (e, t) { return "label" !== e || t ? (this._super(e, t), "disabled" === e ? (this._toggleClass(this.label, null, "ui-state-disabled", t), this.element[0].disabled = t, void 0) : (this.refresh(), void 0)) : void 0 }, _updateIcon: function (t) {
                    var i = "ui-icon ui-icon-background "; this.options.icon ? (this.icon || (this.icon = e("<span>"), this.iconSpace = e("<span> </span>"), this._addClass(this.iconSpace, "ui-checkboxradio-icon-space")), "checkbox" === this.type ? (i += t ? "ui-icon-check ui-state-checked" : "ui-icon-blank", this._removeClass(this.icon, null, t ? "ui-icon-blank" : "ui-icon-check")) : i += "ui-icon-blank", this._addClass(this.icon, "ui-checkboxradio-icon", i), t || this._removeClass(this.icon, null, "ui-icon-check ui-state-checked"), this.icon.prependTo(this.label).after(this.iconSpace)) : void 0 !== this.icon && (this.icon.remove(), this.iconSpace.remove(), delete this.icon)
                }, _updateLabel: function () { var e = this.label.contents().not(this.element[0]); this.icon && (e = e.not(this.icon[0])), this.iconSpace && (e = e.not(this.iconSpace[0])), e.remove(), this.label.append(this.options.label) }, refresh: function () { var e = this.element[0].checked, t = this.element[0].disabled; this._updateIcon(e), this._toggleClass(this.label, "ui-checkboxradio-checked", "ui-state-active", e), null !== this.options.label && this._updateLabel(), t !== this.options.disabled && this._setOptions({ disabled: t }) }
            }]), e.ui.checkboxradio, e.widget("ui.button", { version: "1.12.1", defaultElement: "<button>", options: { classes: { "ui-button": "ui-corner-all" }, disabled: null, icon: null, iconPosition: "beginning", label: null, showLabel: !0 }, _getCreateOptions: function () { var e, t = this._super() || {}; return this.isInput = this.element.is("input"), e = this.element[0].disabled, null != e && (t.disabled = e), this.originalLabel = this.isInput ? this.element.val() : this.element.html(), this.originalLabel && (t.label = this.originalLabel), t }, _create: function () { !this.option.showLabel & !this.options.icon && (this.options.showLabel = !0), null == this.options.disabled && (this.options.disabled = this.element[0].disabled || !1), this.hasTitle = !!this.element.attr("title"), this.options.label && this.options.label !== this.originalLabel && (this.isInput ? this.element.val(this.options.label) : this.element.html(this.options.label)), this._addClass("ui-button", "ui-widget"), this._setOption("disabled", this.options.disabled), this._enhance(), this.element.is("a") && this._on({ keyup: function (t) { t.keyCode === e.ui.keyCode.SPACE && (t.preventDefault(), this.element[0].click ? this.element[0].click() : this.element.trigger("click")) } }) }, _enhance: function () { this.element.is("button") || this.element.attr("role", "button"), this.options.icon && (this._updateIcon("icon", this.options.icon), this._updateTooltip()) }, _updateTooltip: function () { this.title = this.element.attr("title"), this.options.showLabel || this.title || this.element.attr("title", this.options.label) }, _updateIcon: function (t, i) { var s = "iconPosition" !== t, a = s ? this.options.iconPosition : i, n = "top" === a || "bottom" === a; this.icon ? s && this._removeClass(this.icon, null, this.options.icon) : (this.icon = e("<span>"), this._addClass(this.icon, "ui-button-icon", "ui-icon"), this.options.showLabel || this._addClass("ui-button-icon-only")), s && this._addClass(this.icon, null, i), this._attachIcon(a), n ? (this._addClass(this.icon, null, "ui-widget-icon-block"), this.iconSpace && this.iconSpace.remove()) : (this.iconSpace || (this.iconSpace = e("<span> </span>"), this._addClass(this.iconSpace, "ui-button-icon-space")), this._removeClass(this.icon, null, "ui-wiget-icon-block"), this._attachIconSpace(a)) }, _destroy: function () { this.element.removeAttr("role"), this.icon && this.icon.remove(), this.iconSpace && this.iconSpace.remove(), this.hasTitle || this.element.removeAttr("title") }, _attachIconSpace: function (e) { this.icon[/^(?:end|bottom)/.test(e) ? "before" : "after"](this.iconSpace) }, _attachIcon: function (e) { this.element[/^(?:end|bottom)/.test(e) ? "append" : "prepend"](this.icon) }, _setOptions: function (e) { var t = void 0 === e.showLabel ? this.options.showLabel : e.showLabel, i = void 0 === e.icon ? this.options.icon : e.icon; t || i || (e.showLabel = !0), this._super(e) }, _setOption: function (e, t) { "icon" === e && (t ? this._updateIcon(e, t) : this.icon && (this.icon.remove(), this.iconSpace && this.iconSpace.remove())), "iconPosition" === e && this._updateIcon(e, t), "showLabel" === e && (this._toggleClass("ui-button-icon-only", null, !t), this._updateTooltip()), "label" === e && (this.isInput ? this.element.val(t) : (this.element.html(t), this.icon && (this._attachIcon(this.options.iconPosition), this._attachIconSpace(this.options.iconPosition)))), this._super(e, t), "disabled" === e && (this._toggleClass(null, "ui-state-disabled", t), this.element[0].disabled = t, t && this.element.blur()) }, refresh: function () { var e = this.element.is("input, button") ? this.element[0].disabled : this.element.hasClass("ui-button-disabled"); e !== this.options.disabled && this._setOptions({ disabled: e }), this._updateTooltip() } }), e.uiBackCompat !== !1 && (e.widget("ui.button", e.ui.button, { options: { text: !0, icons: { primary: null, secondary: null } }, _create: function () { this.options.showLabel && !this.options.text && (this.options.showLabel = this.options.text), !this.options.showLabel && this.options.text && (this.options.text = this.options.showLabel), this.options.icon || !this.options.icons.primary && !this.options.icons.secondary ? this.options.icon && (this.options.icons.primary = this.options.icon) : this.options.icons.primary ? this.options.icon = this.options.icons.primary : (this.options.icon = this.options.icons.secondary, this.options.iconPosition = "end"), this._super() }, _setOption: function (e, t) { return "text" === e ? (this._super("showLabel", t), void 0) : ("showLabel" === e && (this.options.text = t), "icon" === e && (this.options.icons.primary = t), "icons" === e && (t.primary ? (this._super("icon", t.primary), this._super("iconPosition", "beginning")) : t.secondary && (this._super("icon", t.secondary), this._super("iconPosition", "end"))), this._superApply(arguments), void 0) } }), e.fn.button = function (t) { return function () { return !this.length || this.length && "INPUT" !== this[0].tagName || this.length && "INPUT" === this[0].tagName && "checkbox" !== this.attr("type") && "radio" !== this.attr("type") ? t.apply(this, arguments) : (e.ui.checkboxradio || e.error("Checkboxradio widget missing"), 0 === arguments.length ? this.checkboxradio({ icon: !1 }) : this.checkboxradio.apply(this, arguments)) } }(e.fn.button), e.fn.buttonset = function () { return e.ui.controlgroup || e.error("Controlgroup widget missing"), "option" === arguments[0] && "items" === arguments[1] && arguments[2] ? this.controlgroup.apply(this, [arguments[0], "items.button", arguments[2]]) : "option" === arguments[0] && "items" === arguments[1] ? this.controlgroup.apply(this, [arguments[0], "items.button"]) : ("object" == typeof arguments[0] && arguments[0].items && (arguments[0].items = { button: arguments[0].items }), this.controlgroup.apply(this, arguments)) }), e.ui.button, e.extend(e.ui, { datepicker: { version: "1.12.1" } }); var p; e.extend(s.prototype, {
                markerClassName: "hasDatepicker", maxRows: 4, _widgetDatepicker: function () { return this.dpDiv }, setDefaults: function (e) { return r(this._defaults, e || {}), this }, _attachDatepicker: function (t, i) { var s, a, n; s = t.nodeName.toLowerCase(), a = "div" === s || "span" === s, t.id || (this.uuid += 1, t.id = "dp" + this.uuid), n = this._newInst(e(t), a), n.settings = e.extend({}, i || {}), "input" === s ? this._connectDatepicker(t, n) : a && this._inlineDatepicker(t, n) }, _newInst: function (t, i) { var s = t[0].id.replace(/([^A-Za-z0-9_\-])/g, "\\\\$1"); return { id: s, input: t, selectedDay: 0, selectedMonth: 0, selectedYear: 0, drawMonth: 0, drawYear: 0, inline: i, dpDiv: i ? a(e("<div class='" + this._inlineClass + " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")) : this.dpDiv } }, _connectDatepicker: function (t, i) { var s = e(t); i.append = e([]), i.trigger = e([]), s.hasClass(this.markerClassName) || (this._attachments(s, i), s.addClass(this.markerClassName).on("keydown", this._doKeyDown).on("keypress", this._doKeyPress).on("keyup", this._doKeyUp), this._autoSize(i), e.data(t, "datepicker", i), i.settings.disabled && this._disableDatepicker(t)) }, _attachments: function (t, i) { var s, a, n, r = this._get(i, "appendText"), o = this._get(i, "isRTL"); i.append && i.append.remove(), r && (i.append = e("<span class='" + this._appendClass + "'>" + r + "</span>"), t[o ? "before" : "after"](i.append)), t.off("focus", this._showDatepicker), i.trigger && i.trigger.remove(), s = this._get(i, "showOn"), ("focus" === s || "both" === s) && t.on("focus", this._showDatepicker), ("button" === s || "both" === s) && (a = this._get(i, "buttonText"), n = this._get(i, "buttonImage"), i.trigger = e(this._get(i, "buttonImageOnly") ? e("<img/>").addClass(this._triggerClass).attr({ src: n, alt: a, title: a }) : e("<button type='button'></button>").addClass(this._triggerClass).html(n ? e("<img/>").attr({ src: n, alt: a, title: a }) : a)), t[o ? "before" : "after"](i.trigger), i.trigger.on("click", function () { return e.datepicker._datepickerShowing && e.datepicker._lastInput === t[0] ? e.datepicker._hideDatepicker() : e.datepicker._datepickerShowing && e.datepicker._lastInput !== t[0] ? (e.datepicker._hideDatepicker(), e.datepicker._showDatepicker(t[0])) : e.datepicker._showDatepicker(t[0]), !1 })) }, _autoSize: function (e) { if (this._get(e, "autoSize") && !e.inline) { var t, i, s, a, n = new Date(2009, 11, 20), r = this._get(e, "dateFormat"); r.match(/[DM]/) && (t = function (e) { for (i = 0, s = 0, a = 0; e.length > a; a++)e[a].length > i && (i = e[a].length, s = a); return s }, n.setMonth(t(this._get(e, r.match(/MM/) ? "monthNames" : "monthNamesShort"))), n.setDate(t(this._get(e, r.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - n.getDay())), e.input.attr("size", this._formatDate(e, n).length) } }, _inlineDatepicker: function (t, i) { var s = e(t); s.hasClass(this.markerClassName) || (s.addClass(this.markerClassName).append(i.dpDiv), e.data(t, "datepicker", i), this._setDate(i, this._getDefaultDate(i), !0), this._updateDatepicker(i), this._updateAlternate(i), i.settings.disabled && this._disableDatepicker(t), i.dpDiv.css("display", "block")) }, _dialogDatepicker: function (t, i, s, a, n) { var o, l, h, u, d, c = this._dialogInst; return c || (this.uuid += 1, o = "dp" + this.uuid, this._dialogInput = e("<input type='text' id='" + o + "' style='position: absolute; top: -100px; width: 0px;'/>"), this._dialogInput.on("keydown", this._doKeyDown), e("body").append(this._dialogInput), c = this._dialogInst = this._newInst(this._dialogInput, !1), c.settings = {}, e.data(this._dialogInput[0], "datepicker", c)), r(c.settings, a || {}), i = i && i.constructor === Date ? this._formatDate(c, i) : i, this._dialogInput.val(i), this._pos = n ? n.length ? n : [n.pageX, n.pageY] : null, this._pos || (l = document.documentElement.clientWidth, h = document.documentElement.clientHeight, u = document.documentElement.scrollLeft || document.body.scrollLeft, d = document.documentElement.scrollTop || document.body.scrollTop, this._pos = [l / 2 - 100 + u, h / 2 - 150 + d]), this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"), c.settings.onSelect = s, this._inDialog = !0, this.dpDiv.addClass(this._dialogClass), this._showDatepicker(this._dialogInput[0]), e.blockUI && e.blockUI(this.dpDiv), e.data(this._dialogInput[0], "datepicker", c), this }, _destroyDatepicker: function (t) { var i, s = e(t), a = e.data(t, "datepicker"); s.hasClass(this.markerClassName) && (i = t.nodeName.toLowerCase(), e.removeData(t, "datepicker"), "input" === i ? (a.append.remove(), a.trigger.remove(), s.removeClass(this.markerClassName).off("focus", this._showDatepicker).off("keydown", this._doKeyDown).off("keypress", this._doKeyPress).off("keyup", this._doKeyUp)) : ("div" === i || "span" === i) && s.removeClass(this.markerClassName).empty(), p === a && (p = null)) }, _enableDatepicker: function (t) { var i, s, a = e(t), n = e.data(t, "datepicker"); a.hasClass(this.markerClassName) && (i = t.nodeName.toLowerCase(), "input" === i ? (t.disabled = !1, n.trigger.filter("button").each(function () { this.disabled = !1 }).end().filter("img").css({ opacity: "1.0", cursor: "" })) : ("div" === i || "span" === i) && (s = a.children("." + this._inlineClass), s.children().removeClass("ui-state-disabled"), s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !1)), this._disabledInputs = e.map(this._disabledInputs, function (e) { return e === t ? null : e })) }, _disableDatepicker: function (t) { var i, s, a = e(t), n = e.data(t, "datepicker"); a.hasClass(this.markerClassName) && (i = t.nodeName.toLowerCase(), "input" === i ? (t.disabled = !0, n.trigger.filter("button").each(function () { this.disabled = !0 }).end().filter("img").css({ opacity: "0.5", cursor: "default" })) : ("div" === i || "span" === i) && (s = a.children("." + this._inlineClass), s.children().addClass("ui-state-disabled"), s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled", !0)), this._disabledInputs = e.map(this._disabledInputs, function (e) { return e === t ? null : e }), this._disabledInputs[this._disabledInputs.length] = t) }, _isDisabledDatepicker: function (e) { if (!e) return !1; for (var t = 0; this._disabledInputs.length > t; t++)if (this._disabledInputs[t] === e) return !0; return !1 }, _getInst: function (t) { try { return e.data(t, "datepicker") } catch (i) { throw "Missing instance data for this datepicker" } }, _optionDatepicker: function (t, i, s) { var a, n, o, l, h = this._getInst(t); return 2 === arguments.length && "string" == typeof i ? "defaults" === i ? e.extend({}, e.datepicker._defaults) : h ? "all" === i ? e.extend({}, h.settings) : this._get(h, i) : null : (a = i || {}, "string" == typeof i && (a = {}, a[i] = s), h && (this._curInst === h && this._hideDatepicker(), n = this._getDateDatepicker(t, !0), o = this._getMinMaxDate(h, "min"), l = this._getMinMaxDate(h, "max"), r(h.settings, a), null !== o && void 0 !== a.dateFormat && void 0 === a.minDate && (h.settings.minDate = this._formatDate(h, o)), null !== l && void 0 !== a.dateFormat && void 0 === a.maxDate && (h.settings.maxDate = this._formatDate(h, l)), "disabled" in a && (a.disabled ? this._disableDatepicker(t) : this._enableDatepicker(t)), this._attachments(e(t), h), this._autoSize(h), this._setDate(h, n), this._updateAlternate(h), this._updateDatepicker(h)), void 0) }, _changeDatepicker: function (e, t, i) { this._optionDatepicker(e, t, i) }, _refreshDatepicker: function (e) { var t = this._getInst(e); t && this._updateDatepicker(t) }, _setDateDatepicker: function (e, t) { var i = this._getInst(e); i && (this._setDate(i, t), this._updateDatepicker(i), this._updateAlternate(i)) }, _getDateDatepicker: function (e, t) { var i = this._getInst(e); return i && !i.inline && this._setDateFromField(i, t), i ? this._getDate(i) : null }, _doKeyDown: function (t) { var i, s, a, n = e.datepicker._getInst(t.target), r = !0, o = n.dpDiv.is(".ui-datepicker-rtl"); if (n._keyEvent = !0, e.datepicker._datepickerShowing) switch (t.keyCode) { case 9: e.datepicker._hideDatepicker(), r = !1; break; case 13: return a = e("td." + e.datepicker._dayOverClass + ":not(." + e.datepicker._currentClass + ")", n.dpDiv), a[0] && e.datepicker._selectDay(t.target, n.selectedMonth, n.selectedYear, a[0]), i = e.datepicker._get(n, "onSelect"), i ? (s = e.datepicker._formatDate(n), i.apply(n.input ? n.input[0] : null, [s, n])) : e.datepicker._hideDatepicker(), !1; case 27: e.datepicker._hideDatepicker(); break; case 33: e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(n, "stepBigMonths") : -e.datepicker._get(n, "stepMonths"), "M"); break; case 34: e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(n, "stepBigMonths") : +e.datepicker._get(n, "stepMonths"), "M"); break; case 35: (t.ctrlKey || t.metaKey) && e.datepicker._clearDate(t.target), r = t.ctrlKey || t.metaKey; break; case 36: (t.ctrlKey || t.metaKey) && e.datepicker._gotoToday(t.target), r = t.ctrlKey || t.metaKey; break; case 37: (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, o ? 1 : -1, "D"), r = t.ctrlKey || t.metaKey, t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? -e.datepicker._get(n, "stepBigMonths") : -e.datepicker._get(n, "stepMonths"), "M"); break; case 38: (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, -7, "D"), r = t.ctrlKey || t.metaKey; break; case 39: (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, o ? -1 : 1, "D"), r = t.ctrlKey || t.metaKey, t.originalEvent.altKey && e.datepicker._adjustDate(t.target, t.ctrlKey ? +e.datepicker._get(n, "stepBigMonths") : +e.datepicker._get(n, "stepMonths"), "M"); break; case 40: (t.ctrlKey || t.metaKey) && e.datepicker._adjustDate(t.target, 7, "D"), r = t.ctrlKey || t.metaKey; break; default: r = !1 } else 36 === t.keyCode && t.ctrlKey ? e.datepicker._showDatepicker(this) : r = !1; r && (t.preventDefault(), t.stopPropagation()) }, _doKeyPress: function (t) { var i, s, a = e.datepicker._getInst(t.target); return e.datepicker._get(a, "constrainInput") ? (i = e.datepicker._possibleChars(e.datepicker._get(a, "dateFormat")), s = String.fromCharCode(null == t.charCode ? t.keyCode : t.charCode), t.ctrlKey || t.metaKey || " " > s || !i || i.indexOf(s) > -1) : void 0 }, _doKeyUp: function (t) { var i, s = e.datepicker._getInst(t.target); if (s.input.val() !== s.lastVal) try { i = e.datepicker.parseDate(e.datepicker._get(s, "dateFormat"), s.input ? s.input.val() : null, e.datepicker._getFormatConfig(s)), i && (e.datepicker._setDateFromField(s), e.datepicker._updateAlternate(s), e.datepicker._updateDatepicker(s)) } catch (a) { } return !0 }, _showDatepicker: function (t) { if (t = t.target || t, "input" !== t.nodeName.toLowerCase() && (t = e("input", t.parentNode)[0]), !e.datepicker._isDisabledDatepicker(t) && e.datepicker._lastInput !== t) { var s, a, n, o, l, h, u; s = e.datepicker._getInst(t), e.datepicker._curInst && e.datepicker._curInst !== s && (e.datepicker._curInst.dpDiv.stop(!0, !0), s && e.datepicker._datepickerShowing && e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])), a = e.datepicker._get(s, "beforeShow"), n = a ? a.apply(t, [t, s]) : {}, n !== !1 && (r(s.settings, n), s.lastVal = null, e.datepicker._lastInput = t, e.datepicker._setDateFromField(s), e.datepicker._inDialog && (t.value = ""), e.datepicker._pos || (e.datepicker._pos = e.datepicker._findPos(t), e.datepicker._pos[1] += t.offsetHeight), o = !1, e(t).parents().each(function () { return o |= "fixed" === e(this).css("position"), !o }), l = { left: e.datepicker._pos[0], top: e.datepicker._pos[1] }, e.datepicker._pos = null, s.dpDiv.empty(), s.dpDiv.css({ position: "absolute", display: "block", top: "-1000px" }), e.datepicker._updateDatepicker(s), l = e.datepicker._checkOffset(s, l, o), s.dpDiv.css({ position: e.datepicker._inDialog && e.blockUI ? "static" : o ? "fixed" : "absolute", display: "none", left: l.left + "px", top: l.top + "px" }), s.inline || (h = e.datepicker._get(s, "showAnim"), u = e.datepicker._get(s, "duration"), s.dpDiv.css("z-index", i(e(t)) + 1), e.datepicker._datepickerShowing = !0, e.effects && e.effects.effect[h] ? s.dpDiv.show(h, e.datepicker._get(s, "showOptions"), u) : s.dpDiv[h || "show"](h ? u : null), e.datepicker._shouldFocusInput(s) && s.input.trigger("focus"), e.datepicker._curInst = s)) } }, _updateDatepicker: function (t) { this.maxRows = 4, p = t, t.dpDiv.empty().append(this._generateHTML(t)), this._attachHandlers(t); var i, s = this._getNumberOfMonths(t), a = s[1], r = 17, o = t.dpDiv.find("." + this._dayOverClass + " a"); o.length > 0 && n.apply(o.get(0)), t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""), a > 1 && t.dpDiv.addClass("ui-datepicker-multi-" + a).css("width", r * a + "em"), t.dpDiv[(1 !== s[0] || 1 !== s[1] ? "add" : "remove") + "Class"]("ui-datepicker-multi"), t.dpDiv[(this._get(t, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl"), t === e.datepicker._curInst && e.datepicker._datepickerShowing && e.datepicker._shouldFocusInput(t) && t.input.trigger("focus"), t.yearshtml && (i = t.yearshtml, setTimeout(function () { i === t.yearshtml && t.yearshtml && t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml), i = t.yearshtml = null }, 0)) }, _shouldFocusInput: function (e) { return e.input && e.input.is(":visible") && !e.input.is(":disabled") && !e.input.is(":focus") }, _checkOffset: function (t, i, s) { var a = t.dpDiv.outerWidth(), n = t.dpDiv.outerHeight(), r = t.input ? t.input.outerWidth() : 0, o = t.input ? t.input.outerHeight() : 0, l = document.documentElement.clientWidth + (s ? 0 : e(document).scrollLeft()), h = document.documentElement.clientHeight + (s ? 0 : e(document).scrollTop()); return i.left -= this._get(t, "isRTL") ? a - r : 0, i.left -= s && i.left === t.input.offset().left ? e(document).scrollLeft() : 0, i.top -= s && i.top === t.input.offset().top + o ? e(document).scrollTop() : 0, i.left -= Math.min(i.left, i.left + a > l && l > a ? Math.abs(i.left + a - l) : 0), i.top -= Math.min(i.top, i.top + n > h && h > n ? Math.abs(n + o) : 0), i }, _findPos: function (t) { for (var i, s = this._getInst(t), a = this._get(s, "isRTL"); t && ("hidden" === t.type || 1 !== t.nodeType || e.expr.filters.hidden(t));)t = t[a ? "previousSibling" : "nextSibling"]; return i = e(t).offset(), [i.left, i.top] }, _hideDatepicker: function (t) { var i, s, a, n, r = this._curInst; !r || t && r !== e.data(t, "datepicker") || this._datepickerShowing && (i = this._get(r, "showAnim"), s = this._get(r, "duration"), a = function () { e.datepicker._tidyDialog(r) }, e.effects && (e.effects.effect[i] || e.effects[i]) ? r.dpDiv.hide(i, e.datepicker._get(r, "showOptions"), s, a) : r.dpDiv["slideDown" === i ? "slideUp" : "fadeIn" === i ? "fadeOut" : "hide"](i ? s : null, a), i || a(), this._datepickerShowing = !1, n = this._get(r, "onClose"), n && n.apply(r.input ? r.input[0] : null, [r.input ? r.input.val() : "", r]), this._lastInput = null, this._inDialog && (this._dialogInput.css({ position: "absolute", left: "0", top: "-100px" }), e.blockUI && (e.unblockUI(), e("body").append(this.dpDiv))), this._inDialog = !1) }, _tidyDialog: function (e) { e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar") }, _checkExternalClick: function (t) { if (e.datepicker._curInst) { var i = e(t.target), s = e.datepicker._getInst(i[0]); (i[0].id !== e.datepicker._mainDivId && 0 === i.parents("#" + e.datepicker._mainDivId).length && !i.hasClass(e.datepicker.markerClassName) && !i.closest("." + e.datepicker._triggerClass).length && e.datepicker._datepickerShowing && (!e.datepicker._inDialog || !e.blockUI) || i.hasClass(e.datepicker.markerClassName) && e.datepicker._curInst !== s) && e.datepicker._hideDatepicker() } }, _adjustDate: function (t, i, s) { var a = e(t), n = this._getInst(a[0]); this._isDisabledDatepicker(a[0]) || (this._adjustInstDate(n, i + ("M" === s ? this._get(n, "showCurrentAtPos") : 0), s), this._updateDatepicker(n)) }, _gotoToday: function (t) { var i, s = e(t), a = this._getInst(s[0]); this._get(a, "gotoCurrent") && a.currentDay ? (a.selectedDay = a.currentDay, a.drawMonth = a.selectedMonth = a.currentMonth, a.drawYear = a.selectedYear = a.currentYear) : (i = new Date, a.selectedDay = i.getDate(), a.drawMonth = a.selectedMonth = i.getMonth(), a.drawYear = a.selectedYear = i.getFullYear()), this._notifyChange(a), this._adjustDate(s) }, _selectMonthYear: function (t, i, s) { var a = e(t), n = this._getInst(a[0]); n["selected" + ("M" === s ? "Month" : "Year")] = n["draw" + ("M" === s ? "Month" : "Year")] = parseInt(i.options[i.selectedIndex].value, 10), this._notifyChange(n), this._adjustDate(a) }, _selectDay: function (t, i, s, a) { var n, r = e(t); e(a).hasClass(this._unselectableClass) || this._isDisabledDatepicker(r[0]) || (n = this._getInst(r[0]), n.selectedDay = n.currentDay = e("a", a).html(), n.selectedMonth = n.currentMonth = i, n.selectedYear = n.currentYear = s, this._selectDate(t, this._formatDate(n, n.currentDay, n.currentMonth, n.currentYear))) }, _clearDate: function (t) { var i = e(t); this._selectDate(i, "") }, _selectDate: function (t, i) { var s, a = e(t), n = this._getInst(a[0]); i = null != i ? i : this._formatDate(n), n.input && n.input.val(i), this._updateAlternate(n), s = this._get(n, "onSelect"), s ? s.apply(n.input ? n.input[0] : null, [i, n]) : n.input && n.input.trigger("change"), n.inline ? this._updateDatepicker(n) : (this._hideDatepicker(), this._lastInput = n.input[0], "object" != typeof n.input[0] && n.input.trigger("focus"), this._lastInput = null) }, _updateAlternate: function (t) { var i, s, a, n = this._get(t, "altField"); n && (i = this._get(t, "altFormat") || this._get(t, "dateFormat"), s = this._getDate(t), a = this.formatDate(i, s, this._getFormatConfig(t)), e(n).val(a)) }, noWeekends: function (e) { var t = e.getDay(); return [t > 0 && 6 > t, ""] }, iso8601Week: function (e) { var t, i = new Date(e.getTime()); return i.setDate(i.getDate() + 4 - (i.getDay() || 7)), t = i.getTime(), i.setMonth(0), i.setDate(1), Math.floor(Math.round((t - i) / 864e5) / 7) + 1 }, parseDate: function (t, i, s) { if (null == t || null == i) throw "Invalid arguments"; if (i = "object" == typeof i ? "" + i : i + "", "" === i) return null; var a, n, r, o, l = 0, h = (s ? s.shortYearCutoff : null) || this._defaults.shortYearCutoff, u = "string" != typeof h ? h : (new Date).getFullYear() % 100 + parseInt(h, 10), d = (s ? s.dayNamesShort : null) || this._defaults.dayNamesShort, c = (s ? s.dayNames : null) || this._defaults.dayNames, p = (s ? s.monthNamesShort : null) || this._defaults.monthNamesShort, m = (s ? s.monthNames : null) || this._defaults.monthNames, f = -1, g = -1, v = -1, y = -1, _ = !1, b = function (e) { var i = t.length > a + 1 && t.charAt(a + 1) === e; return i && a++ , i }, k = function (e) { var t = b(e), s = "@" === e ? 14 : "!" === e ? 20 : "y" === e && t ? 4 : "o" === e ? 3 : 2, a = "y" === e ? s : 1, n = RegExp("^\\d{" + a + "," + s + "}"), r = i.substring(l).match(n); if (!r) throw "Missing number at position " + l; return l += r[0].length, parseInt(r[0], 10) }, x = function (t, s, a) { var n = -1, r = e.map(b(t) ? a : s, function (e, t) { return [[t, e]] }).sort(function (e, t) { return -(e[1].length - t[1].length) }); if (e.each(r, function (e, t) { var s = t[1]; return i.substr(l, s.length).toLowerCase() === s.toLowerCase() ? (n = t[0], l += s.length, !1) : void 0 }), -1 !== n) return n + 1; throw "Unknown name at position " + l }, D = function () { if (i.charAt(l) !== t.charAt(a)) throw "Unexpected literal at position " + l; l++ }; for (a = 0; t.length > a; a++)if (_) "'" !== t.charAt(a) || b("'") ? D() : _ = !1; else switch (t.charAt(a)) { case "d": v = k("d"); break; case "D": x("D", d, c); break; case "o": y = k("o"); break; case "m": g = k("m"); break; case "M": g = x("M", p, m); break; case "y": f = k("y"); break; case "@": o = new Date(k("@")), f = o.getFullYear(), g = o.getMonth() + 1, v = o.getDate(); break; case "!": o = new Date((k("!") - this._ticksTo1970) / 1e4), f = o.getFullYear(), g = o.getMonth() + 1, v = o.getDate(); break; case "'": b("'") ? D() : _ = !0; break; default: D() }if (i.length > l && (r = i.substr(l), !/^\s+/.test(r))) throw "Extra/unparsed characters found in date: " + r; if (-1 === f ? f = (new Date).getFullYear() : 100 > f && (f += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (u >= f ? 0 : -100)), y > -1) for (g = 1, v = y; ;) { if (n = this._getDaysInMonth(f, g - 1), n >= v) break; g++ , v -= n } if (o = this._daylightSavingAdjust(new Date(f, g - 1, v)), o.getFullYear() !== f || o.getMonth() + 1 !== g || o.getDate() !== v) throw "Invalid date"; return o }, ATOM: "yy-mm-dd", COOKIE: "D, dd M yy", ISO_8601: "yy-mm-dd", RFC_822: "D, d M y", RFC_850: "DD, dd-M-y", RFC_1036: "D, d M y", RFC_1123: "D, d M yy", RFC_2822: "D, d M yy", RSS: "D, d M y", TICKS: "!", TIMESTAMP: "@", W3C: "yy-mm-dd", _ticksTo1970: 1e7 * 60 * 60 * 24 * (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)), formatDate: function (e, t, i) { if (!t) return ""; var s, a = (i ? i.dayNamesShort : null) || this._defaults.dayNamesShort, n = (i ? i.dayNames : null) || this._defaults.dayNames, r = (i ? i.monthNamesShort : null) || this._defaults.monthNamesShort, o = (i ? i.monthNames : null) || this._defaults.monthNames, l = function (t) { var i = e.length > s + 1 && e.charAt(s + 1) === t; return i && s++ , i }, h = function (e, t, i) { var s = "" + t; if (l(e)) for (; i > s.length;)s = "0" + s; return s }, u = function (e, t, i, s) { return l(e) ? s[t] : i[t] }, d = "", c = !1; if (t) for (s = 0; e.length > s; s++)if (c) "'" !== e.charAt(s) || l("'") ? d += e.charAt(s) : c = !1; else switch (e.charAt(s)) { case "d": d += h("d", t.getDate(), 2); break; case "D": d += u("D", t.getDay(), a, n); break; case "o": d += h("o", Math.round((new Date(t.getFullYear(), t.getMonth(), t.getDate()).getTime() - new Date(t.getFullYear(), 0, 0).getTime()) / 864e5), 3); break; case "m": d += h("m", t.getMonth() + 1, 2); break; case "M": d += u("M", t.getMonth(), r, o); break; case "y": d += l("y") ? t.getFullYear() : (10 > t.getFullYear() % 100 ? "0" : "") + t.getFullYear() % 100; break; case "@": d += t.getTime(); break; case "!": d += 1e4 * t.getTime() + this._ticksTo1970; break; case "'": l("'") ? d += "'" : c = !0; break; default: d += e.charAt(s) }return d }, _possibleChars: function (e) { var t, i = "", s = !1, a = function (i) { var s = e.length > t + 1 && e.charAt(t + 1) === i; return s && t++ , s }; for (t = 0; e.length > t; t++)if (s) "'" !== e.charAt(t) || a("'") ? i += e.charAt(t) : s = !1; else switch (e.charAt(t)) { case "d": case "m": case "y": case "@": i += "0123456789"; break; case "D": case "M": return null; case "'": a("'") ? i += "'" : s = !0; break; default: i += e.charAt(t) }return i }, _get: function (e, t) { return void 0 !== e.settings[t] ? e.settings[t] : this._defaults[t] }, _setDateFromField: function (e, t) { if (e.input.val() !== e.lastVal) { var i = this._get(e, "dateFormat"), s = e.lastVal = e.input ? e.input.val() : null, a = this._getDefaultDate(e), n = a, r = this._getFormatConfig(e); try { n = this.parseDate(i, s, r) || a } catch (o) { s = t ? "" : s } e.selectedDay = n.getDate(), e.drawMonth = e.selectedMonth = n.getMonth(), e.drawYear = e.selectedYear = n.getFullYear(), e.currentDay = s ? n.getDate() : 0, e.currentMonth = s ? n.getMonth() : 0, e.currentYear = s ? n.getFullYear() : 0, this._adjustInstDate(e) } }, _getDefaultDate: function (e) { return this._restrictMinMax(e, this._determineDate(e, this._get(e, "defaultDate"), new Date)) }, _determineDate: function (t, i, s) { var a = function (e) { var t = new Date; return t.setDate(t.getDate() + e), t }, n = function (i) { try { return e.datepicker.parseDate(e.datepicker._get(t, "dateFormat"), i, e.datepicker._getFormatConfig(t)) } catch (s) { } for (var a = (i.toLowerCase().match(/^c/) ? e.datepicker._getDate(t) : null) || new Date, n = a.getFullYear(), r = a.getMonth(), o = a.getDate(), l = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g, h = l.exec(i); h;) { switch (h[2] || "d") { case "d": case "D": o += parseInt(h[1], 10); break; case "w": case "W": o += 7 * parseInt(h[1], 10); break; case "m": case "M": r += parseInt(h[1], 10), o = Math.min(o, e.datepicker._getDaysInMonth(n, r)); break; case "y": case "Y": n += parseInt(h[1], 10), o = Math.min(o, e.datepicker._getDaysInMonth(n, r)) }h = l.exec(i) } return new Date(n, r, o) }, r = null == i || "" === i ? s : "string" == typeof i ? n(i) : "number" == typeof i ? isNaN(i) ? s : a(i) : new Date(i.getTime()); return r = r && "Invalid Date" == "" + r ? s : r, r && (r.setHours(0), r.setMinutes(0), r.setSeconds(0), r.setMilliseconds(0)), this._daylightSavingAdjust(r) }, _daylightSavingAdjust: function (e) { return e ? (e.setHours(e.getHours() > 12 ? e.getHours() + 2 : 0), e) : null }, _setDate: function (e, t, i) { var s = !t, a = e.selectedMonth, n = e.selectedYear, r = this._restrictMinMax(e, this._determineDate(e, t, new Date)); e.selectedDay = e.currentDay = r.getDate(), e.drawMonth = e.selectedMonth = e.currentMonth = r.getMonth(), e.drawYear = e.selectedYear = e.currentYear = r.getFullYear(), a === e.selectedMonth && n === e.selectedYear || i || this._notifyChange(e), this._adjustInstDate(e), e.input && e.input.val(s ? "" : this._formatDate(e)) }, _getDate: function (e) { var t = !e.currentYear || e.input && "" === e.input.val() ? null : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay)); return t }, _attachHandlers: function (t) { var i = this._get(t, "stepMonths"), s = "#" + t.id.replace(/\\\\/g, "\\"); t.dpDiv.find("[data-handler]").map(function () { var t = { prev: function () { e.datepicker._adjustDate(s, -i, "M") }, next: function () { e.datepicker._adjustDate(s, +i, "M") }, hide: function () { e.datepicker._hideDatepicker() }, today: function () { e.datepicker._gotoToday(s) }, selectDay: function () { return e.datepicker._selectDay(s, +this.getAttribute("data-month"), +this.getAttribute("data-year"), this), !1 }, selectMonth: function () { return e.datepicker._selectMonthYear(s, this, "M"), !1 }, selectYear: function () { return e.datepicker._selectMonthYear(s, this, "Y"), !1 } }; e(this).on(this.getAttribute("data-event"), t[this.getAttribute("data-handler")]) }) }, _generateHTML: function (e) {
                    var t, i, s, a, n, r, o, l, h, u, d, c, p, m, f, g, v, y, _, b, k, x, D, w, T, S, M, N, C, A, I, P, F, j, H, z, L, O, E, R = new Date, W = this._daylightSavingAdjust(new Date(R.getFullYear(), R.getMonth(), R.getDate())), Y = this._get(e, "isRTL"), J = this._get(e, "showButtonPanel"), B = this._get(e, "hideIfNoPrevNext"), Q = this._get(e, "navigationAsDateFormat"), K = this._getNumberOfMonths(e), V = this._get(e, "showCurrentAtPos"), U = this._get(e, "stepMonths"), q = 1 !== K[0] || 1 !== K[1], G = this._daylightSavingAdjust(e.currentDay ? new Date(e.currentYear, e.currentMonth, e.currentDay) : new Date(9999, 9, 9)), X = this._getMinMaxDate(e, "min"), $ = this._getMinMaxDate(e, "max"), Z = e.drawMonth - V, et = e.drawYear; if (0 > Z && (Z += 12, et--), $) for (t = this._daylightSavingAdjust(new Date($.getFullYear(), $.getMonth() - K[0] * K[1] + 1, $.getDate())), t = X && X > t ? X : t; this._daylightSavingAdjust(new Date(et, Z, 1)) > t;)Z-- , 0 > Z && (Z = 11, et--); for (e.drawMonth = Z, e.drawYear = et, i = this._get(e, "prevText"), i = Q ? this.formatDate(i, this._daylightSavingAdjust(new Date(et, Z - U, 1)), this._getFormatConfig(e)) : i, s = this._canAdjustMonth(e, -1, et, Z) ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (Y ? "e" : "w") + "'>" + i + "</span></a>" : B ? "" : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" + i + "'><span class='ui-icon ui-icon-circle-triangle-" + (Y ? "e" : "w") + "'>" + i + "</span></a>", a = this._get(e, "nextText"), a = Q ? this.formatDate(a, this._daylightSavingAdjust(new Date(et, Z + U, 1)), this._getFormatConfig(e)) : a, n = this._canAdjustMonth(e, 1, et, Z) ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='" + a + "'><span class='ui-icon ui-icon-circle-triangle-" + (Y ? "w" : "e") + "'>" + a + "</span></a>" : B ? "" : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" + a + "'><span class='ui-icon ui-icon-circle-triangle-" + (Y ? "w" : "e") + "'>" + a + "</span></a>", r = this._get(e, "currentText"), o = this._get(e, "gotoCurrent") && e.currentDay ? G : W, r = Q ? this.formatDate(r, o, this._getFormatConfig(e)) : r, l = e.inline ? "" : "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" + this._get(e, "closeText") + "</button>", h = J ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" + (Y ? l : "") + (this._isInRange(e, o) ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>" + r + "</button>" : "") + (Y ? "" : l) + "</div>" : "", u = parseInt(this._get(e, "firstDay"), 10), u = isNaN(u) ? 0 : u, d = this._get(e, "showWeek"), c = this._get(e, "dayNames"), p = this._get(e, "dayNamesMin"), m = this._get(e, "monthNames"), f = this._get(e, "monthNamesShort"), g = this._get(e, "beforeShowDay"), v = this._get(e, "showOtherMonths"), y = this._get(e, "selectOtherMonths"), _ = this._getDefaultDate(e), b = "", x = 0; K[0] > x; x++) {
                        for (D = "", this.maxRows = 4, w = 0; K[1] > w; w++) {
                            if (T = this._daylightSavingAdjust(new Date(et, Z, e.selectedDay)), S = " ui-corner-all", M = "", q) {
                                if (M += "<div class='ui-datepicker-group", K[1] > 1) switch (w) {
                                    case 0: M += " ui-datepicker-group-first", S = " ui-corner-" + (Y ? "right" : "left");
                                        break; case K[1] - 1: M += " ui-datepicker-group-last", S = " ui-corner-" + (Y ? "left" : "right"); break; default: M += " ui-datepicker-group-middle", S = ""
                                }M += "'>"
                            } for (M += "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" + S + "'>" + (/all|left/.test(S) && 0 === x ? Y ? n : s : "") + (/all|right/.test(S) && 0 === x ? Y ? s : n : "") + this._generateMonthYearHeader(e, Z, et, X, $, x > 0 || w > 0, m, f) + "</div><table class='ui-datepicker-calendar'><thead>" + "<tr>", N = d ? "<th class='ui-datepicker-week-col'>" + this._get(e, "weekHeader") + "</th>" : "", k = 0; 7 > k; k++)C = (k + u) % 7, N += "<th scope='col'" + ((k + u + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : "") + ">" + "<span title='" + c[C] + "'>" + p[C] + "</span></th>"; for (M += N + "</tr></thead><tbody>", A = this._getDaysInMonth(et, Z), et === e.selectedYear && Z === e.selectedMonth && (e.selectedDay = Math.min(e.selectedDay, A)), I = (this._getFirstDayOfMonth(et, Z) - u + 7) % 7, P = Math.ceil((I + A) / 7), F = q ? this.maxRows > P ? this.maxRows : P : P, this.maxRows = F, j = this._daylightSavingAdjust(new Date(et, Z, 1 - I)), H = 0; F > H; H++) { for (M += "<tr>", z = d ? "<td class='ui-datepicker-week-col'>" + this._get(e, "calculateWeek")(j) + "</td>" : "", k = 0; 7 > k; k++)L = g ? g.apply(e.input ? e.input[0] : null, [j]) : [!0, ""], O = j.getMonth() !== Z, E = O && !y || !L[0] || X && X > j || $ && j > $, z += "<td class='" + ((k + u + 6) % 7 >= 5 ? " ui-datepicker-week-end" : "") + (O ? " ui-datepicker-other-month" : "") + (j.getTime() === T.getTime() && Z === e.selectedMonth && e._keyEvent || _.getTime() === j.getTime() && _.getTime() === T.getTime() ? " " + this._dayOverClass : "") + (E ? " " + this._unselectableClass + " ui-state-disabled" : "") + (O && !v ? "" : " " + L[1] + (j.getTime() === G.getTime() ? " " + this._currentClass : "") + (j.getTime() === W.getTime() ? " ui-datepicker-today" : "")) + "'" + (O && !v || !L[2] ? "" : " title='" + L[2].replace(/'/g, "&#39;") + "'") + (E ? "" : " data-handler='selectDay' data-event='click' data-month='" + j.getMonth() + "' data-year='" + j.getFullYear() + "'") + ">" + (O && !v ? "&#xa0;" : E ? "<span class='ui-state-default'>" + j.getDate() + "</span>" : "<a class='ui-state-default" + (j.getTime() === W.getTime() ? " ui-state-highlight" : "") + (j.getTime() === G.getTime() ? " ui-state-active" : "") + (O ? " ui-priority-secondary" : "") + "' href='#'>" + j.getDate() + "</a>") + "</td>", j.setDate(j.getDate() + 1), j = this._daylightSavingAdjust(j); M += z + "</tr>" } Z++ , Z > 11 && (Z = 0, et++), M += "</tbody></table>" + (q ? "</div>" + (K[0] > 0 && w === K[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : "") : ""), D += M
                        } b += D
                    } return b += h, e._keyEvent = !1, b
                }, _generateMonthYearHeader: function (e, t, i, s, a, n, r, o) { var l, h, u, d, c, p, m, f, g = this._get(e, "changeMonth"), v = this._get(e, "changeYear"), y = this._get(e, "showMonthAfterYear"), _ = "<div class='ui-datepicker-title'>", b = ""; if (n || !g) b += "<span class='ui-datepicker-month'>" + r[t] + "</span>"; else { for (l = s && s.getFullYear() === i, h = a && a.getFullYear() === i, b += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>", u = 0; 12 > u; u++)(!l || u >= s.getMonth()) && (!h || a.getMonth() >= u) && (b += "<option value='" + u + "'" + (u === t ? " selected='selected'" : "") + ">" + o[u] + "</option>"); b += "</select>" } if (y || (_ += b + (!n && g && v ? "" : "&#xa0;")), !e.yearshtml) if (e.yearshtml = "", n || !v) _ += "<span class='ui-datepicker-year'>" + i + "</span>"; else { for (d = this._get(e, "yearRange").split(":"), c = (new Date).getFullYear(), p = function (e) { var t = e.match(/c[+\-].*/) ? i + parseInt(e.substring(1), 10) : e.match(/[+\-].*/) ? c + parseInt(e, 10) : parseInt(e, 10); return isNaN(t) ? c : t }, m = p(d[0]), f = Math.max(m, p(d[1] || "")), m = s ? Math.max(m, s.getFullYear()) : m, f = a ? Math.min(f, a.getFullYear()) : f, e.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>"; f >= m; m++)e.yearshtml += "<option value='" + m + "'" + (m === i ? " selected='selected'" : "") + ">" + m + "</option>"; e.yearshtml += "</select>", _ += e.yearshtml, e.yearshtml = null } return _ += this._get(e, "yearSuffix"), y && (_ += (!n && g && v ? "" : "&#xa0;") + b), _ += "</div>" }, _adjustInstDate: function (e, t, i) { var s = e.selectedYear + ("Y" === i ? t : 0), a = e.selectedMonth + ("M" === i ? t : 0), n = Math.min(e.selectedDay, this._getDaysInMonth(s, a)) + ("D" === i ? t : 0), r = this._restrictMinMax(e, this._daylightSavingAdjust(new Date(s, a, n))); e.selectedDay = r.getDate(), e.drawMonth = e.selectedMonth = r.getMonth(), e.drawYear = e.selectedYear = r.getFullYear(), ("M" === i || "Y" === i) && this._notifyChange(e) }, _restrictMinMax: function (e, t) { var i = this._getMinMaxDate(e, "min"), s = this._getMinMaxDate(e, "max"), a = i && i > t ? i : t; return s && a > s ? s : a }, _notifyChange: function (e) { var t = this._get(e, "onChangeMonthYear"); t && t.apply(e.input ? e.input[0] : null, [e.selectedYear, e.selectedMonth + 1, e]) }, _getNumberOfMonths: function (e) { var t = this._get(e, "numberOfMonths"); return null == t ? [1, 1] : "number" == typeof t ? [1, t] : t }, _getMinMaxDate: function (e, t) { return this._determineDate(e, this._get(e, t + "Date"), null) }, _getDaysInMonth: function (e, t) { return 32 - this._daylightSavingAdjust(new Date(e, t, 32)).getDate() }, _getFirstDayOfMonth: function (e, t) { return new Date(e, t, 1).getDay() }, _canAdjustMonth: function (e, t, i, s) { var a = this._getNumberOfMonths(e), n = this._daylightSavingAdjust(new Date(i, s + (0 > t ? t : a[0] * a[1]), 1)); return 0 > t && n.setDate(this._getDaysInMonth(n.getFullYear(), n.getMonth())), this._isInRange(e, n) }, _isInRange: function (e, t) { var i, s, a = this._getMinMaxDate(e, "min"), n = this._getMinMaxDate(e, "max"), r = null, o = null, l = this._get(e, "yearRange"); return l && (i = l.split(":"), s = (new Date).getFullYear(), r = parseInt(i[0], 10), o = parseInt(i[1], 10), i[0].match(/[+\-].*/) && (r += s), i[1].match(/[+\-].*/) && (o += s)), (!a || t.getTime() >= a.getTime()) && (!n || t.getTime() <= n.getTime()) && (!r || t.getFullYear() >= r) && (!o || o >= t.getFullYear()) }, _getFormatConfig: function (e) { var t = this._get(e, "shortYearCutoff"); return t = "string" != typeof t ? t : (new Date).getFullYear() % 100 + parseInt(t, 10), { shortYearCutoff: t, dayNamesShort: this._get(e, "dayNamesShort"), dayNames: this._get(e, "dayNames"), monthNamesShort: this._get(e, "monthNamesShort"), monthNames: this._get(e, "monthNames") } }, _formatDate: function (e, t, i, s) { t || (e.currentDay = e.selectedDay, e.currentMonth = e.selectedMonth, e.currentYear = e.selectedYear); var a = t ? "object" == typeof t ? t : this._daylightSavingAdjust(new Date(s, i, t)) : this._daylightSavingAdjust(new Date(e.currentYear, e.currentMonth, e.currentDay)); return this.formatDate(this._get(e, "dateFormat"), a, this._getFormatConfig(e)) }
            }), e.fn.datepicker = function (t) { if (!this.length) return this; e.datepicker.initialized || (e(document).on("mousedown", e.datepicker._checkExternalClick), e.datepicker.initialized = !0), 0 === e("#" + e.datepicker._mainDivId).length && e("body").append(e.datepicker.dpDiv); var i = Array.prototype.slice.call(arguments, 1); return "string" != typeof t || "isDisabled" !== t && "getDate" !== t && "widget" !== t ? "option" === t && 2 === arguments.length && "string" == typeof arguments[1] ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(i)) : this.each(function () { "string" == typeof t ? e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this].concat(i)) : e.datepicker._attachDatepicker(this, t) }) : e.datepicker["_" + t + "Datepicker"].apply(e.datepicker, [this[0]].concat(i)) }, e.datepicker = new s, e.datepicker.initialized = !1, e.datepicker.uuid = (new Date).getTime(), e.datepicker.version = "1.12.1", e.datepicker, e.widget("ui.dialog", { version: "1.12.1", options: { appendTo: "body", autoOpen: !0, buttons: [], classes: { "ui-dialog": "ui-corner-all", "ui-dialog-titlebar": "ui-corner-all" }, closeOnEscape: !0, closeText: "Close", draggable: !0, hide: null, height: "auto", maxHeight: null, maxWidth: null, minHeight: 150, minWidth: 150, modal: !1, position: { my: "center", at: "center", of: window, collision: "fit", using: function (t) { var i = e(this).css(t).offset().top; 0 > i && e(this).css("top", t.top - i) } }, resizable: !0, show: null, title: null, width: 300, beforeClose: null, close: null, drag: null, dragStart: null, dragStop: null, focus: null, open: null, resize: null, resizeStart: null, resizeStop: null }, sizeRelatedOptions: { buttons: !0, height: !0, maxHeight: !0, maxWidth: !0, minHeight: !0, minWidth: !0, width: !0 }, resizableRelatedOptions: { maxHeight: !0, maxWidth: !0, minHeight: !0, minWidth: !0 }, _create: function () { this.originalCss = { display: this.element[0].style.display, width: this.element[0].style.width, minHeight: this.element[0].style.minHeight, maxHeight: this.element[0].style.maxHeight, height: this.element[0].style.height }, this.originalPosition = { parent: this.element.parent(), index: this.element.parent().children().index(this.element) }, this.originalTitle = this.element.attr("title"), null == this.options.title && null != this.originalTitle && (this.options.title = this.originalTitle), this.options.disabled && (this.options.disabled = !1), this._createWrapper(), this.element.show().removeAttr("title").appendTo(this.uiDialog), this._addClass("ui-dialog-content", "ui-widget-content"), this._createTitlebar(), this._createButtonPane(), this.options.draggable && e.fn.draggable && this._makeDraggable(), this.options.resizable && e.fn.resizable && this._makeResizable(), this._isOpen = !1, this._trackFocus() }, _init: function () { this.options.autoOpen && this.open() }, _appendTo: function () { var t = this.options.appendTo; return t && (t.jquery || t.nodeType) ? e(t) : this.document.find(t || "body").eq(0) }, _destroy: function () { var e, t = this.originalPosition; this._untrackInstance(), this._destroyOverlay(), this.element.removeUniqueId().css(this.originalCss).detach(), this.uiDialog.remove(), this.originalTitle && this.element.attr("title", this.originalTitle), e = t.parent.children().eq(t.index), e.length && e[0] !== this.element[0] ? e.before(this.element) : t.parent.append(this.element) }, widget: function () { return this.uiDialog }, disable: e.noop, enable: e.noop, close: function (t) { var i = this; this._isOpen && this._trigger("beforeClose", t) !== !1 && (this._isOpen = !1, this._focusedElement = null, this._destroyOverlay(), this._untrackInstance(), this.opener.filter(":focusable").trigger("focus").length || e.ui.safeBlur(e.ui.safeActiveElement(this.document[0])), this._hide(this.uiDialog, this.options.hide, function () { i._trigger("close", t) })) }, isOpen: function () { return this._isOpen }, moveToTop: function () { this._moveToTop() }, _moveToTop: function (t, i) { var s = !1, a = this.uiDialog.siblings(".ui-front:visible").map(function () { return +e(this).css("z-index") }).get(), n = Math.max.apply(null, a); return n >= +this.uiDialog.css("z-index") && (this.uiDialog.css("z-index", n + 1), s = !0), s && !i && this._trigger("focus", t), s }, open: function () { var t = this; return this._isOpen ? (this._moveToTop() && this._focusTabbable(), void 0) : (this._isOpen = !0, this.opener = e(e.ui.safeActiveElement(this.document[0])), this._size(), this._position(), this._createOverlay(), this._moveToTop(null, !0), this.overlay && this.overlay.css("z-index", this.uiDialog.css("z-index") - 1), this._show(this.uiDialog, this.options.show, function () { t._focusTabbable(), t._trigger("focus") }), this._makeFocusTarget(), this._trigger("open"), void 0) }, _focusTabbable: function () { var e = this._focusedElement; e || (e = this.element.find("[autofocus]")), e.length || (e = this.element.find(":tabbable")), e.length || (e = this.uiDialogButtonPane.find(":tabbable")), e.length || (e = this.uiDialogTitlebarClose.filter(":tabbable")), e.length || (e = this.uiDialog), e.eq(0).trigger("focus") }, _keepFocus: function (t) { function i() { var t = e.ui.safeActiveElement(this.document[0]), i = this.uiDialog[0] === t || e.contains(this.uiDialog[0], t); i || this._focusTabbable() } t.preventDefault(), i.call(this), this._delay(i) }, _createWrapper: function () { this.uiDialog = e("<div>").hide().attr({ tabIndex: -1, role: "dialog" }).appendTo(this._appendTo()), this._addClass(this.uiDialog, "ui-dialog", "ui-widget ui-widget-content ui-front"), this._on(this.uiDialog, { keydown: function (t) { if (this.options.closeOnEscape && !t.isDefaultPrevented() && t.keyCode && t.keyCode === e.ui.keyCode.ESCAPE) return t.preventDefault(), this.close(t), void 0; if (t.keyCode === e.ui.keyCode.TAB && !t.isDefaultPrevented()) { var i = this.uiDialog.find(":tabbable"), s = i.filter(":first"), a = i.filter(":last"); t.target !== a[0] && t.target !== this.uiDialog[0] || t.shiftKey ? t.target !== s[0] && t.target !== this.uiDialog[0] || !t.shiftKey || (this._delay(function () { a.trigger("focus") }), t.preventDefault()) : (this._delay(function () { s.trigger("focus") }), t.preventDefault()) } }, mousedown: function (e) { this._moveToTop(e) && this._focusTabbable() } }), this.element.find("[aria-describedby]").length || this.uiDialog.attr({ "aria-describedby": this.element.uniqueId().attr("id") }) }, _createTitlebar: function () { var t; this.uiDialogTitlebar = e("<div>"), this._addClass(this.uiDialogTitlebar, "ui-dialog-titlebar", "ui-widget-header ui-helper-clearfix"), this._on(this.uiDialogTitlebar, { mousedown: function (t) { e(t.target).closest(".ui-dialog-titlebar-close") || this.uiDialog.trigger("focus") } }), this.uiDialogTitlebarClose = e("<button type='button'></button>").button({ label: e("<a>").text(this.options.closeText).html(), icon: "ui-icon-closethick", showLabel: !1 }).appendTo(this.uiDialogTitlebar), this._addClass(this.uiDialogTitlebarClose, "ui-dialog-titlebar-close"), this._on(this.uiDialogTitlebarClose, { click: function (e) { e.preventDefault(), this.close(e) } }), t = e("<span>").uniqueId().prependTo(this.uiDialogTitlebar), this._addClass(t, "ui-dialog-title"), this._title(t), this.uiDialogTitlebar.prependTo(this.uiDialog), this.uiDialog.attr({ "aria-labelledby": t.attr("id") }) }, _title: function (e) { this.options.title ? e.text(this.options.title) : e.html("&#160;") }, _createButtonPane: function () { this.uiDialogButtonPane = e("<div>"), this._addClass(this.uiDialogButtonPane, "ui-dialog-buttonpane", "ui-widget-content ui-helper-clearfix"), this.uiButtonSet = e("<div>").appendTo(this.uiDialogButtonPane), this._addClass(this.uiButtonSet, "ui-dialog-buttonset"), this._createButtons() }, _createButtons: function () { var t = this, i = this.options.buttons; return this.uiDialogButtonPane.remove(), this.uiButtonSet.empty(), e.isEmptyObject(i) || e.isArray(i) && !i.length ? (this._removeClass(this.uiDialog, "ui-dialog-buttons"), void 0) : (e.each(i, function (i, s) { var a, n; s = e.isFunction(s) ? { click: s, text: i } : s, s = e.extend({ type: "button" }, s), a = s.click, n = { icon: s.icon, iconPosition: s.iconPosition, showLabel: s.showLabel, icons: s.icons, text: s.text }, delete s.click, delete s.icon, delete s.iconPosition, delete s.showLabel, delete s.icons, "boolean" == typeof s.text && delete s.text, e("<button></button>", s).button(n).appendTo(t.uiButtonSet).on("click", function () { a.apply(t.element[0], arguments) }) }), this._addClass(this.uiDialog, "ui-dialog-buttons"), this.uiDialogButtonPane.appendTo(this.uiDialog), void 0) }, _makeDraggable: function () { function t(e) { return { position: e.position, offset: e.offset } } var i = this, s = this.options; this.uiDialog.draggable({ cancel: ".ui-dialog-content, .ui-dialog-titlebar-close", handle: ".ui-dialog-titlebar", containment: "document", start: function (s, a) { i._addClass(e(this), "ui-dialog-dragging"), i._blockFrames(), i._trigger("dragStart", s, t(a)) }, drag: function (e, s) { i._trigger("drag", e, t(s)) }, stop: function (a, n) { var r = n.offset.left - i.document.scrollLeft(), o = n.offset.top - i.document.scrollTop(); s.position = { my: "left top", at: "left" + (r >= 0 ? "+" : "") + r + " " + "top" + (o >= 0 ? "+" : "") + o, of: i.window }, i._removeClass(e(this), "ui-dialog-dragging"), i._unblockFrames(), i._trigger("dragStop", a, t(n)) } }) }, _makeResizable: function () { function t(e) { return { originalPosition: e.originalPosition, originalSize: e.originalSize, position: e.position, size: e.size } } var i = this, s = this.options, a = s.resizable, n = this.uiDialog.css("position"), r = "string" == typeof a ? a : "n,e,s,w,se,sw,ne,nw"; this.uiDialog.resizable({ cancel: ".ui-dialog-content", containment: "document", alsoResize: this.element, maxWidth: s.maxWidth, maxHeight: s.maxHeight, minWidth: s.minWidth, minHeight: this._minHeight(), handles: r, start: function (s, a) { i._addClass(e(this), "ui-dialog-resizing"), i._blockFrames(), i._trigger("resizeStart", s, t(a)) }, resize: function (e, s) { i._trigger("resize", e, t(s)) }, stop: function (a, n) { var r = i.uiDialog.offset(), o = r.left - i.document.scrollLeft(), l = r.top - i.document.scrollTop(); s.height = i.uiDialog.height(), s.width = i.uiDialog.width(), s.position = { my: "left top", at: "left" + (o >= 0 ? "+" : "") + o + " " + "top" + (l >= 0 ? "+" : "") + l, of: i.window }, i._removeClass(e(this), "ui-dialog-resizing"), i._unblockFrames(), i._trigger("resizeStop", a, t(n)) } }).css("position", n) }, _trackFocus: function () { this._on(this.widget(), { focusin: function (t) { this._makeFocusTarget(), this._focusedElement = e(t.target) } }) }, _makeFocusTarget: function () { this._untrackInstance(), this._trackingInstances().unshift(this) }, _untrackInstance: function () { var t = this._trackingInstances(), i = e.inArray(this, t); -1 !== i && t.splice(i, 1) }, _trackingInstances: function () { var e = this.document.data("ui-dialog-instances"); return e || (e = [], this.document.data("ui-dialog-instances", e)), e }, _minHeight: function () { var e = this.options; return "auto" === e.height ? e.minHeight : Math.min(e.minHeight, e.height) }, _position: function () { var e = this.uiDialog.is(":visible"); e || this.uiDialog.show(), this.uiDialog.position(this.options.position), e || this.uiDialog.hide() }, _setOptions: function (t) { var i = this, s = !1, a = {}; e.each(t, function (e, t) { i._setOption(e, t), e in i.sizeRelatedOptions && (s = !0), e in i.resizableRelatedOptions && (a[e] = t) }), s && (this._size(), this._position()), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", a) }, _setOption: function (t, i) { var s, a, n = this.uiDialog; "disabled" !== t && (this._super(t, i), "appendTo" === t && this.uiDialog.appendTo(this._appendTo()), "buttons" === t && this._createButtons(), "closeText" === t && this.uiDialogTitlebarClose.button({ label: e("<a>").text("" + this.options.closeText).html() }), "draggable" === t && (s = n.is(":data(ui-draggable)"), s && !i && n.draggable("destroy"), !s && i && this._makeDraggable()), "position" === t && this._position(), "resizable" === t && (a = n.is(":data(ui-resizable)"), a && !i && n.resizable("destroy"), a && "string" == typeof i && n.resizable("option", "handles", i), a || i === !1 || this._makeResizable()), "title" === t && this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))) }, _size: function () { var e, t, i, s = this.options; this.element.show().css({ width: "auto", minHeight: 0, maxHeight: "none", height: 0 }), s.minWidth > s.width && (s.width = s.minWidth), e = this.uiDialog.css({ height: "auto", width: s.width }).outerHeight(), t = Math.max(0, s.minHeight - e), i = "number" == typeof s.maxHeight ? Math.max(0, s.maxHeight - e) : "none", "auto" === s.height ? this.element.css({ minHeight: t, maxHeight: i, height: "auto" }) : this.element.height(Math.max(0, s.height - e)), this.uiDialog.is(":data(ui-resizable)") && this.uiDialog.resizable("option", "minHeight", this._minHeight()) }, _blockFrames: function () { this.iframeBlocks = this.document.find("iframe").map(function () { var t = e(this); return e("<div>").css({ position: "absolute", width: t.outerWidth(), height: t.outerHeight() }).appendTo(t.parent()).offset(t.offset())[0] }) }, _unblockFrames: function () { this.iframeBlocks && (this.iframeBlocks.remove(), delete this.iframeBlocks) }, _allowInteraction: function (t) { return e(t.target).closest(".ui-dialog").length ? !0 : !!e(t.target).closest(".ui-datepicker").length }, _createOverlay: function () { if (this.options.modal) { var t = !0; this._delay(function () { t = !1 }), this.document.data("ui-dialog-overlays") || this._on(this.document, { focusin: function (e) { t || this._allowInteraction(e) || (e.preventDefault(), this._trackingInstances()[0]._focusTabbable()) } }), this.overlay = e("<div>").appendTo(this._appendTo()), this._addClass(this.overlay, null, "ui-widget-overlay ui-front"), this._on(this.overlay, { mousedown: "_keepFocus" }), this.document.data("ui-dialog-overlays", (this.document.data("ui-dialog-overlays") || 0) + 1) } }, _destroyOverlay: function () { if (this.options.modal && this.overlay) { var e = this.document.data("ui-dialog-overlays") - 1; e ? this.document.data("ui-dialog-overlays", e) : (this._off(this.document, "focusin"), this.document.removeData("ui-dialog-overlays")), this.overlay.remove(), this.overlay = null } } }), e.uiBackCompat !== !1 && e.widget("ui.dialog", e.ui.dialog, { options: { dialogClass: "" }, _createWrapper: function () { this._super(), this.uiDialog.addClass(this.options.dialogClass) }, _setOption: function (e, t) { "dialogClass" === e && this.uiDialog.removeClass(this.options.dialogClass).addClass(t), this._superApply(arguments) } }), e.ui.dialog, e.widget("ui.progressbar", { version: "1.12.1", options: { classes: { "ui-progressbar": "ui-corner-all", "ui-progressbar-value": "ui-corner-left", "ui-progressbar-complete": "ui-corner-right" }, max: 100, value: 0, change: null, complete: null }, min: 0, _create: function () { this.oldValue = this.options.value = this._constrainedValue(), this.element.attr({ role: "progressbar", "aria-valuemin": this.min }), this._addClass("ui-progressbar", "ui-widget ui-widget-content"), this.valueDiv = e("<div>").appendTo(this.element), this._addClass(this.valueDiv, "ui-progressbar-value", "ui-widget-header"), this._refreshValue() }, _destroy: function () { this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"), this.valueDiv.remove() }, value: function (e) { return void 0 === e ? this.options.value : (this.options.value = this._constrainedValue(e), this._refreshValue(), void 0) }, _constrainedValue: function (e) { return void 0 === e && (e = this.options.value), this.indeterminate = e === !1, "number" != typeof e && (e = 0), this.indeterminate ? !1 : Math.min(this.options.max, Math.max(this.min, e)) }, _setOptions: function (e) { var t = e.value; delete e.value, this._super(e), this.options.value = this._constrainedValue(t), this._refreshValue() }, _setOption: function (e, t) { "max" === e && (t = Math.max(this.min, t)), this._super(e, t) }, _setOptionDisabled: function (e) { this._super(e), this.element.attr("aria-disabled", e), this._toggleClass(null, "ui-state-disabled", !!e) }, _percentage: function () { return this.indeterminate ? 100 : 100 * (this.options.value - this.min) / (this.options.max - this.min) }, _refreshValue: function () { var t = this.options.value, i = this._percentage(); this.valueDiv.toggle(this.indeterminate || t > this.min).width(i.toFixed(0) + "%"), this._toggleClass(this.valueDiv, "ui-progressbar-complete", null, t === this.options.max)._toggleClass("ui-progressbar-indeterminate", null, this.indeterminate), this.indeterminate ? (this.element.removeAttr("aria-valuenow"), this.overlayDiv || (this.overlayDiv = e("<div>").appendTo(this.valueDiv), this._addClass(this.overlayDiv, "ui-progressbar-overlay"))) : (this.element.attr({ "aria-valuemax": this.options.max, "aria-valuenow": t }), this.overlayDiv && (this.overlayDiv.remove(), this.overlayDiv = null)), this.oldValue !== t && (this.oldValue = t, this._trigger("change")), t === this.options.max && this._trigger("complete") } }), e.widget("ui.selectmenu", [e.ui.formResetMixin, { version: "1.12.1", defaultElement: "<select>", options: { appendTo: null, classes: { "ui-selectmenu-button-open": "ui-corner-top", "ui-selectmenu-button-closed": "ui-corner-all" }, disabled: null, icons: { button: "ui-icon-triangle-1-s" }, position: { my: "left top", at: "left bottom", collision: "none" }, width: !1, change: null, close: null, focus: null, open: null, select: null }, _create: function () { var t = this.element.uniqueId().attr("id"); this.ids = { element: t, button: t + "-button", menu: t + "-menu" }, this._drawButton(), this._drawMenu(), this._bindFormResetHandler(), this._rendered = !1, this.menuItems = e() }, _drawButton: function () { var t, i = this, s = this._parseOption(this.element.find("option:selected"), this.element[0].selectedIndex); this.labels = this.element.labels().attr("for", this.ids.button), this._on(this.labels, { click: function (e) { this.button.focus(), e.preventDefault() } }), this.element.hide(), this.button = e("<span>", { tabindex: this.options.disabled ? -1 : 0, id: this.ids.button, role: "combobox", "aria-expanded": "false", "aria-autocomplete": "list", "aria-owns": this.ids.menu, "aria-haspopup": "true", title: this.element.attr("title") }).insertAfter(this.element), this._addClass(this.button, "ui-selectmenu-button ui-selectmenu-button-closed", "ui-button ui-widget"), t = e("<span>").appendTo(this.button), this._addClass(t, "ui-selectmenu-icon", "ui-icon " + this.options.icons.button), this.buttonItem = this._renderButtonItem(s).appendTo(this.button), this.options.width !== !1 && this._resizeButton(), this._on(this.button, this._buttonEvents), this.button.one("focusin", function () { i._rendered || i._refreshMenu() }) }, _drawMenu: function () { var t = this; this.menu = e("<ul>", { "aria-hidden": "true", "aria-labelledby": this.ids.button, id: this.ids.menu }), this.menuWrap = e("<div>").append(this.menu), this._addClass(this.menuWrap, "ui-selectmenu-menu", "ui-front"), this.menuWrap.appendTo(this._appendTo()), this.menuInstance = this.menu.menu({ classes: { "ui-menu": "ui-corner-bottom" }, role: "listbox", select: function (e, i) { e.preventDefault(), t._setSelection(), t._select(i.item.data("ui-selectmenu-item"), e) }, focus: function (e, i) { var s = i.item.data("ui-selectmenu-item"); null != t.focusIndex && s.index !== t.focusIndex && (t._trigger("focus", e, { item: s }), t.isOpen || t._select(s, e)), t.focusIndex = s.index, t.button.attr("aria-activedescendant", t.menuItems.eq(s.index).attr("id")) } }).menu("instance"), this.menuInstance._off(this.menu, "mouseleave"), this.menuInstance._closeOnDocumentClick = function () { return !1 }, this.menuInstance._isDivider = function () { return !1 } }, refresh: function () { this._refreshMenu(), this.buttonItem.replaceWith(this.buttonItem = this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item") || {})), null === this.options.width && this._resizeButton() }, _refreshMenu: function () { var e, t = this.element.find("option"); this.menu.empty(), this._parseOptions(t), this._renderMenu(this.menu, this.items), this.menuInstance.refresh(), this.menuItems = this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"), this._rendered = !0, t.length && (e = this._getSelectedItem(), this.menuInstance.focus(null, e), this._setAria(e.data("ui-selectmenu-item")), this._setOption("disabled", this.element.prop("disabled"))) }, open: function (e) { this.options.disabled || (this._rendered ? (this._removeClass(this.menu.find(".ui-state-active"), null, "ui-state-active"), this.menuInstance.focus(null, this._getSelectedItem())) : this._refreshMenu(), this.menuItems.length && (this.isOpen = !0, this._toggleAttr(), this._resizeMenu(), this._position(), this._on(this.document, this._documentClick), this._trigger("open", e))) }, _position: function () { this.menuWrap.position(e.extend({ of: this.button }, this.options.position)) }, close: function (e) { this.isOpen && (this.isOpen = !1, this._toggleAttr(), this.range = null, this._off(this.document), this._trigger("close", e)) }, widget: function () { return this.button }, menuWidget: function () { return this.menu }, _renderButtonItem: function (t) { var i = e("<span>"); return this._setText(i, t.label), this._addClass(i, "ui-selectmenu-text"), i }, _renderMenu: function (t, i) { var s = this, a = ""; e.each(i, function (i, n) { var r; n.optgroup !== a && (r = e("<li>", { text: n.optgroup }), s._addClass(r, "ui-selectmenu-optgroup", "ui-menu-divider" + (n.element.parent("optgroup").prop("disabled") ? " ui-state-disabled" : "")), r.appendTo(t), a = n.optgroup), s._renderItemData(t, n) }) }, _renderItemData: function (e, t) { return this._renderItem(e, t).data("ui-selectmenu-item", t) }, _renderItem: function (t, i) { var s = e("<li>"), a = e("<div>", { title: i.element.attr("title") }); return i.disabled && this._addClass(s, null, "ui-state-disabled"), this._setText(a, i.label), s.append(a).appendTo(t) }, _setText: function (e, t) { t ? e.text(t) : e.html("&#160;") }, _move: function (e, t) { var i, s, a = ".ui-menu-item"; this.isOpen ? i = this.menuItems.eq(this.focusIndex).parent("li") : (i = this.menuItems.eq(this.element[0].selectedIndex).parent("li"), a += ":not(.ui-state-disabled)"), s = "first" === e || "last" === e ? i["first" === e ? "prevAll" : "nextAll"](a).eq(-1) : i[e + "All"](a).eq(0), s.length && this.menuInstance.focus(t, s) }, _getSelectedItem: function () { return this.menuItems.eq(this.element[0].selectedIndex).parent("li") }, _toggle: function (e) { this[this.isOpen ? "close" : "open"](e) }, _setSelection: function () { var e; this.range && (window.getSelection ? (e = window.getSelection(), e.removeAllRanges(), e.addRange(this.range)) : this.range.select(), this.button.focus()) }, _documentClick: { mousedown: function (t) { this.isOpen && (e(t.target).closest(".ui-selectmenu-menu, #" + e.ui.escapeSelector(this.ids.button)).length || this.close(t)) } }, _buttonEvents: { mousedown: function () { var e; window.getSelection ? (e = window.getSelection(), e.rangeCount && (this.range = e.getRangeAt(0))) : this.range = document.selection.createRange() }, click: function (e) { this._setSelection(), this._toggle(e) }, keydown: function (t) { var i = !0; switch (t.keyCode) { case e.ui.keyCode.TAB: case e.ui.keyCode.ESCAPE: this.close(t), i = !1; break; case e.ui.keyCode.ENTER: this.isOpen && this._selectFocusedItem(t); break; case e.ui.keyCode.UP: t.altKey ? this._toggle(t) : this._move("prev", t); break; case e.ui.keyCode.DOWN: t.altKey ? this._toggle(t) : this._move("next", t); break; case e.ui.keyCode.SPACE: this.isOpen ? this._selectFocusedItem(t) : this._toggle(t); break; case e.ui.keyCode.LEFT: this._move("prev", t); break; case e.ui.keyCode.RIGHT: this._move("next", t); break; case e.ui.keyCode.HOME: case e.ui.keyCode.PAGE_UP: this._move("first", t); break; case e.ui.keyCode.END: case e.ui.keyCode.PAGE_DOWN: this._move("last", t); break; default: this.menu.trigger(t), i = !1 }i && t.preventDefault() } }, _selectFocusedItem: function (e) { var t = this.menuItems.eq(this.focusIndex).parent("li"); t.hasClass("ui-state-disabled") || this._select(t.data("ui-selectmenu-item"), e) }, _select: function (e, t) { var i = this.element[0].selectedIndex; this.element[0].selectedIndex = e.index, this.buttonItem.replaceWith(this.buttonItem = this._renderButtonItem(e)), this._setAria(e), this._trigger("select", t, { item: e }), e.index !== i && this._trigger("change", t, { item: e }), this.close(t) }, _setAria: function (e) { var t = this.menuItems.eq(e.index).attr("id"); this.button.attr({ "aria-labelledby": t, "aria-activedescendant": t }), this.menu.attr("aria-activedescendant", t) }, _setOption: function (e, t) { if ("icons" === e) { var i = this.button.find("span.ui-icon"); this._removeClass(i, null, this.options.icons.button)._addClass(i, null, t.button) } this._super(e, t), "appendTo" === e && this.menuWrap.appendTo(this._appendTo()), "width" === e && this._resizeButton() }, _setOptionDisabled: function (e) { this._super(e), this.menuInstance.option("disabled", e), this.button.attr("aria-disabled", e), this._toggleClass(this.button, null, "ui-state-disabled", e), this.element.prop("disabled", e), e ? (this.button.attr("tabindex", -1), this.close()) : this.button.attr("tabindex", 0) }, _appendTo: function () { var t = this.options.appendTo; return t && (t = t.jquery || t.nodeType ? e(t) : this.document.find(t).eq(0)), t && t[0] || (t = this.element.closest(".ui-front, dialog")), t.length || (t = this.document[0].body), t }, _toggleAttr: function () { this.button.attr("aria-expanded", this.isOpen), this._removeClass(this.button, "ui-selectmenu-button-" + (this.isOpen ? "closed" : "open"))._addClass(this.button, "ui-selectmenu-button-" + (this.isOpen ? "open" : "closed"))._toggleClass(this.menuWrap, "ui-selectmenu-open", null, this.isOpen), this.menu.attr("aria-hidden", !this.isOpen) }, _resizeButton: function () { var e = this.options.width; return e === !1 ? (this.button.css("width", ""), void 0) : (null === e && (e = this.element.show().outerWidth(), this.element.hide()), this.button.outerWidth(e), void 0) }, _resizeMenu: function () { this.menu.outerWidth(Math.max(this.button.outerWidth(), this.menu.width("").outerWidth() + 1)) }, _getCreateOptions: function () { var e = this._super(); return e.disabled = this.element.prop("disabled"), e }, _parseOptions: function (t) { var i = this, s = []; t.each(function (t, a) { s.push(i._parseOption(e(a), t)) }), this.items = s }, _parseOption: function (e, t) { var i = e.parent("optgroup"); return { element: e, index: t, value: e.val(), label: e.text(), optgroup: i.attr("label") || "", disabled: i.prop("disabled") || e.prop("disabled") } }, _destroy: function () { this._unbindFormResetHandler(), this.menuWrap.remove(), this.button.remove(), this.element.show(), this.element.removeUniqueId(), this.labels.attr("for", this.ids.element) } }]), e.widget("ui.slider", e.ui.mouse, {
                version: "1.12.1", widgetEventPrefix: "slide", options: { animate: !1, classes: { "ui-slider": "ui-corner-all", "ui-slider-handle": "ui-corner-all", "ui-slider-range": "ui-corner-all ui-widget-header" }, distance: 0, max: 100, min: 0, orientation: "horizontal", range: !1, step: 1, value: 0, values: null, change: null, slide: null, start: null, stop: null }, numPages: 5, _create: function () { this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this._calculateNewMax(), this._addClass("ui-slider ui-slider-" + this.orientation, "ui-widget ui-widget-content"), this._refresh(), this._animateOff = !1 }, _refresh: function () { this._createRange(), this._createHandles(), this._setupEvents(), this._refreshValue() }, _createHandles: function () { var t, i, s = this.options, a = this.element.find(".ui-slider-handle"), n = "<span tabindex='0'></span>", r = []; for (i = s.values && s.values.length || 1, a.length > i && (a.slice(i).remove(), a = a.slice(0, i)), t = a.length; i > t; t++)r.push(n); this.handles = a.add(e(r.join("")).appendTo(this.element)), this._addClass(this.handles, "ui-slider-handle", "ui-state-default"), this.handle = this.handles.eq(0), this.handles.each(function (t) { e(this).data("ui-slider-handle-index", t).attr("tabIndex", 0) }) }, _createRange: function () {
                    var t = this.options; t.range ? (t.range === !0 && (t.values ? t.values.length && 2 !== t.values.length ? t.values = [t.values[0], t.values[0]] : e.isArray(t.values) && (t.values = t.values.slice(0)) : t.values = [this._valueMin(), this._valueMin()]), this.range && this.range.length ? (this._removeClass(this.range, "ui-slider-range-min ui-slider-range-max"), this.range.css({ left: "", bottom: "" })) : (this.range = e("<div>").appendTo(this.element), this._addClass(this.range, "ui-slider-range")), ("min" === t.range || "max" === t.range) && this._addClass(this.range, "ui-slider-range-" + t.range)) : (this.range && this.range.remove(), this.range = null)
                }, _setupEvents: function () { this._off(this.handles), this._on(this.handles, this._handleEvents), this._hoverable(this.handles), this._focusable(this.handles) }, _destroy: function () { this.handles.remove(), this.range && this.range.remove(), this._mouseDestroy() }, _mouseCapture: function (t) { var i, s, a, n, r, o, l, h, u = this, d = this.options; return d.disabled ? !1 : (this.elementSize = { width: this.element.outerWidth(), height: this.element.outerHeight() }, this.elementOffset = this.element.offset(), i = { x: t.pageX, y: t.pageY }, s = this._normValueFromMouse(i), a = this._valueMax() - this._valueMin() + 1, this.handles.each(function (t) { var i = Math.abs(s - u.values(t)); (a > i || a === i && (t === u._lastChangedValue || u.values(t) === d.min)) && (a = i, n = e(this), r = t) }), o = this._start(t, r), o === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = r, this._addClass(n, null, "ui-state-active"), n.trigger("focus"), l = n.offset(), h = !e(t.target).parents().addBack().is(".ui-slider-handle"), this._clickOffset = h ? { left: 0, top: 0 } : { left: t.pageX - l.left - n.width() / 2, top: t.pageY - l.top - n.height() / 2 - (parseInt(n.css("borderTopWidth"), 10) || 0) - (parseInt(n.css("borderBottomWidth"), 10) || 0) + (parseInt(n.css("marginTop"), 10) || 0) }, this.handles.hasClass("ui-state-hover") || this._slide(t, r, s), this._animateOff = !0, !0)) }, _mouseStart: function () { return !0 }, _mouseDrag: function (e) { var t = { x: e.pageX, y: e.pageY }, i = this._normValueFromMouse(t); return this._slide(e, this._handleIndex, i), !1 }, _mouseStop: function (e) { return this._removeClass(this.handles, null, "ui-state-active"), this._mouseSliding = !1, this._stop(e, this._handleIndex), this._change(e, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1 }, _detectOrientation: function () { this.orientation = "vertical" === this.options.orientation ? "vertical" : "horizontal" }, _normValueFromMouse: function (e) { var t, i, s, a, n; return "horizontal" === this.orientation ? (t = this.elementSize.width, i = e.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, i = e.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), s = i / t, s > 1 && (s = 1), 0 > s && (s = 0), "vertical" === this.orientation && (s = 1 - s), a = this._valueMax() - this._valueMin(), n = this._valueMin() + s * a, this._trimAlignValue(n) }, _uiHash: function (e, t, i) { var s = { handle: this.handles[e], handleIndex: e, value: void 0 !== t ? t : this.value() }; return this._hasMultipleValues() && (s.value = void 0 !== t ? t : this.values(e), s.values = i || this.values()), s }, _hasMultipleValues: function () { return this.options.values && this.options.values.length }, _start: function (e, t) { return this._trigger("start", e, this._uiHash(t)) }, _slide: function (e, t, i) { var s, a, n = this.value(), r = this.values(); this._hasMultipleValues() && (a = this.values(t ? 0 : 1), n = this.values(t), 2 === this.options.values.length && this.options.range === !0 && (i = 0 === t ? Math.min(a, i) : Math.max(a, i)), r[t] = i), i !== n && (s = this._trigger("slide", e, this._uiHash(t, i, r)), s !== !1 && (this._hasMultipleValues() ? this.values(t, i) : this.value(i))) }, _stop: function (e, t) { this._trigger("stop", e, this._uiHash(t)) }, _change: function (e, t) { this._keySliding || this._mouseSliding || (this._lastChangedValue = t, this._trigger("change", e, this._uiHash(t))) }, value: function (e) { return arguments.length ? (this.options.value = this._trimAlignValue(e), this._refreshValue(), this._change(null, 0), void 0) : this._value() }, values: function (t, i) { var s, a, n; if (arguments.length > 1) return this.options.values[t] = this._trimAlignValue(i), this._refreshValue(), this._change(null, t), void 0; if (!arguments.length) return this._values(); if (!e.isArray(arguments[0])) return this._hasMultipleValues() ? this._values(t) : this.value(); for (s = this.options.values, a = arguments[0], n = 0; s.length > n; n += 1)s[n] = this._trimAlignValue(a[n]), this._change(null, n); this._refreshValue() }, _setOption: function (t, i) { var s, a = 0; switch ("range" === t && this.options.range === !0 && ("min" === i ? (this.options.value = this._values(0), this.options.values = null) : "max" === i && (this.options.value = this._values(this.options.values.length - 1), this.options.values = null)), e.isArray(this.options.values) && (a = this.options.values.length), this._super(t, i), t) { case "orientation": this._detectOrientation(), this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-" + this.orientation), this._refreshValue(), this.options.range && this._refreshRange(i), this.handles.css("horizontal" === i ? "bottom" : "left", ""); break; case "value": this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1; break; case "values": for (this._animateOff = !0, this._refreshValue(), s = a - 1; s >= 0; s--)this._change(null, s); this._animateOff = !1; break; case "step": case "min": case "max": this._animateOff = !0, this._calculateNewMax(), this._refreshValue(), this._animateOff = !1; break; case "range": this._animateOff = !0, this._refresh(), this._animateOff = !1 } }, _setOptionDisabled: function (e) { this._super(e), this._toggleClass(null, "ui-state-disabled", !!e) }, _value: function () { var e = this.options.value; return e = this._trimAlignValue(e) }, _values: function (e) { var t, i, s; if (arguments.length) return t = this.options.values[e], t = this._trimAlignValue(t); if (this._hasMultipleValues()) { for (i = this.options.values.slice(), s = 0; i.length > s; s += 1)i[s] = this._trimAlignValue(i[s]); return i } return [] }, _trimAlignValue: function (e) { if (this._valueMin() >= e) return this._valueMin(); if (e >= this._valueMax()) return this._valueMax(); var t = this.options.step > 0 ? this.options.step : 1, i = (e - this._valueMin()) % t, s = e - i; return 2 * Math.abs(i) >= t && (s += i > 0 ? t : -t), parseFloat(s.toFixed(5)) }, _calculateNewMax: function () { var e = this.options.max, t = this._valueMin(), i = this.options.step, s = Math.round((e - t) / i) * i; e = s + t, e > this.options.max && (e -= i), this.max = parseFloat(e.toFixed(this._precision())) }, _precision: function () { var e = this._precisionOf(this.options.step); return null !== this.options.min && (e = Math.max(e, this._precisionOf(this.options.min))), e }, _precisionOf: function (e) { var t = "" + e, i = t.indexOf("."); return -1 === i ? 0 : t.length - i - 1 }, _valueMin: function () { return this.options.min }, _valueMax: function () { return this.max }, _refreshRange: function (e) { "vertical" === e && this.range.css({ width: "", left: "" }), "horizontal" === e && this.range.css({ height: "", bottom: "" }) }, _refreshValue: function () { var t, i, s, a, n, r = this.options.range, o = this.options, l = this, h = this._animateOff ? !1 : o.animate, u = {}; this._hasMultipleValues() ? this.handles.each(function (s) { i = 100 * ((l.values(s) - l._valueMin()) / (l._valueMax() - l._valueMin())), u["horizontal" === l.orientation ? "left" : "bottom"] = i + "%", e(this).stop(1, 1)[h ? "animate" : "css"](u, o.animate), l.options.range === !0 && ("horizontal" === l.orientation ? (0 === s && l.range.stop(1, 1)[h ? "animate" : "css"]({ left: i + "%" }, o.animate), 1 === s && l.range[h ? "animate" : "css"]({ width: i - t + "%" }, { queue: !1, duration: o.animate })) : (0 === s && l.range.stop(1, 1)[h ? "animate" : "css"]({ bottom: i + "%" }, o.animate), 1 === s && l.range[h ? "animate" : "css"]({ height: i - t + "%" }, { queue: !1, duration: o.animate }))), t = i }) : (s = this.value(), a = this._valueMin(), n = this._valueMax(), i = n !== a ? 100 * ((s - a) / (n - a)) : 0, u["horizontal" === this.orientation ? "left" : "bottom"] = i + "%", this.handle.stop(1, 1)[h ? "animate" : "css"](u, o.animate), "min" === r && "horizontal" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({ width: i + "%" }, o.animate), "max" === r && "horizontal" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({ width: 100 - i + "%" }, o.animate), "min" === r && "vertical" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({ height: i + "%" }, o.animate), "max" === r && "vertical" === this.orientation && this.range.stop(1, 1)[h ? "animate" : "css"]({ height: 100 - i + "%" }, o.animate)) }, _handleEvents: { keydown: function (t) { var i, s, a, n, r = e(t.target).data("ui-slider-handle-index"); switch (t.keyCode) { case e.ui.keyCode.HOME: case e.ui.keyCode.END: case e.ui.keyCode.PAGE_UP: case e.ui.keyCode.PAGE_DOWN: case e.ui.keyCode.UP: case e.ui.keyCode.RIGHT: case e.ui.keyCode.DOWN: case e.ui.keyCode.LEFT: if (t.preventDefault(), !this._keySliding && (this._keySliding = !0, this._addClass(e(t.target), null, "ui-state-active"), i = this._start(t, r), i === !1)) return }switch (n = this.options.step, s = a = this._hasMultipleValues() ? this.values(r) : this.value(), t.keyCode) { case e.ui.keyCode.HOME: a = this._valueMin(); break; case e.ui.keyCode.END: a = this._valueMax(); break; case e.ui.keyCode.PAGE_UP: a = this._trimAlignValue(s + (this._valueMax() - this._valueMin()) / this.numPages); break; case e.ui.keyCode.PAGE_DOWN: a = this._trimAlignValue(s - (this._valueMax() - this._valueMin()) / this.numPages); break; case e.ui.keyCode.UP: case e.ui.keyCode.RIGHT: if (s === this._valueMax()) return; a = this._trimAlignValue(s + n); break; case e.ui.keyCode.DOWN: case e.ui.keyCode.LEFT: if (s === this._valueMin()) return; a = this._trimAlignValue(s - n) }this._slide(t, r, a) }, keyup: function (t) { var i = e(t.target).data("ui-slider-handle-index"); this._keySliding && (this._keySliding = !1, this._stop(t, i), this._change(t, i), this._removeClass(e(t.target), null, "ui-state-active")) } }
            }), e.widget("ui.spinner", { version: "1.12.1", defaultElement: "<input>", widgetEventPrefix: "spin", options: { classes: { "ui-spinner": "ui-corner-all", "ui-spinner-down": "ui-corner-br", "ui-spinner-up": "ui-corner-tr" }, culture: null, icons: { down: "ui-icon-triangle-1-s", up: "ui-icon-triangle-1-n" }, incremental: !0, max: null, min: null, numberFormat: null, page: 10, step: 1, change: null, spin: null, start: null, stop: null }, _create: function () { this._setOption("max", this.options.max), this._setOption("min", this.options.min), this._setOption("step", this.options.step), "" !== this.value() && this._value(this.element.val(), !0), this._draw(), this._on(this._events), this._refresh(), this._on(this.window, { beforeunload: function () { this.element.removeAttr("autocomplete") } }) }, _getCreateOptions: function () { var t = this._super(), i = this.element; return e.each(["min", "max", "step"], function (e, s) { var a = i.attr(s); null != a && a.length && (t[s] = a) }), t }, _events: { keydown: function (e) { this._start(e) && this._keydown(e) && e.preventDefault() }, keyup: "_stop", focus: function () { this.previous = this.element.val() }, blur: function (e) { return this.cancelBlur ? (delete this.cancelBlur, void 0) : (this._stop(), this._refresh(), this.previous !== this.element.val() && this._trigger("change", e), void 0) }, mousewheel: function (e, t) { if (t) { if (!this.spinning && !this._start(e)) return !1; this._spin((t > 0 ? 1 : -1) * this.options.step, e), clearTimeout(this.mousewheelTimer), this.mousewheelTimer = this._delay(function () { this.spinning && this._stop(e) }, 100), e.preventDefault() } }, "mousedown .ui-spinner-button": function (t) { function i() { var t = this.element[0] === e.ui.safeActiveElement(this.document[0]); t || (this.element.trigger("focus"), this.previous = s, this._delay(function () { this.previous = s })) } var s; s = this.element[0] === e.ui.safeActiveElement(this.document[0]) ? this.previous : this.element.val(), t.preventDefault(), i.call(this), this.cancelBlur = !0, this._delay(function () { delete this.cancelBlur, i.call(this) }), this._start(t) !== !1 && this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t) }, "mouseup .ui-spinner-button": "_stop", "mouseenter .ui-spinner-button": function (t) { return e(t.currentTarget).hasClass("ui-state-active") ? this._start(t) === !1 ? !1 : (this._repeat(null, e(t.currentTarget).hasClass("ui-spinner-up") ? 1 : -1, t), void 0) : void 0 }, "mouseleave .ui-spinner-button": "_stop" }, _enhance: function () { this.uiSpinner = this.element.attr("autocomplete", "off").wrap("<span>").parent().append("<a></a><a></a>") }, _draw: function () { this._enhance(), this._addClass(this.uiSpinner, "ui-spinner", "ui-widget ui-widget-content"), this._addClass("ui-spinner-input"), this.element.attr("role", "spinbutton"), this.buttons = this.uiSpinner.children("a").attr("tabIndex", -1).attr("aria-hidden", !0).button({ classes: { "ui-button": "" } }), this._removeClass(this.buttons, "ui-corner-all"), this._addClass(this.buttons.first(), "ui-spinner-button ui-spinner-up"), this._addClass(this.buttons.last(), "ui-spinner-button ui-spinner-down"), this.buttons.first().button({ icon: this.options.icons.up, showLabel: !1 }), this.buttons.last().button({ icon: this.options.icons.down, showLabel: !1 }), this.buttons.height() > Math.ceil(.5 * this.uiSpinner.height()) && this.uiSpinner.height() > 0 && this.uiSpinner.height(this.uiSpinner.height()) }, _keydown: function (t) { var i = this.options, s = e.ui.keyCode; switch (t.keyCode) { case s.UP: return this._repeat(null, 1, t), !0; case s.DOWN: return this._repeat(null, -1, t), !0; case s.PAGE_UP: return this._repeat(null, i.page, t), !0; case s.PAGE_DOWN: return this._repeat(null, -i.page, t), !0 }return !1 }, _start: function (e) { return this.spinning || this._trigger("start", e) !== !1 ? (this.counter || (this.counter = 1), this.spinning = !0, !0) : !1 }, _repeat: function (e, t, i) { e = e || 500, clearTimeout(this.timer), this.timer = this._delay(function () { this._repeat(40, t, i) }, e), this._spin(t * this.options.step, i) }, _spin: function (e, t) { var i = this.value() || 0; this.counter || (this.counter = 1), i = this._adjustValue(i + e * this._increment(this.counter)), this.spinning && this._trigger("spin", t, { value: i }) === !1 || (this._value(i), this.counter++) }, _increment: function (t) { var i = this.options.incremental; return i ? e.isFunction(i) ? i(t) : Math.floor(t * t * t / 5e4 - t * t / 500 + 17 * t / 200 + 1) : 1 }, _precision: function () { var e = this._precisionOf(this.options.step); return null !== this.options.min && (e = Math.max(e, this._precisionOf(this.options.min))), e }, _precisionOf: function (e) { var t = "" + e, i = t.indexOf("."); return -1 === i ? 0 : t.length - i - 1 }, _adjustValue: function (e) { var t, i, s = this.options; return t = null !== s.min ? s.min : 0, i = e - t, i = Math.round(i / s.step) * s.step, e = t + i, e = parseFloat(e.toFixed(this._precision())), null !== s.max && e > s.max ? s.max : null !== s.min && s.min > e ? s.min : e }, _stop: function (e) { this.spinning && (clearTimeout(this.timer), clearTimeout(this.mousewheelTimer), this.counter = 0, this.spinning = !1, this._trigger("stop", e)) }, _setOption: function (e, t) { var i, s, a; return "culture" === e || "numberFormat" === e ? (i = this._parse(this.element.val()), this.options[e] = t, this.element.val(this._format(i)), void 0) : (("max" === e || "min" === e || "step" === e) && "string" == typeof t && (t = this._parse(t)), "icons" === e && (s = this.buttons.first().find(".ui-icon"), this._removeClass(s, null, this.options.icons.up), this._addClass(s, null, t.up), a = this.buttons.last().find(".ui-icon"), this._removeClass(a, null, this.options.icons.down), this._addClass(a, null, t.down)), this._super(e, t), void 0) }, _setOptionDisabled: function (e) { this._super(e), this._toggleClass(this.uiSpinner, null, "ui-state-disabled", !!e), this.element.prop("disabled", !!e), this.buttons.button(e ? "disable" : "enable") }, _setOptions: o(function (e) { this._super(e) }), _parse: function (e) { return "string" == typeof e && "" !== e && (e = window.Globalize && this.options.numberFormat ? Globalize.parseFloat(e, 10, this.options.culture) : +e), "" === e || isNaN(e) ? null : e }, _format: function (e) { return "" === e ? "" : window.Globalize && this.options.numberFormat ? Globalize.format(e, this.options.numberFormat, this.options.culture) : e }, _refresh: function () { this.element.attr({ "aria-valuemin": this.options.min, "aria-valuemax": this.options.max, "aria-valuenow": this._parse(this.element.val()) }) }, isValid: function () { var e = this.value(); return null === e ? !1 : e === this._adjustValue(e) }, _value: function (e, t) { var i; "" !== e && (i = this._parse(e), null !== i && (t || (i = this._adjustValue(i)), e = this._format(i))), this.element.val(e), this._refresh() }, _destroy: function () { this.element.prop("disabled", !1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"), this.uiSpinner.replaceWith(this.element) }, stepUp: o(function (e) { this._stepUp(e) }), _stepUp: function (e) { this._start() && (this._spin((e || 1) * this.options.step), this._stop()) }, stepDown: o(function (e) { this._stepDown(e) }), _stepDown: function (e) { this._start() && (this._spin((e || 1) * -this.options.step), this._stop()) }, pageUp: o(function (e) { this._stepUp((e || 1) * this.options.page) }), pageDown: o(function (e) { this._stepDown((e || 1) * this.options.page) }), value: function (e) { return arguments.length ? (o(this._value).call(this, e), void 0) : this._parse(this.element.val()) }, widget: function () { return this.uiSpinner } }), e.uiBackCompat !== !1 && e.widget("ui.spinner", e.ui.spinner, { _enhance: function () { this.uiSpinner = this.element.attr("autocomplete", "off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml()) }, _uiSpinnerHtml: function () { return "<span>" }, _buttonHtml: function () { return "<a></a><a></a>" } }), e.ui.spinner, e.widget("ui.tabs", { version: "1.12.1", delay: 300, options: { active: null, classes: { "ui-tabs": "ui-corner-all", "ui-tabs-nav": "ui-corner-all", "ui-tabs-panel": "ui-corner-bottom", "ui-tabs-tab": "ui-corner-top" }, collapsible: !1, event: "click", heightStyle: "content", hide: null, show: null, activate: null, beforeActivate: null, beforeLoad: null, load: null }, _isLocal: function () { var e = /#.*$/; return function (t) { var i, s; i = t.href.replace(e, ""), s = location.href.replace(e, ""); try { i = decodeURIComponent(i) } catch (a) { } try { s = decodeURIComponent(s) } catch (a) { } return t.hash.length > 1 && i === s } }(), _create: function () { var t = this, i = this.options; this.running = !1, this._addClass("ui-tabs", "ui-widget ui-widget-content"), this._toggleClass("ui-tabs-collapsible", null, i.collapsible), this._processTabs(), i.active = this._initialActive(), e.isArray(i.disabled) && (i.disabled = e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"), function (e) { return t.tabs.index(e) }))).sort()), this.active = this.options.active !== !1 && this.anchors.length ? this._findActive(i.active) : e(), this._refresh(), this.active.length && this.load(i.active) }, _initialActive: function () { var t = this.options.active, i = this.options.collapsible, s = location.hash.substring(1); return null === t && (s && this.tabs.each(function (i, a) { return e(a).attr("aria-controls") === s ? (t = i, !1) : void 0 }), null === t && (t = this.tabs.index(this.tabs.filter(".ui-tabs-active"))), (null === t || -1 === t) && (t = this.tabs.length ? 0 : !1)), t !== !1 && (t = this.tabs.index(this.tabs.eq(t)), -1 === t && (t = i ? !1 : 0)), !i && t === !1 && this.anchors.length && (t = 0), t }, _getCreateEventData: function () { return { tab: this.active, panel: this.active.length ? this._getPanelForTab(this.active) : e() } }, _tabKeydown: function (t) { var i = e(e.ui.safeActiveElement(this.document[0])).closest("li"), s = this.tabs.index(i), a = !0; if (!this._handlePageNav(t)) { switch (t.keyCode) { case e.ui.keyCode.RIGHT: case e.ui.keyCode.DOWN: s++; break; case e.ui.keyCode.UP: case e.ui.keyCode.LEFT: a = !1, s--; break; case e.ui.keyCode.END: s = this.anchors.length - 1; break; case e.ui.keyCode.HOME: s = 0; break; case e.ui.keyCode.SPACE: return t.preventDefault(), clearTimeout(this.activating), this._activate(s), void 0; case e.ui.keyCode.ENTER: return t.preventDefault(), clearTimeout(this.activating), this._activate(s === this.options.active ? !1 : s), void 0; default: return }t.preventDefault(), clearTimeout(this.activating), s = this._focusNextTab(s, a), t.ctrlKey || t.metaKey || (i.attr("aria-selected", "false"), this.tabs.eq(s).attr("aria-selected", "true"), this.activating = this._delay(function () { this.option("active", s) }, this.delay)) } }, _panelKeydown: function (t) { this._handlePageNav(t) || t.ctrlKey && t.keyCode === e.ui.keyCode.UP && (t.preventDefault(), this.active.trigger("focus")) }, _handlePageNav: function (t) { return t.altKey && t.keyCode === e.ui.keyCode.PAGE_UP ? (this._activate(this._focusNextTab(this.options.active - 1, !1)), !0) : t.altKey && t.keyCode === e.ui.keyCode.PAGE_DOWN ? (this._activate(this._focusNextTab(this.options.active + 1, !0)), !0) : void 0 }, _findNextTab: function (t, i) { function s() { return t > a && (t = 0), 0 > t && (t = a), t } for (var a = this.tabs.length - 1; -1 !== e.inArray(s(), this.options.disabled);)t = i ? t + 1 : t - 1; return t }, _focusNextTab: function (e, t) { return e = this._findNextTab(e, t), this.tabs.eq(e).trigger("focus"), e }, _setOption: function (e, t) { return "active" === e ? (this._activate(t), void 0) : (this._super(e, t), "collapsible" === e && (this._toggleClass("ui-tabs-collapsible", null, t), t || this.options.active !== !1 || this._activate(0)), "event" === e && this._setupEvents(t), "heightStyle" === e && this._setupHeightStyle(t), void 0) }, _sanitizeSelector: function (e) { return e ? e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g, "\\$&") : "" }, refresh: function () { var t = this.options, i = this.tablist.children(":has(a[href])"); t.disabled = e.map(i.filter(".ui-state-disabled"), function (e) { return i.index(e) }), this._processTabs(), t.active !== !1 && this.anchors.length ? this.active.length && !e.contains(this.tablist[0], this.active[0]) ? this.tabs.length === t.disabled.length ? (t.active = !1, this.active = e()) : this._activate(this._findNextTab(Math.max(0, t.active - 1), !1)) : t.active = this.tabs.index(this.active) : (t.active = !1, this.active = e()), this._refresh() }, _refresh: function () { this._setOptionDisabled(this.options.disabled), this._setupEvents(this.options.event), this._setupHeightStyle(this.options.heightStyle), this.tabs.not(this.active).attr({ "aria-selected": "false", "aria-expanded": "false", tabIndex: -1 }), this.panels.not(this._getPanelForTab(this.active)).hide().attr({ "aria-hidden": "true" }), this.active.length ? (this.active.attr({ "aria-selected": "true", "aria-expanded": "true", tabIndex: 0 }), this._addClass(this.active, "ui-tabs-active", "ui-state-active"), this._getPanelForTab(this.active).show().attr({ "aria-hidden": "false" })) : this.tabs.eq(0).attr("tabIndex", 0) }, _processTabs: function () { var t = this, i = this.tabs, s = this.anchors, a = this.panels; this.tablist = this._getList().attr("role", "tablist"), this._addClass(this.tablist, "ui-tabs-nav", "ui-helper-reset ui-helper-clearfix ui-widget-header"), this.tablist.on("mousedown" + this.eventNamespace, "> li", function (t) { e(this).is(".ui-state-disabled") && t.preventDefault() }).on("focus" + this.eventNamespace, ".ui-tabs-anchor", function () { e(this).closest("li").is(".ui-state-disabled") && this.blur() }), this.tabs = this.tablist.find("> li:has(a[href])").attr({ role: "tab", tabIndex: -1 }), this._addClass(this.tabs, "ui-tabs-tab", "ui-state-default"), this.anchors = this.tabs.map(function () { return e("a", this)[0] }).attr({ role: "presentation", tabIndex: -1 }), this._addClass(this.anchors, "ui-tabs-anchor"), this.panels = e(), this.anchors.each(function (i, s) { var a, n, r, o = e(s).uniqueId().attr("id"), l = e(s).closest("li"), h = l.attr("aria-controls"); t._isLocal(s) ? (a = s.hash, r = a.substring(1), n = t.element.find(t._sanitizeSelector(a))) : (r = l.attr("aria-controls") || e({}).uniqueId()[0].id, a = "#" + r, n = t.element.find(a), n.length || (n = t._createPanel(r), n.insertAfter(t.panels[i - 1] || t.tablist)), n.attr("aria-live", "polite")), n.length && (t.panels = t.panels.add(n)), h && l.data("ui-tabs-aria-controls", h), l.attr({ "aria-controls": r, "aria-labelledby": o }), n.attr("aria-labelledby", o) }), this.panels.attr("role", "tabpanel"), this._addClass(this.panels, "ui-tabs-panel", "ui-widget-content"), i && (this._off(i.not(this.tabs)), this._off(s.not(this.anchors)), this._off(a.not(this.panels))) }, _getList: function () { return this.tablist || this.element.find("ol, ul").eq(0) }, _createPanel: function (t) { return e("<div>").attr("id", t).data("ui-tabs-destroy", !0) }, _setOptionDisabled: function (t) { var i, s, a; for (e.isArray(t) && (t.length ? t.length === this.anchors.length && (t = !0) : t = !1), a = 0; s = this.tabs[a]; a++)i = e(s), t === !0 || -1 !== e.inArray(a, t) ? (i.attr("aria-disabled", "true"), this._addClass(i, null, "ui-state-disabled")) : (i.removeAttr("aria-disabled"), this._removeClass(i, null, "ui-state-disabled")); this.options.disabled = t, this._toggleClass(this.widget(), this.widgetFullName + "-disabled", null, t === !0) }, _setupEvents: function (t) { var i = {}; t && e.each(t.split(" "), function (e, t) { i[t] = "_eventHandler" }), this._off(this.anchors.add(this.tabs).add(this.panels)), this._on(!0, this.anchors, { click: function (e) { e.preventDefault() } }), this._on(this.anchors, i), this._on(this.tabs, { keydown: "_tabKeydown" }), this._on(this.panels, { keydown: "_panelKeydown" }), this._focusable(this.tabs), this._hoverable(this.tabs) }, _setupHeightStyle: function (t) { var i, s = this.element.parent(); "fill" === t ? (i = s.height(), i -= this.element.outerHeight() - this.element.height(), this.element.siblings(":visible").each(function () { var t = e(this), s = t.css("position"); "absolute" !== s && "fixed" !== s && (i -= t.outerHeight(!0)) }), this.element.children().not(this.panels).each(function () { i -= e(this).outerHeight(!0) }), this.panels.each(function () { e(this).height(Math.max(0, i - e(this).innerHeight() + e(this).height())) }).css("overflow", "auto")) : "auto" === t && (i = 0, this.panels.each(function () { i = Math.max(i, e(this).height("").height()) }).height(i)) }, _eventHandler: function (t) { var i = this.options, s = this.active, a = e(t.currentTarget), n = a.closest("li"), r = n[0] === s[0], o = r && i.collapsible, l = o ? e() : this._getPanelForTab(n), h = s.length ? this._getPanelForTab(s) : e(), u = { oldTab: s, oldPanel: h, newTab: o ? e() : n, newPanel: l }; t.preventDefault(), n.hasClass("ui-state-disabled") || n.hasClass("ui-tabs-loading") || this.running || r && !i.collapsible || this._trigger("beforeActivate", t, u) === !1 || (i.active = o ? !1 : this.tabs.index(n), this.active = r ? e() : n, this.xhr && this.xhr.abort(), h.length || l.length || e.error("jQuery UI Tabs: Mismatching fragment identifier."), l.length && this.load(this.tabs.index(n), t), this._toggle(t, u)) }, _toggle: function (t, i) { function s() { n.running = !1, n._trigger("activate", t, i) } function a() { n._addClass(i.newTab.closest("li"), "ui-tabs-active", "ui-state-active"), r.length && n.options.show ? n._show(r, n.options.show, s) : (r.show(), s()) } var n = this, r = i.newPanel, o = i.oldPanel; this.running = !0, o.length && this.options.hide ? this._hide(o, this.options.hide, function () { n._removeClass(i.oldTab.closest("li"), "ui-tabs-active", "ui-state-active"), a() }) : (this._removeClass(i.oldTab.closest("li"), "ui-tabs-active", "ui-state-active"), o.hide(), a()), o.attr("aria-hidden", "true"), i.oldTab.attr({ "aria-selected": "false", "aria-expanded": "false" }), r.length && o.length ? i.oldTab.attr("tabIndex", -1) : r.length && this.tabs.filter(function () { return 0 === e(this).attr("tabIndex") }).attr("tabIndex", -1), r.attr("aria-hidden", "false"), i.newTab.attr({ "aria-selected": "true", "aria-expanded": "true", tabIndex: 0 }) }, _activate: function (t) { var i, s = this._findActive(t); s[0] !== this.active[0] && (s.length || (s = this.active), i = s.find(".ui-tabs-anchor")[0], this._eventHandler({ target: i, currentTarget: i, preventDefault: e.noop })) }, _findActive: function (t) { return t === !1 ? e() : this.tabs.eq(t) }, _getIndex: function (t) { return "string" == typeof t && (t = this.anchors.index(this.anchors.filter("[href$='" + e.ui.escapeSelector(t) + "']"))), t }, _destroy: function () { this.xhr && this.xhr.abort(), this.tablist.removeAttr("role").off(this.eventNamespace), this.anchors.removeAttr("role tabIndex").removeUniqueId(), this.tabs.add(this.panels).each(function () { e.data(this, "ui-tabs-destroy") ? e(this).remove() : e(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded") }), this.tabs.each(function () { var t = e(this), i = t.data("ui-tabs-aria-controls"); i ? t.attr("aria-controls", i).removeData("ui-tabs-aria-controls") : t.removeAttr("aria-controls") }), this.panels.show(), "content" !== this.options.heightStyle && this.panels.css("height", "") }, enable: function (t) { var i = this.options.disabled; i !== !1 && (void 0 === t ? i = !1 : (t = this._getIndex(t), i = e.isArray(i) ? e.map(i, function (e) { return e !== t ? e : null }) : e.map(this.tabs, function (e, i) { return i !== t ? i : null })), this._setOptionDisabled(i)) }, disable: function (t) { var i = this.options.disabled; if (i !== !0) { if (void 0 === t) i = !0; else { if (t = this._getIndex(t), -1 !== e.inArray(t, i)) return; i = e.isArray(i) ? e.merge([t], i).sort() : [t] } this._setOptionDisabled(i) } }, load: function (t, i) { t = this._getIndex(t); var s = this, a = this.tabs.eq(t), n = a.find(".ui-tabs-anchor"), r = this._getPanelForTab(a), o = { tab: a, panel: r }, l = function (e, t) { "abort" === t && s.panels.stop(!1, !0), s._removeClass(a, "ui-tabs-loading"), r.removeAttr("aria-busy"), e === s.xhr && delete s.xhr }; this._isLocal(n[0]) || (this.xhr = e.ajax(this._ajaxSettings(n, i, o)), this.xhr && "canceled" !== this.xhr.statusText && (this._addClass(a, "ui-tabs-loading"), r.attr("aria-busy", "true"), this.xhr.done(function (e, t, a) { setTimeout(function () { r.html(e), s._trigger("load", i, o), l(a, t) }, 1) }).fail(function (e, t) { setTimeout(function () { l(e, t) }, 1) }))) }, _ajaxSettings: function (t, i, s) { var a = this; return { url: t.attr("href").replace(/#.*$/, ""), beforeSend: function (t, n) { return a._trigger("beforeLoad", i, e.extend({ jqXHR: t, ajaxSettings: n }, s)) } } }, _getPanelForTab: function (t) { var i = e(t).attr("aria-controls"); return this.element.find(this._sanitizeSelector("#" + i)) } }), e.uiBackCompat !== !1 && e.widget("ui.tabs", e.ui.tabs, { _processTabs: function () { this._superApply(arguments), this._addClass(this.tabs, "ui-tab") } }), e.ui.tabs, e.widget("ui.tooltip", {
                version: "1.12.1", options: { classes: { "ui-tooltip": "ui-corner-all ui-widget-shadow" }, content: function () { var t = e(this).attr("title") || ""; return e("<a>").text(t).html() }, hide: !0, items: "[title]:not([disabled])", position: { my: "left top+15", at: "left bottom", collision: "flipfit flip" }, show: !0, track: !1, close: null, open: null }, _addDescribedBy: function (t, i) { var s = (t.attr("aria-describedby") || "").split(/\s+/); s.push(i), t.data("ui-tooltip-id", i).attr("aria-describedby", e.trim(s.join(" "))) }, _removeDescribedBy: function (t) { var i = t.data("ui-tooltip-id"), s = (t.attr("aria-describedby") || "").split(/\s+/), a = e.inArray(i, s); -1 !== a && s.splice(a, 1), t.removeData("ui-tooltip-id"), s = e.trim(s.join(" ")), s ? t.attr("aria-describedby", s) : t.removeAttr("aria-describedby") }, _create: function () { this._on({ mouseover: "open", focusin: "open" }), this.tooltips = {}, this.parents = {}, this.liveRegion = e("<div>").attr({ role: "log", "aria-live": "assertive", "aria-relevant": "additions" }).appendTo(this.document[0].body), this._addClass(this.liveRegion, null, "ui-helper-hidden-accessible"), this.disabledTitles = e([]) }, _setOption: function (t, i) { var s = this; this._super(t, i), "content" === t && e.each(this.tooltips, function (e, t) { s._updateContent(t.element) }) }, _setOptionDisabled: function (e) { this[e ? "_disable" : "_enable"]() }, _disable: function () { var t = this; e.each(this.tooltips, function (i, s) { var a = e.Event("blur"); a.target = a.currentTarget = s.element[0], t.close(a, !0) }), this.disabledTitles = this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function () { var t = e(this); return t.is("[title]") ? t.data("ui-tooltip-title", t.attr("title")).removeAttr("title") : void 0 })) }, _enable: function () { this.disabledTitles.each(function () { var t = e(this); t.data("ui-tooltip-title") && t.attr("title", t.data("ui-tooltip-title")) }), this.disabledTitles = e([]) }, open: function (t) { var i = this, s = e(t ? t.target : this.element).closest(this.options.items); s.length && !s.data("ui-tooltip-id") && (s.attr("title") && s.data("ui-tooltip-title", s.attr("title")), s.data("ui-tooltip-open", !0), t && "mouseover" === t.type && s.parents().each(function () { var t, s = e(this); s.data("ui-tooltip-open") && (t = e.Event("blur"), t.target = t.currentTarget = this, i.close(t, !0)), s.attr("title") && (s.uniqueId(), i.parents[this.id] = { element: this, title: s.attr("title") }, s.attr("title", "")) }), this._registerCloseHandlers(t, s), this._updateContent(s, t)) }, _updateContent: function (e, t) { var i, s = this.options.content, a = this, n = t ? t.type : null; return "string" == typeof s || s.nodeType || s.jquery ? this._open(t, e, s) : (i = s.call(e[0], function (i) { a._delay(function () { e.data("ui-tooltip-open") && (t && (t.type = n), this._open(t, e, i)) }) }), i && this._open(t, e, i), void 0) }, _open: function (t, i, s) { function a(e) { h.of = e, r.is(":hidden") || r.position(h) } var n, r, o, l, h = e.extend({}, this.options.position); if (s) { if (n = this._find(i)) return n.tooltip.find(".ui-tooltip-content").html(s), void 0; i.is("[title]") && (t && "mouseover" === t.type ? i.attr("title", "") : i.removeAttr("title")), n = this._tooltip(i), r = n.tooltip, this._addDescribedBy(i, r.attr("id")), r.find(".ui-tooltip-content").html(s), this.liveRegion.children().hide(), l = e("<div>").html(r.find(".ui-tooltip-content").html()), l.removeAttr("name").find("[name]").removeAttr("name"), l.removeAttr("id").find("[id]").removeAttr("id"), l.appendTo(this.liveRegion), this.options.track && t && /^mouse/.test(t.type) ? (this._on(this.document, { mousemove: a }), a(t)) : r.position(e.extend({ of: i }, this.options.position)), r.hide(), this._show(r, this.options.show), this.options.track && this.options.show && this.options.show.delay && (o = this.delayedShow = setInterval(function () { r.is(":visible") && (a(h.of), clearInterval(o)) }, e.fx.interval)), this._trigger("open", t, { tooltip: r }) } }, _registerCloseHandlers: function (t, i) { var s = { keyup: function (t) { if (t.keyCode === e.ui.keyCode.ESCAPE) { var s = e.Event(t); s.currentTarget = i[0], this.close(s, !0) } } }; i[0] !== this.element[0] && (s.remove = function () { this._removeTooltip(this._find(i).tooltip) }), t && "mouseover" !== t.type || (s.mouseleave = "close"), t && "focusin" !== t.type || (s.focusout = "close"), this._on(!0, i, s) }, close: function (t) {
                    var i, s = this, a = e(t ? t.currentTarget : this.element), n = this._find(a); return n ? (i = n.tooltip, n.closing || (clearInterval(this.delayedShow), a.data("ui-tooltip-title") && !a.attr("title") && a.attr("title", a.data("ui-tooltip-title")), this._removeDescribedBy(a), n.hiding = !0, i.stop(!0), this._hide(i, this.options.hide, function () { s._removeTooltip(e(this)) }), a.removeData("ui-tooltip-open"), this._off(a, "mouseleave focusout keyup"), a[0] !== this.element[0] && this._off(a, "remove"), this._off(this.document, "mousemove"), t && "mouseleave" === t.type && e.each(this.parents, function (t, i) {
                        e(i.element).attr("title", i.title), delete s.parents[t]
                    }), n.closing = !0, this._trigger("close", t, { tooltip: i }), n.hiding || (n.closing = !1)), void 0) : (a.removeData("ui-tooltip-open"), void 0)
                }, _tooltip: function (t) { var i = e("<div>").attr("role", "tooltip"), s = e("<div>").appendTo(i), a = i.uniqueId().attr("id"); return this._addClass(s, "ui-tooltip-content"), this._addClass(i, "ui-tooltip", "ui-widget ui-widget-content"), i.appendTo(this._appendTo(t)), this.tooltips[a] = { element: t, tooltip: i } }, _find: function (e) { var t = e.data("ui-tooltip-id"); return t ? this.tooltips[t] : null }, _removeTooltip: function (e) { e.remove(), delete this.tooltips[e.attr("id")] }, _appendTo: function (e) { var t = e.closest(".ui-front, dialog"); return t.length || (t = this.document[0].body), t }, _destroy: function () { var t = this; e.each(this.tooltips, function (i, s) { var a = e.Event("blur"), n = s.element; a.target = a.currentTarget = n[0], t.close(a, !0), e("#" + i).remove(), n.data("ui-tooltip-title") && (n.attr("title") || n.attr("title", n.data("ui-tooltip-title")), n.removeData("ui-tooltip-title")) }), this.liveRegion.remove() }
            }), e.uiBackCompat !== !1 && e.widget("ui.tooltip", e.ui.tooltip, { options: { tooltipClass: null }, _tooltip: function () { var e = this._superApply(arguments); return this.options.tooltipClass && e.tooltip.addClass(this.options.tooltipClass), e } }), e.ui.tooltip; var m = "ui-effects-", f = "ui-effects-style", g = "ui-effects-animated", v = e; e.effects = { effect: {} }, function (e, t) { function i(e, t, i) { var s = d[t.type] || {}; return null == e ? i || !t.def ? null : t.def : (e = s.floor ? ~~e : parseFloat(e), isNaN(e) ? t.def : s.mod ? (e + s.mod) % s.mod : 0 > e ? 0 : e > s.max ? s.max : e) } function s(i) { var s = h(), a = s._rgba = []; return i = i.toLowerCase(), m(l, function (e, n) { var r, o = n.re.exec(i), l = o && n.parse(o), h = n.space || "rgba"; return l ? (r = s[h](l), s[u[h].cache] = r[u[h].cache], a = s._rgba = r._rgba, !1) : t }), a.length ? ("0,0,0,0" === a.join() && e.extend(a, n.transparent), s) : n[i] } function a(e, t, i) { return i = (i + 1) % 1, 1 > 6 * i ? e + 6 * (t - e) * i : 1 > 2 * i ? t : 2 > 3 * i ? e + 6 * (t - e) * (2 / 3 - i) : e } var n, r = "backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor", o = /^([\-+])=\s*(\d+\.?\d*)/, l = [{ re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/, parse: function (e) { return [e[1], e[2], e[3], e[4]] } }, { re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/, parse: function (e) { return [2.55 * e[1], 2.55 * e[2], 2.55 * e[3], e[4]] } }, { re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/, parse: function (e) { return [parseInt(e[1], 16), parseInt(e[2], 16), parseInt(e[3], 16)] } }, { re: /#([a-f0-9])([a-f0-9])([a-f0-9])/, parse: function (e) { return [parseInt(e[1] + e[1], 16), parseInt(e[2] + e[2], 16), parseInt(e[3] + e[3], 16)] } }, { re: /hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/, space: "hsla", parse: function (e) { return [e[1], e[2] / 100, e[3] / 100, e[4]] } }], h = e.Color = function (t, i, s, a) { return new e.Color.fn.parse(t, i, s, a) }, u = { rgba: { props: { red: { idx: 0, type: "byte" }, green: { idx: 1, type: "byte" }, blue: { idx: 2, type: "byte" } } }, hsla: { props: { hue: { idx: 0, type: "degrees" }, saturation: { idx: 1, type: "percent" }, lightness: { idx: 2, type: "percent" } } } }, d = { "byte": { floor: !0, max: 255 }, percent: { max: 1 }, degrees: { mod: 360, floor: !0 } }, c = h.support = {}, p = e("<p>")[0], m = e.each; p.style.cssText = "background-color:rgba(1,1,1,.5)", c.rgba = p.style.backgroundColor.indexOf("rgba") > -1, m(u, function (e, t) { t.cache = "_" + e, t.props.alpha = { idx: 3, type: "percent", def: 1 } }), h.fn = e.extend(h.prototype, { parse: function (a, r, o, l) { if (a === t) return this._rgba = [null, null, null, null], this; (a.jquery || a.nodeType) && (a = e(a).css(r), r = t); var d = this, c = e.type(a), p = this._rgba = []; return r !== t && (a = [a, r, o, l], c = "array"), "string" === c ? this.parse(s(a) || n._default) : "array" === c ? (m(u.rgba.props, function (e, t) { p[t.idx] = i(a[t.idx], t) }), this) : "object" === c ? (a instanceof h ? m(u, function (e, t) { a[t.cache] && (d[t.cache] = a[t.cache].slice()) }) : m(u, function (t, s) { var n = s.cache; m(s.props, function (e, t) { if (!d[n] && s.to) { if ("alpha" === e || null == a[e]) return; d[n] = s.to(d._rgba) } d[n][t.idx] = i(a[e], t, !0) }), d[n] && 0 > e.inArray(null, d[n].slice(0, 3)) && (d[n][3] = 1, s.from && (d._rgba = s.from(d[n]))) }), this) : t }, is: function (e) { var i = h(e), s = !0, a = this; return m(u, function (e, n) { var r, o = i[n.cache]; return o && (r = a[n.cache] || n.to && n.to(a._rgba) || [], m(n.props, function (e, i) { return null != o[i.idx] ? s = o[i.idx] === r[i.idx] : t })), s }), s }, _space: function () { var e = [], t = this; return m(u, function (i, s) { t[s.cache] && e.push(i) }), e.pop() }, transition: function (e, t) { var s = h(e), a = s._space(), n = u[a], r = 0 === this.alpha() ? h("transparent") : this, o = r[n.cache] || n.to(r._rgba), l = o.slice(); return s = s[n.cache], m(n.props, function (e, a) { var n = a.idx, r = o[n], h = s[n], u = d[a.type] || {}; null !== h && (null === r ? l[n] = h : (u.mod && (h - r > u.mod / 2 ? r += u.mod : r - h > u.mod / 2 && (r -= u.mod)), l[n] = i((h - r) * t + r, a))) }), this[a](l) }, blend: function (t) { if (1 === this._rgba[3]) return this; var i = this._rgba.slice(), s = i.pop(), a = h(t)._rgba; return h(e.map(i, function (e, t) { return (1 - s) * a[t] + s * e })) }, toRgbaString: function () { var t = "rgba(", i = e.map(this._rgba, function (e, t) { return null == e ? t > 2 ? 1 : 0 : e }); return 1 === i[3] && (i.pop(), t = "rgb("), t + i.join() + ")" }, toHslaString: function () { var t = "hsla(", i = e.map(this.hsla(), function (e, t) { return null == e && (e = t > 2 ? 1 : 0), t && 3 > t && (e = Math.round(100 * e) + "%"), e }); return 1 === i[3] && (i.pop(), t = "hsl("), t + i.join() + ")" }, toHexString: function (t) { var i = this._rgba.slice(), s = i.pop(); return t && i.push(~~(255 * s)), "#" + e.map(i, function (e) { return e = (e || 0).toString(16), 1 === e.length ? "0" + e : e }).join("") }, toString: function () { return 0 === this._rgba[3] ? "transparent" : this.toRgbaString() } }), h.fn.parse.prototype = h.fn, u.hsla.to = function (e) { if (null == e[0] || null == e[1] || null == e[2]) return [null, null, null, e[3]]; var t, i, s = e[0] / 255, a = e[1] / 255, n = e[2] / 255, r = e[3], o = Math.max(s, a, n), l = Math.min(s, a, n), h = o - l, u = o + l, d = .5 * u; return t = l === o ? 0 : s === o ? 60 * (a - n) / h + 360 : a === o ? 60 * (n - s) / h + 120 : 60 * (s - a) / h + 240, i = 0 === h ? 0 : .5 >= d ? h / u : h / (2 - u), [Math.round(t) % 360, i, d, null == r ? 1 : r] }, u.hsla.from = function (e) { if (null == e[0] || null == e[1] || null == e[2]) return [null, null, null, e[3]]; var t = e[0] / 360, i = e[1], s = e[2], n = e[3], r = .5 >= s ? s * (1 + i) : s + i - s * i, o = 2 * s - r; return [Math.round(255 * a(o, r, t + 1 / 3)), Math.round(255 * a(o, r, t)), Math.round(255 * a(o, r, t - 1 / 3)), n] }, m(u, function (s, a) { var n = a.props, r = a.cache, l = a.to, u = a.from; h.fn[s] = function (s) { if (l && !this[r] && (this[r] = l(this._rgba)), s === t) return this[r].slice(); var a, o = e.type(s), d = "array" === o || "object" === o ? s : arguments, c = this[r].slice(); return m(n, function (e, t) { var s = d["object" === o ? e : t.idx]; null == s && (s = c[t.idx]), c[t.idx] = i(s, t) }), u ? (a = h(u(c)), a[r] = c, a) : h(c) }, m(n, function (t, i) { h.fn[t] || (h.fn[t] = function (a) { var n, r = e.type(a), l = "alpha" === t ? this._hsla ? "hsla" : "rgba" : s, h = this[l](), u = h[i.idx]; return "undefined" === r ? u : ("function" === r && (a = a.call(this, u), r = e.type(a)), null == a && i.empty ? this : ("string" === r && (n = o.exec(a), n && (a = u + parseFloat(n[2]) * ("+" === n[1] ? 1 : -1))), h[i.idx] = a, this[l](h))) }) }) }), h.hook = function (t) { var i = t.split(" "); m(i, function (t, i) { e.cssHooks[i] = { set: function (t, a) { var n, r, o = ""; if ("transparent" !== a && ("string" !== e.type(a) || (n = s(a)))) { if (a = h(n || a), !c.rgba && 1 !== a._rgba[3]) { for (r = "backgroundColor" === i ? t.parentNode : t; ("" === o || "transparent" === o) && r && r.style;)try { o = e.css(r, "backgroundColor"), r = r.parentNode } catch (l) { } a = a.blend(o && "transparent" !== o ? o : "_default") } a = a.toRgbaString() } try { t.style[i] = a } catch (l) { } } }, e.fx.step[i] = function (t) { t.colorInit || (t.start = h(t.elem, i), t.end = h(t.end), t.colorInit = !0), e.cssHooks[i].set(t.elem, t.start.transition(t.end, t.pos)) } }) }, h.hook(r), e.cssHooks.borderColor = { expand: function (e) { var t = {}; return m(["Top", "Right", "Bottom", "Left"], function (i, s) { t["border" + s + "Color"] = e }), t } }, n = e.Color.names = { aqua: "#00ffff", black: "#000000", blue: "#0000ff", fuchsia: "#ff00ff", gray: "#808080", green: "#008000", lime: "#00ff00", maroon: "#800000", navy: "#000080", olive: "#808000", purple: "#800080", red: "#ff0000", silver: "#c0c0c0", teal: "#008080", white: "#ffffff", yellow: "#ffff00", transparent: [null, null, null, 0], _default: "#ffffff" } }(v), function () { function t(t) { var i, s, a = t.ownerDocument.defaultView ? t.ownerDocument.defaultView.getComputedStyle(t, null) : t.currentStyle, n = {}; if (a && a.length && a[0] && a[a[0]]) for (s = a.length; s--;)i = a[s], "string" == typeof a[i] && (n[e.camelCase(i)] = a[i]); else for (i in a) "string" == typeof a[i] && (n[i] = a[i]); return n } function i(t, i) { var s, n, r = {}; for (s in i) n = i[s], t[s] !== n && (a[s] || (e.fx.step[s] || !isNaN(parseFloat(n))) && (r[s] = n)); return r } var s = ["add", "remove", "toggle"], a = { border: 1, borderBottom: 1, borderColor: 1, borderLeft: 1, borderRight: 1, borderTop: 1, borderWidth: 1, margin: 1, padding: 1 }; e.each(["borderLeftStyle", "borderRightStyle", "borderBottomStyle", "borderTopStyle"], function (t, i) { e.fx.step[i] = function (e) { ("none" !== e.end && !e.setAttr || 1 === e.pos && !e.setAttr) && (v.style(e.elem, i, e.end), e.setAttr = !0) } }), e.fn.addBack || (e.fn.addBack = function (e) { return this.add(null == e ? this.prevObject : this.prevObject.filter(e)) }), e.effects.animateClass = function (a, n, r, o) { var l = e.speed(n, r, o); return this.queue(function () { var n, r = e(this), o = r.attr("class") || "", h = l.children ? r.find("*").addBack() : r; h = h.map(function () { var i = e(this); return { el: i, start: t(this) } }), n = function () { e.each(s, function (e, t) { a[t] && r[t + "Class"](a[t]) }) }, n(), h = h.map(function () { return this.end = t(this.el[0]), this.diff = i(this.start, this.end), this }), r.attr("class", o), h = h.map(function () { var t = this, i = e.Deferred(), s = e.extend({}, l, { queue: !1, complete: function () { i.resolve(t) } }); return this.el.animate(this.diff, s), i.promise() }), e.when.apply(e, h.get()).done(function () { n(), e.each(arguments, function () { var t = this.el; e.each(this.diff, function (e) { t.css(e, "") }) }), l.complete.call(r[0]) }) }) }, e.fn.extend({ addClass: function (t) { return function (i, s, a, n) { return s ? e.effects.animateClass.call(this, { add: i }, s, a, n) : t.apply(this, arguments) } }(e.fn.addClass), removeClass: function (t) { return function (i, s, a, n) { return arguments.length > 1 ? e.effects.animateClass.call(this, { remove: i }, s, a, n) : t.apply(this, arguments) } }(e.fn.removeClass), toggleClass: function (t) { return function (i, s, a, n, r) { return "boolean" == typeof s || void 0 === s ? a ? e.effects.animateClass.call(this, s ? { add: i } : { remove: i }, a, n, r) : t.apply(this, arguments) : e.effects.animateClass.call(this, { toggle: i }, s, a, n) } }(e.fn.toggleClass), switchClass: function (t, i, s, a, n) { return e.effects.animateClass.call(this, { add: i, remove: t }, s, a, n) } }) }(), function () { function t(t, i, s, a) { return e.isPlainObject(t) && (i = t, t = t.effect), t = { effect: t }, null == i && (i = {}), e.isFunction(i) && (a = i, s = null, i = {}), ("number" == typeof i || e.fx.speeds[i]) && (a = s, s = i, i = {}), e.isFunction(s) && (a = s, s = null), i && e.extend(t, i), s = s || i.duration, t.duration = e.fx.off ? 0 : "number" == typeof s ? s : s in e.fx.speeds ? e.fx.speeds[s] : e.fx.speeds._default, t.complete = a || i.complete, t } function i(t) { return !t || "number" == typeof t || e.fx.speeds[t] ? !0 : "string" != typeof t || e.effects.effect[t] ? e.isFunction(t) ? !0 : "object" != typeof t || t.effect ? !1 : !0 : !0 } function s(e, t) { var i = t.outerWidth(), s = t.outerHeight(), a = /^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/, n = a.exec(e) || ["", 0, i, s, 0]; return { top: parseFloat(n[1]) || 0, right: "auto" === n[2] ? i : parseFloat(n[2]), bottom: "auto" === n[3] ? s : parseFloat(n[3]), left: parseFloat(n[4]) || 0 } } e.expr && e.expr.filters && e.expr.filters.animated && (e.expr.filters.animated = function (t) { return function (i) { return !!e(i).data(g) || t(i) } }(e.expr.filters.animated)), e.uiBackCompat !== !1 && e.extend(e.effects, { save: function (e, t) { for (var i = 0, s = t.length; s > i; i++)null !== t[i] && e.data(m + t[i], e[0].style[t[i]]) }, restore: function (e, t) { for (var i, s = 0, a = t.length; a > s; s++)null !== t[s] && (i = e.data(m + t[s]), e.css(t[s], i)) }, setMode: function (e, t) { return "toggle" === t && (t = e.is(":hidden") ? "show" : "hide"), t }, createWrapper: function (t) { if (t.parent().is(".ui-effects-wrapper")) return t.parent(); var i = { width: t.outerWidth(!0), height: t.outerHeight(!0), "float": t.css("float") }, s = e("<div></div>").addClass("ui-effects-wrapper").css({ fontSize: "100%", background: "transparent", border: "none", margin: 0, padding: 0 }), a = { width: t.width(), height: t.height() }, n = document.activeElement; try { n.id } catch (r) { n = document.body } return t.wrap(s), (t[0] === n || e.contains(t[0], n)) && e(n).trigger("focus"), s = t.parent(), "static" === t.css("position") ? (s.css({ position: "relative" }), t.css({ position: "relative" })) : (e.extend(i, { position: t.css("position"), zIndex: t.css("z-index") }), e.each(["top", "left", "bottom", "right"], function (e, s) { i[s] = t.css(s), isNaN(parseInt(i[s], 10)) && (i[s] = "auto") }), t.css({ position: "relative", top: 0, left: 0, right: "auto", bottom: "auto" })), t.css(a), s.css(i).show() }, removeWrapper: function (t) { var i = document.activeElement; return t.parent().is(".ui-effects-wrapper") && (t.parent().replaceWith(t), (t[0] === i || e.contains(t[0], i)) && e(i).trigger("focus")), t } }), e.extend(e.effects, { version: "1.12.1", define: function (t, i, s) { return s || (s = i, i = "effect"), e.effects.effect[t] = s, e.effects.effect[t].mode = i, s }, scaledDimensions: function (e, t, i) { if (0 === t) return { height: 0, width: 0, outerHeight: 0, outerWidth: 0 }; var s = "horizontal" !== i ? (t || 100) / 100 : 1, a = "vertical" !== i ? (t || 100) / 100 : 1; return { height: e.height() * a, width: e.width() * s, outerHeight: e.outerHeight() * a, outerWidth: e.outerWidth() * s } }, clipToBox: function (e) { return { width: e.clip.right - e.clip.left, height: e.clip.bottom - e.clip.top, left: e.clip.left, top: e.clip.top } }, unshift: function (e, t, i) { var s = e.queue(); t > 1 && s.splice.apply(s, [1, 0].concat(s.splice(t, i))), e.dequeue() }, saveStyle: function (e) { e.data(f, e[0].style.cssText) }, restoreStyle: function (e) { e[0].style.cssText = e.data(f) || "", e.removeData(f) }, mode: function (e, t) { var i = e.is(":hidden"); return "toggle" === t && (t = i ? "show" : "hide"), (i ? "hide" === t : "show" === t) && (t = "none"), t }, getBaseline: function (e, t) { var i, s; switch (e[0]) { case "top": i = 0; break; case "middle": i = .5; break; case "bottom": i = 1; break; default: i = e[0] / t.height }switch (e[1]) { case "left": s = 0; break; case "center": s = .5; break; case "right": s = 1; break; default: s = e[1] / t.width }return { x: s, y: i } }, createPlaceholder: function (t) { var i, s = t.css("position"), a = t.position(); return t.css({ marginTop: t.css("marginTop"), marginBottom: t.css("marginBottom"), marginLeft: t.css("marginLeft"), marginRight: t.css("marginRight") }).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()), /^(static|relative)/.test(s) && (s = "absolute", i = e("<" + t[0].nodeName + ">").insertAfter(t).css({ display: /^(inline|ruby)/.test(t.css("display")) ? "inline-block" : "block", visibility: "hidden", marginTop: t.css("marginTop"), marginBottom: t.css("marginBottom"), marginLeft: t.css("marginLeft"), marginRight: t.css("marginRight"), "float": t.css("float") }).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).addClass("ui-effects-placeholder"), t.data(m + "placeholder", i)), t.css({ position: s, left: a.left, top: a.top }), i }, removePlaceholder: function (e) { var t = m + "placeholder", i = e.data(t); i && (i.remove(), e.removeData(t)) }, cleanUp: function (t) { e.effects.restoreStyle(t), e.effects.removePlaceholder(t) }, setTransition: function (t, i, s, a) { return a = a || {}, e.each(i, function (e, i) { var n = t.cssUnit(i); n[0] > 0 && (a[i] = n[0] * s + n[1]) }), a } }), e.fn.extend({ effect: function () { function i(t) { function i() { o.removeData(g), e.effects.cleanUp(o), "hide" === s.mode && o.hide(), r() } function r() { e.isFunction(l) && l.call(o[0]), e.isFunction(t) && t() } var o = e(this); s.mode = u.shift(), e.uiBackCompat === !1 || n ? "none" === s.mode ? (o[h](), r()) : a.call(o[0], s, i) : (o.is(":hidden") ? "hide" === h : "show" === h) ? (o[h](), r()) : a.call(o[0], s, r) } var s = t.apply(this, arguments), a = e.effects.effect[s.effect], n = a.mode, r = s.queue, o = r || "fx", l = s.complete, h = s.mode, u = [], d = function (t) { var i = e(this), s = e.effects.mode(i, h) || n; i.data(g, !0), u.push(s), n && ("show" === s || s === n && "hide" === s) && i.show(), n && "none" === s || e.effects.saveStyle(i), e.isFunction(t) && t() }; return e.fx.off || !a ? h ? this[h](s.duration, l) : this.each(function () { l && l.call(this) }) : r === !1 ? this.each(d).each(i) : this.queue(o, d).queue(o, i) }, show: function (e) { return function (s) { if (i(s)) return e.apply(this, arguments); var a = t.apply(this, arguments); return a.mode = "show", this.effect.call(this, a) } }(e.fn.show), hide: function (e) { return function (s) { if (i(s)) return e.apply(this, arguments); var a = t.apply(this, arguments); return a.mode = "hide", this.effect.call(this, a) } }(e.fn.hide), toggle: function (e) { return function (s) { if (i(s) || "boolean" == typeof s) return e.apply(this, arguments); var a = t.apply(this, arguments); return a.mode = "toggle", this.effect.call(this, a) } }(e.fn.toggle), cssUnit: function (t) { var i = this.css(t), s = []; return e.each(["em", "px", "%", "pt"], function (e, t) { i.indexOf(t) > 0 && (s = [parseFloat(i), t]) }), s }, cssClip: function (e) { return e ? this.css("clip", "rect(" + e.top + "px " + e.right + "px " + e.bottom + "px " + e.left + "px)") : s(this.css("clip"), this) }, transfer: function (t, i) { var s = e(this), a = e(t.to), n = "fixed" === a.css("position"), r = e("body"), o = n ? r.scrollTop() : 0, l = n ? r.scrollLeft() : 0, h = a.offset(), u = { top: h.top - o, left: h.left - l, height: a.innerHeight(), width: a.innerWidth() }, d = s.offset(), c = e("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(t.className).css({ top: d.top - o, left: d.left - l, height: s.innerHeight(), width: s.innerWidth(), position: n ? "fixed" : "absolute" }).animate(u, t.duration, t.easing, function () { c.remove(), e.isFunction(i) && i() }) } }), e.fx.step.clip = function (t) { t.clipInit || (t.start = e(t.elem).cssClip(), "string" == typeof t.end && (t.end = s(t.end, t.elem)), t.clipInit = !0), e(t.elem).cssClip({ top: t.pos * (t.end.top - t.start.top) + t.start.top, right: t.pos * (t.end.right - t.start.right) + t.start.right, bottom: t.pos * (t.end.bottom - t.start.bottom) + t.start.bottom, left: t.pos * (t.end.left - t.start.left) + t.start.left }) } }(), function () { var t = {}; e.each(["Quad", "Cubic", "Quart", "Quint", "Expo"], function (e, i) { t[i] = function (t) { return Math.pow(t, e + 2) } }), e.extend(t, { Sine: function (e) { return 1 - Math.cos(e * Math.PI / 2) }, Circ: function (e) { return 1 - Math.sqrt(1 - e * e) }, Elastic: function (e) { return 0 === e || 1 === e ? e : -Math.pow(2, 8 * (e - 1)) * Math.sin((80 * (e - 1) - 7.5) * Math.PI / 15) }, Back: function (e) { return e * e * (3 * e - 2) }, Bounce: function (e) { for (var t, i = 4; ((t = Math.pow(2, --i)) - 1) / 11 > e;); return 1 / Math.pow(4, 3 - i) - 7.5625 * Math.pow((3 * t - 2) / 22 - e, 2) } }), e.each(t, function (t, i) { e.easing["easeIn" + t] = i, e.easing["easeOut" + t] = function (e) { return 1 - i(1 - e) }, e.easing["easeInOut" + t] = function (e) { return .5 > e ? i(2 * e) / 2 : 1 - i(-2 * e + 2) / 2 } }) }(); var y = e.effects; e.effects.define("blind", "hide", function (t, i) { var s = { up: ["bottom", "top"], vertical: ["bottom", "top"], down: ["top", "bottom"], left: ["right", "left"], horizontal: ["right", "left"], right: ["left", "right"] }, a = e(this), n = t.direction || "up", r = a.cssClip(), o = { clip: e.extend({}, r) }, l = e.effects.createPlaceholder(a); o.clip[s[n][0]] = o.clip[s[n][1]], "show" === t.mode && (a.cssClip(o.clip), l && l.css(e.effects.clipToBox(o)), o.clip = r), l && l.animate(e.effects.clipToBox(o), t.duration, t.easing), a.animate(o, { queue: !1, duration: t.duration, easing: t.easing, complete: i }) }), e.effects.define("bounce", function (t, i) { var s, a, n, r = e(this), o = t.mode, l = "hide" === o, h = "show" === o, u = t.direction || "up", d = t.distance, c = t.times || 5, p = 2 * c + (h || l ? 1 : 0), m = t.duration / p, f = t.easing, g = "up" === u || "down" === u ? "top" : "left", v = "up" === u || "left" === u, y = 0, _ = r.queue().length; for (e.effects.createPlaceholder(r), n = r.css(g), d || (d = r["top" === g ? "outerHeight" : "outerWidth"]() / 3), h && (a = { opacity: 1 }, a[g] = n, r.css("opacity", 0).css(g, v ? 2 * -d : 2 * d).animate(a, m, f)), l && (d /= Math.pow(2, c - 1)), a = {}, a[g] = n; c > y; y++)s = {}, s[g] = (v ? "-=" : "+=") + d, r.animate(s, m, f).animate(a, m, f), d = l ? 2 * d : d / 2; l && (s = { opacity: 0 }, s[g] = (v ? "-=" : "+=") + d, r.animate(s, m, f)), r.queue(i), e.effects.unshift(r, _, p + 1) }), e.effects.define("clip", "hide", function (t, i) { var s, a = {}, n = e(this), r = t.direction || "vertical", o = "both" === r, l = o || "horizontal" === r, h = o || "vertical" === r; s = n.cssClip(), a.clip = { top: h ? (s.bottom - s.top) / 2 : s.top, right: l ? (s.right - s.left) / 2 : s.right, bottom: h ? (s.bottom - s.top) / 2 : s.bottom, left: l ? (s.right - s.left) / 2 : s.left }, e.effects.createPlaceholder(n), "show" === t.mode && (n.cssClip(a.clip), a.clip = s), n.animate(a, { queue: !1, duration: t.duration, easing: t.easing, complete: i }) }), e.effects.define("drop", "hide", function (t, i) { var s, a = e(this), n = t.mode, r = "show" === n, o = t.direction || "left", l = "up" === o || "down" === o ? "top" : "left", h = "up" === o || "left" === o ? "-=" : "+=", u = "+=" === h ? "-=" : "+=", d = { opacity: 0 }; e.effects.createPlaceholder(a), s = t.distance || a["top" === l ? "outerHeight" : "outerWidth"](!0) / 2, d[l] = h + s, r && (a.css(d), d[l] = u + s, d.opacity = 1), a.animate(d, { queue: !1, duration: t.duration, easing: t.easing, complete: i }) }), e.effects.define("explode", "hide", function (t, i) { function s() { _.push(this), _.length === d * c && a() } function a() { p.css({ visibility: "visible" }), e(_).remove(), i() } var n, r, o, l, h, u, d = t.pieces ? Math.round(Math.sqrt(t.pieces)) : 3, c = d, p = e(this), m = t.mode, f = "show" === m, g = p.show().css("visibility", "hidden").offset(), v = Math.ceil(p.outerWidth() / c), y = Math.ceil(p.outerHeight() / d), _ = []; for (n = 0; d > n; n++)for (l = g.top + n * y, u = n - (d - 1) / 2, r = 0; c > r; r++)o = g.left + r * v, h = r - (c - 1) / 2, p.clone().appendTo("body").wrap("<div></div>").css({ position: "absolute", visibility: "visible", left: -r * v, top: -n * y }).parent().addClass("ui-effects-explode").css({ position: "absolute", overflow: "hidden", width: v, height: y, left: o + (f ? h * v : 0), top: l + (f ? u * y : 0), opacity: f ? 0 : 1 }).animate({ left: o + (f ? 0 : h * v), top: l + (f ? 0 : u * y), opacity: f ? 1 : 0 }, t.duration || 500, t.easing, s) }), e.effects.define("fade", "toggle", function (t, i) { var s = "show" === t.mode; e(this).css("opacity", s ? 0 : 1).animate({ opacity: s ? 1 : 0 }, { queue: !1, duration: t.duration, easing: t.easing, complete: i }) }), e.effects.define("fold", "hide", function (t, i) { var s = e(this), a = t.mode, n = "show" === a, r = "hide" === a, o = t.size || 15, l = /([0-9]+)%/.exec(o), h = !!t.horizFirst, u = h ? ["right", "bottom"] : ["bottom", "right"], d = t.duration / 2, c = e.effects.createPlaceholder(s), p = s.cssClip(), m = { clip: e.extend({}, p) }, f = { clip: e.extend({}, p) }, g = [p[u[0]], p[u[1]]], v = s.queue().length; l && (o = parseInt(l[1], 10) / 100 * g[r ? 0 : 1]), m.clip[u[0]] = o, f.clip[u[0]] = o, f.clip[u[1]] = 0, n && (s.cssClip(f.clip), c && c.css(e.effects.clipToBox(f)), f.clip = p), s.queue(function (i) { c && c.animate(e.effects.clipToBox(m), d, t.easing).animate(e.effects.clipToBox(f), d, t.easing), i() }).animate(m, d, t.easing).animate(f, d, t.easing).queue(i), e.effects.unshift(s, v, 4) }), e.effects.define("highlight", "show", function (t, i) { var s = e(this), a = { backgroundColor: s.css("backgroundColor") }; "hide" === t.mode && (a.opacity = 0), e.effects.saveStyle(s), s.css({ backgroundImage: "none", backgroundColor: t.color || "#ffff99" }).animate(a, { queue: !1, duration: t.duration, easing: t.easing, complete: i }) }), e.effects.define("size", function (t, i) { var s, a, n, r = e(this), o = ["fontSize"], l = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"], h = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"], u = t.mode, d = "effect" !== u, c = t.scale || "both", p = t.origin || ["middle", "center"], m = r.css("position"), f = r.position(), g = e.effects.scaledDimensions(r), v = t.from || g, y = t.to || e.effects.scaledDimensions(r, 0); e.effects.createPlaceholder(r), "show" === u && (n = v, v = y, y = n), a = { from: { y: v.height / g.height, x: v.width / g.width }, to: { y: y.height / g.height, x: y.width / g.width } }, ("box" === c || "both" === c) && (a.from.y !== a.to.y && (v = e.effects.setTransition(r, l, a.from.y, v), y = e.effects.setTransition(r, l, a.to.y, y)), a.from.x !== a.to.x && (v = e.effects.setTransition(r, h, a.from.x, v), y = e.effects.setTransition(r, h, a.to.x, y))), ("content" === c || "both" === c) && a.from.y !== a.to.y && (v = e.effects.setTransition(r, o, a.from.y, v), y = e.effects.setTransition(r, o, a.to.y, y)), p && (s = e.effects.getBaseline(p, g), v.top = (g.outerHeight - v.outerHeight) * s.y + f.top, v.left = (g.outerWidth - v.outerWidth) * s.x + f.left, y.top = (g.outerHeight - y.outerHeight) * s.y + f.top, y.left = (g.outerWidth - y.outerWidth) * s.x + f.left), r.css(v), ("content" === c || "both" === c) && (l = l.concat(["marginTop", "marginBottom"]).concat(o), h = h.concat(["marginLeft", "marginRight"]), r.find("*[width]").each(function () { var i = e(this), s = e.effects.scaledDimensions(i), n = { height: s.height * a.from.y, width: s.width * a.from.x, outerHeight: s.outerHeight * a.from.y, outerWidth: s.outerWidth * a.from.x }, r = { height: s.height * a.to.y, width: s.width * a.to.x, outerHeight: s.height * a.to.y, outerWidth: s.width * a.to.x }; a.from.y !== a.to.y && (n = e.effects.setTransition(i, l, a.from.y, n), r = e.effects.setTransition(i, l, a.to.y, r)), a.from.x !== a.to.x && (n = e.effects.setTransition(i, h, a.from.x, n), r = e.effects.setTransition(i, h, a.to.x, r)), d && e.effects.saveStyle(i), i.css(n), i.animate(r, t.duration, t.easing, function () { d && e.effects.restoreStyle(i) }) })), r.animate(y, { queue: !1, duration: t.duration, easing: t.easing, complete: function () { var t = r.offset(); 0 === y.opacity && r.css("opacity", v.opacity), d || (r.css("position", "static" === m ? "relative" : m).offset(t), e.effects.saveStyle(r)), i() } }) }), e.effects.define("scale", function (t, i) { var s = e(this), a = t.mode, n = parseInt(t.percent, 10) || (0 === parseInt(t.percent, 10) ? 0 : "effect" !== a ? 0 : 100), r = e.extend(!0, { from: e.effects.scaledDimensions(s), to: e.effects.scaledDimensions(s, n, t.direction || "both"), origin: t.origin || ["middle", "center"] }, t); t.fade && (r.from.opacity = 1, r.to.opacity = 0), e.effects.effect.size.call(this, r, i) }), e.effects.define("puff", "hide", function (t, i) { var s = e.extend(!0, {}, t, { fade: !0, percent: parseInt(t.percent, 10) || 150 }); e.effects.effect.scale.call(this, s, i) }), e.effects.define("pulsate", "show", function (t, i) { var s = e(this), a = t.mode, n = "show" === a, r = "hide" === a, o = n || r, l = 2 * (t.times || 5) + (o ? 1 : 0), h = t.duration / l, u = 0, d = 1, c = s.queue().length; for ((n || !s.is(":visible")) && (s.css("opacity", 0).show(), u = 1); l > d; d++)s.animate({ opacity: u }, h, t.easing), u = 1 - u; s.animate({ opacity: u }, h, t.easing), s.queue(i), e.effects.unshift(s, c, l + 1) }), e.effects.define("shake", function (t, i) { var s = 1, a = e(this), n = t.direction || "left", r = t.distance || 20, o = t.times || 3, l = 2 * o + 1, h = Math.round(t.duration / l), u = "up" === n || "down" === n ? "top" : "left", d = "up" === n || "left" === n, c = {}, p = {}, m = {}, f = a.queue().length; for (e.effects.createPlaceholder(a), c[u] = (d ? "-=" : "+=") + r, p[u] = (d ? "+=" : "-=") + 2 * r, m[u] = (d ? "-=" : "+=") + 2 * r, a.animate(c, h, t.easing); o > s; s++)a.animate(p, h, t.easing).animate(m, h, t.easing); a.animate(p, h, t.easing).animate(c, h / 2, t.easing).queue(i), e.effects.unshift(a, f, l + 1) }), e.effects.define("slide", "show", function (t, i) { var s, a, n = e(this), r = { up: ["bottom", "top"], down: ["top", "bottom"], left: ["right", "left"], right: ["left", "right"] }, o = t.mode, l = t.direction || "left", h = "up" === l || "down" === l ? "top" : "left", u = "up" === l || "left" === l, d = t.distance || n["top" === h ? "outerHeight" : "outerWidth"](!0), c = {}; e.effects.createPlaceholder(n), s = n.cssClip(), a = n.position()[h], c[h] = (u ? -1 : 1) * d + a, c.clip = n.cssClip(), c.clip[r[l][1]] = c.clip[r[l][0]], "show" === o && (n.cssClip(c.clip), n.css(h, c[h]), c.clip = s, c[h] = a), n.animate(c, { queue: !1, duration: t.duration, easing: t.easing, complete: i }) }); var y; e.uiBackCompat !== !1 && (y = e.effects.define("transfer", function (t, i) { e(this).transfer(t, i) }))
        });
    }(xaJquery);

    xaJquery.shouldInitialize = function () {
        return !!window.Sitecore.WebEditSettings.editing;
    };

    return xaJquery;
}();

/* == jquery mousewheel plugin == Version: 3.1.13, License: MIT License (MIT) */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});
/* == malihu jquery custom scrollbar plugin == Version: 3.1.5, License: MIT License (MIT) */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e:e(jQuery,window,document)}(function(e){!function(t){var o="function"==typeof define&&define.amd,a="undefined"!=typeof module&&module.exports,n="https:"==document.location.protocol?"https:":"http:",i="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js";o||(a?require("jquery-mousewheel")(e):e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+n+"//"+i+"%3E%3C/script%3E"))),t()}(function(){var t,o="mCustomScrollbar",a="mCS",n=".mCustomScrollbar",i={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},r=0,l={},s=window.attachEvent&&!window.addEventListener?1:0,c=!1,d=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],u={init:function(t){var t=e.extend(!0,{},i,t),o=f.call(this);if(t.live){var s=t.liveSelector||this.selector||n,c=e(s);if("off"===t.live)return void m(s);l[s]=setTimeout(function(){c.mCustomScrollbar(t),"once"===t.live&&c.length&&m(s)},500)}else m(s);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?"x":p(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,"object"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=g(t.scrollButtons.scrollType),h(t),e(o).each(function(){var o=e(this);if(!o.data(a)){o.data(a,{idx:++r,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:o.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var n=o.data(a),i=n.opt,l=o.data("mcs-axis"),s=o.data("mcs-scrollbar-position"),c=o.data("mcs-theme");l&&(i.axis=l),s&&(i.scrollbarPosition=s),c&&(i.theme=c,h(i)),v.call(this),n&&i.callbacks.onCreate&&"function"==typeof i.callbacks.onCreate&&i.callbacks.onCreate.call(this),e("#mCSB_"+n.idx+"_container img:not(."+d[2]+")").addClass(d[2]),u.update.call(null,o)}})},update:function(t,o){var n=t||f.call(this);return e(n).each(function(){var t=e(this);if(t.data(a)){var n=t.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container"),l=e("#mCSB_"+n.idx),s=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];if(!r.length)return;n.tweenRunning&&Q(t),o&&n&&i.callbacks.onBeforeUpdate&&"function"==typeof i.callbacks.onBeforeUpdate&&i.callbacks.onBeforeUpdate.call(this),t.hasClass(d[3])&&t.removeClass(d[3]),t.hasClass(d[4])&&t.removeClass(d[4]),l.css("max-height","none"),l.height()!==t.height()&&l.css("max-height",t.height()),_.call(this),"y"===i.axis||i.advanced.autoExpandHorizontalScroll||r.css("width",x(r)),n.overflowed=y.call(this),M.call(this),i.autoDraggerLength&&S.call(this),b.call(this),T.call(this);var c=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==i.axis&&(n.overflowed[0]?s[0].height()>s[0].parent().height()?B.call(this):(G(t,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}),n.contentReset.y=null):(B.call(this),"y"===i.axis?k.call(this):"yx"===i.axis&&n.overflowed[1]&&G(t,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==i.axis&&(n.overflowed[1]?s[1].width()>s[1].parent().width()?B.call(this):(G(t,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}),n.contentReset.x=null):(B.call(this),"x"===i.axis?k.call(this):"yx"===i.axis&&n.overflowed[0]&&G(t,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),o&&n&&(2===o&&i.callbacks.onImageLoad&&"function"==typeof i.callbacks.onImageLoad?i.callbacks.onImageLoad.call(this):3===o&&i.callbacks.onSelectorChange&&"function"==typeof i.callbacks.onSelectorChange?i.callbacks.onSelectorChange.call(this):i.callbacks.onUpdate&&"function"==typeof i.callbacks.onUpdate&&i.callbacks.onUpdate.call(this)),N.call(this)}})},scrollTo:function(t,o){if("undefined"!=typeof t&&null!=t){var n=f.call(this);return e(n).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,o),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=X.call(this,c[0],"y"),c[1]=X.call(this,c[1],"x"),s.moveDragger&&(c[0]*=i.scrollRatio.y,c[1]*=i.scrollRatio.x),s.dur=ne()?0:d,setTimeout(function(){null!==c[0]&&"undefined"!=typeof c[0]&&"x"!==r.axis&&i.overflowed[0]&&(s.dir="y",s.overwrite="all",G(n,c[0].toString(),s)),null!==c[1]&&"undefined"!=typeof c[1]&&"y"!==r.axis&&i.overflowed[1]&&(s.dir="x",s.overwrite="none",G(n,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=f.call(this);return e(t).each(function(){var t=e(this);t.data(a)&&Q(t)})},disable:function(t){var o=f.call(this);return e(o).each(function(){var o=e(this);if(o.data(a)){o.data(a);N.call(this,"remove"),k.call(this),t&&B.call(this),M.call(this,!0),o.addClass(d[3])}})},destroy:function(){var t=f.call(this);return e(t).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx),s=e("#mCSB_"+i.idx+"_container"),c=e(".mCSB_"+i.idx+"_scrollbar");r.live&&m(r.liveSelector||e(t).selector),N.call(this,"remove"),k.call(this),B.call(this),n.removeData(a),$(this,"mcs"),c.remove(),s.find("img."+d[2]).removeClass(d[2]),l.replaceWith(s.contents()),n.removeClass(o+" _"+a+"_"+i.idx+" "+d[6]+" "+d[7]+" "+d[5]+" "+d[3]).addClass(d[4])}})}},f=function(){return"object"!=typeof e(this)||e(this).length<1?n:this},h=function(t){var o=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],a=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,o)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,a)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},m=function(e){l[e]&&(clearTimeout(l[e]),$(l,e))},p=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},g=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},v=function(){var t=e(this),n=t.data(a),i=n.opt,r=i.autoExpandScrollbar?" "+d[1]+"_expand":"",l=["<div id='mCSB_"+n.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+n.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s="yx"===i.axis?"mCSB_vertical_horizontal":"x"===i.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===i.axis?l[0]+l[1]:"x"===i.axis?l[1]:l[0],u="yx"===i.axis?"<div id='mCSB_"+n.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",f=i.autoHideScrollbar?" "+d[6]:"",h="x"!==i.axis&&"rtl"===n.langDir?" "+d[7]:"";i.setWidth&&t.css("width",i.setWidth),i.setHeight&&t.css("height",i.setHeight),i.setLeft="y"!==i.axis&&"rtl"===n.langDir?"989999px":i.setLeft,t.addClass(o+" _"+a+"_"+n.idx+f+h).wrapInner("<div id='mCSB_"+n.idx+"' class='mCustomScrollBox mCS-"+i.theme+" "+s+"'><div id='mCSB_"+n.idx+"_container' class='mCSB_container' style='position:relative; top:"+i.setTop+"; left:"+i.setLeft+";' dir='"+n.langDir+"' /></div>");var m=e("#mCSB_"+n.idx),p=e("#mCSB_"+n.idx+"_container");"y"===i.axis||i.advanced.autoExpandHorizontalScroll||p.css("width",x(p)),"outside"===i.scrollbarPosition?("static"===t.css("position")&&t.css("position","relative"),t.css("overflow","visible"),m.addClass("mCSB_outside").after(c)):(m.addClass("mCSB_inside").append(c),p.wrap(u)),w.call(this);var g=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},x=function(t){var o=[t[0].scrollWidth,Math.max.apply(Math,t.children().map(function(){return e(this).outerWidth(!0)}).get())],a=t.parent().width();return o[0]>a?o[0]:o[1]>a?o[1]:"100%"},_=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx+"_container");if(n.advanced.autoExpandHorizontalScroll&&"y"!==n.axis){i.css({width:"auto","min-width":0,"overflow-x":"scroll"});var r=Math.ceil(i[0].scrollWidth);3===n.advanced.autoExpandHorizontalScroll||2!==n.advanced.autoExpandHorizontalScroll&&r>i.parent().width()?i.css({width:r,"min-width":"100%","overflow-x":"inherit"}):i.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(i[0].getBoundingClientRect().right+.4)-Math.floor(i[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}},w=function(){var t=e(this),o=t.data(a),n=o.opt,i=e(".mCSB_"+o.idx+"_scrollbar:first"),r=oe(n.scrollButtons.tabindex)?"tabindex='"+n.scrollButtons.tabindex+"'":"",l=["<a href='#' class='"+d[13]+"' "+r+" />","<a href='#' class='"+d[14]+"' "+r+" />","<a href='#' class='"+d[15]+"' "+r+" />","<a href='#' class='"+d[16]+"' "+r+" />"],s=["x"===n.axis?l[2]:l[0],"x"===n.axis?l[3]:l[1],l[2],l[3]];n.scrollButtons.enable&&i.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])},S=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[n.height()/i.outerHeight(!1),n.width()/i.outerWidth(!1)],c=[parseInt(r[0].css("min-height")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(l[1]*r[1].parent().width())],d=s&&c[1]<c[0]?c[0]:c[1],u=s&&c[3]<c[2]?c[2]:c[3];r[0].css({height:d,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":c[0]+"px"}),r[1].css({width:u,"max-width":r[1].parent().width()-10})},b=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[i.outerHeight(!1)-n.height(),i.outerWidth(!1)-n.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];o.scrollRatio={y:s[0],x:s[1]}},C=function(e,t,o){var a=o?d[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(d[0]+" "+a),n.toggleClass(d[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(d[0]),n.removeClass(d[1])):(e.addClass(d[0]),n.addClass(d[1])))},y=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=null==o.overflowed?i.height():i.outerHeight(!1),l=null==o.overflowed?i.width():i.outerWidth(!1),s=i[0].scrollHeight,c=i[0].scrollWidth;return s>r&&(r=s),c>l&&(l=c),[r>n.height(),l>n.width()]},B=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx),r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(Q(t),("x"!==n.axis&&!o.overflowed[0]||"y"===n.axis&&o.overflowed[0])&&(l[0].add(r).css("top",0),G(t,"_resetY")),"y"!==n.axis&&!o.overflowed[1]||"x"===n.axis&&o.overflowed[1]){var s=dx=0;"rtl"===o.langDir&&(s=i.width()-r.outerWidth(!1),dx=Math.abs(s/o.scrollRatio.x)),r.css("left",s),l[1].css("left",dx),G(t,"_resetX")}},T=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),W.call(o[0])):t()},100)}var o=e(this),n=o.data(a),i=n.opt;if(!n.bindEvents){if(I.call(this),i.contentTouchScroll&&D.call(this),E.call(this),i.mouseWheel.enable){var r;t()}P.call(this),U.call(this),i.advanced.autoScrollOnFocus&&H.call(this),i.scrollButtons.enable&&F.call(this),i.keyboard.enable&&q.call(this),n.bindEvents=!0}},k=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=".mCSB_"+o.idx+"_scrollbar",l=e("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+r+" ."+d[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+r+">a"),s=e("#mCSB_"+o.idx+"_container");n.advanced.releaseDraggableSelectors&&l.add(e(n.advanced.releaseDraggableSelectors)),n.advanced.extraDraggableSelectors&&l.add(e(n.advanced.extraDraggableSelectors)),o.bindEvents&&(e(document).add(e(!A()||top.document)).unbind("."+i),l.each(function(){e(this).unbind("."+i)}),clearTimeout(t[0]._focusTimeout),$(t[0],"_focusTimeout"),clearTimeout(o.sequential.step),$(o.sequential,"step"),clearTimeout(s[0].onCompleteTimeout),$(s[0],"onCompleteTimeout"),o.bindEvents=!1)},M=function(t){var o=e(this),n=o.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+n.idx+"_container"),s=[e("#mCSB_"+n.idx+"_scrollbar_vertical"),e("#mCSB_"+n.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];"x"!==i.axis&&(n.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children("a")).css("display","block"),l.removeClass(d[8]+" "+d[10])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[0].css("display","none"),l.removeClass(d[10])):(s[0].css("display","none"),l.addClass(d[10])),l.addClass(d[8]))),"y"!==i.axis&&(n.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children("a")).css("display","block"),l.removeClass(d[9]+" "+d[11])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[1].css("display","none"),l.removeClass(d[11])):(s[1].css("display","none"),l.addClass(d[11])),l.addClass(d[9]))),n.overflowed[0]||n.overflowed[1]?o.removeClass(d[5]):o.addClass(d[5])},O=function(t){var o=t.type,a=t.target.ownerDocument!==document&&null!==frameElement?[e(frameElement).offset().top,e(frameElement).offset().left]:null,n=A()&&t.target.ownerDocument!==top.document&&null!==frameElement?[e(t.view.frameElement).offset().top,e(t.view.frameElement).offset().left]:[0,0];switch(o){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return a?[t.originalEvent.pageY-a[0]+n[0],t.originalEvent.pageX-a[1]+n[1],!1]:[t.originalEvent.pageY,t.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],r=t.originalEvent.touches.length||t.originalEvent.changedTouches.length;return t.target.ownerDocument!==document?[i.screenY,i.screenX,r>1]:[i.pageY,i.pageX,r>1];default:return a?[t.pageY-a[0]+n[0],t.pageX-a[1]+n[1],!1]:[t.pageY,t.pageX,!1]}},I=function(){function t(e,t,a,n){if(h[0].idleTimer=d.scrollInertia<233?250:0,o.attr("id")===f[1])var i="x",s=(o[0].offsetLeft-t+n)*l.scrollRatio.x;else var i="y",s=(o[0].offsetTop-e+a)*l.scrollRatio.y;G(r,s.toString(),{dir:i,drag:!0})}var o,n,i,r=e(this),l=r.data(a),d=l.opt,u=a+"_"+l.idx,f=["mCSB_"+l.idx+"_dragger_vertical","mCSB_"+l.idx+"_dragger_horizontal"],h=e("#mCSB_"+l.idx+"_container"),m=e("#"+f[0]+",#"+f[1]),p=d.advanced.releaseDraggableSelectors?m.add(e(d.advanced.releaseDraggableSelectors)):m,g=d.advanced.extraDraggableSelectors?e(!A()||top.document).add(e(d.advanced.extraDraggableSelectors)):e(!A()||top.document);m.bind("contextmenu."+u,function(e){e.preventDefault()}).bind("mousedown."+u+" touchstart."+u+" pointerdown."+u+" MSPointerDown."+u,function(t){if(t.stopImmediatePropagation(),t.preventDefault(),ee(t)){c=!0,s&&(document.onselectstart=function(){return!1}),L.call(h,!1),Q(r),o=e(this);var a=o.offset(),l=O(t)[0]-a.top,u=O(t)[1]-a.left,f=o.height()+a.top,m=o.width()+a.left;f>l&&l>0&&m>u&&u>0&&(n=l,i=u),C(o,"active",d.autoExpandScrollbar)}}).bind("touchmove."+u,function(e){e.stopImmediatePropagation(),e.preventDefault();var a=o.offset(),r=O(e)[0]-a.top,l=O(e)[1]-a.left;t(n,i,r,l)}),e(document).add(g).bind("mousemove."+u+" pointermove."+u+" MSPointerMove."+u,function(e){if(o){var a=o.offset(),r=O(e)[0]-a.top,l=O(e)[1]-a.left;if(n===r&&i===l)return;t(n,i,r,l)}}).add(p).bind("mouseup."+u+" touchend."+u+" pointerup."+u+" MSPointerUp."+u,function(){o&&(C(o,"active",d.autoExpandScrollbar),o=null),c=!1,s&&(document.onselectstart=null),L.call(h,!0)})},D=function(){function o(e){if(!te(e)||c||O(e)[2])return void(t=0);t=1,b=0,C=0,d=1,y.removeClass("mCS_touch_action");var o=I.offset();u=O(e)[0]-o.top,f=O(e)[1]-o.left,z=[O(e)[0],O(e)[1]]}function n(e){if(te(e)&&!c&&!O(e)[2]&&(T.documentTouchScroll||e.preventDefault(),e.stopImmediatePropagation(),(!C||b)&&d)){g=K();var t=M.offset(),o=O(e)[0]-t.top,a=O(e)[1]-t.left,n="mcsLinearOut";if(E.push(o),W.push(a),z[2]=Math.abs(O(e)[0]-z[0]),z[3]=Math.abs(O(e)[1]-z[1]),B.overflowed[0])var i=D[0].parent().height()-D[0].height(),r=u-o>0&&o-u>-(i*B.scrollRatio.y)&&(2*z[3]<z[2]||"yx"===T.axis);if(B.overflowed[1])var l=D[1].parent().width()-D[1].width(),h=f-a>0&&a-f>-(l*B.scrollRatio.x)&&(2*z[2]<z[3]||"yx"===T.axis);r||h?(U||e.preventDefault(),b=1):(C=1,y.addClass("mCS_touch_action")),U&&e.preventDefault(),w="yx"===T.axis?[u-o,f-a]:"x"===T.axis?[null,f-a]:[u-o,null],I[0].idleTimer=250,B.overflowed[0]&&s(w[0],R,n,"y","all",!0),B.overflowed[1]&&s(w[1],R,n,"x",L,!0)}}function i(e){if(!te(e)||c||O(e)[2])return void(t=0);t=1,e.stopImmediatePropagation(),Q(y),p=K();var o=M.offset();h=O(e)[0]-o.top,m=O(e)[1]-o.left,E=[],W=[]}function r(e){if(te(e)&&!c&&!O(e)[2]){d=0,e.stopImmediatePropagation(),b=0,C=0,v=K();var t=M.offset(),o=O(e)[0]-t.top,a=O(e)[1]-t.left;if(!(v-g>30)){_=1e3/(v-p);var n="mcsEaseOut",i=2.5>_,r=i?[E[E.length-2],W[W.length-2]]:[0,0];x=i?[o-r[0],a-r[1]]:[o-h,a-m];var u=[Math.abs(x[0]),Math.abs(x[1])];_=i?[Math.abs(x[0]/4),Math.abs(x[1]/4)]:[_,_];var f=[Math.abs(I[0].offsetTop)-x[0]*l(u[0]/_[0],_[0]),Math.abs(I[0].offsetLeft)-x[1]*l(u[1]/_[1],_[1])];w="yx"===T.axis?[f[0],f[1]]:"x"===T.axis?[null,f[1]]:[f[0],null],S=[4*u[0]+T.scrollInertia,4*u[1]+T.scrollInertia];var y=parseInt(T.contentTouchScroll)||0;w[0]=u[0]>y?w[0]:0,w[1]=u[1]>y?w[1]:0,B.overflowed[0]&&s(w[0],S[0],n,"y",L,!1),B.overflowed[1]&&s(w[1],S[1],n,"x",L,!1)}}}function l(e,t){var o=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?o[0]:o[3]:e>60?t>3?o[3]:o[2]:e>30?t>8?o[1]:t>6?o[0]:t>4?t:o[2]:t>8?t:o[3]}function s(e,t,o,a,n,i){e&&G(y,e.toString(),{dur:t,scrollEasing:o,dir:a,overwrite:n,drag:i})}var d,u,f,h,m,p,g,v,x,_,w,S,b,C,y=e(this),B=y.data(a),T=B.opt,k=a+"_"+B.idx,M=e("#mCSB_"+B.idx),I=e("#mCSB_"+B.idx+"_container"),D=[e("#mCSB_"+B.idx+"_dragger_vertical"),e("#mCSB_"+B.idx+"_dragger_horizontal")],E=[],W=[],R=0,L="yx"===T.axis?"none":"all",z=[],P=I.find("iframe"),H=["touchstart."+k+" pointerdown."+k+" MSPointerDown."+k,"touchmove."+k+" pointermove."+k+" MSPointerMove."+k,"touchend."+k+" pointerup."+k+" MSPointerUp."+k],U=void 0!==document.body.style.touchAction&&""!==document.body.style.touchAction;I.bind(H[0],function(e){o(e)}).bind(H[1],function(e){n(e)}),M.bind(H[0],function(e){i(e)}).bind(H[2],function(e){r(e)}),P.length&&P.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(H[0],function(e){o(e),i(e)}).bind(H[1],function(e){n(e)}).bind(H[2],function(e){r(e)})})})},E=function(){function o(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function n(e,t,o){d.type=o&&i?"stepped":"stepless",d.scrollAmount=10,j(r,e,t,"mcsLinearOut",o?60:null)}var i,r=e(this),l=r.data(a),s=l.opt,d=l.sequential,u=a+"_"+l.idx,f=e("#mCSB_"+l.idx+"_container"),h=f.parent();f.bind("mousedown."+u,function(){t||i||(i=1,c=!0)}).add(document).bind("mousemove."+u,function(e){if(!t&&i&&o()){var a=f.offset(),r=O(e)[0]-a.top+f[0].offsetTop,c=O(e)[1]-a.left+f[0].offsetLeft;r>0&&r<h.height()&&c>0&&c<h.width()?d.step&&n("off",null,"stepped"):("x"!==s.axis&&l.overflowed[0]&&(0>r?n("on",38):r>h.height()&&n("on",40)),"y"!==s.axis&&l.overflowed[1]&&(0>c?n("on",37):c>h.width()&&n("on",39)))}}).bind("mouseup."+u+" dragend."+u,function(){t||(i&&(i=0,n("off",null)),c=!1)})},W=function(){function t(t,a){if(Q(o),!z(o,t.target)){var r="auto"!==i.mouseWheel.deltaFactor?parseInt(i.mouseWheel.deltaFactor):s&&t.deltaFactor<100?100:t.deltaFactor||100,d=i.scrollInertia;if("x"===i.axis||"x"===i.mouseWheel.axis)var u="x",f=[Math.round(r*n.scrollRatio.x),parseInt(i.mouseWheel.scrollAmount)],h="auto"!==i.mouseWheel.scrollAmount?f[1]:f[0]>=l.width()?.9*l.width():f[0],m=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetLeft),p=c[1][0].offsetLeft,g=c[1].parent().width()-c[1].width(),v="y"===i.mouseWheel.axis?t.deltaY||a:t.deltaX;else var u="y",f=[Math.round(r*n.scrollRatio.y),parseInt(i.mouseWheel.scrollAmount)],h="auto"!==i.mouseWheel.scrollAmount?f[1]:f[0]>=l.height()?.9*l.height():f[0],m=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetTop),p=c[0][0].offsetTop,g=c[0].parent().height()-c[0].height(),v=t.deltaY||a;"y"===u&&!n.overflowed[0]||"x"===u&&!n.overflowed[1]||((i.mouseWheel.invert||t.webkitDirectionInvertedFromDevice)&&(v=-v),i.mouseWheel.normalizeDelta&&(v=0>v?-1:1),(v>0&&0!==p||0>v&&p!==g||i.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),t.deltaFactor<5&&!i.mouseWheel.normalizeDelta&&(h=t.deltaFactor,d=17),G(o,(m-v*h).toString(),{dir:u,dur:d}))}}if(e(this).data(a)){var o=e(this),n=o.data(a),i=n.opt,r=a+"_"+n.idx,l=e("#mCSB_"+n.idx),c=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")],d=e("#mCSB_"+n.idx+"_container").find("iframe");d.length&&d.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind("mousewheel."+r,function(e,o){t(e,o)})})}),l.bind("mousewheel."+r,function(e,o){t(e,o)})}},R=new Object,A=function(t){var o=!1,a=!1,n=null;if(void 0===t?a="#empty":void 0!==e(t).attr("id")&&(a=e(t).attr("id")),a!==!1&&void 0!==R[a])return R[a];if(t){try{var i=t.contentDocument||t.contentWindow.document;n=i.body.innerHTML}catch(r){}o=null!==n}else{try{var i=top.document;n=i.body.innerHTML}catch(r){}o=null!==n}return a!==!1&&(R[a]=o),o},L=function(e){var t=this.find("iframe");if(t.length){var o=e?"auto":"none";t.css("pointer-events",o)}},z=function(t,o){var n=o.nodeName.toLowerCase(),i=t.data(a).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(n,i)>-1&&!(e.inArray(n,r)>-1&&!e(o).is(":focus"))},P=function(){var t,o=e(this),n=o.data(a),i=a+"_"+n.idx,r=e("#mCSB_"+n.idx+"_container"),l=r.parent(),s=e(".mCSB_"+n.idx+"_scrollbar ."+d[12]);s.bind("mousedown."+i+" touchstart."+i+" pointerdown."+i+" MSPointerDown."+i,function(o){c=!0,e(o.target).hasClass("mCSB_dragger")||(t=1)}).bind("touchend."+i+" pointerup."+i+" MSPointerUp."+i,function(){c=!1}).bind("click."+i,function(a){if(t&&(t=0,e(a.target).hasClass(d[12])||e(a.target).hasClass("mCSB_draggerRail"))){Q(o);var i=e(this),s=i.find(".mCSB_dragger");if(i.parent(".mCSB_scrollTools_horizontal").length>0){if(!n.overflowed[1])return;var c="x",u=a.pageX>s.offset().left?-1:1,f=Math.abs(r[0].offsetLeft)-u*(.9*l.width())}else{if(!n.overflowed[0])return;var c="y",u=a.pageY>s.offset().top?-1:1,f=Math.abs(r[0].offsetTop)-u*(.9*l.height())}G(o,f.toString(),{dir:c,scrollEasing:"mcsEaseInOut"})}})},H=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=e("#mCSB_"+o.idx+"_container"),l=r.parent();r.bind("focusin."+i,function(){var o=e(document.activeElement),a=r.find(".mCustomScrollBox").length,i=0;o.is(n.advanced.autoScrollOnFocus)&&(Q(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=a?(i+17)*a:0,t[0]._focusTimeout=setTimeout(function(){var e=[ae(o)[0],ae(o)[1]],a=[r[0].offsetTop,r[0].offsetLeft],s=[a[0]+e[0]>=0&&a[0]+e[0]<l.height()-o.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<l.width()-o.outerWidth(!1)],c="yx"!==n.axis||s[0]||s[1]?"all":"none";"x"===n.axis||s[0]||G(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:i}),"y"===n.axis||s[1]||G(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:i})},t[0]._focusTimer))})},U=function(){var t=e(this),o=t.data(a),n=a+"_"+o.idx,i=e("#mCSB_"+o.idx+"_container").parent();i.bind("scroll."+n,function(){0===i.scrollTop()&&0===i.scrollLeft()||e(".mCSB_"+o.idx+"_scrollbar").css("visibility","hidden")})},F=function(){var t=e(this),o=t.data(a),n=o.opt,i=o.sequential,r=a+"_"+o.idx,l=".mCSB_"+o.idx+"_scrollbar",s=e(l+">a");s.bind("contextmenu."+r,function(e){e.preventDefault()}).bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(a){function r(e,o){i.scrollAmount=n.scrollButtons.scrollAmount,j(t,e,o)}if(a.preventDefault(),ee(a)){var l=e(this).attr("class");switch(i.type=n.scrollButtons.scrollType,a.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===i.type)return;c=!0,o.tweenRunning=!1,r("on",l);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===i.type)return;c=!1,i.dir&&r("off",l);break;case"click":if("stepped"!==i.type||o.tweenRunning)return;r("on",l)}}})},q=function(){function t(t){function a(e,t){r.type=i.keyboard.scrollType,r.scrollAmount=i.keyboard.scrollAmount,"stepped"===r.type&&n.tweenRunning||j(o,e,t)}switch(t.type){case"blur":n.tweenRunning&&r.dir&&a("off",null);break;case"keydown":case"keyup":var l=t.keyCode?t.keyCode:t.which,s="on";if("x"!==i.axis&&(38===l||40===l)||"y"!==i.axis&&(37===l||39===l)){if((38===l||40===l)&&!n.overflowed[0]||(37===l||39===l)&&!n.overflowed[1])return;"keyup"===t.type&&(s="off"),e(document.activeElement).is(u)||(t.preventDefault(),t.stopImmediatePropagation(),a(s,l))}else if(33===l||34===l){if((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type){Q(o);var f=34===l?-1:1;if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=Math.abs(c[0].offsetLeft)-f*(.9*d.width());else var h="y",m=Math.abs(c[0].offsetTop)-f*(.9*d.height());G(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}else if((35===l||36===l)&&!e(document.activeElement).is(u)&&((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type)){if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=35===l?Math.abs(d.width()-c.outerWidth(!1)):0;else var h="y",m=35===l?Math.abs(d.height()-c.outerHeight(!1)):0;G(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}}var o=e(this),n=o.data(a),i=n.opt,r=n.sequential,l=a+"_"+n.idx,s=e("#mCSB_"+n.idx),c=e("#mCSB_"+n.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']",f=c.find("iframe"),h=["blur."+l+" keydown."+l+" keyup."+l];f.length&&f.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(h[0],function(e){t(e)})})}),s.attr("tabindex","0").bind(h[0],function(e){t(e)})},j=function(t,o,n,i,r){function l(e){u.snapAmount&&(f.scrollAmount=u.snapAmount instanceof Array?"x"===f.dir[0]?u.snapAmount[1]:u.snapAmount[0]:u.snapAmount);var o="stepped"!==f.type,a=r?r:e?o?p/1.5:g:1e3/60,n=e?o?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],m="x"===f.dir[0]?s[1]+f.dir[1]*(d[1]*n):s[0]+f.dir[1]*(d[0]*n),v="x"===f.dir[0]?s[1]+f.dir[1]*parseInt(f.scrollAmount):s[0]+f.dir[1]*parseInt(f.scrollAmount),x="auto"!==f.scrollAmount?v:m,_=i?i:e?o?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",w=!!e;return e&&17>a&&(x="x"===f.dir[0]?s[1]:s[0]),G(t,x.toString(),{dir:f.dir[0],scrollEasing:_,dur:a,onComplete:w}),e?void(f.dir=!1):(clearTimeout(f.step),void(f.step=setTimeout(function(){l()},a)))}function s(){clearTimeout(f.step),$(f,"step"),Q(t)}var c=t.data(a),u=c.opt,f=c.sequential,h=e("#mCSB_"+c.idx+"_container"),m="stepped"===f.type,p=u.scrollInertia<26?26:u.scrollInertia,g=u.scrollInertia<1?17:u.scrollInertia;switch(o){case"on":if(f.dir=[n===d[16]||n===d[15]||39===n||37===n?"x":"y",n===d[13]||n===d[15]||38===n||37===n?-1:1],Q(t),oe(n)&&"stepped"===f.type)return;l(m);break;case"off":s(),(m||c.tweenRunning&&f.dir)&&l(!0)}},Y=function(t){var o=e(this).data(a).opt,n=[];return"function"==typeof t&&(t=t()),t instanceof Array?n=t.length>1?[t[0],t[1]]:"x"===o.axis?[null,t[0]]:[t[0],null]:(n[0]=t.y?t.y:t.x||"x"===o.axis?null:t,n[1]=t.x?t.x:t.y||"y"===o.axis?null:t),"function"==typeof n[0]&&(n[0]=n[0]()),"function"==typeof n[1]&&(n[1]=n[1]()),n},X=function(t,o){if(null!=t&&"undefined"!=typeof t){var n=e(this),i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx+"_container"),s=l.parent(),c=typeof t;o||(o="x"===r.axis?"x":"y");var d="x"===o?l.outerWidth(!1)-s.width():l.outerHeight(!1)-s.height(),f="x"===o?l[0].offsetLeft:l[0].offsetTop,h="x"===o?"left":"top";switch(c){case"function":return t();case"object":var m=t.jquery?t:e(t);if(!m.length)return;return"x"===o?ae(m)[1]:ae(m)[0];case"string":case"number":if(oe(t))return Math.abs(t);if(-1!==t.indexOf("%"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf("-="))return Math.abs(f-parseInt(t.split("-=")[1]));if(-1!==t.indexOf("+=")){var p=f+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf("px")&&oe(t.split("px")[0]))return Math.abs(t.split("px")[0]);if("top"===t||"left"===t)return 0;if("bottom"===t)return Math.abs(s.height()-l.outerHeight(!1));if("right"===t)return Math.abs(s.width()-l.outerWidth(!1));if("first"===t||"last"===t){var m=l.find(":"+t);return"x"===o?ae(m)[1]:ae(m)[0]}return e(t).length?"x"===o?ae(e(t))[1]:ae(e(t))[0]:(l.css(h,t),void u.update.call(null,n[0]))}}},N=function(t){function o(){return clearTimeout(f[0].autoUpdate),0===l.parents("html").length?void(l=null):void(f[0].autoUpdate=setTimeout(function(){return c.advanced.updateOnSelectorChange&&(s.poll.change.n=i(),s.poll.change.n!==s.poll.change.o)?(s.poll.change.o=s.poll.change.n,void r(3)):c.advanced.updateOnContentResize&&(s.poll.size.n=l[0].scrollHeight+l[0].scrollWidth+f[0].offsetHeight+l[0].offsetHeight+l[0].offsetWidth,s.poll.size.n!==s.poll.size.o)?(s.poll.size.o=s.poll.size.n,void r(1)):!c.advanced.updateOnImageLoad||"auto"===c.advanced.updateOnImageLoad&&"y"===c.axis||(s.poll.img.n=f.find("img").length,s.poll.img.n===s.poll.img.o)?void((c.advanced.updateOnSelectorChange||c.advanced.updateOnContentResize||c.advanced.updateOnImageLoad)&&o()):(s.poll.img.o=s.poll.img.n,void f.find("img").each(function(){n(this)}))},c.advanced.autoUpdateTimeout))}function n(t){function o(e,t){return function(){
    return t.apply(e,arguments)}}function a(){this.onload=null,e(t).addClass(d[2]),r(2)}if(e(t).hasClass(d[2]))return void r();var n=new Image;n.onload=o(n,a),n.src=t.src}function i(){c.advanced.updateOnSelectorChange===!0&&(c.advanced.updateOnSelectorChange="*");var e=0,t=f.find(c.advanced.updateOnSelectorChange);return c.advanced.updateOnSelectorChange&&t.length>0&&t.each(function(){e+=this.offsetHeight+this.offsetWidth}),e}function r(e){clearTimeout(f[0].autoUpdate),u.update.call(null,l[0],e)}var l=e(this),s=l.data(a),c=s.opt,f=e("#mCSB_"+s.idx+"_container");return t?(clearTimeout(f[0].autoUpdate),void $(f[0],"autoUpdate")):void o()},V=function(e,t,o){return Math.round(e/t)*t-o},Q=function(t){var o=t.data(a),n=e("#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal");n.each(function(){Z.call(this)})},G=function(t,o,n){function i(e){return s&&c.callbacks[e]&&"function"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||w>=S[0]+y,c.callbacks.alwaysTriggerOffsets||-B>=w]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],o=[x[0].offsetTop,x[0].offsetLeft],a=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:o[0],draggerLeft:o[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(a[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(a[1])-i[1])),direction:n.dir}}var s=t.data(a),c=s.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},n=e.extend(d,n),u=[n.dur,n.drag?0:n.dur],f=e("#mCSB_"+s.idx),h=e("#mCSB_"+s.idx+"_container"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];if(s.trigger=n.trigger,0===m.scrollTop()&&0===m.scrollLeft()||(e(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible"),m.scrollTop(0).scrollLeft(0)),"_resetY"!==o||s.contentReset.y||(i("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),"_resetX"!==o||s.contentReset.x||(i("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),"_resetY"!==o&&"_resetX"!==o){if(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(i("onOverflowY")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(i("onOverflowX")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount){var v=c.snapAmount instanceof Array?"x"===n.dir?c.snapAmount[1]:c.snapAmount[0]:c.snapAmount;o=V(o,v,c.snapOffset)}switch(n.dir){case"x":var x=e("#mCSB_"+s.idx+"_dragger_horizontal"),_="left",w=h[0].offsetLeft,S=[f.width()-h.outerWidth(!1),x.parent().width()-x.width()],b=[o,0===o?0:o/s.scrollRatio.x],y=p[1],B=g[1],T=y>0?y/s.scrollRatio.x:0,k=B>0?B/s.scrollRatio.x:0;break;case"y":var x=e("#mCSB_"+s.idx+"_dragger_vertical"),_="top",w=h[0].offsetTop,S=[f.height()-h.outerHeight(!1),x.parent().height()-x.height()],b=[o,0===o?0:o/s.scrollRatio.y],y=p[0],B=g[0],T=y>0?y/s.scrollRatio.y:0,k=B>0?B/s.scrollRatio.y:0}b[1]<0||0===b[0]&&0===b[1]?b=[0,0]:b[1]>=S[1]?b=[S[0],S[1]]:b[0]=-b[0],t[0].mcs||(l(),i("onInit")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),J(x[0],_,Math.round(b[1]),u[1],n.scrollEasing),!s.tweenRunning&&(0===w&&b[0]>=0||w===S[0]&&b[0]<=S[0])||J(h[0],_,Math.round(b[0]),u[0],n.scrollEasing,n.overwrite,{onStart:function(){n.callbacks&&n.onStart&&!s.tweenRunning&&(i("onScrollStart")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,C(x),s.cbOffsets=r())},onUpdate:function(){n.callbacks&&n.onUpdate&&i("whileScrolling")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(n.callbacks&&n.onComplete){"yx"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){i("onScroll")&&(l(),c.callbacks.onScroll.call(t[0])),i("onTotalScroll")&&b[1]>=S[1]-T&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),i("onTotalScrollBack")&&b[1]<=k&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,C(x,"hide")},e)}}})}},J=function(e,t,o,a,n,i,r){function l(){S.stop||(x||m.call(),x=K()-v,s(),x>=S.time&&(S.time=x>S.time?x+f-(x-S.time):x+f-1,S.time<x+1&&(S.time=x+1)),S.time<a?S.id=h(l):g.call())}function s(){a>0?(S.currVal=u(S.time,_,b,a,n),w[t]=Math.round(S.currVal)+"px"):w[t]=o+"px",p.call()}function c(){f=1e3/60,S.time=x+f,h=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return s(),setTimeout(e,.01)},S.id=h(l)}function d(){null!=S.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(S.id):clearTimeout(S.id),S.id=null)}function u(e,t,o,a,n){switch(n){case"linear":case"mcsLinear":return o*e/a+t;case"mcsLinearOut":return e/=a,e--,o*Math.sqrt(1-e*e)+t;case"easeInOutSmooth":return e/=a/2,1>e?o/2*e*e+t:(e--,-o/2*(e*(e-2)-1)+t);case"easeInOutStrong":return e/=a/2,1>e?o/2*Math.pow(2,10*(e-1))+t:(e--,o/2*(-Math.pow(2,-10*e)+2)+t);case"easeInOut":case"mcsEaseInOut":return e/=a/2,1>e?o/2*e*e*e+t:(e-=2,o/2*(e*e*e+2)+t);case"easeOutSmooth":return e/=a,e--,-o*(e*e*e*e-1)+t;case"easeOutStrong":return o*(-Math.pow(2,-10*e/a)+1)+t;case"easeOut":case"mcsEaseOut":default:var i=(e/=a)*e,r=i*e;return t+o*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var f,h,r=r||{},m=r.onStart||function(){},p=r.onUpdate||function(){},g=r.onComplete||function(){},v=K(),x=0,_=e.offsetTop,w=e.style,S=e._mTween[t];"left"===t&&(_=e.offsetLeft);var b=o-_;S.stop=0,"none"!==i&&d(),c()},K=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},Z=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var t=["top","left"],o=0;o<t.length;o++){var a=t[o];e._mTween[a].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._mTween[a].id):clearTimeout(e._mTween[a].id),e._mTween[a].id=null,e._mTween[a].stop=1)}},$=function(e,t){try{delete e[t]}catch(o){e[t]=null}},ee=function(e){return!(e.which&&1!==e.which)},te=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},oe=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ae=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]},ne=function(){function e(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}var t=e();return t?document[t]:!1};e.fn[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o].defaults=i,window[o]=!0,e(window).bind("load",function(){e(n)[o](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var o,a,n=e(t),i=n.parents(".mCSB_container");if(i.length)return o=i.parent(),a=[i[0].offsetTop,i[0].offsetLeft],a[0]+ae(n)[0]>=0&&a[0]+ae(n)[0]<o.height()-n.outerHeight(!1)&&a[1]+ae(n)[1]>=0&&a[1]+ae(n)[1]<o.width()-n.outerWidth(!1)},mcsInSight:e.expr[":"].mcsInSight||function(t,o,a){var n,i,r,l,s=e(t),c=s.parents(".mCSB_container"),d="exact"===a[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(c.length)return n=[s.outerHeight(!1),s.outerWidth(!1)],r=[c[0].offsetTop+ae(s)[0],c[0].offsetLeft+ae(s)[1]],i=[c.parent()[0].offsetHeight,c.parent()[0].offsetWidth],l=[n[0]<i[0]?d[0]:d[1],n[1]<i[1]?d[0]:d[1]],r[0]-i[0]*l[0][0]<0&&r[0]+n[0]-i[0]*l[0][1]>=0&&r[1]-i[1]*l[1][0]<0&&r[1]+n[1]-i[1]*l[1][1]>=0},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var o=e(t).data(a);if(o)return o.overflowed[0]||o.overflowed[1]}})})})});
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);
/*! modernizr 3.5.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-applicationcache-audio-backgroundsize-borderimage-borderradius-boxshadow-canvas-canvastext-cssanimations-csscolumns-cssgradients-cssreflections-csstransforms-csstransforms3d-csstransitions-flexbox-fontface-generatedcontent-geolocation-hashchange-history-hsla-indexeddb-inlinesvg-input-inputtypes-localstorage-multiplebgs-opacity-postmessage-rgba-sessionstorage-smil-svg-svgclippaths-textshadow-video-webgl-websockets-websqldatabase-webworkers-addtest-domprefixes-hasevent-mq-prefixed-prefixes-setclasses-shiv-testallprops-testprop-teststyles !*/
!function(e,t,n){function r(e,t){return typeof e===t}function a(){var e,t,n,a,o,i,s;for(var c in w)if(w.hasOwnProperty(c)){if(e=[],t=w[c],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(a=r(t.fn,"function")?t.fn():t.fn,o=0;o<e.length;o++)i=e[o],s=i.split("."),1===s.length?Modernizr[s[0]]=a:(!Modernizr[s[0]]||Modernizr[s[0]]instanceof Boolean||(Modernizr[s[0]]=new Boolean(Modernizr[s[0]])),Modernizr[s[0]][s[1]]=a),T.push((a?"":"no-")+s.join("-"))}}function o(e){var t=C.className,n=Modernizr._config.classPrefix||"";if(E&&(t=t.baseVal),Modernizr._config.enableJSClass){var r=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(r,"$1"+n+"js$2")}Modernizr._config.enableClasses&&(t+=" "+n+e.join(" "+n),E?C.className.baseVal=t:C.className=t)}function i(e,t){if("object"==typeof e)for(var n in e)A(e,n)&&i(n,e[n]);else{e=e.toLowerCase();var r=e.split("."),a=Modernizr[r[0]];if(2==r.length&&(a=a[r[1]]),"undefined"!=typeof a)return Modernizr;t="function"==typeof t?t():t,1==r.length?Modernizr[r[0]]=t:(!Modernizr[r[0]]||Modernizr[r[0]]instanceof Boolean||(Modernizr[r[0]]=new Boolean(Modernizr[r[0]])),Modernizr[r[0]][r[1]]=t),o([(t&&0!=t?"":"no-")+r.join("-")]),Modernizr._trigger(e,t)}return Modernizr}function s(){return"function"!=typeof t.createElement?t.createElement(arguments[0]):E?t.createElementNS.call(t,"http://www.w3.org/2000/svg",arguments[0]):t.createElement.apply(t,arguments)}function c(e){return e.replace(/([a-z])-([a-z])/g,function(e,t,n){return t+n.toUpperCase()}).replace(/^-/,"")}function l(e,t){return!!~(""+e).indexOf(t)}function d(){var e=t.body;return e||(e=s(E?"svg":"body"),e.fake=!0),e}function u(e,n,r,a){var o,i,c,l,u="modernizr",f=s("div"),p=d();if(parseInt(r,10))for(;r--;)c=s("div"),c.id=a?a[r]:u+(r+1),f.appendChild(c);return o=s("style"),o.type="text/css",o.id="s"+u,(p.fake?p:f).appendChild(o),p.appendChild(f),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),f.id=u,p.fake&&(p.style.background="",p.style.overflow="hidden",l=C.style.overflow,C.style.overflow="hidden",C.appendChild(p)),i=n(f,e),p.fake?(p.parentNode.removeChild(p),C.style.overflow=l,C.offsetHeight):f.parentNode.removeChild(f),!!i}function f(e,t){return function(){return e.apply(t,arguments)}}function p(e,t,n){var a;for(var o in e)if(e[o]in t)return n===!1?e[o]:(a=t[e[o]],r(a,"function")?f(a,n||t):a);return!1}function m(e){return e.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-")}function g(t,n,r){var a;if("getComputedStyle"in e){a=getComputedStyle.call(e,t,n);var o=e.console;if(null!==a)r&&(a=a.getPropertyValue(r));else if(o){var i=o.error?"error":"log";o[i].call(o,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}}else a=!n&&t.currentStyle&&t.currentStyle[r];return a}function h(t,r){var a=t.length;if("CSS"in e&&"supports"in e.CSS){for(;a--;)if(e.CSS.supports(m(t[a]),r))return!0;return!1}if("CSSSupportsRule"in e){for(var o=[];a--;)o.push("("+m(t[a])+":"+r+")");return o=o.join(" or "),u("@supports ("+o+") { #modernizr { position: absolute; } }",function(e){return"absolute"==g(e,null,"position")})}return n}function v(e,t,a,o){function i(){u&&(delete G.style,delete G.modElem)}if(o=r(o,"undefined")?!1:o,!r(a,"undefined")){var d=h(e,a);if(!r(d,"undefined"))return d}for(var u,f,p,m,g,v=["modernizr","tspan","samp"];!G.style&&v.length;)u=!0,G.modElem=s(v.shift()),G.style=G.modElem.style;for(p=e.length,f=0;p>f;f++)if(m=e[f],g=G.style[m],l(m,"-")&&(m=c(m)),G.style[m]!==n){if(o||r(a,"undefined"))return i(),"pfx"==t?m:!0;try{G.style[m]=a}catch(y){}if(G.style[m]!=g)return i(),"pfx"==t?m:!0}return i(),!1}function y(e,t,n,a,o){var i=e.charAt(0).toUpperCase()+e.slice(1),s=(e+" "+q.join(i+" ")+i).split(" ");return r(t,"string")||r(t,"undefined")?v(s,t,a,o):(s=(e+" "+N.join(i+" ")+i).split(" "),p(s,t,n))}function b(e,t){var n=e.deleteDatabase(t);n.onsuccess=function(){i("indexeddb.deletedatabase",!0)},n.onerror=function(){i("indexeddb.deletedatabase",!1)}}function x(e,t,r){return y(e,n,n,t,r)}var T=[],w=[],S={_version:"3.5.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){w.push({name:e,fn:t,options:n})},addAsyncTest:function(e){w.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=S,Modernizr=new Modernizr;var C=t.documentElement,E="svg"===C.nodeName.toLowerCase(),k=S._config.usePrefixes?" -webkit- -moz- -o- -ms- ".split(" "):["",""];S._prefixes=k;E||!function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=b.elements;return"string"==typeof e?e.split(" "):e}function a(e,t){var n=b.elements;"string"!=typeof n&&(n=n.join(" ")),"string"!=typeof e&&(e=e.join(" ")),b.elements=n+" "+e,l(t)}function o(e){var t=y[e[h]];return t||(t={},v++,e[h]=v,y[v]=t),t}function i(e,n,r){if(n||(n=t),u)return n.createElement(e);r||(r=o(n));var a;return a=r.cache[e]?r.cache[e].cloneNode():g.test(e)?(r.cache[e]=r.createElem(e)).cloneNode():r.createElem(e),!a.canHaveChildren||m.test(e)||a.tagUrn?a:r.frag.appendChild(a)}function s(e,n){if(e||(e=t),u)return e.createDocumentFragment();n=n||o(e);for(var a=n.frag.cloneNode(),i=0,s=r(),c=s.length;c>i;i++)a.createElement(s[i]);return a}function c(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return b.shivMethods?i(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/[\w\-:]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(b,t.frag)}function l(e){e||(e=t);var r=o(e);return!b.shivCSS||d||r.hasCSS||(r.hasCSS=!!n(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||c(e,r),e}var d,u,f="3.7.3",p=e.html5||{},m=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,g=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,h="_html5shiv",v=0,y={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",d="hidden"in e,u=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){d=!0,u=!0}}();var b={elements:p.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:f,shivCSS:p.shivCSS!==!1,supportsUnknownElements:u,shivMethods:p.shivMethods!==!1,type:"default",shivDocument:l,createElement:i,createDocumentFragment:s,addElements:a};e.html5=b,l(t),"object"==typeof module&&module.exports&&(module.exports=b)}("undefined"!=typeof e?e:this,t),Modernizr.addTest("applicationcache","applicationCache"in e),Modernizr.addTest("geolocation","geolocation"in navigator),Modernizr.addTest("history",function(){var t=navigator.userAgent;return-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone")||"file:"===location.protocol?e.history&&"pushState"in e.history:!1}),Modernizr.addTest("postmessage","postMessage"in e),Modernizr.addTest("svg",!!t.createElementNS&&!!t.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect);var _=!1;try{_="WebSocket"in e&&2===e.WebSocket.CLOSING}catch(P){}Modernizr.addTest("websockets",_),Modernizr.addTest("localstorage",function(){var e="modernizr";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}),Modernizr.addTest("sessionstorage",function(){var e="modernizr";try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(t){return!1}}),Modernizr.addTest("websqldatabase","openDatabase"in e),Modernizr.addTest("webworkers","Worker"in e);var z="Moz O ms Webkit",N=S._config.usePrefixes?z.toLowerCase().split(" "):[];S._domPrefixes=N;var A;!function(){var e={}.hasOwnProperty;A=r(e,"undefined")||r(e.call,"undefined")?function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")}:function(t,n){return e.call(t,n)}}(),S._l={},S.on=function(e,t){this._l[e]||(this._l[e]=[]),this._l[e].push(t),Modernizr.hasOwnProperty(e)&&setTimeout(function(){Modernizr._trigger(e,Modernizr[e])},0)},S._trigger=function(e,t){if(this._l[e]){var n=this._l[e];setTimeout(function(){var e,r;for(e=0;e<n.length;e++)(r=n[e])(t)},0),delete this._l[e]}},Modernizr._q.push(function(){S.addTest=i});var R=function(){function e(e,t){var a;return e?(t&&"string"!=typeof t||(t=s(t||"div")),e="on"+e,a=e in t,!a&&r&&(t.setAttribute||(t=s("div")),t.setAttribute(e,""),a="function"==typeof t[e],t[e]!==n&&(t[e]=n),t.removeAttribute(e)),a):!1}var r=!("onblur"in t.documentElement);return e}();S.hasEvent=R,Modernizr.addTest("hashchange",function(){return R("hashchange",e)===!1?!1:t.documentMode===n||t.documentMode>7}),Modernizr.addTest("audio",function(){var e=s("audio"),t=!1;try{t=!!e.canPlayType,t&&(t=new Boolean(t),t.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),t.mp3=e.canPlayType('audio/mpeg; codecs="mp3"').replace(/^no$/,""),t.opus=e.canPlayType('audio/ogg; codecs="opus"')||e.canPlayType('audio/webm; codecs="opus"').replace(/^no$/,""),t.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),t.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(n){}return t}),Modernizr.addTest("canvas",function(){var e=s("canvas");return!(!e.getContext||!e.getContext("2d"))}),Modernizr.addTest("canvastext",function(){return Modernizr.canvas===!1?!1:"function"==typeof s("canvas").getContext("2d").fillText}),Modernizr.addTest("webgl",function(){var t=s("canvas"),n="probablySupportsContext"in t?"probablySupportsContext":"supportsContext";return n in t?t[n]("webgl")||t[n]("experimental-webgl"):"WebGLRenderingContext"in e}),Modernizr.addTest("video",function(){var e=s("video"),t=!1;try{t=!!e.canPlayType,t&&(t=new Boolean(t),t.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),t.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),t.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""),t.vp9=e.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,""),t.hls=e.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,""))}catch(n){}return t}),Modernizr.addTest("cssgradients",function(){for(var e,t="background-image:",n="gradient(linear,left top,right bottom,from(#9f9),to(white));",r="",a=0,o=k.length-1;o>a;a++)e=0===a?"to ":"",r+=t+k[a]+"linear-gradient("+e+"left top, #9f9, white);";Modernizr._config.usePrefixes&&(r+=t+"-webkit-"+n);var i=s("a"),c=i.style;return c.cssText=r,(""+c.backgroundImage).indexOf("gradient")>-1}),Modernizr.addTest("opacity",function(){var e=s("a").style;return e.cssText=k.join("opacity:.55;"),/^0.55$/.test(e.opacity)}),Modernizr.addTest("multiplebgs",function(){var e=s("a").style;return e.cssText="background:url(https://),url(https://),red url(https://)",/(url\s*\(.*?){3}/.test(e.background)}),Modernizr.addTest("rgba",function(){var e=s("a").style;return e.cssText="background-color:rgba(150,255,150,.5)",(""+e.backgroundColor).indexOf("rgba")>-1}),Modernizr.addTest("inlinesvg",function(){var e=s("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"==("undefined"!=typeof SVGRect&&e.firstChild&&e.firstChild.namespaceURI)});var $=s("input"),M="autocomplete autofocus list placeholder max min multiple pattern required step".split(" "),O={};Modernizr.input=function(t){for(var n=0,r=t.length;r>n;n++)O[t[n]]=!!(t[n]in $);return O.list&&(O.list=!(!s("datalist")||!e.HTMLDataListElement)),O}(M);var L="search tel url email datetime date month week time datetime-local number range color".split(" "),B={};Modernizr.inputtypes=function(e){for(var r,a,o,i=e.length,s="1)",c=0;i>c;c++)$.setAttribute("type",r=e[c]),o="text"!==$.type&&"style"in $,o&&($.value=s,$.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(r)&&$.style.WebkitAppearance!==n?(C.appendChild($),a=t.defaultView,o=a.getComputedStyle&&"textfield"!==a.getComputedStyle($,null).WebkitAppearance&&0!==$.offsetHeight,C.removeChild($)):/^(search|tel)$/.test(r)||(o=/^(url|email)$/.test(r)?$.checkValidity&&$.checkValidity()===!1:$.value!=s)),B[e[c]]=!!o;return B}(L),Modernizr.addTest("hsla",function(){var e=s("a").style;return e.cssText="background-color:hsla(120,40%,100%,.5)",l(e.backgroundColor,"rgba")||l(e.backgroundColor,"hsla")});var j="CSS"in e&&"supports"in e.CSS,F="supportsCSS"in e;Modernizr.addTest("supports",j||F);var I={}.toString;Modernizr.addTest("svgclippaths",function(){return!!t.createElementNS&&/SVGClipPath/.test(I.call(t.createElementNS("http://www.w3.org/2000/svg","clipPath")))}),Modernizr.addTest("smil",function(){return!!t.createElementNS&&/SVGAnimate/.test(I.call(t.createElementNS("http://www.w3.org/2000/svg","animate")))});var D=function(){var t=e.matchMedia||e.msMatchMedia;return t?function(e){var n=t(e);return n&&n.matches||!1}:function(t){var n=!1;return u("@media "+t+" { #modernizr { position: absolute; } }",function(t){n="absolute"==(e.getComputedStyle?e.getComputedStyle(t,null):t.currentStyle).position}),n}}();S.mq=D;var V=S.testStyles=u;V('#modernizr{font:0/0 a}#modernizr:after{content:":)";visibility:hidden;font:7px/1 a}',function(e){Modernizr.addTest("generatedcontent",e.offsetHeight>=6)});var W=function(){var e=navigator.userAgent,t=e.match(/w(eb)?osbrowser/gi),n=e.match(/windows phone/gi)&&e.match(/iemobile\/([0-9])+/gi)&&parseFloat(RegExp.$1)>=9;return t||n}();W?Modernizr.addTest("fontface",!1):V('@font-face {font-family:"font";src:url("https://")}',function(e,n){var r=t.getElementById("smodernizr"),a=r.sheet||r.styleSheet,o=a?a.cssRules&&a.cssRules[0]?a.cssRules[0].cssText:a.cssText||"":"",i=/src/i.test(o)&&0===o.indexOf(n.split(" ")[0]);Modernizr.addTest("fontface",i)});var q=S._config.usePrefixes?z.split(" "):[];S._cssomPrefixes=q;var H=function(t){var r,a=k.length,o=e.CSSRule;if("undefined"==typeof o)return n;if(!t)return!1;if(t=t.replace(/^@/,""),r=t.replace(/-/g,"_").toUpperCase()+"_RULE",r in o)return"@"+t;for(var i=0;a>i;i++){var s=k[i],c=s.toUpperCase()+"_"+r;if(c in o)return"@-"+s.toLowerCase()+"-"+t}return!1};S.atRule=H;var U={elem:s("modernizr")};Modernizr._q.push(function(){delete U.elem});var G={style:U.elem.style};Modernizr._q.unshift(function(){delete G.style});var J=S.testProp=function(e,t,r){return v([e],n,t,r)};Modernizr.addTest("textshadow",J("textShadow","1px 1px")),S.testAllProps=y;var Z=S.prefixed=function(e,t,n){return 0===e.indexOf("@")?H(e):(-1!=e.indexOf("-")&&(e=c(e)),t?y(e,t,n):y(e,"pfx"))};Modernizr.addAsyncTest(function(){var t;try{t=Z("indexedDB",e)}catch(n){}if(t){var r="modernizr-"+Math.random(),a=t.open(r);a.onerror=function(){a.error&&"InvalidStateError"===a.error.name?i("indexeddb",!1):(i("indexeddb",!0),b(t,r))},a.onsuccess=function(){i("indexeddb",!0),b(t,r)}}else i("indexeddb",!1)}),S.testAllProps=x,Modernizr.addTest("cssanimations",x("animationName","a",!0)),Modernizr.addTest("borderimage",x("borderImage","url() 1",!0)),Modernizr.addTest("backgroundsize",x("backgroundSize","100%",!0)),Modernizr.addTest("boxshadow",x("boxShadow","1px 1px",!0)),Modernizr.addTest("borderradius",x("borderRadius","0px",!0)),function(){Modernizr.addTest("csscolumns",function(){var e=!1,t=x("columnCount");try{e=!!t,e&&(e=new Boolean(e))}catch(n){}return e});for(var e,t,n=["Width","Span","Fill","Gap","Rule","RuleColor","RuleStyle","RuleWidth","BreakBefore","BreakAfter","BreakInside"],r=0;r<n.length;r++)e=n[r].toLowerCase(),t=x("column"+n[r]),("breakbefore"===e||"breakafter"===e||"breakinside"==e)&&(t=t||x(n[r])),Modernizr.addTest("csscolumns."+e,t)}(),Modernizr.addTest("flexbox",x("flexBasis","1px",!0)),Modernizr.addTest("cssreflections",x("boxReflect","above",!0)),Modernizr.addTest("csstransforms",function(){return-1===navigator.userAgent.indexOf("Android 2.")&&x("transform","scale(1)",!0)}),Modernizr.addTest("csstransitions",x("transition","all",!0)),Modernizr.addTest("csstransforms3d",function(){var e=!!x("perspective","1px",!0),t=Modernizr._config.usePrefixes;if(e&&(!t||"webkitPerspective"in C.style)){var n,r="#modernizr{width:0;height:0}";Modernizr.supports?n="@supports (perspective: 1px)":(n="@media (transform-3d)",t&&(n+=",(-webkit-transform-3d)")),n+="{#modernizr{width:7px;height:18px;margin:0;padding:0;border:0}}",V(r+n,function(t){e=7===t.offsetWidth&&18===t.offsetHeight})}return e}),a(),o(T),delete S.addTest,delete S.addAsyncTest;for(var K=0;K<Modernizr._q.length;K++)Modernizr._q[K]();e.Modernizr=Modernizr}(window,document);
var XA = XA || (function ($, document) {
    var api = {}, onPreInitHandlers, onPostInitHandlers, modules = {};
    onPreInitHandlers = new Array();
    onPostInitHandlers = new Array();
    api.register = function (name, api, init) {
        modules[name] = {
            name: name,
            api: api,
            init: init || api.init || (function () { })
        };
    };
    api.hasPageModes = function () { return !!(window.Sitecore && window.Sitecore.PageModes); };
    api.registerOnPreInitHandler = function (handler) { onPreInitHandlers.push(handler); };
    api.registerOnPostInitHandler = function (handler) { onPostInitHandlers.push(handler); };
    var initScheduled = false;
    api.init = function () {
        if (!initScheduled) {
            initScheduled = true;
            XA.ready(function () {
                try {
                    for (var name in modules)
                        if (modules.hasOwnProperty(name)) {
                            $xa.each(onPreInitHandlers, function (i, h) { h.process(name, modules[name]); });
                            modules[name].init();
                            $xa.each(onPostInitHandlers, function (i, h) { h.process(name, modules[name]); });
                        }
                }
                finally {
                    initScheduled = false;
                }
            });
        }
    };
    api.ready = function (fn) {
        $(document).ready(fn);
    };
    api.component = {};
    api.connector = {};
    api.cookies = {
        createCookie: function (name, value, days) {
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                var expires = "; expires=" + date.toUTCString();
            }
            else {
                expires = "";
            }
            document.cookie = name + "=" + value + expires + "; path=/";
        },
        readCookie: function (name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1, c.length);
                }
                if (c.indexOf(nameEQ) == 0) {
                    return c.substring(nameEQ.length, c.length);
                }
            }
            return null;
        },
        removeCookieWarning: function () {
            var cookieWarning = $xa(".privacy-warning");
            cookieWarning.remove();
        }
    };
    api.queryString = {
        getQueryParam: function (variable) {
            if (variable != null) {
                variable = variable.toLocaleLowerCase();
            }
            var query = window.location.search.substring(1);
            var vars = query.split("&");
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split("=");
                if (decodeURIComponent(pair[0].toLocaleLowerCase()) === variable) {
                    return decodeURIComponent(pair[1]);
                }
            }
            return null;
        }
    };
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;
    var eventListenerSupported = window.addEventListener;
    api.dom = {
        observeDOM: function (obj, callback) {
            if (MutationObserver) {
                var obs = new MutationObserver(function (mutations) {
                    if (mutations[0].addedNodes.length || mutations[0].removedNodes.length)
                        callback();
                });
                var options = {
                    childList: true,
                    subtree: true
                };
                obs.observe(obj, options);
            }
            else if (eventListenerSupported) {
                obj.addEventListener('DOMNodeInserted', callback, false);
                obj.addEventListener('DOMNodeRemoved', callback, false);
            }
        }
    };
    return api;
})($, document);
XA.init();

//Resolve conflicts calling global $ between Prototype and jQuery
jQuery.noConflict();// Cancels conflicts for jQuery defined in xaquery.js
/* ===================================================
 * bootstrap-transition.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */


!function ($) {

  $(function () {

    "use strict"; // jshint ;_;


    /* CSS TRANSITION SUPPORT (http://www.modernizr.com/)
     * ======================================================= */

    $.support.transition = (function () {

      var transitionEnd = (function () {

        var el = document.createElement('bootstrap')
          , transEndEventNames = {
               'WebkitTransition' : 'webkitTransitionEnd'
            ,  'MozTransition'    : 'transitionend'
            ,  'OTransition'      : 'oTransitionEnd otransitionend'
            ,  'transition'       : 'transitionend'
            }
          , name

        for (name in transEndEventNames){
          if (el.style[name] !== undefined) {
            return transEndEventNames[name]
          }
        }

      }())

      return transitionEnd && {
        end: transitionEnd
      }

    })()

  })

}(window.jQuery);/* ==========================================================
 * bootstrap-alert.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#alerts
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* ALERT CLASS DEFINITION
  * ====================== */

  var dismiss = '[data-dismiss="alert"]'
    , Alert = function (el) {
        $(el).on('click', dismiss, this.close)
      }

  Alert.prototype.close = function (e) {
    var $this = $(this)
      , selector = $this.attr('data-target')
      , $parent

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '') //strip for ie7
    }

    $parent = $(selector)

    e && e.preventDefault()

    $parent.length || ($parent = $this.hasClass('alert') ? $this : $this.parent())

    $parent.trigger(e = $.Event('close'))

    if (e.isDefaultPrevented()) return

    $parent.removeClass('in')

    function removeElement() {
      $parent
        .trigger('closed')
        .remove()
    }

    $.support.transition && $parent.hasClass('fade') ?
      $parent.on($.support.transition.end, removeElement) :
      removeElement()
  }


 /* ALERT PLUGIN DEFINITION
  * ======================= */

  $.fn.alert = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('alert')
      if (!data) $this.data('alert', (data = new Alert(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  $.fn.alert.Constructor = Alert


 /* ALERT DATA-API
  * ============== */

  $(function () {
    $('body').on('click.alert.data-api', dismiss, Alert.prototype.close)
  })

}(window.jQuery);/* ============================================================
 * bootstrap-button.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#buttons
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */


!function ($) {

  "use strict"; // jshint ;_;


 /* BUTTON PUBLIC CLASS DEFINITION
  * ============================== */

  var Button = function (element, options) {
    this.$element = $(element)
    this.options = $.extend({}, $.fn.button.defaults, options)
  }

  Button.prototype.setState = function (state) {
    var d = 'disabled'
      , $el = this.$element
      , data = $el.data()
      , val = $el.is('input') ? 'val' : 'html'

    state = state + 'Text'
    data.resetText || $el.data('resetText', $el[val]())

    $el[val](data[state] || this.options[state])

    // push to event loop to allow forms to submit
    setTimeout(function () {
      state == 'loadingText' ?
        $el.addClass(d).attr(d, d) :
        $el.removeClass(d).removeAttr(d)
    }, 0)
  }

  Button.prototype.toggle = function () {
    var $parent = this.$element.closest('[data-toggle="buttons-radio"]')

    $parent && $parent
      .find('.active')
      .removeClass('active')

    this.$element.toggleClass('active')
  }


 /* BUTTON PLUGIN DEFINITION
  * ======================== */

  $.fn.button = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('button')
        , options = typeof option == 'object' && option
      if (!data) $this.data('button', (data = new Button(this, options)))
      if (option == 'toggle') data.toggle()
      else if (option) data.setState(option)
    })
  }

  $.fn.button.defaults = {
    loadingText: 'loading...'
  }

  $.fn.button.Constructor = Button


 /* BUTTON DATA-API
  * =============== */

  $(function () {
    $('body').on('click.button.data-api', '[data-toggle^=button]', function ( e ) {
      var $btn = $(e.target)
      if (!$btn.hasClass('btn')) $btn = $btn.closest('.btn')
      $btn.button('toggle')
    })
  })

}(window.jQuery);/* ==========================================================
 * bootstrap-carousel.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#carousel
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* CAROUSEL CLASS DEFINITION
  * ========================= */

  var Carousel = function (element, options) {
    this.$element = $(element)
    this.options = options
    this.options.slide && this.slide(this.options.slide)
    this.options.pause == 'hover' && this.$element
      .on('mouseenter', $.proxy(this.pause, this))
      .on('mouseleave', $.proxy(this.cycle, this))
  }

  Carousel.prototype = {

    cycle: function (e) {
      if (!e) this.paused = false
      this.options.interval
        && !this.paused
        && (this.interval = setInterval($.proxy(this.next, this), this.options.interval))
      return this
    }

  , to: function (pos) {
      var $active = this.$element.find('.item.active')
        , children = $active.parent().children()
        , activePos = children.index($active)
        , that = this

      if (pos > (children.length - 1) || pos < 0) return

      if (this.sliding) {
        return this.$element.one('slid', function () {
          that.to(pos)
        })
      }

      if (activePos == pos) {
        return this.pause().cycle()
      }

      return this.slide(pos > activePos ? 'next' : 'prev', $(children[pos]))
    }

  , pause: function (e) {
      if (!e) this.paused = true
      if (this.$element.find('.next, .prev').length && $.support.transition.end) {
        this.$element.trigger($.support.transition.end)
        this.cycle()
      }
      clearInterval(this.interval)
      this.interval = null
      return this
    }

  , next: function () {
      if (this.sliding) return
      return this.slide('next')
    }

  , prev: function () {
      if (this.sliding) return
      return this.slide('prev')
    }

  , slide: function (type, next) {
      var $active = this.$element.find('.item.active')
        , $next = next || $active[type]()
        , isCycling = this.interval
        , direction = type == 'next' ? 'left' : 'right'
        , fallback  = type == 'next' ? 'first' : 'last'
        , that = this
        , e = $.Event('slide', {
            relatedTarget: $next[0]
          })

      this.sliding = true

      isCycling && this.pause()

      $next = $next.length ? $next : this.$element.find('.item')[fallback]()

      if ($next.hasClass('active')) return

      if ($.support.transition && this.$element.hasClass('slide')) {
        this.$element.trigger(e)
        if (e.isDefaultPrevented()) return
        $next.addClass(type)
        $next[0].offsetWidth // force reflow
        $active.addClass(direction)
        $next.addClass(direction)
        this.$element.one($.support.transition.end, function () {
          $next.removeClass([type, direction].join(' ')).addClass('active')
          $active.removeClass(['active', direction].join(' '))
          that.sliding = false
          setTimeout(function () { that.$element.trigger('slid') }, 0)
        })
      } else {
        this.$element.trigger(e)
        if (e.isDefaultPrevented()) return
        $active.removeClass('active')
        $next.addClass('active')
        this.sliding = false
        this.$element.trigger('slid')
      }

      isCycling && this.cycle()

      return this
    }

  }


 /* CAROUSEL PLUGIN DEFINITION
  * ========================== */

  $.fn.carousel = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('carousel')
        , options = $.extend({}, $.fn.carousel.defaults, typeof option == 'object' && option)
        , action = typeof option == 'string' ? option : options.slide
      if (!data) $this.data('carousel', (data = new Carousel(this, options)))
      if (typeof option == 'number') data.to(option)
      else if (action) data[action]()
      else if (options.interval) data.cycle()
    })
  }

  $.fn.carousel.defaults = {
    interval: 5000
  , pause: 'hover'
  }

  $.fn.carousel.Constructor = Carousel


 /* CAROUSEL DATA-API
  * ================= */

  $(function () {
    $('body').on('click.carousel.data-api', '[data-slide]', function ( e ) {
      var $this = $(this), href
        , $target = $($this.attr('data-target') || (href = $this.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '')) //strip for ie7
        , options = !$target.data('modal') && $.extend({}, $target.data(), $this.data())
      $target.carousel(options)
      e.preventDefault()
    })
  })

}(window.jQuery);/* =============================================================
 * bootstrap-collapse.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#collapse
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */


!function ($) {

  "use strict"; // jshint ;_;


 /* COLLAPSE PUBLIC CLASS DEFINITION
  * ================================ */

  var Collapse = function (element, options) {
    this.$element = $(element)
    this.options = $.extend({}, $.fn.collapse.defaults, options)

    if (this.options.parent) {
      this.$parent = $(this.options.parent)
    }

    this.options.toggle && this.toggle()
  }

  Collapse.prototype = {

    constructor: Collapse

  , dimension: function () {
      var hasWidth = this.$element.hasClass('width')
      return hasWidth ? 'width' : 'height'
    }

  , show: function () {
      var dimension
        , scroll
        , actives
        , hasData

      if (this.transitioning) return

      dimension = this.dimension()
      scroll = $.camelCase(['scroll', dimension].join('-'))
      actives = this.$parent && this.$parent.find('> .accordion-group > .in')

      if (actives && actives.length) {
        hasData = actives.data('collapse')
        if (hasData && hasData.transitioning) return
        actives.collapse('hide')
        hasData || actives.data('collapse', null)
      }

      this.$element[dimension](0)
      this.transition('addClass', $.Event('show'), 'shown')
      $.support.transition && this.$element[dimension](this.$element[0][scroll])
    }

  , hide: function () {
      var dimension
      if (this.transitioning) return
      dimension = this.dimension()
      this.reset(this.$element[dimension]())
      this.transition('removeClass', $.Event('hide'), 'hidden')
      this.$element[dimension](0)
    }

  , reset: function (size) {
      var dimension = this.dimension()

      this.$element
        .removeClass('collapse')
        [dimension](size || 'auto')
        [0].offsetWidth

      this.$element[size !== null ? 'addClass' : 'removeClass']('collapse')

      return this
    }

  , transition: function (method, startEvent, completeEvent) {
      var that = this
        , complete = function () {
            if (startEvent.type == 'show') that.reset()
            that.transitioning = 0
            that.$element.trigger(completeEvent)
          }

      this.$element.trigger(startEvent)

      if (startEvent.isDefaultPrevented()) return

      this.transitioning = 1

      this.$element[method]('in')

      $.support.transition && this.$element.hasClass('collapse') ?
        this.$element.one($.support.transition.end, complete) :
        complete()
    }

  , toggle: function () {
      this[this.$element.hasClass('in') ? 'hide' : 'show']()
    }

  }


 /* COLLAPSIBLE PLUGIN DEFINITION
  * ============================== */

  $.fn.collapse = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('collapse')
        , options = typeof option == 'object' && option
      if (!data) $this.data('collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.collapse.defaults = {
    toggle: true
  }

  $.fn.collapse.Constructor = Collapse


 /* COLLAPSIBLE DATA-API
  * ==================== */

  $(function () {
    $('body').on('click.collapse.data-api', '[data-toggle=collapse]', function (e) {
      var $this = $(this), href
        , target = $this.attr('data-target')
          || e.preventDefault()
          || (href = $this.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') //strip for ie7
        , option = $(target).data('collapse') ? 'toggle' : $this.data()
      $this[$(target).hasClass('in') ? 'addClass' : 'removeClass']('collapsed')
      $(target).collapse(option)
    })
  })

}(window.jQuery);/* ============================================================
 * bootstrap-dropdown.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#dropdowns
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */


!function ($) {

  "use strict"; // jshint ;_;


 /* DROPDOWN CLASS DEFINITION
  * ========================= */

  var toggle = '[data-toggle=dropdown]'
    , Dropdown = function (element) {
        var $el = $(element).on('click.dropdown.data-api', this.toggle)
        $('html').on('click.dropdown.data-api', function () {
          $el.parent().removeClass('open')
        })
      }

  Dropdown.prototype = {

    constructor: Dropdown

  , toggle: function (e) {
      var $this = $(this)
        , $parent
        , isActive

      if ($this.is('.disabled, :disabled')) return

      $parent = getParent($this)

      isActive = $parent.hasClass('open')

      clearMenus()

      if (!isActive) {
        $parent.toggleClass('open')
        $this.focus()
      }

      return false
    }

  , keydown: function (e) {
      var $this
        , $items
        , $active
        , $parent
        , isActive
        , index

      if (!/(38|40|27)/.test(e.keyCode)) return

      $this = $(this)

      e.preventDefault()
      e.stopPropagation()

      if ($this.is('.disabled, :disabled')) return

      $parent = getParent($this)

      isActive = $parent.hasClass('open')

      if (!isActive || (isActive && e.keyCode == 27)) return $this.click()

      $items = $('[role=menu] li:not(.divider) a', $parent)

      if (!$items.length) return

      index = $items.index($items.filter(':focus'))

      if (e.keyCode == 38 && index > 0) index--                                        // up
      if (e.keyCode == 40 && index < $items.length - 1) index++                        // down
      if (!~index) index = 0

      $items
        .eq(index)
        .focus()
    }

  }

  function clearMenus() {
    getParent($(toggle))
      .removeClass('open')
  }

  function getParent($this) {
    var selector = $this.attr('data-target')
      , $parent

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') //strip for ie7
    }

    $parent = $(selector)
    $parent.length || ($parent = $this.parent())

    return $parent
  }


  /* DROPDOWN PLUGIN DEFINITION
   * ========================== */

  $.fn.dropdown = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('dropdown')
      if (!data) $this.data('dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  $.fn.dropdown.Constructor = Dropdown


  /* APPLY TO STANDARD DROPDOWN ELEMENTS
   * =================================== */

  $(function () {
    $('html')
      .on('click.dropdown.data-api touchstart.dropdown.data-api', clearMenus)
    $('body')
      .on('click.dropdown touchstart.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
      .on('click.dropdown.data-api touchstart.dropdown.data-api'  , toggle, Dropdown.prototype.toggle)
      .on('keydown.dropdown.data-api touchstart.dropdown.data-api', toggle + ', [role=menu]' , Dropdown.prototype.keydown)
  })

}(window.jQuery);/* =========================================================
 * bootstrap-modal.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#modals
 * =========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */


!function ($) {

  "use strict"; // jshint ;_;


 /* MODAL CLASS DEFINITION
  * ====================== */

  var Modal = function (element, options) {
    this.options = options
    this.$element = $(element)
      .delegate('[data-dismiss="modal"]', 'click.dismiss.modal', $.proxy(this.hide, this))
    this.options.remote && this.$element.find('.modal-body').load(this.options.remote)
  }

  Modal.prototype = {

      constructor: Modal

    , toggle: function () {
        return this[!this.isShown ? 'show' : 'hide']()
      }

    , show: function () {
        var that = this
          , e = $.Event('show')

        this.$element.trigger(e)

        if (this.isShown || e.isDefaultPrevented()) return

        $('body').addClass('modal-open')

        this.isShown = true

        this.escape()

        this.backdrop(function () {
          var transition = $.support.transition && that.$element.hasClass('fade')

          if (!that.$element.parent().length) {
            that.$element.appendTo(document.body) //don't move modals dom position
          }

          that.$element
            .show()

          if (transition) {
            that.$element[0].offsetWidth // force reflow
          }

          that.$element
            .addClass('in')
            .attr('aria-hidden', false)
            .focus()

          that.enforceFocus()

          transition ?
            that.$element.one($.support.transition.end, function () { that.$element.trigger('shown') }) :
            that.$element.trigger('shown')

        })
      }

    , hide: function (e) {
        e && e.preventDefault()

        var that = this

        e = $.Event('hide')

        this.$element.trigger(e)

        if (!this.isShown || e.isDefaultPrevented()) return

        this.isShown = false

        $('body').removeClass('modal-open')

        this.escape()

        $(document).off('focusin.modal')

        this.$element
          .removeClass('in')
          .attr('aria-hidden', true)

        $.support.transition && this.$element.hasClass('fade') ?
          this.hideWithTransition() :
          this.hideModal()
      }

    , enforceFocus: function () {
        var that = this
        $(document).on('focusin.modal', function (e) {
          if (that.$element[0] !== e.target && !that.$element.has(e.target).length) {
            that.$element.focus()
          }
        })
      }

    , escape: function () {
        var that = this
        if (this.isShown && this.options.keyboard) {
          this.$element.on('keyup.dismiss.modal', function ( e ) {
            e.which == 27 && that.hide()
          })
        } else if (!this.isShown) {
          this.$element.off('keyup.dismiss.modal')
        }
      }

    , hideWithTransition: function () {
        var that = this
          , timeout = setTimeout(function () {
              that.$element.off($.support.transition.end)
              that.hideModal()
            }, 500)

        this.$element.one($.support.transition.end, function () {
          clearTimeout(timeout)
          that.hideModal()
        })
      }

    , hideModal: function (that) {
        this.$element
          .hide()
          .trigger('hidden')

        this.backdrop()
      }

    , removeBackdrop: function () {
        this.$backdrop.remove()
        this.$backdrop = null
      }

    , backdrop: function (callback) {
        var that = this
          , animate = this.$element.hasClass('fade') ? 'fade' : ''

        if (this.isShown && this.options.backdrop) {
          var doAnimate = $.support.transition && animate

          this.$backdrop = $('<div class="modal-backdrop ' + animate + '" />')
            .appendTo(document.body)

          if (this.options.backdrop != 'static') {
            this.$backdrop.click($.proxy(this.hide, this))
          }

          if (doAnimate) this.$backdrop[0].offsetWidth // force reflow

          this.$backdrop.addClass('in')

          doAnimate ?
            this.$backdrop.one($.support.transition.end, callback) :
            callback()

        } else if (!this.isShown && this.$backdrop) {
          this.$backdrop.removeClass('in')

          $.support.transition && this.$element.hasClass('fade')?
            this.$backdrop.one($.support.transition.end, $.proxy(this.removeBackdrop, this)) :
            this.removeBackdrop()

        } else if (callback) {
          callback()
        }
      }
  }


 /* MODAL PLUGIN DEFINITION
  * ======================= */

  $.fn.modal = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('modal')
        , options = $.extend({}, $.fn.modal.defaults, $this.data(), typeof option == 'object' && option)
      if (!data) $this.data('modal', (data = new Modal(this, options)))
      if (typeof option == 'string') data[option]()
      else if (options.show) data.show()
    })
  }

  $.fn.modal.defaults = {
      backdrop: true
    , keyboard: true
    , show: true
  }

  $.fn.modal.Constructor = Modal


 /* MODAL DATA-API
  * ============== */

  $(function () {
    $('body').on('click.modal.data-api', '[data-toggle="modal"]', function ( e ) {
      var $this = $(this)
        , href = $this.attr('href')
        , $target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\s]+$)/, ''))) //strip for ie7
        , option = $target.data('modal') ? 'toggle' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data())

      e.preventDefault()

      $target
        .modal(option)
        .one('hide', function () {
          $this.focus()
        })
    })
  })

}(window.jQuery);/* ===========================================================
 * bootstrap-tooltip.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#tooltips
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* TOOLTIP PUBLIC CLASS DEFINITION
  * =============================== */

  var Tooltip = function (element, options) {
    this.init('tooltip', element, options)
  }

  Tooltip.prototype = {

    constructor: Tooltip

  , init: function (type, element, options) {
      var eventIn
        , eventOut

      this.type = type
      this.$element = $(element)
      this.options = this.getOptions(options)
      this.enabled = true

      if (this.options.trigger == 'click') {
        this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))
      } else if (this.options.trigger != 'manual') {
        eventIn = this.options.trigger == 'hover' ? 'mouseenter' : 'focus'
        eventOut = this.options.trigger == 'hover' ? 'mouseleave' : 'blur'
        this.$element.on(eventIn + '.' + this.type, this.options.selector, $.proxy(this.enter, this))
        this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))
      }

      this.options.selector ?
        (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :
        this.fixTitle()
    }

  , getOptions: function (options) {
      options = $.extend({}, $.fn[this.type].defaults, options, this.$element.data())

      if (options.delay && typeof options.delay == 'number') {
        options.delay = {
          show: options.delay
        , hide: options.delay
        }
      }

      return options
    }

  , enter: function (e) {
      var self = $(e.currentTarget)[this.type](this._options).data(this.type)

      if (!self.options.delay || !self.options.delay.show) return self.show()

      clearTimeout(this.timeout)
      self.hoverState = 'in'
      this.timeout = setTimeout(function() {
        if (self.hoverState == 'in') self.show()
      }, self.options.delay.show)
    }

  , leave: function (e) {
      var self = $(e.currentTarget)[this.type](this._options).data(this.type)

      if (this.timeout) clearTimeout(this.timeout)
      if (!self.options.delay || !self.options.delay.hide) return self.hide()

      self.hoverState = 'out'
      this.timeout = setTimeout(function() {
        if (self.hoverState == 'out') self.hide()
      }, self.options.delay.hide)
    }

  , show: function () {
      var $tip
        , inside
        , pos
        , actualWidth
        , actualHeight
        , placement
        , tp

      if (this.hasContent() && this.enabled) {
        $tip = this.tip()
        this.setContent()

        if (this.options.animation) {
          $tip.addClass('fade')
        }

        placement = typeof this.options.placement == 'function' ?
          this.options.placement.call(this, $tip[0], this.$element[0]) :
          this.options.placement

        inside = /in/.test(placement)

        $tip
          .remove()
          .css({ top: 0, left: 0, display: 'block' })
          .appendTo(inside ? this.$element : document.body)

        pos = this.getPosition(inside)

        actualWidth = $tip[0].offsetWidth
        actualHeight = $tip[0].offsetHeight

        switch (inside ? placement.split(' ')[1] : placement) {
          case 'bottom':
            tp = {top: pos.top + pos.height, left: pos.left + pos.width / 2 - actualWidth / 2}
            break
          case 'top':
            tp = {top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2}
            break
          case 'left':
            tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth}
            break
          case 'right':
            tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width}
            break
        }

        $tip
          .css(tp)
          .addClass(placement)
          .addClass('in')
      }
    }

  , setContent: function () {
      var $tip = this.tip()
        , title = this.getTitle()

      $tip.find('.tooltip-inner')[this.options.html ? 'html' : 'text'](title)
      $tip.removeClass('fade in top bottom left right')
    }

  , hide: function () {
      var that = this
        , $tip = this.tip()

      $tip.removeClass('in')

      function removeWithAnimation() {
        var timeout = setTimeout(function () {
          $tip.off($.support.transition.end).remove()
        }, 500)

        $tip.one($.support.transition.end, function () {
          clearTimeout(timeout)
          $tip.remove()
        })
      }

      $.support.transition && this.$tip.hasClass('fade') ?
        removeWithAnimation() :
        $tip.remove()

      return this
    }

  , fixTitle: function () {
      var $e = this.$element
      if ($e.attr('title') || typeof($e.attr('data-original-title')) != 'string') {
        $e.attr('data-original-title', $e.attr('title') || '').removeAttr('title')
      }
    }

  , hasContent: function () {
      return this.getTitle()
    }

  , getPosition: function (inside) {
      return $.extend({}, (inside ? {top: 0, left: 0} : this.$element.offset()), {
        width: this.$element[0].offsetWidth
      , height: this.$element[0].offsetHeight
      })
    }

  , getTitle: function () {
      var title
        , $e = this.$element
        , o = this.options

      title = $e.attr('data-original-title')
        || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)

      return title
    }

  , tip: function () {
      return this.$tip = this.$tip || $(this.options.template)
    }

  , validate: function () {
      if (!this.$element[0].parentNode) {
        this.hide()
        this.$element = null
        this.options = null
      }
    }

  , enable: function () {
      this.enabled = true
    }

  , disable: function () {
      this.enabled = false
    }

  , toggleEnabled: function () {
      this.enabled = !this.enabled
    }

  , toggle: function () {
      this[this.tip().hasClass('in') ? 'hide' : 'show']()
    }

  , destroy: function () {
      this.hide().$element.off('.' + this.type).removeData(this.type)
    }

  }


 /* TOOLTIP PLUGIN DEFINITION
  * ========================= */

  $.fn.tooltip = function ( option ) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('tooltip')
        , options = typeof option == 'object' && option
      if (!data) $this.data('tooltip', (data = new Tooltip(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.tooltip.Constructor = Tooltip

  $.fn.tooltip.defaults = {
    animation: true
  , placement: 'top'
  , selector: false
  , template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'
  , trigger: 'hover'
  , title: ''
  , delay: 0
  , html: true
  }

}(window.jQuery);
/* ===========================================================
 * bootstrap-popover.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#popovers
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* POPOVER PUBLIC CLASS DEFINITION
  * =============================== */

  var Popover = function (element, options) {
    this.init('popover', element, options)
  }


  /* NOTE: POPOVER EXTENDS BOOTSTRAP-TOOLTIP.js
     ========================================== */

  Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype, {

    constructor: Popover

  , setContent: function () {
      var $tip = this.tip()
        , title = this.getTitle()
        , content = this.getContent()

      $tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title)
      $tip.find('.popover-content > *')[this.options.html ? 'html' : 'text'](content)

      $tip.removeClass('fade top bottom left right in')
    }

  , hasContent: function () {
      return this.getTitle() || this.getContent()
    }

  , getContent: function () {
      var content
        , $e = this.$element
        , o = this.options

      content = $e.attr('data-content')
        || (typeof o.content == 'function' ? o.content.call($e[0]) :  o.content)

      return content
    }

  , tip: function () {
      if (!this.$tip) {
        this.$tip = $(this.options.template)
      }
      return this.$tip
    }

  , destroy: function () {
      this.hide().$element.off('.' + this.type).removeData(this.type)
    }

  })


 /* POPOVER PLUGIN DEFINITION
  * ======================= */

  $.fn.popover = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('popover')
        , options = typeof option == 'object' && option
      if (!data) $this.data('popover', (data = new Popover(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.popover.Constructor = Popover

  $.fn.popover.defaults = $.extend({} , $.fn.tooltip.defaults, {
    placement: 'right'
  , trigger: 'click'
  , content: ''
  , template: '<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'
  })

}(window.jQuery);/* =============================================================
 * bootstrap-scrollspy.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#scrollspy
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* SCROLLSPY CLASS DEFINITION
  * ========================== */

  function ScrollSpy(element, options) {
    var process = $.proxy(this.process, this)
      , $element = $(element).is('body') ? $(window) : $(element)
      , href
    this.options = $.extend({}, $.fn.scrollspy.defaults, options)
    this.$scrollElement = $element.on('scroll.scroll-spy.data-api', process)
    this.selector = (this.options.target
      || ((href = $(element).attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '')) //strip for ie7
      || '') + ' .nav li > a'
    this.$body = $('body')
    this.refresh()
    this.process()
  }

  ScrollSpy.prototype = {

      constructor: ScrollSpy

    , refresh: function () {
        var self = this
          , $targets

        this.offsets = $([])
        this.targets = $([])

        $targets = this.$body
          .find(this.selector)
          .map(function () {
            var $el = $(this)
              , href = $el.data('target') || $el.attr('href')
              , $href = /^#\w/.test(href) && $(href)
            return ( $href
              && $href.length
              && [[ $href.position().top, href ]] ) || null
          })
          .sort(function (a, b) { return a[0] - b[0] })
          .each(function () {
            self.offsets.push(this[0])
            self.targets.push(this[1])
          })
      }

    , process: function () {
        var scrollTop = this.$scrollElement.scrollTop() + this.options.offset
          , scrollHeight = this.$scrollElement[0].scrollHeight || this.$body[0].scrollHeight
          , maxScroll = scrollHeight - this.$scrollElement.height()
          , offsets = this.offsets
          , targets = this.targets
          , activeTarget = this.activeTarget
          , i

        if (scrollTop >= maxScroll) {
          return activeTarget != (i = targets.last()[0])
            && this.activate ( i )
        }

        for (i = offsets.length; i--;) {
          activeTarget != targets[i]
            && scrollTop >= offsets[i]
            && (!offsets[i + 1] || scrollTop <= offsets[i + 1])
            && this.activate( targets[i] )
        }
      }

    , activate: function (target) {
        var active
          , selector

        this.activeTarget = target

        $(this.selector)
          .parent('.active')
          .removeClass('active')

        selector = this.selector
          + '[data-target="' + target + '"],'
          + this.selector + '[href="' + target + '"]'

        active = $(selector)
          .parent('li')
          .addClass('active')

        if (active.parent('.dropdown-menu').length)  {
          active = active.closest('li.dropdown').addClass('active')
        }

        active.trigger('activate')
      }

  }


 /* SCROLLSPY PLUGIN DEFINITION
  * =========================== */

  $.fn.scrollspy = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('scrollspy')
        , options = typeof option == 'object' && option
      if (!data) $this.data('scrollspy', (data = new ScrollSpy(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.scrollspy.Constructor = ScrollSpy

  $.fn.scrollspy.defaults = {
    offset: 10
  }


 /* SCROLLSPY DATA-API
  * ================== */

  $(window).on('load', function () {
    $('[data-spy="scroll"]').each(function () {
      var $spy = $(this)
      $spy.scrollspy($spy.data())
    })
  })

}(window.jQuery);/* ========================================================
 * bootstrap-tab.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#tabs
 * ========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* TAB CLASS DEFINITION
  * ==================== */

  var Tab = function (element) {
    this.element = $(element)
  }

  Tab.prototype = {

    constructor: Tab

  , show: function () {
      var $this = this.element
        , $ul = $this.closest('ul:not(.dropdown-menu)')
        , selector = $this.attr('data-target')
        , previous
        , $target
        , e

      if (!selector) {
        selector = $this.attr('href')
        selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '') //strip for ie7
      }

      if ( $this.parent('li').hasClass('active') ) return

      previous = $ul.find('.active a').last()[0]

      e = $.Event('show', {
        relatedTarget: previous
      })

      $this.trigger(e)

      if (e.isDefaultPrevented()) return

      $target = $(selector)

      this.activate($this.parent('li'), $ul)
      this.activate($target, $target.parent(), function () {
        $this.trigger({
          type: 'shown'
        , relatedTarget: previous
        })
      })
    }

  , activate: function ( element, container, callback) {
      var $active = container.find('> .active')
        , transition = callback
            && $.support.transition
            && $active.hasClass('fade')

      function next() {
        $active
          .removeClass('active')
          .find('> .dropdown-menu > .active')
          .removeClass('active')

        element.addClass('active')

        if (transition) {
          element[0].offsetWidth // reflow for transition
          element.addClass('in')
        } else {
          element.removeClass('fade')
        }

        if ( element.parent('.dropdown-menu') ) {
          element.closest('li.dropdown').addClass('active')
        }

        callback && callback()
      }

      transition ?
        $active.one($.support.transition.end, next) :
        next()

      $active.removeClass('in')
    }
  }


 /* TAB PLUGIN DEFINITION
  * ===================== */

  $.fn.tab = function ( option ) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('tab')
      if (!data) $this.data('tab', (data = new Tab(this)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.tab.Constructor = Tab


 /* TAB DATA-API
  * ============ */

  $(function () {
    $('body').on('click.tab.data-api', '[data-toggle="tab"], [data-toggle="pill"]', function (e) {
      e.preventDefault()
      $(this).tab('show')
    })
  })

}(window.jQuery);/* =============================================================
 * bootstrap-typeahead.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#typeahead
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */


!function($){

  "use strict"; // jshint ;_;


 /* TYPEAHEAD PUBLIC CLASS DEFINITION
  * ================================= */

  var Typeahead = function (element, options) {
    this.$element = $(element)
    this.options = $.extend({}, $.fn.typeahead.defaults, options)
    this.matcher = this.options.matcher || this.matcher
    this.sorter = this.options.sorter || this.sorter
    this.highlighter = this.options.highlighter || this.highlighter
    this.updater = this.options.updater || this.updater
    this.$menu = $(this.options.menu).appendTo('body')
    this.source = this.options.source
    this.shown = false
    this.listen()
  }

  Typeahead.prototype = {

    constructor: Typeahead

  , select: function () {
      var val = this.$menu.find('.active').attr('data-value')
      this.$element
        .val(this.updater(val))
        .change()
      return this.hide()
    }

  , updater: function (item) {
      return item
    }

  , show: function () {
      var pos = $.extend({}, this.$element.offset(), {
        height: this.$element[0].offsetHeight
      })

      this.$menu.css({
        top: pos.top + pos.height
      , left: pos.left
      })

      this.$menu.show()
      this.shown = true
      return this
    }

  , hide: function () {
      this.$menu.hide()
      this.shown = false
      return this
    }

  , lookup: function (event) {
      var items

      this.query = this.$element.val()

      if (!this.query || this.query.length < this.options.minLength) {
        return this.shown ? this.hide() : this
      }

      items = $.isFunction(this.source) ? this.source(this.query, $.proxy(this.process, this)) : this.source

      return items ? this.process(items) : this
    }

  , process: function (items) {
      var that = this

      items = $.grep(items, function (item) {
        return that.matcher(item)
      })

      items = this.sorter(items)

      if (!items.length) {
        return this.shown ? this.hide() : this
      }

      return this.render(items.slice(0, this.options.items)).show()
    }

  , matcher: function (item) {
      return ~item.toLowerCase().indexOf(this.query.toLowerCase())
    }

  , sorter: function (items) {
      var beginswith = []
        , caseSensitive = []
        , caseInsensitive = []
        , item

      while (item = items.shift()) {
        if (!item.toLowerCase().indexOf(this.query.toLowerCase())) beginswith.push(item)
        else if (~item.indexOf(this.query)) caseSensitive.push(item)
        else caseInsensitive.push(item)
      }

      return beginswith.concat(caseSensitive, caseInsensitive)
    }

  , highlighter: function (item) {
      var query = this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, '\\$&')
      return item.replace(new RegExp('(' + query + ')', 'ig'), function ($1, match) {
        return '<strong>' + match + '</strong>'
      })
    }

  , render: function (items) {
      var that = this

      items = $(items).map(function (i, item) {
        i = $(that.options.item).attr('data-value', item)
        i.find('a').html(that.highlighter(item))
        return i[0]
      })

      items.first().addClass('active')
      this.$menu.html(items)
      return this
    }

  , next: function (event) {
      var active = this.$menu.find('.active').removeClass('active')
        , next = active.next()

      if (!next.length) {
        next = $(this.$menu.find('li')[0])
      }

      next.addClass('active')
    }

  , prev: function (event) {
      var active = this.$menu.find('.active').removeClass('active')
        , prev = active.prev()

      if (!prev.length) {
        prev = this.$menu.find('li').last()
      }

      prev.addClass('active')
    }

  , listen: function () {
      this.$element
        .on('blur',     $.proxy(this.blur, this))
        .on('keypress', $.proxy(this.keypress, this))
        .on('keyup',    $.proxy(this.keyup, this))

      if ($.browser.chrome || $.browser.webkit || $.browser.msie) {
        this.$element.on('keydown', $.proxy(this.keydown, this))
      }

      this.$menu
        .on('click', $.proxy(this.click, this))
        .on('mouseenter', 'li', $.proxy(this.mouseenter, this))
    }

  , move: function (e) {
      if (!this.shown) return

      switch(e.keyCode) {
        case 9: // tab
        case 13: // enter
        case 27: // escape
          e.preventDefault()
          break

        case 38: // up arrow
          e.preventDefault()
          this.prev()
          break

        case 40: // down arrow
          e.preventDefault()
          this.next()
          break
      }

      e.stopPropagation()
    }

  , keydown: function (e) {
      this.suppressKeyPressRepeat = !~$.inArray(e.keyCode, [40,38,9,13,27])
      this.move(e)
    }

  , keypress: function (e) {
      if (this.suppressKeyPressRepeat) return
      this.move(e)
    }

  , keyup: function (e) {
      switch(e.keyCode) {
        case 40: // down arrow
        case 38: // up arrow
          break

        case 9: // tab
        case 13: // enter
          if (!this.shown) return
          this.select()
          break

        case 27: // escape
          if (!this.shown) return
          this.hide()
          break

        default:
          this.lookup()
      }

      e.stopPropagation()
      e.preventDefault()
  }

  , blur: function (e) {
      var that = this
      setTimeout(function () { that.hide() }, 150)
    }

  , click: function (e) {
      e.stopPropagation()
      e.preventDefault()
      this.select()
    }

  , mouseenter: function (e) {
      this.$menu.find('.active').removeClass('active')
      $(e.currentTarget).addClass('active')
    }

  }


  /* TYPEAHEAD PLUGIN DEFINITION
   * =========================== */

  $.fn.typeahead = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('typeahead')
        , options = typeof option == 'object' && option
      if (!data) $this.data('typeahead', (data = new Typeahead(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.typeahead.defaults = {
    source: []
  , items: 8
  , menu: '<ul class="typeahead dropdown-menu"></ul>'
  , item: '<li><a href="#"></a></li>'
  , minLength: 1
  }

  $.fn.typeahead.Constructor = Typeahead


 /*   TYPEAHEAD DATA-API
  * ================== */

  $(function () {
    $('body').on('focus.typeahead.data-api', '[data-provide="typeahead"]', function (e) {
      var $this = $(this)
      if ($this.data('typeahead')) return
      e.preventDefault()
      $this.typeahead($this.data())
    })
  })

}(window.jQuery);
/* ==========================================================
 * bootstrap-affix.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#affix
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* AFFIX CLASS DEFINITION
  * ====================== */

  var Affix = function (element, options) {
    this.options = $.extend({}, $.fn.affix.defaults, options)
    this.$window = $(window).on('scroll.affix.data-api', $.proxy(this.checkPosition, this))
    this.$element = $(element)
    this.checkPosition()
  }

  Affix.prototype.checkPosition = function () {
    if (!this.$element.is(':visible')) return

    var scrollHeight = $(document).height()
      , scrollTop = this.$window.scrollTop()
      , position = this.$element.offset()
      , offset = this.options.offset
      , offsetBottom = offset.bottom
      , offsetTop = offset.top
      , reset = 'affix affix-top affix-bottom'
      , affix

    if (typeof offset != 'object') offsetBottom = offsetTop = offset
    if (typeof offsetTop == 'function') offsetTop = offset.top()
    if (typeof offsetBottom == 'function') offsetBottom = offset.bottom()

    affix = this.unpin != null && (scrollTop + this.unpin <= position.top) ?
      false    : offsetBottom != null && (position.top + this.$element.height() >= scrollHeight - offsetBottom) ?
      'bottom' : offsetTop != null && scrollTop <= offsetTop ?
      'top'    : false

    if (this.affixed === affix) return

    this.affixed = affix
    this.unpin = affix == 'bottom' ? position.top - scrollTop : null

    this.$element.removeClass(reset).addClass('affix' + (affix ? '-' + affix : ''))
  }


 /* AFFIX PLUGIN DEFINITION
  * ======================= */

  $.fn.affix = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('affix')
        , options = typeof option == 'object' && option
      if (!data) $this.data('affix', (data = new Affix(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.affix.Constructor = Affix

  $.fn.affix.defaults = {
    offset: 0
  }


 /* AFFIX DATA-API
  * ============== */

  $(window).on('load', function () {
    $('[data-spy="affix"]').each(function () {
      var $spy = $(this)
        , data = $spy.data()

      data.offset = data.offset || {}

      data.offsetBottom && (data.offset.bottom = data.offsetBottom)
      data.offsetTop && (data.offset.top = data.offsetTop)

      $spy.affix(data)
    })
  })


}(window.jQuery);
!function(){function t(e,n){e instanceof t?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=n)}function e(t,e,n,i,o){this.stream=t,this.header=e,this.length=n,this.tag=i,this.sub=o}function n(t){var e,n,i="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),i+=et.charAt(n>>6)+et.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),i+=et.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),i+=et.charAt(n>>2)+et.charAt((3&n)<<4));(3&i.length)>0;)i+=nt;return i}function i(t){var e,n,i,o="",r=0;for(e=0;e<t.length&&t.charAt(e)!=nt;++e)i=et.indexOf(t.charAt(e)),0>i||(0==r?(o+=l(i>>2),n=3&i,r=1):1==r?(o+=l(n<<2|i>>4),n=15&i,r=2):2==r?(o+=l(n),o+=l(i>>2),n=3&i,r=3):(o+=l(n<<2|i>>4),o+=l(15&i),r=0));return 1==r&&(o+=l(n<<2)),o}function o(t){var e,n=i(t),o=new Array;for(e=0;2*e<n.length;++e)o[e]=parseInt(n.substring(2*e,2*e+2),16);return o}function r(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function s(){return new r(null)}function a(t,e,n,i,o,r){for(;--r>=0;){var s=e*this[t++]+n[i]+o;o=Math.floor(s/67108864),n[i++]=67108863&s}return o}function c(t,e,n,i,o,r){for(var s=32767&e,a=e>>15;--r>=0;){var c=32767&this[t],u=this[t++]>>15,l=a*c+u*s;c=s*c+((32767&l)<<15)+n[i]+(1073741823&o),o=(c>>>30)+(l>>>15)+a*u+(o>>>30),n[i++]=1073741823&c}return o}function u(t,e,n,i,o,r){for(var s=16383&e,a=e>>14;--r>=0;){var c=16383&this[t],u=this[t++]>>14,l=a*c+u*s;c=s*c+((16383&l)<<14)+n[i]+o,o=(c>>28)+(l>>14)+a*u,n[i++]=268435455&c}return o}function l(t){return ct.charAt(t)}function h(t,e){var n=ut[t.charCodeAt(e)];return null==n?-1:n}function p(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function d(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+this.DV:this.t=0}function f(t){var e=s();return e.fromInt(t),e}function m(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,o=!1,s=0;--i>=0;){var a=8==n?255&t[i]:h(t,i);0>a?"-"==t.charAt(i)&&(o=!0):(o=!1,0==s?this[this.t++]=a:s+n>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,s+=n,s>=this.DB&&(s-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&r.ZERO.subTo(this,this)}function y(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function g(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,i=(1<<e)-1,o=!1,r="",s=this.t,a=this.DB-s*this.DB%e;if(s-->0)for(a<this.DB&&(n=this[s]>>a)>0&&(o=!0,r=l(n));s>=0;)e>a?(n=(this[s]&(1<<a)-1)<<e-a,n|=this[--s]>>(a+=this.DB-e)):(n=this[s]>>(a-=e)&i,0>=a&&(a+=this.DB,--s)),n>0&&(o=!0),o&&(r+=l(n));return o?r:"0"}function v(){var t=s();return r.ZERO.subTo(this,t),t}function _(){return this.s<0?this.negate():this}function E(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(e=n-t.t,0!=e)return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0}function b(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function w(){return this.t<=0?0:this.DB*(this.t-1)+b(this[this.t-1]^this.s&this.DM)}function A(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s}function C(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s}function N(t,e){var n,i=t%this.DB,o=this.DB-i,r=(1<<o)-1,s=Math.floor(t/this.DB),a=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)e[n+s+1]=this[n]>>o|a,a=(this[n]&r)<<i;for(n=s-1;n>=0;--n)e[n]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function T(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)return void(e.t=0);var i=t%this.DB,o=this.DB-i,r=(1<<i)-1;e[0]=this[n]>>i;for(var s=n+1;s<this.t;++s)e[s-n-1]|=(this[s]&r)<<o,e[s-n]=this[s]>>i;i>0&&(e[this.t-n-1]|=(this.s&r)<<o),e.t=this.t-n,e.clamp()}function I(t,e){for(var n=0,i=0,o=Math.min(t.t,this.t);o>n;)i+=this[n]-t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i-=t[n],e[n++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=0>i?-1:0,-1>i?e[n++]=this.DV+i:i>0&&(e[n++]=i),e.t=n,e.clamp()}function P(t,e){var n=this.abs(),i=t.abs(),o=n.t;for(e.t=o+i.t;--o>=0;)e[o]=0;for(o=0;o<i.t;++o)e[o+n.t]=n.am(0,i[o],e,o,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&r.ZERO.subTo(e,e)}function S(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var i=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,i,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()}function x(t,e,n){var i=t.abs();if(!(i.t<=0)){var o=this.abs();if(o.t<i.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=s());var a=s(),c=this.s,u=t.s,l=this.DB-b(i[i.t-1]);l>0?(i.lShiftTo(l,a),o.lShiftTo(l,n)):(i.copyTo(a),o.copyTo(n));var h=a.t,p=a[h-1];if(0!=p){var d=p*(1<<this.F1)+(h>1?a[h-2]>>this.F2:0),f=this.FV/d,m=(1<<this.F1)/d,y=1<<this.F2,g=n.t,v=g-h,_=null==e?s():e;for(a.dlShiftTo(v,_),n.compareTo(_)>=0&&(n[n.t++]=1,n.subTo(_,n)),r.ONE.dlShiftTo(h,_),_.subTo(a,a);a.t<h;)a[a.t++]=0;for(;--v>=0;){var E=n[--g]==p?this.DM:Math.floor(n[g]*f+(n[g-1]+y)*m);if((n[g]+=a.am(0,E,n,v,0,h))<E)for(a.dlShiftTo(v,_),n.subTo(_,n);n[g]<--E;)n.subTo(_,n)}null!=e&&(n.drShiftTo(h,e),c!=u&&r.ZERO.subTo(e,e)),n.t=h,n.clamp(),l>0&&n.rShiftTo(l,n),0>c&&r.ZERO.subTo(n,n)}}}function O(t){var e=s();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(r.ZERO)>0&&t.subTo(e,e),e}function R(t){this.m=t}function D(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function M(t){return t}function U(t){t.divRemTo(this.m,null,t)}function L(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function F(t,e){t.squareTo(e),this.reduce(e)}function k(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function B(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function V(t){var e=s();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(r.ZERO)>0&&this.m.subTo(e,e),e}function j(t){var e=s();return t.copyTo(e),this.reduce(e),e}function H(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],i=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(n=e+this.m.t,t[n]+=this.m.am(0,i,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function z(t,e){t.squareTo(e),this.reduce(e)}function Y(t,e,n){t.multiplyTo(e,n),this.reduce(n)}function G(){return 0==(this.t>0?1&this[0]:this.s)}function W(t,e){if(t>4294967295||1>t)return r.ONE;var n=s(),i=s(),o=e.convert(this),a=b(t)-1;for(o.copyTo(n);--a>=0;)if(e.sqrTo(n,i),(t&1<<a)>0)e.mulTo(i,o,n);else{var c=n;n=i,i=c}return e.revert(n)}function q(t,e){var n;return n=256>t||e.isEven()?new R(e):new B(e),this.exp(t,n)}function K(t,e){return new r(t,e)}function Q(t,e){if(e<t.length+11)throw new Error("Message too long for RSA");for(var n=new Array,i=t.length-1;i>=0&&e>0;){var o=t.charCodeAt(i--);128>o?n[--e]=o:o>127&&2048>o?(n[--e]=63&o|128,n[--e]=o>>6|192):(n[--e]=63&o|128,n[--e]=o>>6&63|128,n[--e]=o>>12|224)}n[--e]=0;for(var s=0,a=0,c=0;e>2;)0==c&&(a=lt.random.randomWords(1,0)[0]),s=a>>c&255,c=(c+8)%32,0!=s&&(n[--e]=s);return n[--e]=2,n[--e]=0,new r(n)}function Z(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function X(t,e){if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw new Error("Invalid RSA public key");this.n=K(t,16),this.e=parseInt(e,16)}function $(t){return t.modPowInt(this.e,this.n)}function J(t){var e=Q(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var i=n.toString(16);return 0==(1&i.length)?i:"0"+i}t.prototype.get=function(t){if(void 0==t&&(t=this.pos++),t>=this.enc.length)throw"Requesting byte offset "+t+" on a stream of length "+this.enc.length;return this.enc[t]},t.prototype.hexDigits="0123456789ABCDEF",t.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},t.prototype.hexDump=function(t,e){for(var n="",i=t;e>i;++i)switch(n+=this.hexByte(this.get(i)),15&i){case 7:n+="  ";break;case 15:n+="\n";break;default:n+=" "}return n},t.prototype.parseStringISO=function(t,e){for(var n="",i=t;e>i;++i)n+=String.fromCharCode(this.get(i));return n},t.prototype.parseStringUTF=function(t,e){for(var n="",i=0,o=t;e>o;){var i=this.get(o++);n+=String.fromCharCode(128>i?i:i>191&&224>i?(31&i)<<6|63&this.get(o++):(15&i)<<12|(63&this.get(o++))<<6|63&this.get(o++))}return n},t.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,t.prototype.parseTime=function(t,e){var n=this.parseStringISO(t,e),i=this.reTime.exec(n);return i?(n=i[1]+"-"+i[2]+"-"+i[3]+" "+i[4],i[5]&&(n+=":"+i[5],i[6]&&(n+=":"+i[6],i[7]&&(n+="."+i[7]))),i[8]&&(n+=" UTC","Z"!=i[8]&&(n+=i[8],i[9]&&(n+=":"+i[9]))),n):"Unrecognized time: "+n},t.prototype.parseInteger=function(t,e){var n=e-t;if(n>4){n<<=3;var i=this.get(t);if(0==i)n-=8;else for(;128>i;)i<<=1,--n;return"("+n+" bit)"}for(var o=0,r=t;e>r;++r)o=o<<8|this.get(r);return o},t.prototype.parseBitString=function(t,e){var n=this.get(t),i=(e-t-1<<3)-n,o="("+i+" bit)";if(20>=i){var r=n;o+=" ";for(var s=e-1;s>t;--s){for(var a=this.get(s),c=r;8>c;++c)o+=a>>c&1?"1":"0";r=0}}return o},t.prototype.parseOctetString=function(t,e){var n=e-t,i="("+n+" byte) ";n>20&&(e=t+20);for(var o=t;e>o;++o)i+=this.hexByte(this.get(o));return n>20&&(i+=String.fromCharCode(8230)),i},t.prototype.parseOID=function(t,e){for(var n,i=0,o=0,r=t;e>r;++r){var s=this.get(r);i=i<<7|127&s,o+=7,128&s||(void 0==n?n=parseInt(i/40)+"."+i%40:n+="."+(o>=31?"bigint":i),i=o=0),n+=String.fromCharCode()}return n},e.prototype.typeName=function(){if(void 0==this.tag)return"unknown";var t=this.tag>>6,e=(this.tag>>5&1,31&this.tag);switch(t){case 0:switch(e){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+e.toString(16)}case 1:return"Application_"+e.toString(16);case 2:return"["+e+"]";case 3:return"Private_"+e.toString(16)}},e.prototype.content=function(){if(void 0==this.tag)return null;var t=this.tag>>6;if(0!=t)return null==this.sub?null:"("+this.sub.length+")";var e=31&this.tag,n=this.posContent(),i=Math.abs(this.length);switch(e){case 1:return 0==this.stream.get(n)?"false":"true";case 2:return this.stream.parseInteger(n,n+i);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(n,n+i);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(n,n+i);case 6:return this.stream.parseOID(n,n+i);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(n,n+i);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(n,n+i);case 23:case 24:return this.stream.parseTime(n,n+i)}return null},e.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null==this.sub?"null":this.sub.length)+"]"},e.prototype.print=function(t){if(void 0==t&&(t=""),document.writeln(t+this),null!=this.sub){t+="  ";for(var e=0,n=this.sub.length;n>e;++e)this.sub[e].print(t)}},e.prototype.toPrettyString=function(t){void 0==t&&(t="");var e=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(e+="+"),e+=this.length,32&this.tag?e+=" (constructed)":3!=this.tag&&4!=this.tag||null==this.sub||(e+=" (encapsulates)"),e+="\n",null!=this.sub){t+="  ";for(var n=0,i=this.sub.length;i>n;++n)e+=this.sub[n].toPrettyString(t)}return e},e.prototype.posStart=function(){return this.stream.pos},e.prototype.posContent=function(){return this.stream.pos+this.header},e.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},e.decodeLength=function(t){var e=t.get(),n=127&e;if(n==e)return n;if(n>3)throw"Length over 24 bits not supported at position "+(t.pos-1);if(0==n)return-1;e=0;for(var i=0;n>i;++i)e=e<<8|t.get();return e},e.hasContent=function(n,i,o){if(32&n)return!0;if(3>n||n>4)return!1;var r=new t(o);3==n&&r.get();var s=r.get();if(s>>6&1)return!1;try{var a=e.decodeLength(r);return r.pos-o.pos+a==i}catch(c){return!1}},e.decode=function(n){n instanceof t||(n=new t(n,0));var i=new t(n),o=n.get(),r=e.decodeLength(n),s=n.pos-i.pos,a=null;if(e.hasContent(o,r,n)){var c=n.pos;if(3==o&&n.get(),a=[],r>=0){for(var u=c+r;n.pos<u;)a[a.length]=e.decode(n);if(n.pos!=u)throw"Content size is not correct for container starting at offset "+c}else try{for(;;){var l=e.decode(n);if(0==l.tag)break;a[a.length]=l}r=c-n.pos}catch(h){throw"Exception while decoding undefined length content: "+h}}else n.pos+=r;return new e(i,s,r,o,a)};var tt,et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nt="=",it=0xdeadbeefcafe,ot=15715070==(16777215&it);ot&&"Microsoft Internet Explorer"==navigator.appName?(r.prototype.am=c,tt=30):ot&&"Netscape"!=navigator.appName?(r.prototype.am=a,tt=26):(r.prototype.am=u,tt=28),r.prototype.DB=tt,r.prototype.DM=(1<<tt)-1,r.prototype.DV=1<<tt;var rt=52;r.prototype.FV=Math.pow(2,rt),r.prototype.F1=rt-tt,r.prototype.F2=2*tt-rt;var st,at,ct="0123456789abcdefghijklmnopqrstuvwxyz",ut=new Array;for(st="0".charCodeAt(0),at=0;9>=at;++at)ut[st++]=at;for(st="a".charCodeAt(0),at=10;36>at;++at)ut[st++]=at;for(st="A".charCodeAt(0),at=10;36>at;++at)ut[st++]=at;R.prototype.convert=D,R.prototype.revert=M,R.prototype.reduce=U,R.prototype.mulTo=L,R.prototype.sqrTo=F,B.prototype.convert=V,B.prototype.revert=j,B.prototype.reduce=H,B.prototype.mulTo=Y,B.prototype.sqrTo=z,r.prototype.copyTo=p,r.prototype.fromInt=d,r.prototype.fromString=m,r.prototype.clamp=y,r.prototype.dlShiftTo=A,r.prototype.drShiftTo=C,r.prototype.lShiftTo=N,r.prototype.rShiftTo=T,r.prototype.subTo=I,r.prototype.multiplyTo=P,r.prototype.squareTo=S,r.prototype.divRemTo=x,r.prototype.invDigit=k,r.prototype.isEven=G,r.prototype.exp=W,r.prototype.toString=g,r.prototype.negate=v,r.prototype.abs=_,r.prototype.compareTo=E,r.prototype.bitLength=w,r.prototype.mod=O,r.prototype.modPowInt=q,r.ZERO=f(0),r.ONE=f(1),Z.prototype.doPublic=$,Z.prototype.setPublic=X,Z.prototype.encrypt=J;var lt={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=lt),lt.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,n,i,o,r,s=this._tables[0][4],a=this._tables[1],c=t.length,u=1;if(4!==c&&6!==c&&8!==c)throw new lt.exception.invalid("invalid aes key size");for(this._key=[o=t.slice(0),r=[]],e=c;4*c+28>e;e++)i=o[e-1],(e%c===0||8===c&&e%c===4)&&(i=s[i>>>24]<<24^s[i>>16&255]<<16^s[i>>8&255]<<8^s[255&i],e%c===0&&(i=i<<8^i>>>24^u<<24,u=u<<1^283*(u>>7))),o[e]=o[e-c]^i;for(n=0;e;n++,e--)i=o[3&n?e:e-4],r[n]=4>=e||4>n?i:a[0][s[i>>>24]]^a[1][s[i>>16&255]]^a[2][s[i>>8&255]]^a[3][s[255&i]]},lt.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,n,i,o,r,s,a,c,u=this._tables[0],l=this._tables[1],h=u[4],p=l[4],d=[],f=[];for(t=0;256>t;t++)f[(d[t]=t<<1^283*(t>>7))^t]=t;for(e=n=0;!h[e];e^=i||1,n=f[n]||1)for(s=n^n<<1^n<<2^n<<3^n<<4,s=s>>8^255&s^99,h[e]=s,p[s]=e,r=d[o=d[i=d[e]]],c=16843009*r^65537*o^257*i^16843008*e,a=257*d[s]^16843008*s,t=0;4>t;t++)u[t][e]=a=a<<24^a>>>8,l[t][s]=c=c<<24^c>>>8;for(t=0;5>t;t++)u[t]=u[t].slice(0),l[t]=l[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new lt.exception.invalid("invalid aes block size");var n,i,o,r,s=this._key[e],a=t[0]^s[0],c=t[e?3:1]^s[1],u=t[2]^s[2],l=t[e?1:3]^s[3],h=s.length/4-2,p=4,d=[0,0,0,0],f=this._tables[e],m=f[0],y=f[1],g=f[2],v=f[3],_=f[4];for(r=0;h>r;r++)n=m[a>>>24]^y[c>>16&255]^g[u>>8&255]^v[255&l]^s[p],i=m[c>>>24]^y[u>>16&255]^g[l>>8&255]^v[255&a]^s[p+1],o=m[u>>>24]^y[l>>16&255]^g[a>>8&255]^v[255&c]^s[p+2],l=m[l>>>24]^y[a>>16&255]^g[c>>8&255]^v[255&u]^s[p+3],p+=4,a=n,c=i,u=o;for(r=0;4>r;r++)d[e?3&-r:r]=_[a>>>24]<<24^_[c>>16&255]<<16^_[u>>8&255]<<8^_[255&l]^s[p++],n=a,a=c,c=u,u=l,l=n;return d}},lt.bitArray={bitSlice:function(t,e,n){return t=lt.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===n?t:lt.bitArray.clamp(t,n-e)},extract:function(t,e,n){var i,o=Math.floor(-e-n&31);return i=-32&(e+n-1^e)?t[e/32|0]<<32-o^t[e/32+1|0]>>>o:t[e/32|0]>>>o,i&(1<<n)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var n=t[t.length-1],i=lt.bitArray.getPartial(n);return 32===i?t.concat(e):lt.bitArray._shiftRight(e,i,0|n,t.slice(0,t.length-1))},bitLength:function(t){var e,n=t.length;return 0===n?0:(e=t[n-1],32*(n-1)+lt.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var n=t.length;return e=31&e,n>0&&e&&(t[n-1]=lt.bitArray.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial:function(t,e,n){return 32===t?e:(n?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(lt.bitArray.bitLength(t)!==lt.bitArray.bitLength(e))return!1;var n,i=0;for(n=0;n<t.length;n++)i|=t[n]^e[n];return 0===i},_shiftRight:function(t,e,n,i){var o,r,s=0;for(void 0===i&&(i=[]);e>=32;e-=32)i.push(n),n=0;if(0===e)return i.concat(t);for(o=0;o<t.length;o++)i.push(n|t[o]>>>e),n=t[o]<<32-e;return s=t.length?t[t.length-1]:0,r=lt.bitArray.getPartial(s),i.push(lt.bitArray.partial(e+r&31,e+r>32?n:i.pop(),1)),i},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},lt.codec.hex={fromBits:function(t){var e,n="";for(e=0;e<t.length;e++)n+=((0|t[e])+0xf00000000000).toString(16).substr(4);return n.substr(0,lt.bitArray.bitLength(t)/4)},toBits:function(t){var e,n,i=[];for(t=t.replace(/\s|0x/g,""),n=t.length,t+="00000000",e=0;e<t.length;e+=8)i.push(0^parseInt(t.substr(e,8),16));return lt.bitArray.clamp(i,4*n)}},lt.codec.utf8String={fromBits:function(t){var e,n,i="",o=lt.bitArray.bitLength(t);for(e=0;o/8>e;e++)0===(3&e)&&(n=t[e/4]),i+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(i))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,n=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t.charCodeAt(e),3===(3&e)&&(n.push(i),i=0);return 3&e&&n.push(lt.bitArray.partial(8*(3&e),i)),n}},lt.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,n){var i,o="",r=0,s=lt.codec.base64._chars,a=0,c=lt.bitArray.bitLength(t);for(n&&(s=s.substr(0,62)+"-_"),i=0;6*o.length<c;)o+=s.charAt((a^t[i]>>>r)>>>26),6>r?(a=t[i]<<6-r,r+=26,i++):(a<<=6,r-=6);for(;3&o.length&&!e;)o+="=";return o},toBits:function(t,e){t=t.replace(/\s|=/g,"");var n,i,o=[],r=0,s=lt.codec.base64._chars,a=0;for(e&&(s=s.substr(0,62)+"-_"),n=0;n<t.length;n++){if(i=s.indexOf(t.charAt(n)),0>i)throw new lt.exception.invalid("this isn't base64!");r>26?(r-=26,o.push(a^i>>>r),a=i<<32-r):(r+=6,a^=i<<32-r)}return 56&r&&o.push(lt.bitArray.partial(56&r,a,1)),o}},lt.codec.base64url={fromBits:function(t){return lt.codec.base64.fromBits(t,1,1)},toBits:function(t){return lt.codec.base64.toBits(t,1)}},void 0===lt.beware&&(lt.beware={}),lt.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){lt.mode.cbc={name:"cbc",encrypt:function(t,e,n,i){if(i&&i.length)throw new lt.exception.invalid("cbc can't authenticate data");if(128!==lt.bitArray.bitLength(n))throw new lt.exception.invalid("cbc iv must be 128 bits");var o,r=lt.bitArray,s=r._xor4,a=r.bitLength(e),c=0,u=[];if(7&a)throw new lt.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(o=0;a>=c+128;o+=4,c+=128)n=t.encrypt(s(n,e.slice(o,o+4))),u.splice(o,0,n[0],n[1],n[2],n[3]);return a=16843009*(16-(a>>3&15)),n=t.encrypt(s(n,r.concat(e,[a,a,a,a]).slice(o,o+4))),u.splice(o,0,n[0],n[1],n[2],n[3]),u},decrypt:function(t,e,n,i){if(i&&i.length)throw new lt.exception.invalid("cbc can't authenticate data");if(128!==lt.bitArray.bitLength(n))throw new lt.exception.invalid("cbc iv must be 128 bits");if(127&lt.bitArray.bitLength(e)||!e.length)throw new lt.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var o,r,s,a=lt.bitArray,c=a._xor4,u=[];for(i=i||[],o=0;o<e.length;o+=4)r=e.slice(o,o+4),s=c(n,t.decrypt(r)),u.splice(o,0,s[0],s[1],s[2],s[3]),n=r;if(r=255&u[o-1],0==r||r>16)throw new lt.exception.corrupt("pkcs#5 padding corrupt");if(s=16843009*r,!a.equal(a.bitSlice([s,s,s,s],0,8*r),a.bitSlice(u,32*u.length-8*r,32*u.length)))throw new lt.exception.corrupt("pkcs#5 padding corrupt");return a.bitSlice(u,0,32*u.length-8*r)}}},lt.misc.hmac=function(t,e){this._hash=e=e||lt.hash.sha256;var n,i=[[],[]],o=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>o&&(t=e.hash(t)),n=0;o>n;n++)i[0][n]=909522486^t[n],i[1][n]=1549556828^t[n];this._baseHash[0].update(i[0]),this._baseHash[1].update(i[1])},lt.misc.hmac.prototype.encrypt=lt.misc.hmac.prototype.mac=function(t,e){var n=new this._hash(this._baseHash[0]).update(t,e).finalize();return new this._hash(this._baseHash[1]).update(n).finalize()},lt.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},lt.hash.sha256.hash=function(t){return(new lt.hash.sha256).update(t).finalize()},lt.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=lt.codec.utf8String.toBits(t));var e,n=this._buffer=lt.bitArray.concat(this._buffer,t),i=this._length,o=this._length=i+lt.bitArray.bitLength(t);for(e=512+i&-512;o>=e;e+=512)this._block(n.splice(0,16));return this},finalize:function(){var t,e=this._buffer,n=this._h;for(e=lt.bitArray.concat(e,[lt.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),n},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,n=0,i=2;t:for(;64>n;i++){for(e=2;i>=e*e;e++)if(i%e===0)continue t;8>n&&(this._init[n]=t(Math.pow(i,.5))),this._key[n]=t(Math.pow(i,1/3)),n++}},_block:function(t){var e,n,i,o,r=t.slice(0),s=this._h,a=this._key,c=s[0],u=s[1],l=s[2],h=s[3],p=s[4],d=s[5],f=s[6],m=s[7];for(e=0;64>e;e++)16>e?n=r[e]:(i=r[e+1&15],o=r[e+14&15],n=r[15&e]=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+r[15&e]+r[e+9&15]|0),n=n+m+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(f^p&(d^f))+a[e],m=f,f=d,d=p,p=h+n|0,h=l,l=u,u=c,c=n+(u&l^h&(u^l))+(u>>>2^u>>>13^u>>>22^u<<30^u<<19^u<<10)|0;s[0]=s[0]+c|0,s[1]=s[1]+u|0,s[2]=s[2]+l|0,s[3]=s[3]+h|0,s[4]=s[4]+p|0,s[5]=s[5]+d|0,s[6]=s[6]+f|0,s[7]=s[7]+m|0}},lt.random={randomWords:function(t,e){var n,i,o=[],r=this.isReady(e);if(r===this._NOT_READY)throw new lt.exception.notReady("generator isn't seeded");for(r&this._REQUIRES_RESEED&&this._reseedFromPools(!(r&this._READY)),n=0;t>n;n+=4)(n+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),i=this._gen4words(),o.push(i[0],i[1],i[2],i[3]);return this._gate(),o.slice(0,t)},setDefaultParanoia:function(t){this._defaultParanoia=t},addEntropy:function(t,e,n){n=n||"user";var i,o,r,s=(new Date).valueOf(),a=this._robins[n],c=this.isReady(),u=0;switch(i=this._collectorIds[n],void 0===i&&(i=this._collectorIds[n]=this._collectorIdNext++),void 0===a&&(a=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[a].update([i,this._eventId++,1,e,s,1,0|t]);break;case"object":var l=Object.prototype.toString.call(t);if("[object Uint32Array]"===l){for(r=[],o=0;o<t.length;o++)r.push(t[o]);t=r}else for("[object Array]"!==l&&(u=1),o=0;o<t.length&&!u;o++)"number"!=typeof t[o]&&(u=1);if(!u){if(void 0===e)for(e=0,o=0;o<t.length;o++)for(r=t[o];r>0;)e++,r>>>=1;this._pools[a].update([i,this._eventId++,2,e,s,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[a].update([i,this._eventId++,3,e,s,t.length]),this._pools[a].update(t);break;default:u=1}if(u)throw new lt.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[a]+=e,this._poolStrength+=e,c===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new lt.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector,!1),window.removeEventListener("mousemove",this._mouseCollector,!1)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var n,i,o=this._callbacks[t],r=[];for(i in o)o.hasOwnProperty(i)&&o[i]===e&&r.push(i);for(n=0;n<r.length;n++)i=r[n],delete o[i]},_pools:[new lt.hash.sha256],_poolEntropy:[0],_reseedCount:0,_robins:{},_eventId:0,_collectorIds:{},_collectorIdNext:0,_strength:0,_poolStrength:0,_nextReseed:0,_key:[0,0,0,0,0,0,0,0],_counter:[0,0,0,0],_cipher:void 0,_defaultParanoia:6,_collectorsStarted:!1,_callbacks:{progress:{},seeded:{}},_callbackI:0,_NOT_READY:0,_READY:1,_REQUIRES_RESEED:2,_MAX_WORDS_PER_BURST:65536,_PARANOIA_LEVELS:[0,48,64,96,128,192,256,384,512,768,1024],_MILLISECONDS_PER_RESEED:3e4,_BITS_PER_RESEED:80,_gen4words:function(){for(var t=0;4>t&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new lt.cipher.aes(this._key)},_reseed:function(t){this._key=lt.hash.sha256.hash(this._key.concat(t)),this._cipher=new lt.cipher.aes(this._key);for(var e=0;4>e&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,n=[],i=0;for(this._nextReseed=n[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;16>e;e++)n.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(n=n.concat(this._pools[e].finalize()),i+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new lt.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=i,i>this._strength&&(this._strength=i),this._reseedCount++,this._reseed(n)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX||0,n=t.y||t.clientY||t.offsetY||0;lt.random.addEntropy([e,n],2,"mouse")},_loadTimeCollector:function(t){lt.random.addEntropy((new Date).valueOf(),2,"loadtime")},_fireEvent:function(t,e){var n,i=lt.random._callbacks[t],o=[];for(n in i)i.hasOwnProperty(n)&&o.push(i[n]);for(n=0;n<o.length;n++)o[n](e)}},function(){try{var t=new Uint32Array(32);crypto.getRandomValues(t),lt.random.addEntropy(t,1024,"crypto.getRandomValues")}catch(e){}}(),function(){for(var t in lt.beware)lt.beware.hasOwnProperty(t)&&lt.beware[t]()}();var ht={sjcl:lt,version:"1.3.10"};ht.generateAesKey=function(){return{key:lt.random.randomWords(8,0),encrypt:function(t){return this.encryptWithIv(t,lt.random.randomWords(4,0))},encryptWithIv:function(t,e){var n=new lt.cipher.aes(this.key),i=lt.codec.utf8String.toBits(t),o=lt.mode.cbc.encrypt(n,i,e),r=lt.bitArray.concat(e,o);return lt.codec.base64.fromBits(r)}}},ht.create=function(t){return new ht.EncryptionClient(t)},ht.EncryptionClient=function(t){var i=this,r=[];i.publicKey=t,i.version=ht.version;var s=function(t,e){var n,i,o;n=document.createElement(t);for(i in e)e.hasOwnProperty(i)&&(o=e[i],n.setAttribute(i,o));return n},a=function(t){return window.jQuery&&t instanceof jQuery?t[0]:t.nodeType&&1===t.nodeType?t:document.getElementById(t)},c=function(t){var e,n,i,o,r=[];if("INTEGER"===t.typeName()&&(e=t.posContent(),n=t.posEnd(),i=t.stream.hexDump(e,n).replace(/[ \n]/g,""),r.push(i)),null!==t.sub)for(o=0;o<t.sub.length;o++)r=r.concat(c(t.sub[o]));return r},u=function(t){var e,n,i=[],o=t.children;for(n=0;n<o.length;n++)e=o[n],1===e.nodeType&&e.attributes["data-encrypted-name"]?i.push(e):e.children&&e.children.length>0&&(i=i.concat(u(e)));return i},l=function(){var n,i,r,s,a,u;try{a=o(t),n=e.decode(a)}catch(l){throw"Invalid encryption key. Please use the key labeled 'Client-Side Encryption Key'"}if(r=c(n),2!==r.length)throw"Invalid encryption key. Please use the key labeled 'Client-Side Encryption Key'";return s=r[0],i=r[1],u=new Z,u.setPublic(s,i),u},h=function(){return{key:lt.random.randomWords(8,0),sign:function(t){var e=new lt.misc.hmac(this.key,lt.hash.sha256),n=e.encrypt(t);return lt.codec.base64.fromBits(n)}}};i.encrypt=function(t){var e=l(),o=ht.generateAesKey(),r=h(),s=o.encrypt(t),a=r.sign(lt.codec.base64.toBits(s)),c=lt.bitArray.concat(o.key,r.key),u=lt.codec.base64.fromBits(c),p=e.encrypt(u),d="$bt4|javascript_"+i.version.replace(/\./g,"_")+"$",f=null;return p&&(f=n(p)),d+f+"$"+s+"$"+a},i.encryptForm=function(t){var e,n,o,c,l,h;for(t=a(t),h=u(t);r.length>0;){try{t.removeChild(r[0])}catch(p){}r.splice(0,1)}for(l=0;l<h.length;l++)e=h[l],o=e.getAttribute("data-encrypted-name"),n=i.encrypt(e.value),e.removeAttribute("name"),c=s("input",{value:n,type:"hidden",name:o}),r.push(c),t.appendChild(c)},i.onSubmitEncryptForm=function(t,e){var n;t=a(t),n=function(n){return i.encryptForm(t),e?e(n):n},window.jQuery?window.jQuery(t).submit(n):t.addEventListener?t.addEventListener("submit",n,!1):t.attachEvent&&t.attachEvent("onsubmit",n)},i.formEncrypter={encryptForm:i.encryptForm,extractForm:a,onSubmitEncryptForm:i.onSubmitEncryptForm},lt.random.startCollectors()},window.Braintree=ht;

}(),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.braintree=t()}}(function(){var t;return function e(t,n,i){function o(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){"use strict";function i(t,e){var n,i=0===t.length;i?(t(),e(null)):(n=o(e),t(n))}function o(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}e.exports=function(t,e){var n=t.length,o=n;if(0===n)return void e(null);for(var r=0;n>r;r++)i(t[r],function(t){return t?void e(t):(o-=1,void(0===o&&e(null)))})}},{}],2:[function(t,e,n){"use strict";function i(t,e){var n=window.getComputedStyle?getComputedStyle(t):t.currentStyle;return n[e]}function o(){return{html:{height:s.style.height||"",overflow:i(s,"overflow"),position:i(s,"position")},body:{height:a.style.height||"",overflow:i(a,"overflow")}}}function r(t,e){this.assetsUrl=t,this.container=e||document.body,this.iframe=null,s=document.documentElement,a=document.body,this.merchantPageDefaultStyles=o()}var s,a,c=t(47),u=t(116),l=t(9),h="1.3.3";r.prototype.get=function(t,e){var n=this,i=this.constructAuthorizationURL(t);this.container&&u(this.container)?this.container(i+"&no_style=1"):this.insertIframe(i),new l(function(t){u(n.container)||n.removeIframe(),e(t)})},r.prototype.removeIframe=function(){this.container&&this.container.nodeType&&1===this.container.nodeType?this.container.removeChild(this.iframe):this.container&&window.jQuery&&this.container instanceof jQuery?$(this.iframe,this.container).remove():"string"==typeof this.container&&document.getElementById(this.container).removeChild(this.iframe),this.unlockMerchantWindowSize()},r.prototype.insertIframe=function(t){var e=document.createElement("iframe");if(e.src=t,this.applyStyles(e),this.lockMerchantWindowSize(),this.container&&this.container.nodeType&&1===this.container.nodeType)this.container.appendChild(e);else if(this.container&&window.jQuery&&this.container instanceof jQuery&&0!==this.container.length)this.container.append(e);else{if("string"!=typeof this.container||!document.getElementById(this.container))throw new Error("Unable to find valid container for iframe.");document.getElementById(this.container).appendChild(e)}this.iframe=e},r.prototype.applyStyles=function(t){t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.height="100%",t.style.width="100%",t.setAttribute("frameborder","0"),t.setAttribute("allowTransparency","true"),t.style.border="0",t.style.zIndex="99999"},r.prototype.lockMerchantWindowSize=function(){s.style.overflow="hidden",a.style.overflow="hidden",a.style.height="100%"},r.prototype.unlockMerchantWindowSize=function(){var t=this.merchantPageDefaultStyles;a.style.height=t.body.height,a.style.overflow=t.body.overflow,s.style.overflow=t.html.overflow},r.prototype.constructAuthorizationURL=function(t){var e,n=window.location.href;return n.indexOf("#")>-1&&(n=n.split("#")[0]),e=c.makeQueryString({acsUrl:t.acsUrl,pareq:t.pareq,termUrl:t.termUrl+"&three_d_secure_version="+h,md:t.md,parentUrl:n}),this.assetsUrl+"/3ds/"+h+"/html/style_frame?"+e},e.exports=r},{116:116,47:47,9:9}],3:[function(t,e,n){"use strict";function i(){}function o(t,e){e=e||{},this.clientToken=e.clientToken,this.container=e.container,this.api=t,this.nonce=null,this._loader=null,this._boundHandleUserClose=s(this._handleUserClose,this)}var r=t(47),s=t(57),a=t(116),c=t(2),u=t(5);o.prototype.verify=function(t,e){if(!a(e))throw this.api.sendAnalyticsEvents("3ds.web.no_callback"),new Error("No suitable callback argument was given");a(t.onUserClose)&&(this._onUserClose=t.onUserClose),a(t.onLookupComplete)&&(this._onLookupComplete=t.onLookupComplete),(void 0===t.useDefaultLoader||t.useDefaultLoader===!0)&&this._createDefaultLoader();var n={nonce:"",amount:t.amount},i=t.creditCard;if("string"==typeof i)n.nonce=i,this.api.sendAnalyticsEvents("3ds.web.verify.nonce"),this.startVerification(n,e);else{var o=this,r=function(t,i){return t?(o._removeDefaultLoader(),e(t)):(n.nonce=i,void o.startVerification(n,e))};this.api.sendAnalyticsEvents("3ds.web.verify.credit_card"),this.api.tokenizeCard(i,r)}},o.prototype.startVerification=function(t,e){this.api.lookup3DS(t,s(this.handleLookupResponse(e),this))},o.prototype.handleLookupResponse=function(t){var e=this;return function(n,i){var o;this._onLookupComplete(),n?t(n.error):i.lookup&&i.lookup.acsUrl&&i.lookup.acsUrl.length>0?(e.nonce=i.paymentMethod.nonce,o=new c(this.clientToken.assetsUrl,this.container),o.get(i.lookup,s(this.handleAuthenticationResponse(t),this)),this._detachListeners(),this._attachListeners()):(e.nonce=i.paymentMethod.nonce,t(null,{nonce:e.nonce,verificationDetails:i.threeDSecureInfo}))}},o.prototype.handleAuthenticationResponse=function(t){return function(e){var n,i=r.decodeQueryString(e);i.user_closed||(n=JSON.parse(i.auth_response),n.success?t(null,{nonce:n.paymentMethod.nonce,verificationDetails:n.threeDSecureInfo}):n.threeDSecureInfo&&n.threeDSecureInfo.liabilityShiftPossible?t(null,{nonce:this.nonce,verificationDetails:n.threeDSecureInfo}):t(n.error))}},o.prototype._attachListeners=function(){r.addEventListener(window,"message",this._boundHandleUserClose)},o.prototype._detachListeners=function(){r.removeEventListener(window,"message",this._boundHandleUserClose)},o.prototype._createDefaultLoader=function(){this._loader=new u,document.body.appendChild(this._loader.getElement())},o.prototype._removeDefaultLoader=function(){if(this._loader){var t=this._loader.getElement(),e=t.parentNode;e&&e.removeChild(t),this._loader.dispose(),this._loader=null}},o.prototype._handleUserClose=function(t){"user_closed=true"===t.data&&this._onUserClose()},o.prototype._onUserClose=i,o.prototype._onLookupComplete=function(){this._removeDefaultLoader()},e.exports=o},{116:116,2:2,47:47,5:5,57:57}],4:[function(t,e,n){"use strict";var i=t(3);e.exports={create:function(t,e){var n=new i(t,e);return n}}},{3:3}],5:[function(t,e,n){"use strict";function i(){this._element=document.createElement("div"),this._element.style.cssText=this._cssDeclarations,this._display=null,this._initialize()}var o=t(6),r=t(7),s=t(8);i.prototype._cssDeclarations=["filter:progid:DXImageTransform.Microsoft.Gradient(StartColorStr=#7F000000, EndColorStr=#7F000000)","background-color: rgba(0, 0, 0, 0.5)","display: table","height: 100%","left: 0","position: fixed","right: 0","top: 0","width: 100%","z-index: 99999"].join(";"),i.prototype.getElement=function(){return this._element},i.prototype.dispose=function(){this._display.dispose(),this._display=null,this._element=null},i.prototype._initialize=function(){var t=new s,e=window.SVGElement&&window.SVGAnimateElement&&window.SVGAnimateTransformElement;e||(t=new r("Loading...")),this._display=new o(t),this.getElement().appendChild(this._display.getElement())},e.exports=i},{6:6,7:7,8:8}],6:[function(t,e,n){"use strict";function i(t){this._element=document.createElement("div"),this._element.style.cssText=this._cssDeclarations,this._displayObject=t,this._initialize()}i.prototype._cssDeclarations=["display: table-cell","vertical-align: middle"].join(";"),i.prototype.getElement=function(){return this._element},i.prototype.dispose=function(){this._displayObject.dispose(),this._displayObject=null,this._element=null},i.prototype._initialize=function(){this.getElement().appendChild(this._displayObject.getElement())},e.exports=i},{}],7:[function(t,e,n){"use strict";function i(t){this._element=document.createElement("div"),this._element.style.cssText=this._cssDeclarations,this._element.innerHTML=t}i.prototype._cssDeclarations=["color: #fff","font-family: Helvetica, sans-serif","font-size: 12px","text-align: center"].join(";"),i.prototype.getElement=function(){return this._element},i.prototype.dispose=function(){this._element=null},e.exports=i},{}],8:[function(t,e,n){"use strict";function i(){this._element=document.createElement("div"),this._element.style.cssText=this._cssDeclarations,this._element.innerHTML=this._markup}i.prototype._cssDeclarations=["height: 36px","margin-left: auto","margin-right: auto","width: 36px"].join(";"),i.prototype._markup=['<svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"','width="100%" height="100%" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">','  <path fill="#FFF" d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z">','    <animateTransform attributeType="xml"','    attributeName="transform"','    type="rotate"','    from="0 25 25"','    to="360 25 25"','    dur="780ms"','    repeatCount="indefinite"','    calcMode="spline"','    keySplines="0.44, 0.22, 0, 1"','    keyTimes="0;1"/>',"  </path>","</svg>"].join(""),i.prototype.getElement=function(){return this._element},i.prototype.dispose=function(){this._element=null},e.exports=i},{}],9:[function(t,e,n){"use strict";function i(t){this.postMessageReceiver(t),this.hashChangeReceiver(t)}var o=t(47);i.prototype.postMessageReceiver=function(t){var e=this;this.wrappedCallback=function(n){var i=n.data;(/^(auth_response=)/.test(i)||"user_closed=true"===i)&&(t(i),e.stopListening())},o.addEventListener(window,"message",this.wrappedCallback)},i.prototype.hashChangeReceiver=function(t){var e,n=window.location.hash,i=this;this.poll=setInterval(function(){e=window.location.hash,e.length>0&&e!==n&&(i.stopListening(),e=e.substring(1,e.length),t(e),window.location.hash=n.length>0?n:"")},10)},i.prototype.stopListening=function(){clearTimeout(this.poll),o.removeEventListener(window,"message",this.wrappedCallback)},e.exports=i},{47:47}],10:[function(t,e,n){(function(n){"use strict";function i(t){var e=t.analyticsConfiguration||{},i=n.braintree?n.braintree.VERSION:null,o=i?"braintree/web/"+i:"";return{sdkVersion:e.sdkVersion||o,merchantAppId:e.merchantAppId||n.location.host}}function o(t){var e=i(t);this.options=t,this.driver=t.driver||m({enableCORS:y(t)}),this.customerId=t.customerId,this.integration=t.integrationType||t.integration||"",this.sdkVersion=e.sdkVersion,this.merchantAppId=e.merchantAppId,this.sessionId=t.channel||_(),this.authorization=t.authorization||t.clientToken,c.isTokenizationKey(this.authorization)?(this.authorizationType=v.authorizationTypes.TOKENIZATION_KEY,this.gatewayConfiguration=t.gatewayConfiguration):(this.gatewayConfiguration=t.gatewayConfiguration||a(this.authorization),this.authorizationFingerprint=a(this.authorization).authorizationFingerprint,this.authorizationType=v.authorizationTypes.CLIENT_TOKEN),this.requestTimeout=t.hasOwnProperty("timeout")?t.timeout:6e4}var r=t(57),s=t(4),a=t(17),c=t(22),u=t(20),l=t(14),h=t(13),p=t(11),d=t(18),f=t(16).normalizeCreditCardFields,m=t(32).chooseDriver,y=t(21),g=t(15),v=t(12),_=t(47).uuid;o.prototype._getGatewayConfiguration=function(t){var e=this;return this.gatewayConfiguration?void t(null,this.gatewayConfiguration):void g({authorization:this.authorization,enableCORS:y(this.options)},function(n,i){return n?void t(n,null):(e.gatewayConfiguration=i,void t(null,i))})},o.prototype._getAttrs=function(t){var e={};return this.options.hasOwnProperty("sharedCustomerIdentifier")&&(e.sharedCustomerIdentifier=this.options.sharedCustomerIdentifier),e.sharedCustomerIdentifierType=this.options.sharedCustomerIdentifierType,e.braintreeLibraryVersion=this.sdkVersion,t.merchantAccountId&&(e.merchantAccountId=t.merchantAccountId),this.authorizationType===v.authorizationTypes.TOKENIZATION_KEY?e.clientKey=this.options.authorization:e.authorizationFingerprint=this.authorizationFingerprint,e._meta={sessionId:this.sessionId},e},o.prototype.getCreditCards=function(t,e){"function"==typeof t&&(e=t,t={}),this._getGatewayConfiguration(r(function(n,i){var o;return n?e(n):(o=this._getAttrs(i),t.defaultFirst===!0&&(o.defaultFirst=1),void this.driver.get(c.joinUrlFragments([i.clientApiUrl,"v1","payment_methods"]),o,function(t){var e=0,n=t.paymentMethods.length,i=[];for(e;n>e;e++)i.push(new h(t.paymentMethods[e]));return i},e,this.requestTimeout))},this))},o.prototype.tokenizeCoinbase=function(t,e){t.options={validate:!1},this.addCoinbase(t,function(t,n){t?e(t,null):n&&n.nonce?e(t,n):e("Unable to tokenize coinbase account.",null)})},o.prototype.tokenizePayPalAccount=function(t,e){t.options={validate:!1},this.addPayPalAccount(t,function(t,n){t?e(t,null):n&&n.nonce?e(null,n):e("Unable to tokenize paypal account.",null)})},o.prototype.tokenizeCard=function(t,e){t.options={validate:!1},this.addCreditCard(t,function(t,n){n&&n.nonce?e(t,n.nonce,{type:n.type,details:n.details}):e("Unable to tokenize card.",null)})},o.prototype.lookup3DS=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o,r;return n?e(n):(o=c.joinUrlFragments([i.clientApiUrl,"v1/payment_methods",t.nonce,"three_d_secure/lookup"]),r=c.mergeOptions(this._getAttrs(i),{amount:t.amount}),void this.driver.post(o,r,function(t){return t},e,this.requestTimeout))},this))},o.prototype.createSEPAMandate=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o;return n?e(n):(o=c.mergeOptions(this._getAttrs(i),{sepaMandate:t}),void this.driver.post(c.joinUrlFragments([i.clientApiUrl,"v1","sepa_mandates.json"]),o,function(t){return{sepaMandate:new u(t.europeBankAccounts[0].sepaMandates[0]),sepaBankAccount:new l(t.europeBankAccounts[0])}},e,this.requestTimeout))},this))},o.prototype.getSEPAMandate=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o;return n?e(n):(o=c.mergeOptions(this._getAttrs(i),t),void this.driver.get(c.joinUrlFragments([i.clientApiUrl,"v1","sepa_mandates.json"]),o,function(t){return{sepaMandate:new u(t.sepaMandates[0])}},e,this.requestTimeout))},this))},o.prototype.addCoinbase=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o;return n?e(n):(delete t.share,o=c.mergeOptions(this._getAttrs(i),{coinbaseAccount:t,_meta:{integration:this.integration||"custom",source:"coinbase",sessionId:this.sessionId}}),void this.driver.post(c.joinUrlFragments([i.clientApiUrl,"v1","payment_methods/coinbase_accounts"]),o,function(t){return new p(t.coinbaseAccounts[0])},e,this.requestTimeout))},this))},o.prototype.addPayPalAccount=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o;return n?e(n):(delete t.share,o=c.mergeOptions(this._getAttrs(i),{paypalAccount:t,_meta:{integration:this.integration||"paypal",source:"paypal",sessionId:this.sessionId}}),void this.driver.post(c.joinUrlFragments([i.clientApiUrl,"v1","payment_methods","paypal_accounts"]),o,function(t){return new d(t.paypalAccounts[0])},e,this.requestTimeout))},this))},o.prototype.addCreditCard=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o,r,s;return n?e(n):(s=t.share,delete t.share,r=f(t),o=c.mergeOptions(this._getAttrs(i),{share:s,creditCard:r,_meta:{integration:this.integration||"custom",source:"form",sessionId:this.sessionId}}),void this.driver.post(c.joinUrlFragments([i.clientApiUrl,"v1","payment_methods/credit_cards"]),o,function(t){return new h(t.creditCards[0])},e,this.requestTimeout))},this))},o.prototype.sendAnalyticsEvents=function(t,e){this._getGatewayConfiguration(r(function(i,o){var r,s,a,u;if(i)return void e(i);if(a=o.analytics.url,u=[],t=c.isArray(t)?t:[t],!a)return void(e&&e(null,{}));for(s in t)t.hasOwnProperty(s)&&u.push({kind:t[s]});r=c.mergeOptions(this._getAttrs(o),{analytics:u,_meta:{merchantAppId:this.merchantAppId,platform:"web",platformVersion:n.navigator.userAgent,integrationType:this.integration,sdkVersion:this.sdkVersion,sessionId:this.sessionId}}),this.driver.post(a,r,function(t){return t},e,v.ANALYTICS_TIMEOUT_MS)},this))},o.prototype.decryptBrowserswitchPayload=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o,r;return n?e(n):(o=c.mergeOptions(this._getAttrs(i),{asymmetricEncryptedPayload:t}),r=c.joinUrlFragments([i.clientApiUrl,"/v1/paypal_browser_switch/decrypt"]),void this.driver.post(r,o,function(t){return t},e,this.requestTimeout))},this))},o.prototype.encryptBrowserswitchReturnPayload=function(t,e,n){this._getGatewayConfiguration(r(function(i,o){var r,s;return i?n(i):(r=c.mergeOptions(this._getAttrs(o),{payload:t,aesKey:e}),s=c.joinUrlFragments([o.clientApiUrl,"/v1/paypal_browser_switch/encrypt"]),void this.driver.post(s,r,function(t){return t},n,this.requestTimeout))},this))},o.prototype.exchangePaypalTokenForConsentCode=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o,r;return n?e(n):(o=c.mergeOptions(this._getAttrs(i),t),i.merchantAccountId&&(o.merchantAccountId=i.merchantAccountId),r=c.joinUrlFragments([i.clientApiUrl,"/v1/paypal_account_service/merchant_consent"]),void this.driver.post(r,o,function(t){return t},e,this.requestTimeout))},this))},o.prototype.getAmexRewardsBalance=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o;return n?e(n):(o=c.mergeOptions(this._getAttrs(i),t),o.nonce&&(o.paymentMethodNonce=o.nonce,delete o.nonce),void this.driver.get(c.joinUrlFragments([i.clientApiUrl,"v1/payment_methods/amex_rewards_balance"]),o,function(t){return t},e,this.requestTimeout))},this))},o.prototype.getAmexExpressCheckoutNonceProfile=function(t,e){this._getGatewayConfiguration(r(function(n,i){var o;return n?e(n):(o=c.mergeOptions(this._getAttrs(i),t),o.nonce&&(o.paymentMethodNonce=o.nonce,delete o.nonce),void this.driver.get(c.joinUrlFragments([i.clientApiUrl,"v1/payment_methods/amex_express_checkout_cards",o.paymentMethodNonce]),o,function(t){return t},e,this.requestTimeout))},this))},o.prototype.verify3DS=function(){var t=arguments;return this._secure3d?this._secure3d.verify.apply(this._secure3d,t):void this._getGatewayConfiguration(r(function(e,n){var i;return e?(i=t[t.length-1])(e):(this._secure3d=s.create(this,{container:this.options.container,clientToken:n}),this._secure3d.verify.apply(this._secure3d,t))},this))},e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,20:20,21:21,22:22,32:32,4:4,47:47,57:57}],11:[function(t,e,n){"use strict";function i(t){var e,n;for(e=0;e<o.length;e++)n=o[e],this[n]=t[n]}var o=["nonce","type","description","details"];e.exports=i},{}],12:[function(t,e,n){"use strict";var i={production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"};e.exports={apiUrls:i,errors:{UNKNOWN_ERROR:"Unknown error",INVALID_TIMEOUT:"Timeout must be a number"},ANALYTICS_TIMEOUT_MS:4e3,authorizationTypes:{CLIENT_TOKEN:"CLIENT_TOKEN",TOKENIZATION_KEY:"TOKENIZATION_KEY"}}},{}],13:[function(t,e,n){"use strict";function i(t){var e,n;for(e=0;e<o.length;e++)n=o[e],this[n]=t[n]}var o=["billingAddress","branding","createdAt","createdAtMerchant","createdAtMerchantName","details","isLocked","lastUsedAt","lastUsedAtMerchant","lastUsedAtMerchantName","lastUsedByCurrentMerchant","nonce","securityQuestions","type"];e.exports=i},{}],14:[function(t,e,n){"use strict";function i(t){var e,n=["bic","maskedIBAN","nonce","accountHolderName"],i=0;for(i=0;i<n.length;i++)e=n[i],this[e]=t[e]}e.exports=i},{}],15:[function(t,e,n){"use strict";function i(t){var e=t.split("_"),n=e[0],i=e.slice(2).join("_");return{merchantId:i,environment:n}}function o(t,e){var n,o,l,h=a({enableCORS:c(t)}),p={};s.isTokenizationKey(t.authorization)?(p.clientKey=t.authorization,o=i(t.authorization),n=u.apiUrls[o.environment]+"/merchants/"+o.merchantId+"/client_api/v1/configuration"):(l=r(t.authorization),p.authorizationFingerprint=l.authorizationFingerprint,n=l.configUrl),t.sessionId&&(p._meta={sessionId:t.sessionId}),h.get(n,p,function(t){return t},e,t.timeout)}var r=t(17),s=t(22),a=t(32).chooseDriver,c=t(21),u=t(12);e.exports=o},{12:12,17:17,21:21,22:22,32:32}],16:[function(t,e,n){"use strict";function i(t){var e,n={billingAddress:t.billingAddress||{}};for(e in t)if(t.hasOwnProperty(e))switch(e.replace(/_/g,"").toLowerCase()){case"postalcode":case"countryname":case"countrycodenumeric":case"countrycodealpha2":case"countrycodealpha3":case"region":case"extendedaddress":case"locality":case"firstname":case"lastname":case"company":case"streetaddress":n.billingAddress[e]=t[e];break;default:n[e]=t[e]}return n}e.exports={normalizeCreditCardFields:i}},{}],17:[function(t,e,n){"use strict";function i(t){var e,n=!0;if(!t)throw new Error("Braintree API Client Misconfigured: clientToken required.");if("object"==typeof t&&null!==t)e=t;else{try{t=window.atob(t)}catch(i){}try{e=JSON.parse(t)}catch(s){throw new Error("Braintree API Client Misconfigured: clientToken is not valid JSON.")}}if(e.hasOwnProperty("clientApiUrl")&&r.isWhitelistedDomain(e.clientApiUrl)||(n=!1),o.test(e.clientApiUrl)&&(n=!0),n)return e;throw new Error("Braintree API Client Misconfigured: the clientApiUrl provided in the clientToken is invalid.")}var o=/^ $/,r=t(47);t(19),e.exports=i},{19:19,47:47}],18:[function(t,e,n){"use strict";function i(t){var e,n;for(e=0;e<o.length;e++)n=o[e],this[n]=t[n]}var o=["nonce","type","description","details"];e.exports=i},{}],19:[function(t,e,n){(function(t){"use strict";var n=function(t){var e=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="";if(!e.test(t))throw new Error("Non base64 encoded input passed to window.atob polyfill");var o=0;do{var r=n.indexOf(t.charAt(o++)),s=n.indexOf(t.charAt(o++)),a=n.indexOf(t.charAt(o++)),c=n.indexOf(t.charAt(o++)),u=(63&r)<<2|s>>4&3,l=(15&s)<<4|a>>2&15,h=(3&a)<<6|63&c;i+=String.fromCharCode(u)+(l?String.fromCharCode(l):"")+(h?String.fromCharCode(h):"")}while(o<t.length);return i};t.atob=t.atob||n,e.exports={atobPolyfill:n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(t,e,n){"use strict";function i(t){var e,n=0,i=["accountHolderName","bic","longFormURL","mandateReferenceNumber","maskedIBAN","shortForm"];for(n=0;n<i.length;n++)e=i[n],this[e]=t[e]}e.exports=i},{}],21:[function(t,e,n){"use strict";e.exports=function(t){return null!=t.enableCORS?t.enableCORS:t.merchantConfiguration?t.merchantConfiguration.enableCORS:!1}},{}],22:[function(t,e,n){"use strict";function i(t){var e,n,i=[];for(n=0;n<t.length;n++)e=t[n],"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),"/"===e.charAt(0)&&(e=e.substring(1)),i.push(e);return i.join("/")}function o(t){return t&&"object"==typeof t&&"number"==typeof t.length&&"[object Array]"===Object.prototype.toString.call(t)||!1}function r(t,e){var n,i={};for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);for(n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i}function s(t){return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(t)}e.exports={joinUrlFragments:i,isArray:o,mergeOptions:r,isTokenizationKey:s}},{}],23:[function(t,e,n){"use strict";function i(t){return new o(t)}var o=t(10),r=t(22),s=t(17),a=t(15);e.exports={Client:o,configure:i,util:r,parseClientToken:s,_getConfiguration:a}},{10:10,15:15,17:17,22:22}],24:[function(t,e,n){(function(n){"use strict";function i(){return h?new XMLHttpRequest:new XDomainRequest}function o(t,e,n,i,o){var r=a.createURLParams(t,e);s("GET",r,null,n,i,o)}function r(t,e,n,i,o){s("POST",t,e,n,i,o)}function s(t,e,n,o,r,s){var a,p,d=i();r=r||function(){},h?d.onreadystatechange=function(){4===d.readyState&&(a=d.status,p=u(d.responseText),a>=400||0===a?r.call(null,p||{errors:l.errors.UNKNOWN_ERROR},null):a>0&&r.call(null,null,o(p)))}:(d.onload=function(){r.call(null,null,o(u(d.responseText)))},d.onerror=function(){r.call(null,d.responseText,null)},d.onprogress=function(){},d.ontimeout=function(){r.call(null,{errors:l.errors.UNKNOWN_ERROR},null)}),d.open(t,e,!0),d.timeout=null==s?6e4:s,h&&"POST"===t&&d.setRequestHeader("Content-Type","application/json"),setTimeout(function(){d.send(c(t,n))},0)}var a=t(31),c=t(30),u=t(29),l=t(26),h=n.XMLHttpRequest&&"withCredentials"in new n.XMLHttpRequest;e.exports={get:o,post:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{26:26,29:29,30:30,31:31}],25:[function(t,e,n){"use strict";function i(t){var e=s.getUserAgent(),n=!(s.isHTTP()&&/(MSIE\s(8|9))|(Phantom)/.test(e));return t=t||{},t.enableCORS&&n?r:o}var o=t(27),r=t(24),s=t(31);e.exports=i},{24:24,27:27,31:31}],26:[function(t,e,n){e.exports={errors:{UNKNOWN_ERROR:"Unknown error",INVALID_TIMEOUT:"Timeout must be a number"}}},{}],27:[function(t,e,n){"use strict";function i(t,e){return t.status>=400?[t,null]:[null,e(t)]}function o(){}function r(t,e,n,r,s,a){var c;s=s||o,null==a&&(a=6e4),c=r(t,e,function(t,e,o){l[o]&&(clearTimeout(l[o]),t?s.call(null,t):s.apply(null,i(e,function(t){return n(t)})))}),"number"==typeof a?l[c]=setTimeout(function(){l[c]=null,s.apply(null,[{errors:u.errors.UNKNOWN_ERROR},null])},a):s.apply(null,[{errors:u.errors.INVALID_TIMEOUT},null])}function s(t,e,n,i,o){e._method="POST",r(t,e,n,c.get,i,o)}function a(t,e,n,i,o){r(t,e,n,c.get,i,o)}var c=t(28),u=t(26),l=[];e.exports={get:a,post:s}},{26:26,28:28}],28:[function(t,e,n){(function(n){"use strict";function i(t,e){var n=document.createElement("script"),i=!1;n.src=t,n.async=!0;var o=e||u.error;"function"==typeof o&&(n.onerror=function(e){o({url:t,event:e})}),n.onload=n.onreadystatechange=function(){i||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(i=!0,n.onload=n.onreadystatechange=null,n&&n.parentNode&&n.parentNode.removeChild(n))},s||(s=document.getElementsByTagName("head")[0]),s.appendChild(n)}function o(t,e,n,o){var r,s;return o=o||u.callbackName||"callback",s=o+"_json"+a.generateUUID(),e[o]=s,r=a.createURLParams(t,e),c[s]=function(t){n(null,t,s);try{delete c[s]}catch(e){}c[s]=null},i(r,function(t){n(t,null,s)}),s}function r(t){u=t}var s,a=t(31),c=n,u={};e.exports={get:o,init:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{31:31}],29:[function(t,e,n){"use strict";e.exports=function(t){try{t=JSON.parse(t)}catch(e){}return t}},{}],30:[function(t,e,n){"use strict";e.exports=function(t,e){if("string"!=typeof t)throw new Error("Method must be a string");return"get"!==t.toLowerCase()&&null!=e&&(e="string"==typeof e?e:JSON.stringify(e)),e}},{}],31:[function(t,e,n){(function(t){"use strict";function n(t){var e;for(e in t)if(t.hasOwnProperty(e))return!0;return!1}function i(t){return t&&"object"==typeof t&&"number"==typeof t.length&&"[object Array]"===Object.prototype.toString.call(t)||!1}function o(t,e){var n,r,s,a=[];for(s in t)t.hasOwnProperty(s)&&(r=t[s],n=e?i(t)?e+"[]":e+"["+s+"]":s,a.push("object"==typeof r?o(r,n):encodeURIComponent(n)+"="+encodeURIComponent(r)));return a.join("&")}function r(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.floor(16*Math.random()),n="x"===t?e:3&e|8;return n.toString(16)})}function s(t,e){return t=t||"",null!=e&&"object"==typeof e&&n(e)&&(t+=-1===t.indexOf("?")?"?":"",t+=-1!==t.indexOf("=")?"&":"",t+=o(e)),t}function a(){return t.navigator.userAgent}function c(){return"http:"===t.location.protocol}e.exports={isArray:i,generateUUID:r,stringify:o,createURLParams:s,getUserAgent:a,isHTTP:c}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(t,e,n){"use strict";var i=t(24),o=t(27),r=t(25),s=t(31);e.exports={AJAXDriver:i,JSONPDriver:o,chooseDriver:r,util:s}},{24:24,25:25,27:27,31:31}],33:[function(t,e,n){"use strict";function i(t,e){this.host=t||window,this.channel=e||null,this.handlers=[],o.addEventListener(this.host,"message",o.bind(this.receive,this))}var o=t(47);i.prototype.receive=function(t){var e,n,o,r;try{o=JSON.parse(t.data)}catch(s){return}for(r=o.type,n=new i.Message(this,t.source,o.data),e=0;e<this.handlers.length;e++)this.handlers[e].type===r&&this.handlers[e].handler(n)},i.prototype.send=function(t,e,n){try{t.postMessage(JSON.stringify({type:this._namespaceEvent(e),data:n}),"*")}catch(i){}},i.prototype.register=function(t,e){this.handlers.push({type:this._namespaceEvent(t),handler:e})},i.prototype.unregister=function(t,e){for(var n=this.handlers.length-1;n>=0;n--)if(this.handlers[n].type===t&&this.handlers[n].handler===e)return this.handlers.splice(n,1)},i.prototype._namespaceEvent=function(t){return this.channel?["braintree",this.channel,t].join(":"):t},i.Message=function(t,e,n){this.bus=t,this.source=e,this.content=n},i.Message.prototype.reply=function(t,e){this.bus.send(this.source,t,e)},e.exports=i},{47:47}],34:[function(t,e,n){"use strict";function i(t,e){this.bus=t,this.target=e,this.handlers=[],this.bus.register("publish",o.bind(this._handleMessage,this))}var o=t(47);i.prototype._handleMessage=function(t){var e,n=t.content,i=this.handlers[n.channel];if("undefined"!=typeof i)for(e=0;e<i.length;e++)i[e](n.data)},i.prototype.publish=function(t,e){this.bus.send(this.target,"publish",{channel:t,data:e})},i.prototype.subscribe=function(t,e){this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e)},i.prototype.unsubscribe=function(t,e){var n,i=this.handlers[t];if("undefined"!=typeof i)for(n=0;n<i.length;n++)i[n]===e&&i.splice(n,1)},e.exports=i},{47:47}],35:[function(t,e,n){"use strict";function i(t){this.bus=t,this.frames=[],this.handlers=[]}i.prototype.subscribe=function(t,e){this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e)},i.prototype.registerFrame=function(t){this.frames.push(t)},i.prototype.unregisterFrame=function(t){for(var e=0;e<this.frames.length;e++)this.frames[e]===t&&this.frames.splice(e,1)},i.prototype.publish=function(t,e){var n,i=this.handlers[t];if("undefined"!=typeof i)for(n=0;n<i.length;n++)i[n](e);for(n=0;n<this.frames.length;n++)this.bus.send(this.frames[n],"publish",{channel:t,data:e})},i.prototype.unsubscribe=function(t,e){var n,i=this.handlers[t];if("undefined"!=typeof i)for(n=0;n<i.length;n++)i[n]===e&&i.splice(n,1)},e.exports=i},{}],36:[function(t,e,n){"use strict";function i(t,e){this.bus=t,this.target=e||window.parent,this.counter=0,this.callbacks={},this.bus.register("rpc_response",o.bind(this._handleResponse,this))}var o=t(47);i.prototype._handleResponse=function(t){var e=t.content,n=this.callbacks[e.id];"function"==typeof n&&(n.apply(null,e.response),delete this.callbacks[e.id])},i.prototype.invoke=function(t,e,n){var i=this.counter++;this.callbacks[i]=n,this.bus.send(this.target,"rpc_request",{id:i,method:t,args:e})},e.exports=i},{47:47}],37:[function(t,e,n){"use strict";function i(t){this.bus=t,this.methods={},this.bus.register("rpc_request",o.bind(this._handleRequest,this))}var o=t(47);i.prototype._handleRequest=function(t){var e,n=t.content,i=n.args||[],o=this.methods[n.method];"function"==typeof o&&(e=function(){t.reply("rpc_response",{id:n.id,response:Array.prototype.slice.call(arguments)})},i.push(e),o.apply(null,i))},i.prototype.reset=function(){this.methods={}},i.prototype.define=function(t,e){this.methods[t]=e},e.exports=i},{47:47}],38:[function(t,e,n){var i=t(33),o=t(34),r=t(35),s=t(36),a=t(37);e.exports={MessageBus:i,PubsubClient:o,PubsubServer:r,RPCClient:s,RPCServer:a}},{33:33,34:34,35:35,36:36,37:37}],39:[function(t,e,n){"use strict";var i,o=Array.prototype.indexOf;i=o?function(t,e){return t.indexOf(e)}:function(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},e.exports={indexOf:i}},{}],40:[function(t,e,n){"use strict";function i(t){var e,n,i="";for(e=0;e<t.length;e++)i+="%",n=t[e].charCodeAt(0).toString(16).toUpperCase(),n.length<2&&(i+="0"),
i+=n;return i}function o(t){return decodeURIComponent(i(atob(t)))}e.exports={decodeUtf8:o}},{}],41:[function(t,e,n){"use strict";function i(t,e){if(e=e||"["+t+"] is not a valid DOM Element",t&&t.nodeType&&1===t.nodeType)return t;if(t&&window.jQuery&&(t instanceof jQuery||"jquery"in Object(t))&&0!==t.length)return t[0];if("string"==typeof t&&document.getElementById(t))return document.getElementById(t);throw new Error(e)}e.exports={normalizeElement:i}},{}],42:[function(t,e,n){"use strict";function i(t,e,n,i){t.addEventListener?t.addEventListener(e,n,i||!1):t.attachEvent&&t.attachEvent("on"+e,n)}function o(t,e,n,i){t.removeEventListener?t.removeEventListener(e,n,i||!1):t.detachEvent&&t.detachEvent("on"+e,n)}function r(t){t.preventDefault?t.preventDefault():t.returnValue=!1}e.exports={addEventListener:i,removeEventListener:o,preventDefault:r}},{}],43:[function(t,e,n){"use strict";function i(t){return"[object Function]"===r.call(t)}function o(t,e){return function(){return t.apply(e,arguments)}}var r=Object.prototype.toString;e.exports={bind:o,isFunction:i}},{}],44:[function(t,e,n){"use strict";function i(t){var e,n,i,o,r=[{min:0,max:180,chars:7},{min:181,max:620,chars:14},{min:621,max:960,chars:22}];for(o=r.length,t=t||window.innerWidth,n=0;o>n;n++)i=r[n],t>=i.min&&t<=i.max&&(e=i.chars);return e||60}function o(t,e){var n,i;return-1===t.indexOf("@")?t:(t=t.split("@"),n=t[0],i=t[1],n.length>e&&(n=n.slice(0,e)+"..."),i.length>e&&(i="..."+i.slice(-e)),n+"@"+i)}e.exports={truncateEmail:o,getMaxCharLength:i}},{}],45:[function(t,e,n){"use strict";function i(){return"https:"===window.location.protocol}function o(t){switch(t){case null:case void 0:return"";case!0:return"1";case!1:return"0";default:return encodeURIComponent(t)}}function r(t,e){var n,i,s=[];for(i in t)if(t.hasOwnProperty(i)){var a=t[i];n=e?e+"["+i+"]":i,"object"==typeof a?s.push(r(a,n)):void 0!==a&&null!==a&&s.push(o(n)+"="+o(a))}return s.join("&")}function s(t){for(var e={},n=t.split("&"),i=0;i<n.length;i++){var o=n[i].split("="),r=o[0],s=decodeURIComponent(o[1]);e[r]=s}return e}function a(t){var e=t.split("?");return 2!==e.length?{}:s(e[1])}function c(t){if(t=t.toLowerCase(),!/^http/.test(t))return!1;l.href=t;var e=l.hostname.split("."),n=e.slice(-2).join(".");return-1===u.indexOf(h,n)?!1:!0}var u=t(39),l=document.createElement("a"),h=["paypal.com","braintreepayments.com","braintreegateway.com","localhost"];e.exports={isBrowserHttps:i,makeQueryString:r,decodeQueryString:s,getParams:a,isWhitelistedDomain:c}},{39:39}],46:[function(t,e,n){"use strict";function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})}e.exports=i},{}],47:[function(t,e,n){var i=t(41),o=t(45),r=t(43),s=t(42),a=t(44),c=t(39),u=t(40),l=t(46);e.exports={string:a,array:c,normalizeElement:i.normalizeElement,isBrowserHttps:o.isBrowserHttps,makeQueryString:o.makeQueryString,decodeQueryString:o.decodeQueryString,getParams:o.getParams,isWhitelistedDomain:o.isWhitelistedDomain,removeEventListener:s.removeEventListener,addEventListener:s.addEventListener,preventDefault:s.preventDefault,bind:r.bind,isFunction:r.isFunction,base64ToUtf8:u.decodeUtf8,uuid:l}},{39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46}],48:[function(t,e,n){"use strict";function i(t){if(!(this instanceof i))return new i(t);var e,n=r(t.className).split(/\s+/);for(this._elem=t,this.length=0,e=0;e<n.length;e+=1)n[e]&&s.push.call(this,n[e])}e.exports=i;var o=t(49),r=t(129),s=Array.prototype;i.prototype.add=function(){var t,e;for(e=0;e<arguments.length;e+=1)t=""+arguments[e],o(this,t)>=0||s.push.call(this,t);return this._elem.className=this.toString(),this},i.prototype.remove=function(){var t,e,n;for(n=0;n<arguments.length;n+=1)e=""+arguments[n],t=o(this,e),0>t||s.splice.call(this,t,1);return this._elem.className=this.toString(),this},i.prototype.contains=function(t){return t+="",o(this,t)>=0},i.prototype.toggle=function(t,e){return t+="",e===!0?this.add(t):e===!1?this.remove(t):this[this.contains(t)?"remove":"add"](t)},i.prototype.toString=function(){return s.join.call(this," ")}},{129:129,49:49}],49:[function(t,e,n){e.exports=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},{}],50:[function(t,e,n){"use strict";function i(){this._teardownRegistry=[]}var o=t(1),r=t(43);i.prototype.registerFunctionForTeardown=function(t){r.isFunction(t)&&this._teardownRegistry.push(t)},i.prototype.teardown=function(t){o(this._teardownRegistry,r.bind(function(e){this._teardownRegistry=[],r.isFunction(t)&&t(e)},this))},e.exports=i},{1:1,43:43}],51:[function(t,e,n){(function(t){"use strict";function n(t){if(("string"==typeof t||t instanceof String)&&(t=document.getElementById(t)),!(t instanceof HTMLFormElement))throw new TypeError("FormNapper requires an HTMLFormElement element or the id string of one.");this.htmlForm=t}n.prototype.hijack=function(e){this.submitHandler||(this.submitHandler=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e(t)},null!=t.addEventListener?this.htmlForm.addEventListener("submit",this.submitHandler,!1):null!=t.attachEvent?this.htmlForm.attachEvent("onsubmit",this.submitHandler):this.htmlForm.onsubmit=this.submitHandler)},n.prototype.inject=function(t,e){var n=this.htmlForm.querySelector('input[name="'+t+'"]');return null==n&&(n=document.createElement("input"),n.type="hidden",n.name=t,this.htmlForm.appendChild(n)),n.value=e,n},n.prototype.submit=function(){HTMLFormElement.prototype.submit.call(this.htmlForm)},n.prototype.detach=function(){this.submitHandler&&(null!=t.removeEventListener?this.htmlForm.removeEventListener("submit",this.submitHandler,!1):null!=t.detachEvent?this.htmlForm.detachEvent("onsubmit",this.submitHandler):this.htmlForm.onsubmit=null,delete this.submitHandler)},e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],52:[function(e,n,i){(function(e){"use strict";!function(o,r){"object"==typeof i&&"undefined"!=typeof n?n.exports=r("undefined"==typeof e?o:e):"function"==typeof t&&t.amd?t([],function(){return r(o)}):o.framebus=r(o)}(this,function(t){function e(t){return null==t?!1:null==t.Window?!1:t.constructor!==t.Window?!1:(b.push(t),!0)}function n(t){var e,n={};for(e in E)E.hasOwnProperty(e)&&(n[e]=E[e]);return n._origin=t||"*",n}function i(t){var e,n,i=s(this);return a(t)?!1:a(i)?!1:(n=Array.prototype.slice.call(arguments,1),e=c(t,n,i),e===!1?!1:(m(_.top||_.self,e,i),!0))}function o(t,e){var n=s(this);return v(t,e,n)?!1:(w[n]=w[n]||{},w[n][t]=w[n][t]||[],w[n][t].push(e),!0)}function r(t,e){var n,i,o=s(this);if(v(t,e,o))return!1;if(i=w[o]&&w[o][t],!i)return!1;for(n=0;n<i.length;n++)if(i[n]===e)return i.splice(n,1),!0;return!1}function s(t){return t&&t._origin||"*"}function a(t){return"string"!=typeof t}function c(t,e,n){var i=!1,o={event:t,origin:n},r=e[e.length-1];"function"==typeof r&&(o.reply=g(r,n),e=e.slice(0,-1)),o.args=e;try{i=A+JSON.stringify(o)}catch(s){throw new Error("Could not stringify event: "+s.message)}return i}function u(t){var e,n,i,o;if(t.data.slice(0,A.length)!==A)return!1;try{e=JSON.parse(t.data.slice(A.length))}catch(r){return!1}return null!=e.reply&&(n=t.origin,i=t.source,o=e.reply,e.reply=function(t){var e=c(o,[t],n);return e===!1?!1:void i.postMessage(e,n)},e.args.push(e.reply)),e}function l(e){_||(_=e||t,_.addEventListener?_.addEventListener("message",p,!1):_.attachEvent?_.attachEvent("onmessage",p):null===_.onmessage?_.onmessage=p:_=null)}function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})}function p(t){var e;a(t.data)||(e=u(t),e&&(d("*",e.event,e.args,t),d(t.origin,e.event,e.args,t),y(t.data,e.origin,t.source)))}function d(t,e,n,i){var o;if(w[t]&&w[t][e])for(o=0;o<w[t][e].length;o++)w[t][e][o].apply(i,n)}function f(t){return t.top!==t?!1:null==t.opener?!1:t.opener===t?!1:t.opener.closed===!0?!1:!0}function m(t,e,n){var i;try{for(t.postMessage(e,n),f(t)&&m(t.opener.top,e,n),i=0;i<t.frames.length;i++)m(t.frames[i],e,n)}catch(o){}}function y(t,e,n){var i,o;for(i=b.length-1;i>=0;i--)o=b[i],o.closed===!0?b=b.slice(i,1):n!==o&&m(o.top,t,e)}function g(t,e){function n(o,r){t(o,r),E.target(e).unsubscribe(i,n)}var i=h();return E.target(e).subscribe(i,n),i}function v(t,e,n){return a(t)?!0:"function"!=typeof e?!0:a(n)?!0:!1}var _,E,b=[],w={},A="/*framebus*/";return l(),E={target:n,include:e,publish:i,pub:i,trigger:i,emit:i,subscribe:o,sub:o,on:o,unsubscribe:r,unsub:r,off:r}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],53:[function(t,e,n){"use strict";var i=t(120),o=t(119),r=t(128),s=t(54);e.exports=function(t){var e=document.createElement("iframe"),n=i({},s,t);return n.style&&!o(n.style)&&(i(e.style,n.style),delete n.style),r(e,n),e.getAttribute("id")||(e.id=e.name),e}},{119:119,120:120,128:128,54:54}],54:[function(t,e,n){e.exports={src:"about:blank",frameBorder:0,allowtransparency:!0,scrolling:"no"}},{}],55:[function(t,e,n){function i(t){if(c(t)&&!a(t)&&!(t instanceof o)){if(t instanceof r)return t;if(h.call(t,"__chain__")&&h.call(t,"__wrapped__"))return u(t)}return new r(t)}var o=t(62),r=t(63),s=t(77),a=t(115),c=t(103),u=t(112),l=Object.prototype,h=l.hasOwnProperty;i.prototype=s.prototype,e.exports=i},{103:103,112:112,115:115,62:62,63:63,77:77}],56:[function(t,e,n){var i=t(94),o=i(Date,"now"),r=o||function(){return(new Date).getTime()};e.exports=r},{94:94}],57:[function(t,e,n){var i=t(90),o=t(108),r=t(61),s=1,a=32,c=r(function(t,e,n){var r=s;if(n.length){var u=o(n,c.placeholder);r|=a}return i(t,r,e,n,u)});c.placeholder={},e.exports=c},{108:108,61:61,90:90}],58:[function(t,e,n){var i=t(73),o=t(90),r=t(122),s=t(61),a=1,c=s(function(t,e){e=e.length?i(e):r(t);for(var n=-1,s=e.length;++n<s;){var c=e[n];t[c]=o(t[c],a,t)}return t});e.exports=c},{122:122,61:61,73:73,90:90}],59:[function(t,e,n){function i(t,e,n){function i(){g&&clearTimeout(g),d&&clearTimeout(d),_=0,d=g=v=void 0}function c(e,n){n&&clearTimeout(n),d=g=v=void 0,e&&(_=r(),f=t.apply(y,p),g||d||(p=y=void 0))}function u(){var t=e-(r()-m);0>=t||t>e?c(v,d):g=setTimeout(u,t)}function l(){c(b,g)}function h(){if(p=arguments,m=r(),y=this,v=b&&(g||!w),E===!1)var n=w&&!g;else{d||w||(_=m);var i=E-(m-_),o=0>=i||i>E;o?(d&&(d=clearTimeout(d)),_=m,f=t.apply(y,p)):d||(d=setTimeout(l,i))}return o&&g?g=clearTimeout(g):g||e===E||(g=setTimeout(u,e)),n&&(o=!0,f=t.apply(y,p)),!o||g||d||(p=y=void 0),f}var p,d,f,m,y,g,v,_=0,E=!1,b=!0;if("function"!=typeof t)throw new TypeError(s);if(e=0>e?0:+e||0,n===!0){var w=!0;b=!1}else o(n)&&(w=!!n.leading,E="maxWait"in n&&a(+n.maxWait||0,e),b="trailing"in n?!!n.trailing:b);return h.cancel=i,h}var o=t(118),r=t(56),s="Expected a function",a=Math.max;e.exports=i},{118:118,56:56}],60:[function(t,e,n){var i=t(72),o=t(61),r=o(function(t,e){return i(t,1,e)});e.exports=r},{61:61,72:72}],61:[function(t,e,n){function i(t,e){if("function"!=typeof t)throw new TypeError(o);return e=r(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,i=-1,o=r(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,n[0],s);case 2:return t.call(this,n[0],n[1],s)}var a=Array(e+1);for(i=-1;++i<e;)a[i]=n[i];return a[e]=s,t.apply(this,a)}}var o="Expected a function",r=Math.max;e.exports=i},{}],62:[function(t,e,n){function i(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=s,this.__views__=[]}var o=t(71),r=t(77),s=Number.POSITIVE_INFINITY;i.prototype=o(r.prototype),i.prototype.constructor=i,e.exports=i},{71:71,77:77}],63:[function(t,e,n){function i(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}var o=t(71),r=t(77);i.prototype=o(r.prototype),i.prototype.constructor=i,e.exports=i},{71:71,77:77}],64:[function(t,e,n){function i(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}e.exports=i},{}],65:[function(t,e,n){function i(t,e){for(var n=-1,i=t.length;++n<i&&e(t[n],n,t)!==!1;);return t}e.exports=i},{}],66:[function(t,e,n){function i(t,e){for(var n=-1,i=e.length,o=t.length;++n<i;)t[o+n]=e[n];return t}e.exports=i},{}],67:[function(t,e,n){function i(t,e,n){for(var i=-1,r=o(e),s=r.length;++i<s;){var a=r[i],c=t[a],u=n(c,e[a],a,t,e);(u===u?u===c:c!==c)&&(void 0!==c||a in t)||(t[a]=u)}return t}var o=t(123);e.exports=i},{123:123}],68:[function(t,e,n){function i(t,e){return null==e?t:o(e,r(e),t)}var o=t(70),r=t(123);e.exports=i},{123:123,70:70}],69:[function(t,e,n){function i(t,e,n,f,m,y,g){var _;if(n&&(_=m?n(t,f,m):n(t)),void 0!==_)return _;if(!p(t))return t;var E=h(t);if(E){if(_=c(t),!e)return o(t,_)}else{var w=k.call(t),A=w==v;if(w!=b&&w!=d&&(!A||m))return L[w]?u(t,w,e):m?t:{};if(_=l(A?{}:t),!e)return s(_,t)}y||(y=[]),g||(g=[]);for(var C=y.length;C--;)if(y[C]==t)return g[C];return y.push(t),g.push(_),(E?r:a)(t,function(o,r){_[r]=i(o,e,n,r,t,y,g)}),_}var o=t(64),r=t(65),s=t(68),a=t(75),c=t(95),u=t(96),l=t(97),h=t(115),p=t(118),d="[object Arguments]",f="[object Array]",m="[object Boolean]",y="[object Date]",g="[object Error]",v="[object Function]",_="[object Map]",E="[object Number]",b="[object Object]",w="[object RegExp]",A="[object Set]",C="[object String]",N="[object WeakMap]",T="[object ArrayBuffer]",I="[object Float32Array]",P="[object Float64Array]",S="[object Int8Array]",x="[object Int16Array]",O="[object Int32Array]",R="[object Uint8Array]",D="[object Uint8ClampedArray]",M="[object Uint16Array]",U="[object Uint32Array]",L={};L[d]=L[f]=L[T]=L[m]=L[y]=L[I]=L[P]=L[S]=L[x]=L[O]=L[E]=L[b]=L[w]=L[C]=L[R]=L[D]=L[M]=L[U]=!0,L[g]=L[v]=L[_]=L[A]=L[N]=!1;var F=Object.prototype,k=F.toString;e.exports=i},{115:115,118:118,64:64,65:65,68:68,75:75,95:95,96:96,97:97}],70:[function(t,e,n){function i(t,e,n){n||(n={});for(var i=-1,o=e.length;++i<o;){var r=e[i];n[r]=t[r]}return n}e.exports=i},{}],71:[function(t,e,n){var i=t(118),o=function(){function t(){}return function(e){if(i(e)){t.prototype=e;var n=new t;t.prototype=void 0}return n||{}}}();e.exports=o},{118:118}],72:[function(t,e,n){function i(t,e,n){if("function"!=typeof t)throw new TypeError(o);return setTimeout(function(){t.apply(void 0,n)},e)}var o="Expected a function";e.exports=i},{}],73:[function(t,e,n){function i(t,e,n,u){u||(u=[]);for(var l=-1,h=t.length;++l<h;){var p=t[l];c(p)&&a(p)&&(n||s(p)||r(p))?e?i(p,e,n,u):o(u,p):n||(u[u.length]=p)}return u}var o=t(66),r=t(114),s=t(115),a=t(98),c=t(103);e.exports=i},{103:103,114:114,115:115,66:66,98:98}],74:[function(t,e,n){var i=t(85),o=i();e.exports=o},{85:85}],75:[function(t,e,n){function i(t,e){return o(t,e,r)}var o=t(74),r=t(123);e.exports=i},{123:123,74:74}],76:[function(t,e,n){function i(t,e){for(var n=-1,i=e.length,r=-1,s=[];++n<i;){var a=e[n];o(t[a])&&(s[++r]=a)}return s}var o=t(116);e.exports=i},{116:116}],77:[function(t,e,n){function i(){}e.exports=i},{}],78:[function(t,e,n){function i(t){return function(e){return null==e?void 0:e[t]}}e.exports=i},{}],79:[function(t,e,n){var i=t(125),o=t(105),r=o?function(t,e){return o.set(t,e),t}:i;e.exports=r},{105:105,125:125}],80:[function(t,e,n){function i(t,e,n){if("function"!=typeof t)return o;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,o){return t.call(e,n,i,o)};case 4:return function(n,i,o,r){return t.call(e,n,i,o,r)};case 5:return function(n,i,o,r,s){return t.call(e,n,i,o,r,s)}}return function(){return t.apply(e,arguments)}}var o=t(125);e.exports=i},{125:125}],81:[function(t,e,n){(function(t){function n(t){var e=new i(t.byteLength),n=new o(e);return n.set(new o(t)),e}var i=t.ArrayBuffer,o=t.Uint8Array;e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],82:[function(t,e,n){function i(t,e,n){for(var i=n.length,r=-1,s=o(t.length-i,0),a=-1,c=e.length,u=Array(c+s);++a<c;)u[a]=e[a];for(;++r<i;)u[n[r]]=t[r];for(;s--;)u[a++]=t[r++];return u}var o=Math.max;e.exports=i},{}],83:[function(t,e,n){function i(t,e,n){for(var i=-1,r=n.length,s=-1,a=o(t.length-r,0),c=-1,u=e.length,l=Array(a+u);++s<a;)l[s]=t[s];for(var h=s;++c<u;)l[h+c]=e[c];for(;++i<r;)l[h+n[i]]=t[s++];return l}var o=Math.max;e.exports=i},{}],84:[function(t,e,n){function i(t){return s(function(e,n){var i=-1,s=null==e?0:n.length,a=s>2?n[s-2]:void 0,c=s>2?n[2]:void 0,u=s>1?n[s-1]:void 0;for("function"==typeof a?(a=o(a,u,5),s-=2):(a="function"==typeof u?u:void 0,s-=a?1:0),c&&r(n[0],n[1],c)&&(a=3>s?void 0:a,s=1);++i<s;){var l=n[i];l&&t(e,l,a)}return e})}var o=t(80),r=t(100),s=t(61);e.exports=i},{100:100,61:61,80:80}],85:[function(t,e,n){function i(t){return function(e,n,i){for(var r=o(e),s=i(e),a=s.length,c=t?a:-1;t?c--:++c<a;){var u=s[c];if(n(r[u],u,r)===!1)break}return e}}var o=t(111);e.exports=i},{111:111}],86:[function(t,e,n){(function(n){function i(t,e){function i(){var o=this&&this!==n&&this instanceof i?r:t;return o.apply(e,arguments)}var r=o(t);return i}var o=t(87);e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{87:87}],87:[function(t,e,n){function i(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=o(t.prototype),i=t.apply(n,e);return r(i)?i:n}}var o=t(71),r=t(118);e.exports=i},{118:118,71:71}],88:[function(t,e,n){(function(n){function i(t,e,b,w,A,C,N,T,I,P){function S(){for(var f=arguments.length,m=f,y=Array(f);m--;)y[m]=arguments[m];if(w&&(y=r(y,w,A)),C&&(y=s(y,C,N)),D||U){var _=S.placeholder,F=l(y,_);if(f-=F.length,P>f){var k=T?o(T):void 0,B=E(P-f,0),V=D?F:void 0,j=D?void 0:F,H=D?y:void 0,z=D?void 0:y;e|=D?g:v,e&=~(D?v:g),M||(e&=~(p|d));var Y=[t,e,b,H,V,z,j,k,I,B],G=i.apply(void 0,Y);return c(t)&&h(G,Y),G.placeholder=_,G}}var W=O?b:this,q=R?W[t]:t;return T&&(y=u(y,T)),x&&I<y.length&&(y.length=I),this&&this!==n&&this instanceof S&&(q=L||a(t)),q.apply(W,y)}var x=e&_,O=e&p,R=e&d,D=e&m,M=e&f,U=e&y,L=R?void 0:a(t);return S}var o=t(64),r=t(82),s=t(83),a=t(87),c=t(101),u=t(107),l=t(108),h=t(109),p=1,d=2,f=4,m=8,y=16,g=32,v=64,_=128,E=Math.max;e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{101:101,107:107,108:108,109:109,64:64,82:82,83:83,87:87}],89:[function(t,e,n){(function(n){function i(t,e,i,s){function a(){for(var e=-1,o=arguments.length,r=-1,l=s.length,h=Array(l+o);++r<l;)h[r]=s[r];for(;o--;)h[r++]=arguments[++e];var p=this&&this!==n&&this instanceof a?u:t;return p.apply(c?i:this,h)}var c=e&r,u=o(t);return a}var o=t(87),r=1;e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{87:87}],90:[function(t,e,n){function i(t,e,n,i,g,v,_,E){var b=e&p;if(!b&&"function"!=typeof t)throw new TypeError(m);var w=i?i.length:0;if(w||(e&=~(d|f),i=g=void 0),w-=g?g.length:0,e&f){var A=i,C=g;i=g=void 0}var N=b?void 0:c(t),T=[t,e,n,i,g,A,C,v,_,E];if(N&&(u(T,N),e=T[1],E=T[9]),T[9]=null==E?b?0:t.length:y(E-w,0)||0,e==h)var I=r(T[0],T[2]);else I=e!=d&&e!=(h|d)||T[4].length?s.apply(void 0,T):a.apply(void 0,T);var P=N?o:l;return P(I,T)}var o=t(79),r=t(86),s=t(88),a=t(89),c=t(91),u=t(104),l=t(109),h=1,p=2,d=32,f=64,m="Expected a function",y=Math.max;e.exports=i},{104:104,109:109,79:79,86:86,88:88,89:89,91:91}],91:[function(t,e,n){var i=t(105),o=t(126),r=i?function(t){return i.get(t)}:o;e.exports=r},{105:105,126:126}],92:[function(t,e,n){function i(t){for(var e=t.name+"",n=o[e],i=n?n.length:0;i--;){var r=n[i],s=r.func;if(null==s||s==t)return r.name}return e}var o=t(106);e.exports=i},{106:106}],93:[function(t,e,n){var i=t(78),o=i("length");e.exports=o},{78:78}],94:[function(t,e,n){function i(t,e){var n=null==t?void 0:t[e];return o(n)?n:void 0}var o=t(117);e.exports=i},{117:117}],95:[function(t,e,n){function i(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&r.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var o=Object.prototype,r=o.hasOwnProperty;e.exports=i},{}],96:[function(t,e,n){function i(t,e,n){var i=t.constructor;switch(e){case l:return o(t);case r:case s:return new i(+t);case h:case p:case d:case f:case m:case y:case g:case v:case _:var b=t.buffer;return new i(n?o(b):b,t.byteOffset,t.length);case a:case u:return new i(t);case c:var w=new i(t.source,E.exec(t));w.lastIndex=t.lastIndex}return w}var o=t(81),r="[object Boolean]",s="[object Date]",a="[object Number]",c="[object RegExp]",u="[object String]",l="[object ArrayBuffer]",h="[object Float32Array]",p="[object Float64Array]",d="[object Int8Array]",f="[object Int16Array]",m="[object Int32Array]",y="[object Uint8Array]",g="[object Uint8ClampedArray]",v="[object Uint16Array]",_="[object Uint32Array]",E=/\w*$/;e.exports=i},{81:81}],97:[function(t,e,n){function i(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Object),new e}e.exports=i},{}],98:[function(t,e,n){function i(t){return null!=t&&r(o(t))}var o=t(93),r=t(102);e.exports=i},{102:102,93:93}],99:[function(t,e,n){function i(t,e){return t="number"==typeof t||o.test(t)?+t:-1,e=null==e?r:e,t>-1&&t%1==0&&e>t}var o=/^\d+$/,r=9007199254740991;e.exports=i},{}],100:[function(t,e,n){function i(t,e,n){if(!s(n))return!1;var i=typeof e;if("number"==i?o(n)&&r(e,n.length):"string"==i&&e in n){var a=n[e];return t===t?t===a:a!==a}return!1}var o=t(98),r=t(99),s=t(118);e.exports=i},{118:118,98:98,99:99}],101:[function(t,e,n){function i(t){var e=s(t),n=a[e];if("function"!=typeof n||!(e in o.prototype))return!1;if(t===n)return!0;var i=r(n);return!!i&&t===i[0]}var o=t(62),r=t(91),s=t(92),a=t(55);e.exports=i},{55:55,62:62,91:91,92:92}],102:[function(t,e,n){function i(t){return"number"==typeof t&&t>-1&&t%1==0&&o>=t}var o=9007199254740991;e.exports=i},{}],103:[function(t,e,n){function i(t){return!!t&&"object"==typeof t}e.exports=i},{}],104:[function(t,e,n){function i(t,e){var n=t[1],i=e[1],m=n|i,y=h>m,g=i==h&&n==l||i==h&&n==p&&t[7].length<=e[8]||i==(h|p)&&n==l;if(!y&&!g)return t;i&c&&(t[2]=e[2],m|=n&c?0:u);var v=e[3];if(v){var _=t[3];t[3]=_?r(_,v,e[4]):o(v),t[4]=_?a(t[3],d):o(e[4])}return v=e[5],v&&(_=t[5],t[5]=_?s(_,v,e[6]):o(v),t[6]=_?a(t[5],d):o(e[6])),v=e[7],v&&(t[7]=o(v)),i&h&&(t[8]=null==t[8]?e[8]:f(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=m,t}var o=t(64),r=t(82),s=t(83),a=t(108),c=1,u=4,l=8,h=128,p=256,d="__lodash_placeholder__",f=Math.min;e.exports=i},{108:108,64:64,82:82,83:83}],105:[function(t,e,n){(function(n){var i=t(94),o=i(n,"WeakMap"),r=o&&new o;e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{94:94}],106:[function(t,e,n){var i={};e.exports=i},{}],107:[function(t,e,n){function i(t,e){for(var n=t.length,i=s(e.length,n),a=o(t);i--;){var c=e[i];t[i]=r(c,n)?a[c]:void 0}return t}var o=t(64),r=t(99),s=Math.min;e.exports=i},{64:64,99:99}],108:[function(t,e,n){function i(t,e){for(var n=-1,i=t.length,r=-1,s=[];++n<i;)t[n]===e&&(t[n]=o,s[++r]=n);return s}var o="__lodash_placeholder__";e.exports=i},{}],109:[function(t,e,n){var i=t(79),o=t(56),r=150,s=16,a=function(){var t=0,e=0;return function(n,a){var c=o(),u=s-(c-e);if(e=c,u>0){if(++t>=r)return n}else t=0;return i(n,a)}}();e.exports=a},{56:56,79:79}],110:[function(t,e,n){function i(t){for(var e=c(t),n=e.length,i=n&&t.length,u=!!i&&a(i)&&(r(t)||o(t)),h=-1,p=[];++h<n;){var d=e[h];(u&&s(d,i)||l.call(t,d))&&p.push(d)}return p}var o=t(114),r=t(115),s=t(99),a=t(102),c=t(124),u=Object.prototype,l=u.hasOwnProperty;e.exports=i},{102:102,114:114,115:115,124:124,99:99}],111:[function(t,e,n){function i(t){return o(t)?t:Object(t)}var o=t(118);e.exports=i},{118:118}],112:[function(t,e,n){function i(t){return t instanceof o?t.clone():new r(t.__wrapped__,t.__chain__,s(t.__actions__))}var o=t(62),r=t(63),s=t(64);e.exports=i},{62:62,63:63,64:64}],113:[function(t,e,n){function i(t,e,n){return"function"==typeof e?o(t,!0,r(e,n,3)):o(t,!0)}var o=t(69),r=t(80);e.exports=i},{69:69,80:80}],114:[function(t,e,n){function i(t){return r(t)&&o(t)&&a.call(t,"callee")&&!c.call(t,"callee")}var o=t(98),r=t(103),s=Object.prototype,a=s.hasOwnProperty,c=s.propertyIsEnumerable;e.exports=i},{103:103,98:98}],115:[function(t,e,n){var i=t(94),o=t(102),r=t(103),s="[object Array]",a=Object.prototype,c=a.toString,u=i(Array,"isArray"),l=u||function(t){return r(t)&&o(t.length)&&c.call(t)==s};e.exports=l},{102:102,103:103,94:94}],116:[function(t,e,n){function i(t){return o(t)&&a.call(t)==r}var o=t(118),r="[object Function]",s=Object.prototype,a=s.toString;e.exports=i},{118:118}],117:[function(t,e,n){function i(t){return null==t?!1:o(t)?l.test(c.call(t)):r(t)&&s.test(t)}var o=t(116),r=t(103),s=/^\[object .+?Constructor\]$/,a=Object.prototype,c=Function.prototype.toString,u=a.hasOwnProperty,l=RegExp("^"+c.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=i},{103:103,116:116}],118:[function(t,e,n){function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=i},{}],119:[function(t,e,n){function i(t){return"string"==typeof t||o(t)&&a.call(t)==r}var o=t(103),r="[object String]",s=Object.prototype,a=s.toString;e.exports=i},{103:103}],120:[function(t,e,n){var i=t(67),o=t(68),r=t(84),s=r(function(t,e,n){return n?i(t,e,n):o(t,e)});e.exports=s},{67:67,68:68,84:84}],121:[function(t,e,n){function i(t,e,n){var i=r(t);return n&&s(t,e,n)&&(e=void 0),e?o(i,e):i}var o=t(68),r=t(71),s=t(100);e.exports=i},{100:100,68:68,71:71}],122:[function(t,e,n){function i(t){return o(t,r(t))}var o=t(76),r=t(124);e.exports=i},{124:124,76:76}],123:[function(t,e,n){var i=t(94),o=t(98),r=t(118),s=t(110),a=i(Object,"keys"),c=a?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&o(t)?s(t):r(t)?a(t):[]}:s;e.exports=c},{110:110,118:118,94:94,98:98}],124:[function(t,e,n){function i(t){if(null==t)return[];c(t)||(t=Object(t));var e=t.length;e=e&&a(e)&&(r(t)||o(t))&&e||0;for(var n=t.constructor,i=-1,u="function"==typeof n&&n.prototype===t,h=Array(e),p=e>0;++i<e;)h[i]=i+"";for(var d in t)p&&s(d,e)||"constructor"==d&&(u||!l.call(t,d))||h.push(d);return h}var o=t(114),r=t(115),s=t(99),a=t(102),c=t(118),u=Object.prototype,l=u.hasOwnProperty;e.exports=i},{102:102,114:114,115:115,118:118,99:99}],125:[function(t,e,n){function i(t){return t}e.exports=i},{}],126:[function(t,e,n){function i(){}e.exports=i},{}],127:[function(t,e,n){function i(t){try{return Array.prototype.slice.call(t)}catch(e){for(var n=[],i=0;i<t.length;i++)n.push(t[i]);return n}}"undefined"!=typeof e&&(e.exports=i)},{}],128:[function(t,e,n){e.exports=function(t,e){var n;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],null==n?t.removeAttribute(i):t.setAttribute(i,n))}},{}],129:[function(t,e,n){function i(t){return t.replace(/^\s*|\s*$/g,"")}n=e.exports=i,n.left=function(t){return t.replace(/^\s*/,"")},n.right=function(t){return t.replace(/\s*$/,"")}},{}],130:[function(t,e,n){"use strict";function i(t){if(t=t||{},this.channel=t.channel,!this.channel)throw new Error("Channel ID must be specified");this.merchantUrl=t.merchantUrl,this._isDestroyed=!1,this._isVerbose=!1,this._listeners=[],this._log("new bus on channel "+this.channel,[location.href])}var o=t(52),r=t(132),s=t(131).checkOrigin;i.prototype.on=function(t,e){var n,i,r=e,a=this;this._isDestroyed||(this.merchantUrl&&(r=function(){s(this.origin,a.merchantUrl)&&e.apply(this,arguments)}),n=this._namespaceEvent(t),i=Array.prototype.slice.call(arguments),i[0]=n,i[1]=r,this._log("on",i),o.on.apply(o,i),this._listeners.push({eventName:t,handler:r,originalHandler:e}))},i.prototype.emit=function(t){var e;this._isDestroyed||(e=Array.prototype.slice.call(arguments),e[0]=this._namespaceEvent(t),this._log("emit",e),o.emit.apply(o,e))},i.prototype._offDirect=function(t){var e=Array.prototype.slice.call(arguments);this._isDestroyed||(e[0]=this._namespaceEvent(t),this._log("off",e),o.off.apply(o,e))},i.prototype.off=function(t,e){var n,i,o=e;if(!this._isDestroyed){if(this.merchantUrl)for(n=0;n<this._listeners.length;n++)i=this._listeners[n],i.originalHandler===e&&(o=i.handler);this._offDirect(t,o)}},i.prototype._namespaceEvent=function(t){return["braintree",this.channel,t].join(":")},i.prototype.teardown=function(){var t,e;for(e=0;e<this._listeners.length;e++)t=this._listeners[e],this._offDirect(t.eventName,t.handler);this._listeners.length=0,this._isDestroyed=!0},i.prototype._log=function(t,e){this._isVerbose&&console.log(t,e)},i.events=r,e.exports=i},{131:131,132:132,52:52}],131:[function(t,e,n){"use strict";function i(t,e){var n,i,r=document.createElement("a");return r.href=e,i="https:"===r.protocol?r.host.replace(/:443$/,""):"http:"===r.protocol?r.host.replace(/:80$/,""):r.host,n=r.protocol+"//"+i,n===t||o.test(t)}var o=/^https:\/\/([a-zA-Z0-9-]+\.)*(braintreepayments|braintreegateway|paypal)\.com(:\d{1,5})?$/;e.exports={checkOrigin:i}},{}],132:[function(t,e,n){"use strict";var i,o,r=["PAYMENT_METHOD_REQUEST","PAYMENT_METHOD_RECEIVED","PAYMENT_METHOD_GENERATED","PAYMENT_METHOD_NOT_GENERATED","PAYMENT_METHOD_CANCELLED","PAYMENT_METHOD_ERROR","CONFIGURATION_REQUEST","ROOT_METADATA_REQUEST","ERROR","WARNING","UI_POPUP_DID_OPEN","UI_POPUP_DID_CLOSE","UI_POPUP_FORCE_CLOSE","UI_MODAL_DID_OPEN","UI_MODAL_DID_CLOSE","ASYNC_DEPENDENCY_INITIALIZING","ASYNC_DEPENDENCY_READY","USER_FORM_SUBMIT_REQUEST","SEND_ANALYTICS_EVENTS"],s={};for(i=0;i<r.length;i++)o=r[i],s[o]=o;e.exports=s},{}],133:[function(t,e,n){"use strict";function i(t){var e,n={};if(t){for(e in t)t.hasOwnProperty(e)&&(n[o(e)]=t[e]);return n}}function o(t){return t.replace(/([A-Z])/g,function(t){return"_"+t.toLowerCase()})}e.exports={convertToLegacyShippingAddress:i}},{}],134:[function(t,e,n){"use strict";e.exports={ROOT_SUCCESS_CALLBACK:"onPaymentMethodReceived",ROOT_ERROR_CALLBACK:"onError",ROOT_READY_CALLBACK:"onReady",TEARDOWN_STATE:{IN_PROGRESS:"inProgress",COMPLETE:"complete"},AUTHORIZATION_PRIVILEGE_ERROR:"The client authorization used has insufficient privileges."}},{}],135:[function(t,e,n){(function(n){"use strict";function i(){}function o(t){t.paypal=t.paypal||{}}function r(){this._dependenciesRemaining++}function s(){this._dependenciesRemaining--,0===this._dependenciesRemaining&&(delete this._dependenciesRemaining,this.bus.off(l.events.ASYNC_DEPENDENCY_INITIALIZING,this._handleDependencyInitializing),this.bus.off(l.events.ASYNC_DEPENDENCY_READY,this._handleDependencyReady),this._onIntegrationReady())}function a(t){this.configuration=t,this.isReady=!1,this.destructor=new h,this.bus=new l({channel:this.configuration.channel,merchantUrl:n.location.href}),this.apiClient=new u.Client(this.configuration),this._configureCallbacks(),this._configureAnalytics(),this._attachEvents(),this._emitInitializing()}var c=t(141).cloneAndStripDOM,u=t(23),l=t(130),h=t(50),p=t(57),d=t(134),f=t(146),m=t(144),y=t(142),g=t(160);a.prototype._emitInitializing=function(){this.bus.emit(l.events.ASYNC_DEPENDENCY_INITIALIZING)},a.prototype._configureCallbacks=function(){function t(t){return function(e){t(f(e))}}var e=m(this.configuration.merchantConfiguration);this.onSuccess=t(e(d.ROOT_SUCCESS_CALLBACK)),this.onError=e(d.ROOT_ERROR_CALLBACK,y),this.onReady=e(d.ROOT_READY_CALLBACK)},a.prototype._configureAnalytics=function(){var t="web."+this.configuration.integrationType+".",e=this.apiClient;this.bus.on(l.events.SEND_ANALYTICS_EVENTS,function(n,i){var o;for(n instanceof Array||(n=[n]),o=0;o<n.length;o++)n[o]=t+n[o];e.sendAnalyticsEvents(n,i)})},a.prototype._attachEvents=function(){var t=c(this.configuration);"dropin"===t.integrationType&&o(t.merchantConfiguration),this.bus.on(l.events.ERROR,this.onError),this.bus.on(l.events.PAYMENT_METHOD_RECEIVED,this.onSuccess),
this.bus.on(l.events.WARNING,function(t){try{console.warn(t)}catch(e){}}),this.bus.on(l.events.CONFIGURATION_REQUEST,function(e){e(t)}),this._dependenciesRemaining=0,this._handleDependencyInitializing=p(r,this),this._handleDependencyReady=p(s,this),this.bus.on(l.events.ASYNC_DEPENDENCY_INITIALIZING,this._handleDependencyInitializing),this.bus.on(l.events.ASYNC_DEPENDENCY_READY,this._handleDependencyReady)},a.prototype._addDeviceData=function(t){var e,n=this.configuration.merchantConfiguration,i=this.configuration.gatewayConfiguration,o={};if(null!=n.dataCollector&&(i.kount&&n.dataCollector.kount&&(o.kount={merchantId:n.dataCollector.kount.merchantId||i.kount.kountMerchantId,environment:n.dataCollector.kount.environment||i.environment}),o.paypal=n.dataCollector.paypal===!0,o.kount||o.paypal)){try{e=g.setup(o)}catch(r){this.bus.emit(l.events.ERROR,{type:"CONFIGURATION",message:r.message})}null!=e&&(this.destructor.registerFunctionForTeardown(function(){e.teardown()}),t.deviceData=e.deviceData)}},a.prototype.teardown=function(t){if(this.teardownState===d.TEARDOWN_STATE.IN_PROGRESS)throw new Error("Cannot call teardown while in progress");if(this.teardownState===d.TEARDOWN_STATE.COMPLETE)throw new Error("Cannot teardown integration more than once");this.teardownMerchantCallback=t||i,this.teardownState=d.TEARDOWN_STATE.IN_PROGRESS,this.destructor.teardown(p(this._handleTeardown,this))},a.prototype._handleTeardown=function(){this.bus.teardown(),this.teardownState=d.TEARDOWN_STATE.COMPLETE,this.teardownMerchantCallback()},a.prototype._wrapWithTeardownReply=function(t,e){var n=this;return function(){if(n.teardownState===d.TEARDOWN_STATE.IN_PROGRESS)throw new Error("Cannot call "+t+" while teardown is in progress");if(n.teardownState===d.TEARDOWN_STATE.COMPLETE)throw new Error("Cannot call "+t+" after teardown has completed");e()}},a.prototype._onIntegrationReady=function(t){this.returnedInstance=t||{},this.returnedInstance.teardown=p(this.teardown,this),this._addDeviceData(this.returnedInstance),this.isReady=!0,this.onReady(this.returnedInstance)},e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{130:130,134:134,141:141,142:142,144:144,146:146,160:160,23:23,50:50,57:57}],136:[function(t,e,n){"use strict";function i(){var t,e;u.apply(this,arguments),e=o(this.configuration),e.apiClient=this.apiClient,this._attachBusEvents(),t=a.create(e),null!=t&&this.destructor.registerFunctionForTeardown(function(e){t.teardown(e)}),this.bus.emit(c.events.ASYNC_DEPENDENCY_READY)}var o=t(141).cloneAndPreserveDOM,r=t(121),s=t(57),a=t(148),c=t(130),u=t(135);i.prototype=r(u.prototype,{constructor:i}),i.prototype._attachBusEvents=function(){this.bus.on(c.events.PAYMENT_METHOD_GENERATED,s(this._onPaymentMethodGenerated,this))},i.prototype._onPaymentMethodGenerated=function(t){this.bus.emit(c.events.PAYMENT_METHOD_RECEIVED,t)},e.exports=i},{121:121,130:130,135:135,141:141,148:148,57:57}],137:[function(t,e,n){"use strict";function i(){E.apply(this,arguments),null!=this.configuration.merchantConfiguration.hostedFields?this._setupHostedFields():this._setupForm(),this._setupPayPal(!1),this._setupPayPal(!0),this._setupCoinbase(),this.bus.emit(v.events.ASYNC_DEPENDENCY_READY)}function o(t,e){return function(n){return e in t&&d(t[e][n])?t[e][n]:function(){}}}var r=t(141).cloneAndPreserveDOM,s=t(121),a=t(59),c=t(60),u=t(169),l=t(181),h=t(148),p=t(57),d=t(116),f=t(175),m=t(51),y=t(134),g=t(194),v=t(130),_=t(133).convertToLegacyShippingAddress,E=t(135),b=t(143);i.prototype=s(E.prototype,{constructor:i}),i.prototype._setupHostedFields=function(){var t,e=this.configuration.merchantConfiguration,n=e[y.ROOT_SUCCESS_CALLBACK],i=new m(e.id),o=f.create(this.configuration),r=new b({formNapper:i,rootCallback:n,channel:this.configuration.channel});return null==i.htmlForm?void this.bus.emit(v.events.ERROR,{type:"CONFIGURATION",message:"options.id does not reference a valid DOM element"}):(t=p(r.handleSubmitRequest,r),i.hijack(t),this.bus.on(v.events.USER_FORM_SUBMIT_REQUEST,t),void this.destructor.registerFunctionForTeardown(p(function(t){r.teardown(),i.detach(),o.teardown(t)},this)))},i.prototype._setupForm=function(){var t,e,n,i=this.configuration.merchantConfiguration;i.id?(n=u.setup(this.apiClient,this.configuration),t=!d(i[y.ROOT_SUCCESS_CALLBACK]),t||(e=this.onSuccess,n.onNonceReceived=p(function(t,n){t?this.bus.emit(v.events.ERROR,t):e(n)},this)),this.destructor.registerFunctionForTeardown(function(){n.teardown()})):this.bus.on(v.events.PAYMENT_METHOD_GENERATED,p(function(t){this.bus.emit(v.events.PAYMENT_METHOD_RECEIVED,t)},this))},i.prototype._setupPayPal=function(t){var e,n,i,s,u,h,p,f,m,y,E;(!t||this.configuration.merchantConfiguration.paypalCredit)&&(t||this.configuration.merchantConfiguration.paypal)&&(e=r(this.configuration),p=e.merchantConfiguration,t&&p.paypalCredit&&(p.paypal=p.paypalCredit),h=p.paypal,n=o(p,"paypal"),i=n("onSuccess"),s=n("onCancelled"),h.paymentMethodNonceInputField||(u=document.createElement("input"),u.id="braintree-custom-integration-dummy-input",h.paymentMethodNonceInputField=u),h.onSuccess=function(t){y=t.nonce,i(t.nonce,t.details.email,_(t.details.shippingAddress))},d(h.onAuthorizationDismissed)&&(f=t?g.PAYPAL_CREDIT_INTEGRATION_NAME:g.PAYPAL_INTEGRATION_NAME,m=a(function(t){c(function(){t&&t.source===f&&!y&&h.onAuthorizationDismissed()})},200,{leading:!0}),this.bus.on(v.events.UI_POPUP_DID_CLOSE,m),this.bus.on(v.events.UI_MODAL_DID_CLOSE,m)),h.onCancelled=function(){y=null,s()},p.enableCORS&&(h.enableCORS=!0),E=l.create(e,t),t?this.paypalCreditIntegration=E:this.paypalIntegration=E,E&&this.destructor.registerFunctionForTeardown(function(){E.teardown()}))},i.prototype._setupCoinbase=function(){var t,e;this.configuration.merchantConfiguration.coinbase&&(navigator.userAgent.match(/MSIE 8\.0/)||(t=r(this.configuration),t.apiClient=this.apiClient,e=h.create(t),null!=e&&this.destructor.registerFunctionForTeardown(function(t){e.teardown(t)})))},i.prototype._onIntegrationReady=function(){var t=this,e={};this.paypalIntegration&&(e.paypal={initAuthFlow:this._wrapWithTeardownReply("initAuthFlow",function(){t.bus.emit(v.events.SEND_ANALYTICS_EVENTS,"paypal.auth.init"),t.paypalIntegration.initAuthFlow()}),closeAuthFlow:this._wrapWithTeardownReply("closeAuthFlow",function(){t.bus.emit(v.events.SEND_ANALYTICS_EVENTS,"paypal.auth.close"),t.paypalIntegration.closeAuthFlow()})}),E.prototype._onIntegrationReady.call(this,e)},e.exports=i},{116:116,121:121,130:130,133:133,134:134,135:135,141:141,143:143,148:148,169:169,175:175,181:181,194:194,51:51,57:57,59:59,60:60}],138:[function(t,e,n){"use strict";function i(t){return l(t.paymentMethodNonceReceived)?t.paymentMethodNonceReceived:null}function o(t){return l(t[p.ROOT_SUCCESS_CALLBACK])}function r(){var t,e,n,r,a;f.apply(this,arguments),a=s(this.configuration),t=a.merchantConfiguration,e=i(t),n=o(t),(e||n)&&(t.paymentMethodNonceReceived=u(function(t){e&&e(t.originalEvent,t.nonce),this.bus.emit(h.events.PAYMENT_METHOD_RECEIVED,d(t))},this)),r=c.create(a),this.destructor.registerFunctionForTeardown(function(t){r.teardown(t)}),this.bus.emit(h.events.ASYNC_DEPENDENCY_READY)}var s=t(141).cloneAndPreserveDOM,a=t(121),c=t(167),u=t(57),l=t(116),h=t(130),p=t(134),d=t(146),f=t(135);r.prototype=a(f.prototype,{constructor:r}),e.exports=r},{116:116,121:121,130:130,134:134,135:135,141:141,146:146,167:167,57:57}],139:[function(t,e,n){"use strict";e.exports={custom:t(137),dropin:t(138),paypal:t(140),coinbase:t(136)}},{136:136,137:137,138:138,140:140}],140:[function(t,e,n){"use strict";function i(t){return"onSuccess"in t&&p(t.onSuccess)?t.onSuccess:"paypal"in t&&p(t.paypal.onSuccess)?t.paypal.onSuccess:null}function o(t){return p(t[d.ROOT_SUCCESS_CALLBACK])}function r(t){var e,n,r,a,d,g,v;t=s(t),t.merchantConfiguration.paypal=t.merchantConfiguration.paypal||{};for(a in t.merchantConfiguration)t.merchantConfiguration.hasOwnProperty(a)&&"paypal"!==a&&(t.merchantConfiguration.paypal[a]=t.merchantConfiguration[a]);y.call(this,t),e=this.configuration.merchantConfiguration,n=i(e),r=o(e),d=p(e.paypal.onCancelled)?e.paypal.onCancelled:function(){},(n||r)&&(e.paypal.onSuccess=h(function(t){v=t.nonce,n&&n(t.nonce,t.details.email,m(t.details.shippingAddress)),this.bus.emit(f.events.PAYMENT_METHOD_RECEIVED,t)},this)),p(e.paypal.onAuthorizationDismissed)&&(g=c(function(t){u(function(){t&&"PayPal"===t.source&&!v&&e.paypal.onAuthorizationDismissed()})},200,{leading:!0}),this.bus.on(f.events.UI_POPUP_DID_CLOSE,g),this.bus.on(f.events.UI_MODAL_DID_CLOSE,g)),e.paypal.onCancelled=function(){v=null,d&&d()},this.paypalIntegration=l.create(this.configuration,!1),this.destructor.registerFunctionForTeardown(h(function(){this.paypalIntegration.teardown()},this)),this.bus.emit(f.events.ASYNC_DEPENDENCY_READY)}var s=t(141).cloneAndPreserveDOM,a=t(121),c=t(59),u=t(60),l=t(181),h=t(57),p=t(116),d=t(134),f=t(130),m=t(133).convertToLegacyShippingAddress,y=t(135);r.prototype=a(y.prototype,{constructor:r}),r.prototype._onIntegrationReady=function(){var t=this,e={};this.paypalIntegration&&(e.paypal={initAuthFlow:this._wrapWithTeardownReply("initAuthFlow",function(){t.bus.emit(f.events.SEND_ANALYTICS_EVENTS,"paypal.auth.init"),t.paypalIntegration.initAuthFlow()}),closeAuthFlow:this._wrapWithTeardownReply("closeAuthFlow",function(){t.bus.emit(f.events.SEND_ANALYTICS_EVENTS,"paypal.auth.close"),t.paypalIntegration.closeAuthFlow()})}),y.prototype._onIntegrationReady.call(this,e)},e.exports=r},{116:116,121:121,130:130,133:133,134:134,135:135,141:141,181:181,57:57,59:59,60:60}],141:[function(t,e,n){"use strict";function i(t){return r(t,function(t){return a(t)?t.get(0):c(t)?t:void 0})}function o(t){return r(t,function(t){return a(t)||c(t)?{}:void 0})}var r=t(113),s=t(145),a=s.isJQueryElement,c=s.isHTMLElement;e.exports={cloneAndPreserveDOM:i,cloneAndStripDOM:o}},{113:113,145:145}],142:[function(t,e,n){"use strict";e.exports=function(t){if("CONFIGURATION"===t.type||"IMMEDIATE"===t.type)throw new Error(t.message);try{console.error(-1===navigator.userAgent.indexOf("MSIE")?t:JSON.stringify(t,null,2))}catch(e){}}},{}],143:[function(t,e,n){"use strict";function i(t){this.paymentMethod=null,this.nonceInputElement=null,this.bus=new o({channel:t.channel}),this.formNapper=t.formNapper,this.rootCallback=t.rootCallback,this._attachEvents()}var o=t(130),r=t(175),s="web.custom.hosted-fields.via.",a="payment_method_nonce";i.prototype._shouldStrictlyValidate=function(t){return null!=t?!1:null==this.paymentMethod||"CreditCard"===this.paymentMethod.type},i.prototype._clearNonce=function(){this.paymentMethod&&this.paymentMethod.nonce&&(this.paymentMethod=null,this.nonceInputElement=this.formNapper.inject(a,""))},i.prototype._attachEvents=function(){var t=this;this.bus.on(o.events.PAYMENT_METHOD_CANCELLED,function(){t._clearNonce()}),this.bus.on(o.events.PAYMENT_METHOD_GENERATED,function(e){t.paymentMethod=e,t.nonceInputElement=t.formNapper.inject(a,t.paymentMethod.nonce)})},i.prototype.handleSubmitRequest=function(){var t=this;this.bus.emit(r.events.TOKENIZATION_REQUEST,function(e){var n=e[0],i=e[1];return n?void t.bus.emit(o.events.ERROR,n):(t.paymentMethod=i||t.paymentMethod,t._shouldStrictlyValidate(i)?(t.bus.emit(r.events.VALIDATE_STRICT),void t.bus.emit(o.events.ERROR,{type:"VALIDATION",message:"User did not enter a payment method"})):void(t.rootCallback?t.bus.emit(o.events.SEND_ANALYTICS_EVENTS,s+"callback.success",function(){t.rootCallback(t.paymentMethod)}):t.bus.emit(o.events.SEND_ANALYTICS_EVENTS,s+"formsubmit.success",function(){t.nonceInputElement=t.formNapper.inject(a,t.paymentMethod.nonce),t.formNapper.submit()})))})},i.prototype.teardown=function(){this._clearNonce()},e.exports=i},{130:130,175:175}],144:[function(t,e,n){"use strict";function i(){}var o=t(116);e.exports=function(t){return function(e,n){return o(t[e])?t[e]:o(n)?n:i}}},{116:116}],145:[function(t,e,n){"use strict";function i(t){return Boolean(t)&&"object"==typeof t&&"jquery"in t}function o(t){return Boolean(t)&&1===t.nodeType}e.exports={isJQueryElement:i,isHTMLElement:o}},{}],146:[function(t,e,n){"use strict";e.exports=function(t){return{nonce:t.nonce,details:t.details,type:t.type}}},{}],147:[function(t,e,n){(function(n){"use strict";function i(t,e,i){var s;if(!c.hasOwnProperty(e))throw new Error(e+" is an unsupported integration");i=i||{},s=p.uuid(),r._getConfiguration({enableCORS:i.enableCORS||!1,authorization:t,sessionId:s},function(r,a){var d;return r?(d=h(i)(u.ROOT_ERROR_CALLBACK,l),void d(403===r.status?{type:"CONFIGURATION",message:u.AUTHORIZATION_PRIVILEGE_ERROR}:{message:r.errors})):void new c[e]({channel:s,authorization:t,gatewayConfiguration:a,integrationType:e,merchantConfiguration:i,analyticsConfiguration:{sdkVersion:"braintree/web/"+o,merchantAppId:n.location.host},isMerchantPageHttps:p.isBrowserHttps()})})}var o="2.32.1",r=t(23),s=t(181),a=t(167),c=t(139),u=t(134),l=t(142),h=t(144),p=t(47),d=t(160);e.exports={api:r,data:d,cse:n.Braintree,paypal:s,dropin:a,hostedFields:{VERSION:t(175).VERSION},setup:i,VERSION:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{134:134,139:139,142:142,144:144,160:160,167:167,175:175,181:181,23:23,47:47}],148:[function(t,e,n){"use strict";function i(t){var e=new o(t);return e.canCreateIntegration?e:null}var o=t(151);e.exports={create:i}},{151:151}],149:[function(t,e,n){(function(t){"use strict";function n(e){return e=e||t.navigator.userAgent,/AppleWebKit\//.test(e)&&/Mobile\//.test(e)?e.replace(/.* OS ([0-9_]+) like Mac OS X.*/,"$1").replace(/_/g,"."):null}function i(e){var n=e||t.navigator.userAgent,i=null,o=/MSIE.(\d+)/.exec(n);return/Trident/.test(n)&&(i=11),o&&(i=parseInt(o[1],10)),i}function o(e){return e=e||t.navigator.userAgent,/Android/.test(e)?e.replace(/^.* Android ([0-9\.]+).*$/,"$1"):null}e.exports={ieVersion:i,iOSSafariVersion:n,androidVersion:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],150:[function(t,e,n){"use strict";function i(t,e,n){return t?(n.bus.emit(o.ERROR,t.error),void n.bus.emit(o.SEND_ANALYTICS_EVENTS,"coinbase.generate.nonce.failed")):(n.bus.emit(o.PAYMENT_METHOD_GENERATED,e),void n.bus.emit(o.SEND_ANALYTICS_EVENTS,"coinbase.generate.nonce.succeeded"))}var o=t(130).events;e.exports={tokenize:i}},{130:130}],151:[function(t,e,n){(function(n){"use strict";function i(t){return{clientId:t.gatewayConfiguration.coinbase.clientId,redirectUrl:t.gatewayConfiguration.coinbase.redirectUrl,scopes:t.gatewayConfiguration.coinbase.scopes||d.SCOPES,meta:{authorizations_merchant_account:t.gatewayConfiguration.coinbase.merchantAccount||""}}}function o(t){return function(e,n){t.emit(m.events.ERROR,{type:n,message:e})}}function r(t,e){var n=(t.merchantConfiguration||{}).coinbase,i=o(e);if(null==t.apiClient)i("apiClient is required for coinbase",d.CONFIGURATION_ERROR);else if(t.gatewayConfiguration.coinbaseEnabled)if(n&&(n.container||n.button))if(n.container&&n.button)i("options.coinbase.container and options.coinbase.button are mutually exclusive",d.CONFIGURATION_ERROR);else{if(f.isSupportedBrowser())return!0;i("Coinbase is not supported by your browser. Please consider upgrading",d.UNSUPPORTED_BROWSER_ERROR)}else i("Either options.coinbase.container or options.coinbase.button is required for Coinbase integrations",d.CONFIGURATION_ERROR);else i("Coinbase is not enabled for your merchant account",d.CONFIGURATION_ERROR);return!1}function s(t){var e,o,s=this;this.configuration=t,this.destructor=new u,o={channel:t.channel};try{t.coinbase.container&&(o.merchantUrl=n.location.href)}catch(l){}this.bus=t.bus||new m(o),this.canCreateIntegration=r(t,this.bus),this.canCreateIntegration&&(this.buttonId=t.merchantConfiguration.coinbase.button||d.BUTTON_ID,this.apiClient=t.apiClient||new y.Client(t),this._onOAuthSuccess=a(this._onOAuthSuccess,this),this._handleButtonClick=a(this._handleButtonClick,this),this.popupParams=i(t),this.redirectDoneInterval=null,t.merchantConfiguration.coinbase.container?(e=c.normalizeElement(t.merchantConfiguration.coinbase.container),this._insertFrame(e)):(n.braintreeCoinbasePopupCallback=this._onOAuthSuccess,e=document.body,c.addEventListener(e,"click",this._handleButtonClick),this.bus.emit(m.events.SEND_ANALYTICS_EVENTS,"coinbase.initialized"),this.destructor.registerFunctionForTeardown(function(){s._closePopup()}),this.bus.on(d.TEARDOWN_EVENT,a(this.destructor.teardown,this.destructor))))}var a=t(57),c=t(47),u=t(50),l=t(155),h=t(158),p=t(150),d=t(152),f=t(153),m=t(130),y=t(23);s.prototype._insertFrame=function(t){var e=this,n=l.createFrame({channel:this.configuration.channel});this.bus.emit(m.events.ASYNC_DEPENDENCY_INITIALIZING),t.appendChild(n),this.destructor.registerFunctionForTeardown(function(){t.removeChild(n)}),setTimeout(function(){n.src=e.configuration.gatewayConfiguration.assetsUrl+"/coinbase/"+d.VERSION+"/coinbase-frame.html#"+e.configuration.channel},0)},s.prototype._onOAuthSuccess=function(t){var e=this;return t.code?(this.bus.emit("coinbase:view:navigate","loading"),this.bus.emit(m.events.SEND_ANALYTICS_EVENTS,"coinbase.popup.authorized"),this.apiClient.tokenizeCoinbase({code:t.code,query:h.getQueryString()},function(t,n){p.tokenize.apply(null,[t,n,e])}),void this._closePopup()):(this.bus.emit(m.events.SEND_ANALYTICS_EVENTS,"coinbase.popup.denied"),void this._closePopup())},s.prototype._clearPollForRedirectDone=function(){this.redirectDoneInterval&&(clearInterval(this.redirectDoneInterval),this.redirectDoneInterval=null)},s.prototype._closePopup=function(t){t=t||this.popup,null!=t&&(f.shouldCloseFromParent()&&t.close(),this._popupCleanup())},s.prototype._popupCleanup=function(){this._clearPollForRedirectDone(),this.bus.emit(m.events.UI_POPUP_DID_CLOSE,{source:d.INTEGRATION_NAME})},s.prototype._pollForRedirectDone=function(t){var e=this,n=setInterval(function(){var n;if(null==t||t.closed)return e.bus.emit(m.events.SEND_ANALYTICS_EVENTS,"coinbase.popup.aborted"),void e._popupCleanup();try{if("about:blank"===t.location.href)throw new Error("Not finished loading");n=c.decodeQueryString(t.location.search.replace(/^\?/,"")).code}catch(i){return}e._onOAuthSuccess({code:n})},100);return this.redirectDoneInterval=n,n},s.prototype._openPopup=function(){var t;this.bus.emit(m.events.SEND_ANALYTICS_EVENTS,"coinbase.popup.started"),t=l.createPopup(h.compose(this._getOAuthBaseUrl(),this.popupParams)),t.focus(),this._pollForRedirectDone(t),this.bus.emit(m.events.UI_POPUP_DID_OPEN,{source:d.INTEGRATION_NAME}),this.bus.on(m.events.UI_POPUP_FORCE_CLOSE,function(e){e.target===d.INTEGRATION_NAME&&t.close()}),this.popup=t},s.prototype._getOAuthBaseUrl=function(){var t;return t="shared_sandbox"===this.configuration.gatewayConfiguration.coinbase.environment?d.SANDBOX_OAUTH_BASE_URL:d.PRODUCTION_OAUTH_BASE_URL},s.prototype._handleButtonClick=function(t){for(var e=t.target||t.srcElement;;){if(null==e)return;if(e===t.currentTarget)return;if(e.id===this.buttonId)break;e=e.parentNode}t&&t.preventDefault?t.preventDefault():t.returnValue=!1,this._openPopup()},s.prototype.teardown=function(t){var e=this;return this.canCreateIntegration?void this.bus.emit(d.TEARDOWN_EVENT,function(){e.destructor.teardown(function(n){return n?t(n):(e.bus.teardown(),void t(null))})}):void t(null)},e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{130:130,150:150,152:152,153:153,155:155,158:158,23:23,47:47,50:50,57:57}],152:[function(t,e,n){"use strict";e.exports={PRODUCTION_OAUTH_BASE_URL:"https://coinbase.com",SANDBOX_OAUTH_BASE_URL:"https://sandbox.coinbase.com",ORIGIN_URL:"https://www.coinbase.com",FRAME_NAME:"braintree-coinbase-frame",POPUP_NAME:"coinbase",BUTTON_ID:"bt-coinbase-button",SCOPES:"send",VERSION:"2.32.1",INTEGRATION_NAME:"Coinbase",CONFIGURATION_ERROR:"CONFIGURATION",UNSUPPORTED_BROWSER_ERROR:"UNSUPPORTED_BROWSER",TEARDOWN_EVENT:"coinbase:TEARDOWN"}},{}],153:[function(t,e,n){"use strict";function i(){var t=a.ieVersion();return!t||t>8}function o(){var t=a.androidVersion();return null==t?!1:/^5/.test(t)}function r(){return!(o()||s())}function s(){var t=a.iOSSafariVersion();return null==t?!1:/^8\.0/.test(t)||/^8\.1$/.test(t)}var a=t(149);e.exports={isSupportedBrowser:i,shouldCloseFromParent:r,shouldDisplayIOSClose:s,shouldDisplayLollipopClose:o}},{149:149}],154:[function(t,e,n){"use strict";function i(t){var e=document.createElement("button");return t=t||{},e.id=t.id||"coinbase-button",e.style.backgroundColor=t.backgroundColor||"#EEE",e.style.color=t.color||"#4597C3",e.style.border=t.border||"0",e.style.borderRadius=t.borderRadius||"6px",e.style.padding=t.padding||"12px",e.innerHTML=t.innerHTML||"coinbase",e}e.exports={create:i}},{}],155:[function(t,e,n){"use strict";var i=t(157),o=t(154),r=t(156);e.exports={createButton:o.create,createPopup:i.create,createFrame:r.create}},{154:154,156:156,157:157}],156:[function(t,e,n){"use strict";function i(){return r({name:o.FRAME_NAME,height:"70px",width:"100%",style:{padding:0,margin:0,border:0,outline:"none"}})}var o=t(152),r=t(53);e.exports={create:i}},{152:152,53:53}],157:[function(t,e,n){(function(n){"use strict";function i(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push([e,t[e]].join("="));return n.join(",")}function o(){var t=580,e=810;return i({width:t,height:e,left:(screen.width-t)/2,top:(screen.height-e)/4})}function r(t){return n.open(t,s.POPUP_NAME,o())}var s=t(152);e.exports={create:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{152:152}],158:[function(t,e,n){"use strict";function i(){return"version="+r.VERSION}function o(t,e){var n,o=t+"/oauth/authorize?response_type=code",r=e.redirectUrl+"?"+i();if(o+="&redirect_uri="+encodeURIComponent(r),o+="&client_id="+e.clientId,e.scopes&&(o+="&scope="+encodeURIComponent(e.scopes)),e.meta)for(n in e.meta)e.meta.hasOwnProperty(n)&&(o+="&meta["+encodeURIComponent(n)+"]="+encodeURIComponent(e.meta[n]));return o}var r=t(152);e.exports={compose:o,getQueryString:i}},{152:152}],159:[function(t,e,n){"use strict";function i(){return new o}function o(){this.sessionId=r(),this._beaconId=s(this.sessionId),this._parameterBlock=a(this.sessionId,this._beaconId),this._thirdPartyBlock=c()}function r(){var t,e="";for(t=0;32>t;t++)e+=Math.floor(16*Math.random()).toString(16);return e}function s(t){var e=(new Date).getTime()/1e3;return"https://b.stats.paypal.com/counter.cgi?i=127.0.0.1&p="+t+"&t="+e+"&a=14"}function a(t,e){var n=document.body.appendChild(document.createElement("script"));return n.type="application/json",n.setAttribute("fncls","fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99"),n.text=JSON.stringify({f:t,s:"BRAINTREE_SIGNIN",b:e}),n}function c(){function t(){n._l()}var e,n,i="https://www.paypalobjects.com/webstatic/r/fb/",o=document.createElement("iframe");o.src="about:blank",o.title="",o.role="presentation",(o.frameElement||o).style.cssText="width: 0; height: 0; border: 0",document.body.appendChild(o);try{n=o.contentWindow.document}catch(r){e=document.domain,o.src='javascript:var d=document.open();d.domain="'+e+'";void(0);',n=o.contentWindow.document}return n.open()._l=function(){var t=this.createElement("script");e&&(this.domain=e),t.id="js-iframe-async",t.src=i+"fb-all-prod.pp.min.js",this.body.appendChild(t)},o.addEventListener?o.addEventListener("load",t,!1):o.attachEvent?o.attachEvent("onload",t):n.write('<body onload="document._l();">'),n.close(),o}o.prototype.teardown=function(){this._thirdPartyBlock.parentNode.removeChild(this._thirdPartyBlock)},e.exports={setup:i}},{}],160:[function(t,e,n){"use strict";function i(t){function e(){var t;for(t=0;t<a.length;t++)a[t].teardown()}var n,i,s,a=[];return null!=t.kount?(i=o.setup(t.kount),n=i.deviceData,a.push(i)):n={},t.paypal===!0&&(s=r.setup(),n.correlation_id=s.sessionId,a.push(s)),{deviceData:JSON.stringify(n),teardown:e}}var o=t(161),r=t(159);e.exports={setup:i}},{159:159,161:161}],161:[function(t,e,n){(function(t){"use strict";function n(t){var e=null!=t?t:{};return new i(e)}function i(t){o.random.startCollectors(),this._currentEnvironment=this._initializeEnvironment(t),this._deviceSessionId=this._generateDeviceSessionId(),this.deviceData=this._getDeviceData(),this._iframe=this._setupIFrame()}var o=t.Braintree.sjcl,r="braintreeDataFrame",s="600000",a="https://assets.qa.braintreepayments.com/data",c={development:a,qa:a,sandbox:"https://assets.braintreegateway.com/sandbox/data",production:"https://assets.braintreegateway.com/data"};i.prototype.teardown=function(){o.random.stopCollectors(),this._removeIframe()},i.prototype._removeIframe=function(){this._iframe.parentNode.removeChild(this._iframe)},i.prototype._getDeviceData=function(){return{device_session_id:this._deviceSessionId,fraud_merchant_id:this._currentEnvironment.id}},i.prototype._generateDeviceSessionId=function(){var t,e;return t=o.random.randomWords(4,0),e=o.codec.hex.fromBits(t)},i.prototype._setupIFrame=function(){var t,e=this,n=document.getElementById(r);return null!=n?n:(t="?m="+this._currentEnvironment.id+"&s="+this._deviceSessionId,n=document.createElement("iframe"),n.width=1,n.id=r,n.height=1,n.frameBorder=0,n.scrolling="no",document.body.appendChild(n),setTimeout(function(){n.src=e._currentEnvironment.url+"/logo.htm"+t;try{n.innerHTML='<img src="'+e._currentEnvironment.url+"/logo.gif"+t+'" />'}catch(i){}},10),n)},i.prototype._initializeEnvironment=function(t){var e=c[t.environment];if(null==e)throw new Error(t.environment+" is not a valid environment for kount.environment");return{url:e,name:t.environment,id:null==t.merchantId?s:t.merchantId}},e.exports={setup:n,Kount:i,environmentUrls:c}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],162:[function(t,e,n){"use strict";function i(t){this.apiClient=t}var o=["unlockCreditCard"];i.prototype.attach=function(t){function e(e){t.define(e,function(){n.apiClient[e].apply(n.apiClient,arguments)})}var n=this,i=0,r=o.length;for(i;r>i;i++)e(o[i])},e.exports=i},{}],163:[function(t,e,n){(function(n){"use strict";function i(t,e){var n=window.getComputedStyle?getComputedStyle(t):t.currentStyle;return n[e]}function o(){return{html:{height:a.style.height||"",overflow:i(a,"overflow"),position:i(a,"position")},body:{height:c.style.height||"",overflow:i(c,"overflow")}}}function r(){var t=/Android|iPhone|iPod|iPad/i.test(window.navigator.userAgent);return t}function s(t){var e,i,o,r=this;this.configuration=t,this.destructor=new h,this.container=null,this.merchantFormManager=null,this.configurationRequests=[],this.braintreeApiClient=new u.Client(this.configuration),this.braintreeBus=new l({merchantUrl:n.location.href,channel:this.configuration.channel}),this.bus=new p.MessageBus(this.configuration.root,this.configuration.channel),this.rpcServer=new p.RPCServer(this.bus),this.apiProxyServer=new y(this.braintreeApiClient),this.apiProxyServer.attach(this.rpcServer),e=this.configuration.inlineFramePath||this.configuration.gatewayConfiguration.assetsUrl+"/dropin/"+E+"/inline-frame.html",i=this.configuration.modalFramePath||this.configuration.gatewayConfiguration.assetsUrl+"/dropin/"+E+"/modal-frame.html",a=document.documentElement,c=document.body,this.frames={inline:this._createFrame(e,_.INLINE_FRAME_NAME),modal:this._createFrame(i,_.MODAL_FRAME_NAME)},this.container=f(this.configuration.merchantConfiguration.container,"Unable to find valid container."),o=f(this.configuration.merchantConfiguration.form||this._findClosest(this.container,"form")),this.merchantFormManager=new g({form:o,frames:this.frames,onSubmit:this.configuration.merchantConfiguration.paymentMethodNonceReceived,apiClient:this.braintreeApiClient}).initialize(),this.destructor.registerFunctionForTeardown(function(){r.merchantFormManager.teardown()}),this.configuration.gatewayConfiguration.paypalEnabled&&this._configurePayPal(),this.braintreeApiClient.sendAnalyticsEvents("dropin.web.initialized")}var a,c,u=t(23),l=t(130),h=t(50),p=t(38),d=t(47),f=d.normalizeElement,m=t(57),y=t(162),g=t(166),v=t(165),_=t(168),E="2.32.1",b=t(185);s.prototype.initialize=function(){var t,e=this;this._initializeModal(),this.braintreeBus.emit(l.events.ASYNC_DEPENDENCY_INITIALIZING),this.container.appendChild(this.frames.inline.element),c.appendChild(this.frames.modal.element),this.destructor.registerFunctionForTeardown(function(t){e._hideModal(function(){e.container.removeChild(e.frames.inline.element),c.removeChild(e.frames.modal.element),t()})}),this.rpcServer.define("receiveSharedCustomerIdentifier",function(n){for(e.braintreeApiClient.attrs.sharedCustomerIdentifier=n,e.braintreeApiClient.attrs.sharedCustomerIdentifierType="browser_session_cookie_store",t=0;t<e.configurationRequests.length;t++)e.configurationRequests[t](e.encodedClientToken);e.configurationRequests=[]}),this.braintreeBus.on(l.events.PAYMENT_METHOD_GENERATED,m(this._handleAltPayData,this)),this.rpcServer.define("selectPaymentMethod",function(t){e.frames.modal.rpcClient.invoke("selectPaymentMethod",[t]),e._showModal()}),this.rpcServer.define("sendAddedPaymentMethod",function(t){e.merchantFormManager.setNoncePayload(t),e.frames.inline.rpcClient.invoke("receiveNewPaymentMethod",[t])}),this.rpcServer.define("sendUsedPaymentMethod",function(t){e.frames.inline.rpcClient.invoke("selectPaymentMethod",[t])}),this.rpcServer.define("sendUnlockedNonce",function(t){e.merchantFormManager.setNoncePayload(t)}),this.rpcServer.define("clearNonce",function(){e.merchantFormManager.clearNoncePayload()}),this.rpcServer.define("closeDropInModal",function(){e._hideModal()}),this.rpcServer.define("setInlineFrameHeight",function(t){e.frames.inline.element.style.height=t+"px"}),this.bus.register("ready",function(t){t.source===e.frames.inline.element.contentWindow?e.frames.inline.rpcClient=new p.RPCClient(e.bus,t.source):t.source===e.frames.modal.element.contentWindow&&(e.frames.modal.rpcClient=new p.RPCClient(e.bus,t.source))})},s.prototype._createFrame=function(t,e){return new v(t,e,this.braintreeBus)},s.prototype._initializeModal=function(){this.frames.modal.element.style.display="none",this.frames.modal.element.style.position=r()?"absolute":"fixed",this.frames.modal.element.style.top="0",this.frames.modal.element.style.left="0",this.frames.modal.element.style.height="100%",this.frames.modal.element.style.width="100%"},s.prototype._lockMerchantWindowSize=function(){setTimeout(function(){a.style.overflow="hidden",c.style.overflow="hidden",c.style.height="100%",r()&&(a.style.position="relative",a.style.height=window.innerHeight+"px")},160)},s.prototype._unlockMerchantWindowSize=function(){var t=this.merchantPageDefaultStyles;t&&(c.style.height=t.body.height,c.style.overflow=t.body.overflow,a.style.overflow=t.html.overflow,r()&&(a.style.height=t.html.height,a.style.position=t.html.position),delete this.merchantPageDefaultStyles)},s.prototype._showModal=function(){var t=this,e=this.frames.modal.element;this.merchantPageDefaultStyles=o(),e.style.display="block",this.frames.modal.rpcClient.invoke("open",[],function(){setTimeout(function(){t._lockMerchantWindowSize(),e.contentWindow.focus()},200)})},s.prototype._hideModal=function(t){this._unlockMerchantWindowSize(),this.frames.modal.element.style.display="none",t&&t()},s.prototype._configurePayPal=function(){var t=this.configuration.merchantConfiguration.paypal||{},e=this.configuration.merchantConfiguration.paypalCredit;this.paypalModalView=new b({channel:this.configuration.channel,insertFrameFunction:t.insertFrame,paypalAssetsUrl:this.configuration.gatewayConfiguration.paypal.assetsUrl,isHermes:Boolean(t.singleUse)&&Boolean(t.amount)&&Boolean(t.currency),offerPaypalCredit:!1}),e&&(this.paypalCreditModalView=new b({channel:this.configuration.channel,insertFrameFunction:e.insertFrame,paypalAssetsUrl:this.configuration.gatewayConfiguration.paypal.assetsUrl,isHermes:Boolean(e.singleUse)&&Boolean(e.amount)&&Boolean(e.currency),
offerPaypalCredit:!0}))},s.prototype._handleAltPayData=function(t){this.merchantFormManager.setNoncePayload(t),this.frames.inline.rpcClient.invoke("receiveNewPaymentMethod",[t]),this.frames.modal.rpcClient.invoke("modalViewClose")},s.prototype._findClosest=function(t,e){e=e.toUpperCase();do{if(t.nodeName===e)return t;t=t.parentNode}while(t);throw new Error("Unable to find a valid "+e)},s.prototype.teardown=function(t){var e=this;this.paypalCreditModalView&&this.paypalCreditModalView.teardown(),this.paypalModalView&&this.paypalModalView.teardown(),this.braintreeBus.emit(_.MODAL_FRAME_TEARDOWN_EVENT,function(){e.braintreeBus.emit(_.INLINE_FRAME_TEARDOWN_EVENT,function(){e.destructor.teardown(function(n){return n?t(n):(e.braintreeBus.teardown(),void t())})})})},e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{130:130,162:162,165:165,166:166,168:168,185:185,23:23,38:38,47:47,50:50,57:57}],164:[function(t,e,n){"use strict";function i(t){var e=new o(t);return e.initialize(),e}var o=t(163),r="2.32.1";e.exports={create:i,VERSION:r}},{163:163}],165:[function(t,e,n){"use strict";function i(){var t,e=document.createElement("fakeelement");for(t in u)if("undefined"!=typeof e.style[t])return u[t];return null}function o(t,e){function n(i){i.target===t&&"height"===i.propertyName&&(e.emit(s.events.ASYNC_DEPENDENCY_READY),t.removeEventListener(o,n))}var o=i();o?t.addEventListener(o,n):setTimeout(function(){e.emit(s.events.ASYNC_DEPENDENCY_READY)},500)}function r(t,e,n){var i="height 210ms cubic-bezier(0.390, 0.575, 0.565, 1.000)",r=c({name:e,width:"100%",height:"68",style:{transition:i,WebkitTransition:i,MozTransition:i,msTransition:i,OTransition:i,border:"0",zIndex:"9999"}});this.element=r,setTimeout(function(){r.src=t+"#"+n.channel},0),e===a.INLINE_FRAME_NAME&&o(r,n)}var s=t(130),a=t(168),c=t(53),u={transition:"transitionend","-o-transition":"otransitionEnd","-moz-transition":"transitionend","-webkit-transition":"webkitTransitionEnd"};e.exports=r},{130:130,168:168,53:53}],166:[function(t,e,n){"use strict";function i(t){this.formNapper=new r(t.form),this.frames=t.frames,this.onSubmit=t.onSubmit,this.apiClient=t.apiClient}var o=t(57),r=t(51);i.prototype.initialize=function(){return this._isSubmitBased()&&this._setElements(),this._setEvents(),this},i.prototype.setNoncePayload=function(t){this.noncePayload=t},i.prototype.clearNoncePayload=function(){this.noncePayload=null},i.prototype._isSubmitBased=function(){return!this.onSubmit},i.prototype._isCallbackBased=function(){return Boolean(this.onSubmit)},i.prototype._setElements=function(){this.nonceInput=this.formNapper.inject("payment_method_nonce","")},i.prototype._setEvents=function(){this.formNapper.hijack(o(this._handleFormSubmit,this))},i.prototype._handleFormSubmit=function(t){var e=this;this.noncePayload&&this.noncePayload.nonce?this._handleNonceReply(t):this.frames.inline.rpcClient.invoke("requestNonce",[],function(n){e.setNoncePayload(n),e._handleNonceReply(t)})},i.prototype._handleNonceReply=function(t){var e=this;this._isCallbackBased()?this.apiClient.sendAnalyticsEvents("dropin.web.end.callback",function(){var n=e.noncePayload;n.originalEvent=t,e.onSubmit(n),setTimeout(function(){delete n.originalEvent,e.frames.inline.rpcClient.invoke("clearLoadingState"),e.frames.inline.rpcClient.invoke("receiveNewPaymentMethod",[n])},200)}):this._triggerFormSubmission()},i.prototype._triggerFormSubmission=function(){var t=this;this.nonceInput=this.formNapper.inject("payment_method_nonce",this.noncePayload.nonce),this.apiClient.sendAnalyticsEvents("dropin.web.end.auto-submit",function(){t.formNapper.submit()})},i.prototype.teardown=function(){var t;this.nonceInput&&(t=this.formNapper.htmlForm,t.removeChild(this.nonceInput)),this.formNapper.detach()},e.exports=i},{51:51,57:57}],167:[function(t,e,n){"use strict";e.exports=t(164)},{164:164}],168:[function(t,e,n){e.exports={PAYPAL_INTEGRATION_NAME:"PayPal",INLINE_FRAME_NAME:"braintree-dropin-frame",MODAL_FRAME_NAME:"braintree-dropin-modal-frame",PAYMENT_METHOD_TYPES:["CoinbaseAccount","PayPalAccount","CreditCard"],cssClassMap:{"American Express":"american-express","Diners Club":"diners-club",DinersClub:"diners-club",Discover:"discover",JCB:"jcb",Maestro:"maestro",MasterCard:"master-card",Solo:"solo",Switch:"switch",UKMaestro:"maestro",UnionPay:"unionpay",Visa:"visa"},INLINE_FRAME_TEARDOWN_EVENT:"dropin:TEARDOWN_INLINE_FRAME",MODAL_FRAME_TEARDOWN_EVENT:"dropin:TEARDOWN_MODAL_FRAME"}},{}],169:[function(t,e,n){"use strict";function i(t,e){var n=e.merchantConfiguration||{},i=document.getElementById(n.id),s=n.useCreditCard!==!1;if(!i)throw new Error('Unable to find form with id: "'+n.id+'"');return s&&r(i),new o(t,e)}var o=t(171),r=t(174);e.exports={setup:i}},{171:171,174:174}],170:[function(t,e,n){(function(t){"use strict";function n(t,e){var o,s,a,c=t.children;for(e=e||{},s=0;s<c.length;s++)o=c[s],r(o)?(a=o.getAttribute("data-braintree-name"),"postal_code"===a?e.billingAddress={postalCode:o.value}:e[a]=o.value,i(o)):o.children&&o.children.length>0&&n(o,e);return e}function i(t){try{t.attributes.removeNamedItem("name")}catch(e){}}function o(t){n(t)}function r(t){return t.nodeType===s&&t.attributes["data-braintree-name"]}var s=t.Node?t.Node.ELEMENT_NODE:1;e.exports={extractValues:n,scrubAllAttributes:o,scrubAttributes:i,isBraintreeNode:r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],171:[function(t,e,n){(function(n){"use strict";function i(t,e){var i=e.merchantConfiguration,o="object"==typeof i.paymentMethodNonceInputField,r=this;this.destructor=new a,this.apiClient=t,this.isCreditCardForm=i.useCreditCard!==!1,this.htmlForm=document.getElementById(i.id),this.paymentMethodNonceInput=l(i.paymentMethodNonceInputField),this.htmlForm.appendChild(this.paymentMethodNonceInput),this.destructor.registerFunctionForTeardown(function(){o?r.paymentMethodNonceInput.value="":r.htmlForm.removeChild(r.paymentMethodNonceInput)}),this.model=new u,this.bus=new c({merchantUrl:n.location.href,channel:e.channel}),this.setEvents(),this.destructor.registerFunctionForTeardown(function(){r.bus.teardown()})}var o=t(57),r=t(47),s=t(170),a=t(50),c=t(130),u=t(173),l=t(172),h={message:"Unable to process payments at this time",type:"IMMEDIATE"};i.prototype.setEvents=function(){var t=this;this.onSubmitHandler=o(this.handleSubmit,this),this.onExternalNonceReceived=o(this.onExternalNonceReceived,this),this.clearExternalNonce=o(this.clearExternalNonce,this),r.addEventListener(this.htmlForm,"submit",this.onSubmitHandler),this.destructor.registerFunctionForTeardown(function(){r.removeEventListener(t.htmlForm,"submit",t.onSubmitHandler)}),this.bus.on(c.events.PAYMENT_METHOD_GENERATED,this.onExternalNonceReceived),this.bus.on(c.events.PAYMENT_METHOD_CANCELLED,this.clearExternalNonce)},i.prototype.handleSubmit=function(t){var e,n=this;return t.preventDefault?t.preventDefault():t.returnValue=!1,this.isCreditCardForm?(e=this.model.get("type"),e&&"CreditCard"!==e?(s.scrubAllAttributes(this.htmlForm),void this.onNonceReceived(null,this.model.attributes)):void this.apiClient.tokenizeCard(s.extractValues(this.htmlForm),function(t,e,i){t?n.onNonceReceived(h,null):(n.model.set({nonce:e,type:i.type,details:i.details}),n.onNonceReceived(null,n.model.attributes))})):void this.onNonceReceived(null,this.model.attributes)},i.prototype.writeNonceToDOM=function(){this.paymentMethodNonceInput.value=this.model.get("nonce")},i.prototype.onExternalNonceReceived=function(t){this.model.set(t),this.writeNonceToDOM()},i.prototype.clearExternalNonce=function(){this.model.reset()},i.prototype.onNonceReceived=function(t){var e=this.htmlForm;return t?void this.bus.emit(c.events.ERROR,h):(r.removeEventListener(e,"submit",this.onSubmitHandler),this.writeNonceToDOM(),void(e.submit&&("function"==typeof e.submit||e.submit.call)?e.submit():setTimeout(function(){e.querySelector('[type="submit"]').click()},1)))},i.prototype.teardown=function(){this.destructor.teardown()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{130:130,170:170,172:172,173:173,47:47,50:50,57:57}],172:[function(t,e,n){"use strict";e.exports=function(t){var e,n;return"object"==typeof t?t:(e="payment_method_nonce","string"==typeof t&&(e=t),n=document.createElement("input"),n.name=e,n.type="hidden",n)}},{}],173:[function(t,e,n){"use strict";function i(){this.reset()}i.prototype.get=function(t){return this.attributes[t]},i.prototype.set=function(t){this.attributes=t||{}},i.prototype.reset=function(){this.attributes={}},e.exports=i},{}],174:[function(t,e,n){"use strict";e.exports=function(t){var e,n,i=t.getElementsByTagName("*"),o={};for(e=0;e<i.length;e++)n=i[e].getAttribute("data-braintree-name"),o[n]=!0;if(!o.number)throw new Error('Unable to find an input with data-braintree-name="number" in your form. Please add one.');if(o.expiration_date){if(o.expiration_month||o.expiration_year)throw new Error('You have inputs with data-braintree-name="expiration_date" AND data-braintree-name="expiration_(year|month)". Please use either "expiration_date" or "expiration_year" and "expiration_month".')}else{if(!o.expiration_month&&!o.expiration_year)throw new Error('Unable to find an input with data-braintree-name="expiration_date" in your form. Please add one.');if(!o.expiration_month)throw new Error('Unable to find an input with data-braintree-name="expiration_month" in your form. Please add one.');if(!o.expiration_year)throw new Error('Unable to find an input with data-braintree-name="expiration_year" in your form. Please add one.')}}},{}],175:[function(t,e,n){"use strict";var i=t(177),o=t(179).events,r="2.32.1";e.exports={create:function(t){return new i(t)},events:o,VERSION:r}},{177:177,179:179}],176:[function(t,e,n){"use strict";var i=t(179);e.exports=function(t,e){return t+"/hosted-fields/"+i.VERSION+"/hosted-fields-frame.html#"+e}},{179:179}],177:[function(t,e,n){"use strict";function i(t,e){var n=document.createElement("div");return n.style.clear="both",e=e||document.body,e.appendChild(t),e.appendChild(n),{parent:e,children:[t,n]}}function o(t,e){return function(n){var i=t[n.fieldKey].containerElement,o=a(i);n.target={fieldKey:n.fieldKey,container:i},o.toggle(h.externalClasses.FOCUSED,n.isFocused).toggle(h.externalClasses.VALID,n.isValid),n.isStrictlyValidating?o.toggle(h.externalClasses.INVALID,!n.isValid):o.toggle(h.externalClasses.INVALID,!n.isPotentiallyValid),delete n.fieldKey,delete n.isStrictlyValidating,e&&e(n)}}function r(t){var e,n,r,p,d,f=this,m={},g=0;this.injectedNodes=[],this.destructor=new s,this.bus=new u({channel:t.channel,merchantUrl:location.href}),this.destructor.registerFunctionForTeardown(function(){f.bus.teardown()}),this.bus.emit(u.events.ASYNC_DEPENDENCY_INITIALIZING),this.bus.emit(u.events.SEND_ANALYTICS_EVENTS,"hosted-fields.initialized");for(p in h.whitelistedFields)if(h.whitelistedFields.hasOwnProperty(p)){if(e=t.merchantConfiguration.hostedFields[p],!e)continue;if(n=document.querySelector(e.selector),!n){d='Unable to find element with selector "'+e.selector+'" for hostedFields.'+p,this.bus.emit(u.events.ERROR,{message:d});continue}if(n.querySelector('iframe[name^="braintree-"]')){this.bus.emit(u.events.ERROR,{message:'Cannot place two elements in "'+e.selector+'"'});continue}r=c({type:p,name:"braintree-hosted-field-"+p,style:h.defaultIFrameStyle}),this.injectedNodes.push(i(r,n)),this.setupLabelFocus(p,n),m[p]={frameElement:r,containerElement:n},g++,setTimeout(function(e){return function(){e.src=l(t.gatewayConfiguration.assetsUrl,t.channel)}}(r),0)}this.bus.on(y.FRAME_READY,function(t){g--,t(0===g)}),this.bus.on(y.INPUT_EVENT,o(m,t.merchantConfiguration.hostedFields.onFieldEvent)),this.destructor.registerFunctionForTeardown(function(){var t,e,n;for(t=0;t<f.injectedNodes.length;t++){for(n=f.injectedNodes[t],e=0;e<n.children.length;e++)n.parent.removeChild(n.children[e]);a(n.parent).remove(h.externalClasses.FOCUSED,h.externalClasses.INVALID,h.externalClasses.VALID)}})}var s=t(50),a=t(48),c=t(53),u=t(130),l=t(176),h=t(179),p=t(127),d=t(47),f=t(180),m=t(178),y=h.events;r.prototype.setupLabelFocus=function(t,e){function n(){r.emit(y.TRIGGER_INPUT_FOCUS,t)}var i,o,r=this.bus;if(m()&&null!=e.id){for(i=p(document.querySelectorAll('label[for="'+e.id+'"]')),i=i.concat(f(e,"label")),o=0;o<i.length;o++)d.addEventListener(i[o],"click",n,!1);this.destructor.registerFunctionForTeardown(function(){for(o=0;o<i.length;o++)d.removeEventListener(i[o],"click",n,!1)})}},r.prototype.teardown=function(t){this.destructor.teardown(t)},e.exports=r},{127:127,130:130,176:176,178:178,179:179,180:180,47:47,48:48,50:50,53:53}],178:[function(t,e,n){"use strict";e.exports=function(){return!/(iPad|iPhone|iPod)/i.test(navigator.userAgent)}},{}],179:[function(t,e,n){"use strict";var i="2.32.1";e.exports={VERSION:i,events:{FRAME_READY:"hosted-fields:FRAME_READY",VALIDATE_STRICT:"hosted-fields:VALIDATE_STRICT",CONFIGURATION:"hosted-fields:CONFIGURATION",TOKENIZATION_REQUEST:"hosted-fields:TOKENIZATION_REQUEST",INPUT_EVENT:"hosted-fields:INPUT_EVENT",TRIGGER_INPUT_FOCUS:"hosted-fields:TRIGGER_INPUT_FOCUS"},externalEvents:{FOCUS:"focus",BLUR:"blur",FIELD_STATE_CHANGE:"fieldStateChange"},defaultMaxLengths:{number:19,postalCode:8,expirationDate:7,expirationMonth:2,expirationYear:4,cvv:3},externalClasses:{FOCUSED:"braintree-hosted-fields-focused",INVALID:"braintree-hosted-fields-invalid",VALID:"braintree-hosted-fields-valid"},defaultIFrameStyle:{border:"none",width:"100%",height:"100%","float":"left"},whitelistedStyles:["-moz-osx-font-smoothing","-moz-transition","-moz-tap-highlight-color","-webkit-font-smoothing","-webkit-transition","-webkit-tap-highlight-color","color","font","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","line-height","opacity","outline","text-shadow","transition"],whitelistedFields:{number:{name:"credit-card-number",label:"Credit Card Number"},cvv:{name:"cvv",label:"CVV"},expirationDate:{name:"expiration",label:"Expiration Date"},expirationMonth:{name:"expiration-month",label:"Expiration Month"},expirationYear:{name:"expiration-year",label:"Expiration Year"},postalCode:{name:"postal-code",label:"Postal Code"}}}},{}],180:[function(t,e,n){"use strict";function i(t,e){for(var n=t.parentNode,i=[];null!=n;)null!=n.tagName&&n.tagName.toLowerCase()===e&&i.push(n),n=n.parentNode;return i}e.exports=i},{}],181:[function(t,e,n){"use strict";e.exports=t(183)},{183:183}],182:[function(t,e,n){(function(n){"use strict";function i(t,e){this.configuration=t,this.offerPaypalCredit=e,this.sourceName=e?v.PAYPAL_CREDIT_INTEGRATION_NAME:v.PAYPAL_INTEGRATION_NAME,this.destructor=new a,this.bus=new c({merchantUrl:n.location.href,channel:this.configuration.channel}),this.container=o.normalizeElement(this.configuration.merchantConfiguration.paypal.container||document.body),this.loggedInView=null,this.loggedOutView=null,this.appView=null,this.merchantPageView=null,this.paymentMethodNonceInputFieldView=null,this.overlayView=null,this.bridgeIframeView=null,E(this,["initAuthFlow","closeAuthFlow"])}var o=t(47),r=t(57),s=t(116),a=t(50),c=t(130),u=t(185),l=t(187),h=t(188),p=t(191),d=t(189),f=t(192),m=t(186),y=t(202),g=t(198),v=t(194),_=t(204),E=t(58);i.prototype.initialize=function(){var t=r(this._handleClickLogin,this);this._createViews(),this.bus.on(c.events.PAYMENT_METHOD_CANCELLED,r(this._handlePaymentMethodCancelled,this)),"dropin"!==this.configuration.integrationType&&this.bus.on(c.events.PAYMENT_METHOD_GENERATED,r(this._handlePaymentMethodGenerated,this)),o.addEventListener(document.body,"click",t),this.destructor.registerFunctionForTeardown(function(){o.removeEventListener(document.body,"click",t)})},i.prototype._createViews=function(){function t(){g.isFirefox()?(i.closeAuthFlow(),i.initAuthFlow()):i.bus.emit(v.events.FOCUS_APP)}var e,n=[],i=this,o="dropin"===this.configuration.integrationType,r=this.offerPaypalCredit;y.isBridgeIframeRequired()&&(this.bridgeIframeView=new m({container:this.container,paypalAssetsUrl:this.configuration.gatewayConfiguration.paypal.assetsUrl,channel:this.configuration.channel,offerPaypalCredit:r}),n.push(this.bridgeIframeView)),this.appView=new u({insertFrameFunction:this.configuration.merchantConfiguration.paypal.insertFrameFunction,paypalAssetsUrl:this.configuration.gatewayConfiguration.paypal.assetsUrl,isHermes:_.isHermesConfiguration(this.configuration),isDropin:o,channel:this.configuration.channel,offerPaypalCredit:r}),n.push(this.appView),o||(this.merchantPageView=new d({channel:this.configuration.channel,offerPaypalCredit:r}),n.push(this.merchantPageView),y.isPopupSupported()&&y.isOverlaySupported()&&(this.overlayView=new p({paypalAssetsUrl:this.configuration.gatewayConfiguration.paypal.assetsUrl,onFocus:t,onClose:function(){i.bus.emit(v.events.CLOSE_APP)},locale:this.configuration.merchantConfiguration.paypal.locale,channel:this.configuration.channel,offerPaypalCredit:r}),n.push(this.overlayView))),o||this.configuration.merchantConfiguration.paypal.headless||(this.paymentMethodNonceInputFieldView=new f({container:this.container,el:this.configuration.merchantConfiguration.paypal.paymentMethodNonceInputField,channel:this.configuration.channel,offerPaypalCredit:r}),n.push(this.paymentMethodNonceInputFieldView),this.loggedInView=new l({paypalAssetsUrl:this.configuration.gatewayConfiguration.paypal.assetsUrl,container:this.container,locale:this.configuration.merchantConfiguration.paypal.locale,channel:this.configuration.channel,offerPaypalCredit:r}),n.push(this.loggedInView),this.loggedOutView=new h({paypalAssetsUrl:this.configuration.gatewayConfiguration.paypal.assetsUrl,container:this.container,enablePayPalButton:_.isOnetimeHermesConfiguration(this.configuration),locale:this.configuration.merchantConfiguration.paypal.locale,channel:this.configuration.channel,offerPaypalCredit:r}),n.push(this.loggedOutView)),this.destructor.registerFunctionForTeardown(function(){for(e=0;e<n.length;e++)n[e].teardown()})},i.prototype._handleClickLogin=function(t){for(var e=t.target||t.srcElement,n=this.offerPaypalCredit;;){if(null==e)return;if(e===t.currentTarget)return;if(this._isButton(e,n))break;e=e.parentNode}_.preventDefault(t),this.initAuthFlow()},i.prototype.initAuthFlow=function(){this.appView.open()},i.prototype.closeAuthFlow=function(){this.appView.close()},i.prototype._isButton=function(t,e){return e?"braintree-paypal-credit-button"===t.id:"braintree-paypal-button"===t.id},i.prototype._handlePaymentMethodGenerated=function(t,e){var n=this.configuration.merchantConfiguration.paypal,i=n.onSuccess,o=this.offerPaypalCredit;e=e||{offerPaypalCredit:!1},t.type===v.NONCE_TYPE&&e.offerPaypalCredit===o&&s(i)&&i(t)},i.prototype._handlePaymentMethodCancelled=function(t){var e=this.configuration.merchantConfiguration.paypal.onCancelled;t.source===this.sourceName&&s(e)&&e()},i.prototype.teardown=function(){var t=this;this.destructor.teardown(function(){t.bus.teardown()})},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{116:116,130:130,185:185,186:186,187:187,188:188,189:189,191:191,192:192,194:194,198:198,202:202,204:204,47:47,50:50,57:57,58:58}],183:[function(t,e,n){"use strict";function i(t,e){var n,i;if(i=t.merchantConfiguration.onUnsupported,"function"!=typeof i&&(i=function(t){try{console.log(t)}catch(e){}}),!t.gatewayConfiguration.paypalEnabled)return i(new Error("PayPal is not enabled")),null;if(!h.detectedPostMessage())return i(new Error("unsupported browser detected")),null;if(!t.merchantConfiguration.paypal.container&&!t.merchantConfiguration.paypal.headless)return i(new Error("Please supply a container for the PayPal button to be appended to")),null;if(!u(t))return i(new Error("unsupported protocol detected")),null;if(c(t))return i(new Error("Unvetted merchant client token does not include a payee email")),null;if(f.isHermesConfiguration(t)&&!s(t.merchantConfiguration.paypal.locale))return i(new Error("This PayPal integration does not support this country")),null;if(f.isOnetimeHermesConfiguration(t)){if(!r(t.merchantConfiguration.paypal.currency))return i(new Error("This PayPal integration does not support this currency")),null;if(!a(t.merchantConfiguration.paypal.amount))return i(new Error("Amount must be a number")),null}return n=new l(t,e),n.initialize(),n}function o(t,e){var n,i=e.length,o=!1;for(n=0;i>n;n++)t.toLowerCase()===e[n].toLowerCase()&&(o=!0);return o}function r(t){return o(t,p.HERMES_SUPPORTED_CURRENCIES)}function s(t){return o(d(t).split("_")[1],p.HERMES_SUPPORTED_COUNTRIES)}function a(t){return t=parseFloat(t),"number"==typeof t&&!isNaN(t)&&t>=0}function c(t){return t.gatewayConfiguration.paypal.unvettedMerchant&&(!f.isHermesConfiguration(t)||!t.gatewayConfiguration.paypal.payeeEmail)}function u(t){return t.gatewayConfiguration.paypal.allowHttp?!0:h.isPopupSupported()?!0:"isMerchantPageHttps"in t?t.isMerchantPageHttps:y.isBrowserHttps()}var l=t(182),h=t(202),p=t(194),d=t(196),f=t(204),m="2.32.1",y=t(47);e.exports={create:i,VERSION:m}},{182:182,194:194,196:196,202:202,204:204,47:47}],184:[function(t,e,n){e.exports={en_us:{cancel:"Cancel",overlay_text:"Don't see the secure PayPal browser? We'll help you re-launch the window to complete your purchase.",continue_link:"Continue"},en_uk:{cancel:"Cancel",overlay_text:"Don't see the secure PayPal browser? We'll help you re-launch the window to complete your purchase.",continue_link:"Continue"},en_au:{cancel:"Cancel",overlay_text:"Don't see the secure PayPal browser? We'll help you re-launch the window to complete your purchase.",continue_link:"Continue"},sv_se:{cancel:"Avbryt",overlay_text:"Ser du inte den säkra PayPal-webbl&auml;saren? Vi hj&auml;lper dig att starta om f&ouml;nstret f&ouml;r att slutf&ouml;ra k&ouml;pet.",continue_link:"Forts&auml;tt"},de_de:{cancel:"Abbrechen",overlay_text:"Sie sehen das sichere Browserfenster von PayPal nicht? Das Fenster wird neu ge&ouml;ffnet, damit Sie Ihren Einkauf abschlie&szlig;en k&ouml;nnen.",continue_link:"Weiter"},fr_fr:{cancel:"Annuler",overlay_text:"Vous ne voyez pas le navigateur s&eacute;curis&eacute; PayPal ? Nous allons vous aider &agrave; relancer la fen&ecirc;tre pour effectuer votre achat.",continue_link:"Continuer"},en_ca:{cancel:"Cancel",overlay_text:"Don't see the secure PayPal browser? We'll help you re-launch the window to complete your purchase.",continue_link:"Continue"},fr_ca:{cancel:"Annuler",overlay_text:"Vous ne voyez pas le navigateur s&eacute;curis&eacute; de PayPal ? Nous vous aiderons &agrave; relancer la fen&ecirc;tre afin d'effectuer votre achat.",continue_link:"Continuer"},es_es:{cancel:"Cancelar",overlay_text:"&iquest;No ves el s&iacute;mbolo de navegaci&oacute;n segura de PayPal? Te ayudaremos a abrir de nuevo la ventana para completar la compra.",continue_link:"Continuar"},es_xc:{cancel:"Cancelar",overlay_text:"&iquest;No ve el s&iacute;mbolo de navegaci&oacute;n segura de PayPal? Abriremos la ventana nuevamente para que pueda completar su compra.",continue_link:"Continuar"},fr_xc:{cancel:"Annuler",overlay_text:"Le navigateur s&eacute;curis&eacute; de PayPal n'appara&icirc;t pas ? Nous allons vous aider &agrave; rouvrir la fen&ecirc;tre pour finaliser votre achat.",continue_link:"Continuer"},nl_nl:{cancel:"Annuleren",overlay_text:"Ziet u de beveiligde PayPal-browser niet? We helpen u het venster opnieuw te openen zodat u uw aankoop kunt voltooien.",continue_link:"Doorgaan"},pt_pt:{cancel:"Cancelar",overlay_text:"N&atilde;o est&aacute; a ver a indica&ccedil;&atilde;o de liga&ccedil;&atilde;o segura PayPal no browser? Vamos ent&atilde;o voltar a abrir a janela para concluir a sua compra.",continue_link:"Continuar"},ru_ru:{cancel:"Отмена",overlay_text:"Не отображается безопасная страница PayPal в браузере? Мы поможем вам повторно загрузить окно, чтобы завершить покупку.",continue_link:"Продолжить"},da_dk:{cancel:"Annuller",overlay_text:"Kan du ikke se PayPals sikre browser? Vi hj&aelig;lper dig med at &aring;bne vinduet igen, s&aring; du kan betale.",continue_link:"Forts&aelig;t"},it_it:{cancel:"Annulla",overlay_text:"Non vedi il browser sicuro di PayPal? Ti aiuteremo a riavviare la pagina per completare l'acquisto.",continue_link:"Continua"},no_no:{cancel:"Avbryt",overlay_text:"Ser du ikke den sikre PayPal-nettleseren? Vi hjelper deg med &aring; &aring;pne vinduet p&aring; nytt s&aring; du kan fullf&oslash;re kj&oslash;pet.",continue_link:"Fortsett"},pl_pl:{cancel:"Anuluj",overlay_text:"Nie widzisz bezpiecznej przeglądarki PayPal? Pomożemy Ci ponownie uruchomić to okno w celu dokonania zakupu.",continue_link:"Kontynuuj"},tr_tr:{cancel:"İptal",overlay_text:"G&uuml;venli PayPal tarayıcısını g&ouml;rm&uuml;yor musunuz? Alışverişinizi tamamlamak i&ccedil;in pencereyi yeniden başlatmanıza yardımcı olacağız.",continue_link:"Devam"},zh_xc:{cancel:"取消",overlay_text:"没有看到安全的PayPal浏览器？我们将帮助您重启窗口以完成购物。",continue_link:"继续"},en_hk:{cancel:"Cancel",overlay_text:"Don't see the secure PayPal browser? We'll help you re-launch the window to complete your purchase.",continue_link:"Continue"},zh_hk:{cancel:"取消",overlay_text:"看不到安全的 PayPal 瀏覽器視窗？我們會助你重新啟動視窗，以完成購物。",continue_link:"繼續"},en_my:{cancel:"Cancel",overlay_text:"Don't see the secure PayPal browser? We'll help you re-launch the window to complete your purchase.",continue_link:"Continue"},en_nz:{cancel:"Cancel",overlay_text:"Don't see the secure PayPal browser? We'll help you re-launch the window to complete your purchase.",continue_link:"Continue"},en_sg:{cancel:"Cancel",overlay_text:"Don't see the secure PayPal browser? We'll help you re-launch the window to complete your purchase.",continue_link:"Continue"}}},{}],185:[function(t,e,n){(function(n){"use strict";function i(t){var e=this;this.options=t||{},this.destructor=new a,this.bus=new c({merchantUrl:n.location.href,channel:this.options.channel}),this.destructor.registerFunctionForTeardown(function(){e.bus.teardown()}),this._initialize()}var o=t(57),r=t(116),s=t(202),a=t(50),c=t(130),u=t(194),l=t(193),h=t(190);i.prototype._initialize=function(){var t=this;this.app=s.isPopupSupported()?new l({src:this._buildUrl(),isHermes:this.options.isHermes,channel:this.options.channel,offerPaypalCredit:this.options.offerPaypalCredit}):new h({src:this._buildUrl(),isDropin:this.options.isDropin,isHermes:this.options.isHermes,insertFrameFunction:this.options.insertFrameFunction,channel:this.options.channel,offerPaypalCredit:this.options.offerPaypalCredit}),this.destructor.registerFunctionForTeardown(function(){t.app.teardown()}),this.bus.on(u.events.CLOSE_APP,o(this.close,this)),this.bus.on(u.events.FOCUS_APP,o(this.focus,this)),this.bus.on(c.events.PAYMENT_METHOD_GENERATED,o(this._handlePaymentMethodGenerated,this)),this.bus.on(c.events.UI_POPUP_FORCE_CLOSE,o(this._handleForceClose,this))},i.prototype._buildUrl=function(){var t=this.options.paypalAssetsUrl,e=this.options.offerPaypalCredit?u.PAYPAL_CREDIT_INTEGRATION_NAME:u.PAYPAL_INTEGRATION_NAME;return t+="/pwpp/",t+=u.VERSION,t+="/html/braintree-frame.html",t+="#"+e+":"+this.options.channel},i.prototype.open=function(){this.focus(),this.app.open(),this.poll()},i.prototype._handleForceClose=function(t){var e=this.options.offerPaypalCredit?u.PAYPAL_CREDIT_INTEGRATION_NAME:u.PAYPAL_INTEGRATION_NAME;t.target===e&&this.close()},i.prototype.close=function(){this.app.close()},i.prototype.focus=function(){r(this.app.focus)&&this.app.focus()},i.prototype.isClosed=function(){return this.app.isClosed()},i.prototype.stopPolling=function(){clearInterval(this.pollId)},i.prototype.poll=function(){var t=this;this.pollId=setInterval(function(){t.isClosed()&&t._handleClosed()},100)},i.prototype._handlePaymentMethodGenerated=function(t,e){var n=Boolean(this.options.offerPaypalCredit)===Boolean(e&&e.offerPaypalCredit);t.type===u.NONCE_TYPE&&n&&this.close()},i.prototype._handleClosed=function(){this.stopPolling(),this.close(),s.isPopupSupported()&&(this.app.el=null)},i.prototype.teardown=function(){this.destructor.teardown()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{116:116,130:130,190:190,193:193,194:194,202:202,50:50,57:57}],186:[function(t,e,n){"use strict";function i(t){this.options=t||{},this.prefix=this.options.offerPaypalCredit?o.PAYPAL_CREDIT_INTEGRATION_NAME:o.PAYPAL_INTEGRATION_NAME,this.el=r({src:this._buildUrl(),name:this.prefix+":"+o.BRIDGE_FRAME_NAME,height:1,width:1,style:{position:"static",top:0,left:0,bottom:0,padding:0,margin:0,border:0,outline:"none",background:"transparent"}}),this.options.container.appendChild(this.el)}var o=t(194),r=t(53);i.prototype._buildUrl=function(){var t=this.options.paypalAssetsUrl;return t+="/pwpp/",t+=o.VERSION,t+="/html/bridge-frame.html",t+="#"+this.prefix+":"+this.options.channel},i.prototype.teardown=function(){this.options.container.removeChild(this.el)},e.exports=i},{194:194,53:53}],187:[function(t,e,n){(function(n){"use strict";function i(t){var e;this.options=t||{},this.wrapper=this.options.container||document.body,this.sourceName=this.options.offerPaypalCredit?l.PAYPAL_CREDIT_INTEGRATION_NAME:l.PAYPAL_INTEGRATION_NAME,this.destructor=new s,this.bus=new a({merchantUrl:n.location.href,channel:t.channel}),e=h(this.options.locale,p),this.translation=e.translation,this._initialize()}var o=t(47),r=t(57),s=t(50),a=t(130),c=t(204),u=t(203),l=t(194),h=t(197),p=t(184);i.prototype._initialize=function(){var t=this,e=r(this._handleClickLogout,this);this._createViewContainer(),this._createPayPalName(),this._createEmailNode(),this._createLogoutNode(),o.addEventListener(this.logoutNode,"click",e),this.destructor.registerFunctionForTeardown(function(){o.removeEventListener(t.logoutNode,"click",e)}),this.bus.on(a.events.PAYMENT_METHOD_GENERATED,r(this._handlePaymentMethodGenerated,this)),this.bus.on(a.events.PAYMENT_METHOD_CANCELLED,r(this._handlePaymentMethodCancelled,this))},i.prototype._createViewContainer=function(){var t=["display: none","max-width: 500px","overflow: hidden","padding: 16px","background-image: url("+this.options.paypalAssetsUrl+"/pwpp/"+l.VERSION+"/images/paypal-small.png)","background-image: url("+this.options.paypalAssetsUrl+"/pwpp/"+l.VERSION+"/images/paypal-small.svg), none","background-position: 20px 50%","background-repeat: no-repeat","background-size: 13px 15px","border-top: 1px solid #d1d4d6","border-bottom: 1px solid #d1d4d6"].join(";");this.container=document.createElement("div"),this.container.id="braintree-paypal-loggedin",this.container.style.cssText=t,this.wrapper.appendChild(this.container)},i.prototype._createPayPalName=function(){var t=["color: #283036","font-size: 13px","font-weight: 800",'font-family: "Helvetica Neue", Helvetica, Arial, sans-serif',"margin-left: 36px","-webkit-font-smoothing: antialiased","-moz-font-smoothing: antialiased","-ms-font-smoothing: antialiased","font-smoothing: antialiased"].join(";");return this.payPalName=document.createElement("span"),this.payPalName.id="bt-pp-name",this.payPalName.innerHTML="PayPal",this.payPalName.style.cssText=t,this.container.appendChild(this.payPalName)},i.prototype._createEmailNode=function(){var t=["color: #6e787f","font-size: 13px",'font-family: "Helvetica Neue", Helvetica, Arial, sans-serif',"margin-left: 5px","-webkit-font-smoothing: antialiased","-moz-font-smoothing: antialiased","-ms-font-smoothing: antialiased","font-smoothing: antialiased"].join(";");this.emailNode=document.createElement("span"),this.emailNode.id="bt-pp-email",this.emailNode.style.cssText=t,this.container.appendChild(this.emailNode)},i.prototype._createLogoutNode=function(){var t=["color: #3d95ce","font-size: 11px",'font-family: "Helvetica Neue", Helvetica, Arial, sans-serif',"line-height: 20px","margin: 0 0 0 25px","padding: 0","background-color: transparent","border: 0","cursor: pointer","text-decoration: underline","float: right","-webkit-font-smoothing: antialiased","-moz-font-smoothing: antialiased","-ms-font-smoothing: antialiased","font-smoothing: antialiased"].join(";");

this.logoutNode=document.createElement("button"),this.logoutNode.id="bt-pp-cancel",this.logoutNode.innerHTML=this.translation.cancel,this.logoutNode.setAttribute("type","button"),this.logoutNode.style.cssText=t,this.container.appendChild(this.logoutNode)},i.prototype.show=function(t){this.container.style.display="block",u.setTextContent(this.emailNode,t)},i.prototype.hide=function(){this.container.style.display="none"},i.prototype._handleClickLogout=function(t){c.preventDefault(t),this.bus.emit(a.events.PAYMENT_METHOD_CANCELLED,{source:this.sourceName})},i.prototype._handlePaymentMethodGenerated=function(t,e){var n,i=Boolean(this.options.offerPaypalCredit)===Boolean(e&&e.offerPaypalCredit);t.type===l.NONCE_TYPE&&i&&(n=t&&t.details&&t.details.email?t.details.email:"",this.show(n))},i.prototype._handlePaymentMethodCancelled=function(t){t.source===this.sourceName&&this.hide()},i.prototype.teardown=function(){this.wrapper.removeChild(this.container),this.destructor.teardown(),this.bus.teardown()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{130:130,184:184,194:194,197:197,203:203,204:204,47:47,50:50,57:57}],188:[function(t,e,n){(function(n){"use strict";function i(t){this.options=t,this.wrapper=this.options.container||document.body,this.sourceName=this.options.offerPaypalCredit?s.PAYPAL_CREDIT_INTEGRATION_NAME:s.PAYPAL_INTEGRATION_NAME,this.bus=new r({merchantUrl:n.location.href,channel:t.channel}),this._initialize()}var o=t(57),r=t(130),s=t(194),a=t(196);i.prototype._initialize=function(){this.createViewContainer(),this.options.enablePayPalButton?this.createCheckoutWithPayPalButton():this.createPayWithPayPalButton(),this.bus.on(r.events.PAYMENT_METHOD_GENERATED,o(this._handlePaymentMethodGenerated,this)),this.bus.on(r.events.PAYMENT_METHOD_CANCELLED,o(this._handlePaymentMethodCancelled,this))},i.prototype.createViewContainer=function(){this.container=document.createElement("div"),this.container.id="braintree-paypal-loggedout",this.wrapper.appendChild(this.container),this.loginNode=this.container},i.prototype.createPayWithPayPalButton=function(){var t=document.createElement("a"),e=new Image,n=["max-width: 100%","display: block","width: 100%","height: 100%","outline: none","border: 0"].join(";"),i=["display: block","width: 115px","height: 44px","overflow: hidden"].join(";");t.id="braintree-paypal-button",t.href="#",t.style.cssText=i,e.src=this.options.paypalAssetsUrl+"/pwpp/"+s.VERSION+"/images/pay-with-paypal.png",e.setAttribute("alt","Pay with PayPal"),e.style.cssText=n,t.appendChild(e),this.container.appendChild(t)},i.prototype.createCheckoutWithPayPalButton=function(){var t,e=document.createElement("script"),n={"data-merchant":"merchant-id","data-button":"checkout","data-type":"button","data-color":"blue","data-lc":a(this.options.locale),"data-id":"braintree-paypal-button"};this.options.offerPaypalCredit&&(n["data-button"]="credit",n["data-id"]="braintree-paypal-credit-button"),e.src="//www.paypalobjects.com/api/button.js",e.async=!0;for(t in n)n.hasOwnProperty(t)&&e.setAttribute(t,n[t]);this.container.appendChild(e)},i.prototype.show=function(){this.container.style.display="block"},i.prototype.hide=function(){this.container.style.display="none"},i.prototype._handlePaymentMethodGenerated=function(t,e){var n=Boolean(this.options.offerPaypalCredit)===Boolean(e&&e.offerPaypalCredit);t.type===s.NONCE_TYPE&&n&&this.hide()},i.prototype._handlePaymentMethodCancelled=function(t){t.source===this.sourceName&&this.show()},i.prototype.teardown=function(){this.wrapper.removeChild(this.container),this.bus.teardown()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{130:130,194:194,196:196,57:57}],189:[function(t,e,n){(function(n){"use strict";function i(t){this.options=t,this.sourceName=this.options.offerPaypalCredit?c.PAYPAL_CREDIT_INTEGRATION_NAME:c.PAYPAL_INTEGRATION_NAME,this.bus=new s({merchantUrl:n.location.href,channel:t.channel}),this.bus.on(s.events.UI_MODAL_DID_OPEN,a(this.lockWindowSize,this)),this.bus.on(s.events.UI_MODAL_DID_CLOSE,a(this.unlockWindowSize,this))}function o(t){var e=window.getComputedStyle?getComputedStyle(t):t.currentStyle;return{overflow:e.overflow||"",height:t.style.height||""}}function r(){return{html:{node:document.documentElement,styles:o(document.documentElement)},body:{node:document.body,styles:o(document.body)}}}var s=t(130),a=t(57),c=t(194);i.prototype.lockWindowSize=function(){this.defaultStyles=r(),document.documentElement.style.height="100%",document.documentElement.style.overflow="hidden",document.body.style.height="100%",document.body.style.overflow="hidden"},i.prototype.unlockWindowSize=function(){this.defaultStyles&&(document.documentElement.style.height=this.defaultStyles.html.styles.height,document.documentElement.style.overflow=this.defaultStyles.html.styles.overflow,document.body.style.height=this.defaultStyles.body.styles.height,document.body.style.overflow=this.defaultStyles.body.styles.overflow,delete this.defaultStyles)},i.prototype._handleUIModalDidOpen=function(t){t.source===this.sourceName&&this.lockWindowSize()},i.prototype._handleUIModalDidClose=function(t){t.source===this.sourceName&&this.unlockWindowSize()},i.prototype.teardown=function(){this.unlockWindowSize(),this.bus.teardown()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{130:130,194:194,57:57}],190:[function(t,e,n){(function(n){"use strict";function i(t){this.options=t||{},this.container=document.body,this.sourceName=this.options.offerPaypalCredit?a.PAYPAL_CREDIT_INTEGRATION_NAME:a.PAYPAL_INTEGRATION_NAME,this.bus=new c({merchantUrl:n.location.href,channel:t.channel}),this.options.isDropin?this._open=this._openHeadless:this._attachBusEvents(),this._initialize()}var o=t(57),r=t(116),s=t(200),a=t(194),c=t(130),u=t(53),l=t(202).isIosUIWebView,h={position:"fixed",top:0,left:0,bottom:0,padding:0,margin:0,border:0,outline:"none",zIndex:20001,background:"#FFFFFF"};i.prototype._attachBusEvents=function(){this.bus.on(a.events.OPEN_MODAL,o(this._handleOpenModal,this))},i.prototype._initialize=function(){var t=this.options.isHermes?a.HERMES_FRAME_NAME:a.FRAME_NAME;s.isIos()?(this.el=document.createElement("div"),this.el.className=a.FRAME_CONTAINER_NAME,l()||(this.el.style.webkitOverflowScrolling="touch"),this.el.appendChild(u({src:this.options.src,name:t,scrolling:"yes",height:"100%",width:"100%",style:{position:"absolute",top:0,left:0,border:0,outline:"none",background:"#FFFFFF"}}))):this.el=u({src:this.options.src,name:t,scrolling:"yes",height:this.options.height||"100%",width:this.options.width||"100%",style:h})},i.prototype.isClosed=function(){return!this.container.contains(this.el)},i.prototype._handleOpenModal=function(t){t.source===this.sourceName&&this.open()},i.prototype._openHeadless=function(){this.bus.emit(a.events.OPEN_MODAL,{source:this.sourceName})},i.prototype._open=function(){r(this.options.insertFrameFunction)?this.options.insertFrameFunction(this.el.src):this.container.appendChild(this.el),this.bus.emit(c.events.UI_MODAL_DID_OPEN,{source:this.sourceName})},i.prototype.open=function(){this.isClosed()&&this._open()},i.prototype.close=function(){this.isClosed()||(this.container.removeChild(this.el),this.bus.emit(c.events.UI_MODAL_DID_CLOSE,{source:this.sourceName}))},i.prototype.teardown=function(){this.close(),this.bus.teardown()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{116:116,130:130,194:194,200:200,202:202,53:53,57:57}],191:[function(t,e,n){(function(n){"use strict";function i(t){var e;this.options=t,this.sourceName=this.options.offerPaypalCredit?u.PAYPAL_CREDIT_INTEGRATION_NAME:u.PAYPAL_INTEGRATION_NAME,this.spriteSrc=this.options.paypalAssetsUrl+"/pwpp/"+u.VERSION+"/images/pp_overlay_sprite.png",this.bus=new c({merchantUrl:n.location.href,channel:t.channel}),this.destructor=new a,e=l(this.options.locale,h),this.translation=e.translation,this._create(),this._setupEvents(),this.bus.on(c.events.UI_POPUP_DID_OPEN,r(this._handleUIPopupDidOpen,this)),this.bus.on(c.events.UI_POPUP_DID_CLOSE,r(this._handleUIPopupDidClose,this))}var o=t(47),r=t(57),s=t(116),a=t(50),c=t(130),u=t(194),l=t(197),h=t(184);i.prototype.open=function(){document.body.contains(this.el)||document.body.appendChild(this.el)},i.prototype.close=function(){document.body.contains(this.el)&&document.body.removeChild(this.el)},i.prototype._handleUIPopupDidClose=function(t){t.source===this.sourceName&&this.close()},i.prototype._handleUIPopupDidOpen=function(t){t.source===this.sourceName&&this.open()},i.prototype._create=function(){this.el=document.createElement("div"),this.el.className="bt-overlay",this._setStyles(this.el,["z-index: 20001","position: fixed","top: 0","left: 0","height: 100%","width: 100%","text-align: center","background: #000","background: rgba(0,0,0,0.7)",'-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=52)"']),this.el.appendChild(this._createCloseIcon()),this.el.appendChild(this._createMessage())},i.prototype._createCloseIcon=function(){return this.closeIcon=document.createElement("div"),this.closeIcon.className="bt-close-overlay",this._setStyles(this.closeIcon,["position: absolute","top: 10px","right: 10px","cursor: pointer","background: url("+this.spriteSrc+") no-repeat 0 -67px","height: 14px","width: 14px"]),this.closeIcon},i.prototype._createMessage=function(){var t=document.createElement("div");return this._setStyles(t,["position: relative","top: 50%","max-width: 350px",'font-family: "HelveticaNeue", "HelveticaNeue-Light", "Helvetica Neue Light", helvetica, arial, sans-serif',"font-size: 14px","line-height: 20px","margin: -70px auto 0"]),t.appendChild(this._createLogo()),t.appendChild(this._createExplanation()),t.appendChild(this._createFocusLink()),t},i.prototype._createExplanation=function(){return this.explanation=document.createElement("div"),this._setStyles(this.explanation,["color: #FFF","margin-bottom: 20px"]),this.explanation.innerHTML=this.translation.overlay_text,this.explanation},i.prototype._createLogo=function(){var t=document.createElement("div");return this._setStyles(t,["background: url("+this.spriteSrc+") no-repeat 0 0","width: 94px","height: 25px","margin: 0 auto 26px auto"]),t},i.prototype._createFocusLink=function(){return this.focusLink=document.createElement("a"),this._setStyles(this.focusLink,["color: #009be1","cursor: pointer"]),this.focusLink.innerHTML=this.translation.continue_link,this.focusLink},i.prototype._setStyles=function(t,e){var n=e.join(";");t.style.cssText=n},i.prototype._setupEvents=function(){var t=this,e=r(this._handleClose,this),n=r(this._handleFocus,this);o.addEventListener(this.closeIcon,"click",e),o.addEventListener(this.focusLink,"click",n),this.destructor.registerFunctionForTeardown(function(){o.removeEventListener(t.closeIcon,"click",e),o.removeEventListener(t.focusLink,"click",n)})},i.prototype._handleClose=function(t){t.preventDefault(),this.close(),s(this.options.onClose)&&this.options.onClose()},i.prototype._handleFocus=function(t){t.preventDefault(),s(this.options.onFocus)&&this.options.onFocus()},i.prototype.teardown=function(){this.bus.teardown(),this.destructor.teardown(),this.close()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{116:116,130:130,184:184,194:194,197:197,47:47,50:50,57:57}],192:[function(t,e,n){(function(n){"use strict";function i(t){this.options=t||{},this.container=this.options.container||document.body,this.el=this.options.el,this.sourceName=this.options.offerPaypalCredit?u.PAYPAL_CREDIT_INTEGRATION_NAME:u.PAYPAL_INTEGRATION_NAME,this.destructor=new a,this.bus=new c({merchantUrl:n.location.href,channel:t.channel}),this._initialize()}var o=t(47),r=t(57),s=t(116),a=t(50),c=t(130),u=t(194);i.prototype._initialize=function(){var t=this;s(this.el)||(null!=this.el?(this.el=o.normalizeElement(this.el),this.destructor.registerFunctionForTeardown(function(){t.clear()})):this.el=this.create()),this.bus.on(c.events.PAYMENT_METHOD_GENERATED,r(this._handlePaymentMethodGenerated,this)),this.bus.on(c.events.PAYMENT_METHOD_CANCELLED,r(this._handlePaymentMethodCancelled,this))},i.prototype.create=function(){var t=this,e=document.createElement("input");return e.name="payment_method_nonce",e.type="hidden",this.container.appendChild(e),this.destructor.registerFunctionForTeardown(function(){t.container.removeChild(e)}),e},i.prototype.value=function(t){s(this.el)?this.el(t):this.el.value=t},i.prototype.clear=function(){this.value("")},i.prototype._handlePaymentMethodCancelled=function(t){t.source===this.sourceName&&this.clear()},i.prototype._handlePaymentMethodGenerated=function(t,e){var n=Boolean(this.options.offerPaypalCredit)===Boolean(e&&e.offerPaypalCredit);t.type===u.NONCE_TYPE&&n&&this.value(t.nonce)},i.prototype.teardown=function(){this.destructor.teardown(),this.bus.teardown()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{116:116,130:130,194:194,47:47,50:50,57:57}],193:[function(t,e,n){(function(n){"use strict";function i(t){this.options=t,this.sourceName=this.options.offerPaypalCredit?o.PAYPAL_CREDIT_INTEGRATION_NAME:o.PAYPAL_INTEGRATION_NAME,this.bus=new r({merchantUrl:n.location.href,channel:this.options.channel}),t.isHermes?(this.name=o.HERMES_POPUP_NAME,this.popupHeight=o.HERMES_POPUP_HEIGHT,this.popupWidth=o.HERMES_POPUP_WIDTH):(this.name=o.POPUP_NAME,this.popupHeight=o.POPUP_HEIGHT,this.popupWidth=o.POPUP_WIDTH)}var o=t(194),r=t(130),s=t(198);i.prototype._getPopupOptions=function(){return["height="+this.popupHeight,"width="+this.popupWidth,"top="+this._getTopPosition(),"left="+this._getLeftPosition(),o.POPUP_OPTIONS].join(",")},i.prototype._centerPosition=function(t,e,n){return(t-e)/2+n},i.prototype._getTopPosition=function(){var t=window.outerHeight||document.documentElement.clientHeight,e="undefined"==typeof window.screenY?window.screenTop:window.screenY;return this._centerPosition(t,this.popupHeight,e)},i.prototype._getLeftPosition=function(){var t=window.outerWidth||document.documentElement.clientWidth,e="undefined"==typeof window.screenX?window.screenLeft:window.screenX;return this._centerPosition(t,this.popupWidth,e)},i.prototype.isClosed=function(){return this.el?this.el.closed:void 0},i.prototype.open=function(){(!this.el||this.isClosed())&&(this.el=window.open(this.options.src,this.name,this._getPopupOptions()),this.focus(),this.bus.emit(r.events.UI_POPUP_DID_OPEN,{source:this.sourceName}))},i.prototype.close=function(){this.el&&((s.isIE8()&&!this.isClosed()||!s.isIE8())&&this.el.close(),this.bus.emit(r.events.UI_POPUP_DID_CLOSE,{source:this.sourceName}))},i.prototype.focus=function(){this.el&&this.el.focus()},i.prototype.teardown=function(){this.close(),this.bus.teardown()},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{130:130,194:194,198:198}],194:[function(t,e,n){"use strict";var i,o="2.32.1",r=["GET_CLIENT_TOKEN","GET_CLIENT_OPTIONS","OPEN_MODAL","CLOSE_APP","FOCUS_APP"],s={LEGACY_ONETIME:"Legacy Onetime",HERMES_ONETIME:"Hermes Onetime",LEGACY_FUTURE_PAYMENTS:"Legacy Future Payments",HERMES_BILLING_AGREEMENTS:"Hermes Billing Agreements"};for(n.VERSION=o,n.POPUP_NAME="braintree_paypal_popup",n.HERMES_POPUP_NAME="PPFrameRedirect",n.FRAME_NAME="braintree-paypal-frame",n.HERMES_FRAME_NAME="PPFrameRedirect",n.FRAME_CONTAINER_NAME="braintree-paypal-frame-container",n.POPUP_PATH="/pwpp/"+o+"/html/braintree-frame.html",n.POPUP_OPTIONS="resizable,scrollbars",n.POPUP_HEIGHT=470,n.POPUP_WIDTH=410,n.HERMES_POPUP_HEIGHT=535,n.HERMES_POPUP_WIDTH=450,n.BRIDGE_FRAME_NAME="bt-proxy-frame",n.HERMES_SUPPORTED_CURRENCIES=["AUD","BRL","CAD","CHF","CZK","DKK","EUR","GBP","HKD","HUF","ILS","INR","JPY","MXN","MYR","NOK","NZD","PHP","PLN","RUB","SEK","SGD","THB","TRY","TWD","USD"],n.HERMES_SUPPORTED_COUNTRIES=["AT","AU","BE","BR","CA","CH","CN","DE","DK","EG","ES","FR","GB","HK","ID","IL","IN","IT","JP","KR","NL","NO","PL","PT","RU","SE","TR","TH","TW","US","XC"],n.NONCE_TYPE="PayPalAccount",n.PAYPAL_INTEGRATION_NAME="PayPal",n.PAYPAL_CREDIT_INTEGRATION_NAME="PayPalCredit",n.ILLEGAL_XHR_ERROR="Illegal XHR request attempted",n.CONFIGURATION_TYPES=s,n.events={},i=0;i<r.length;i++)n.events[r[i]]="paypal:"+r[i]},{}],195:[function(t,e,n){"use strict";e.exports={us:"en_us",gb:"en_uk",uk:"en_uk",de:"de_de",fr:"fr_fr",it:"it_it",es:"es_es",ca:"en_ca",au:"en_au",at:"de_de",be:"en_us",ch:"de_de",dk:"da_dk",nl:"nl_nl",no:"no_no",pl:"pl_pl",se:"sv_se",tr:"tr_tr",bg:"en_us",cy:"en_us",hr:"en_us",is:"en_us",kh:"en_us",mt:"en_us",my:"en_us",ru:"ru_ru"}},{}],196:[function(t,e,n){"use strict";function i(t){return-1!==t.indexOf("_")&&5===t.length}function o(t){var e,n;for(e in s)s.hasOwnProperty(e)&&(e===t?n=s[e]:s[e]===t&&(n=s[e]));return n}function r(t){var e,n;return t=t?t.toLowerCase():"us",t=t.replace(/-/g,"_"),e=i(t)?t:o(t),e?(n=e.split("_"),[n[0],n[1].toUpperCase()].join("_")):"en_US"}var s=t(195);e.exports=r},{195:195}],197:[function(t,e,n){"use strict";function i(t){var e=t?t.toLowerCase().replace(/-/g,"_"):"us";return-1!==e.indexOf("_")&&(e=e.split("_")[1]),e=s.hasOwnProperty(e)?e:"us","uk"===e&&(e="gb"),e}function o(t,e){return t=t.toLowerCase(),e.hasOwnProperty(t)?e[t]:e.en_us}function r(t,e){var n=i(t),r=a(t),s=o(r,e);return{country:n,locale:r,translation:s}}var s=t(195),a=t(196);e.exports=r},{195:195,196:196}],198:[function(t,e,n){"use strict";function i(){return f.matchUserAgent("Android")&&!o()}function o(){return f.matchUserAgent("Chrome")||f.matchUserAgent("CriOS")}function r(){return f.matchUserAgent("Firefox")}function s(){return f.matchUserAgent("Trident")||f.matchUserAgent("MSIE")}function a(){return f.matchUserAgent(/MSIE 8\.0/)}function c(){return f.matchUserAgent("Opera")||f.matchUserAgent("OPR")}function u(){return c()&&"[object OperaMini]"===Object.prototype.toString.call(window.operamini)}function l(){return f.matchUserAgent("Safari")&&!o()&&!i()&&!d()}function h(){return m.isIos()&&!o()&&!l()}function p(){var t=/Version\/[\w\.]+ Chrome\/[\w\.]+ Mobile/;return m.isAndroid()&&f.matchUserAgent(t)}function d(){return f.matchUserAgent(/\bGSA\b/)}var f=t(201),m=t(200);e.exports={isAndroid:i,isChrome:o,isFirefox:r,isIE:s,isIE8:a,isOpera:c,isOperaMini:u,isSafari:l,isIosWebView:h,isAndroidWebView:p,isGoogleSearchApp:d}},{200:200,201:201}],199:[function(t,e,n){"use strict";function i(){return!o()&&(a.isAndroid()||a.isIpod()||a.isIphone()||s.matchUserAgent("IEMobile"))}function o(){return a.isIpad()||a.isAndroid()&&!s.matchUserAgent("Mobile")}function r(){return!i()&&!o()}var s=t(201),a=t(200);e.exports={isMobile:i,isTablet:o,isDesktop:r}},{200:200,201:201}],200:[function(t,e,n){"use strict";function i(){return u.matchUserAgent("Android")}function o(){return u.matchUserAgent("iPad")}function r(){return u.matchUserAgent("iPod")}function s(){return u.matchUserAgent("iPhone")&&!r()}function a(){return o()||r()||s()}function c(){var t,e=u.getNativeUserAgent().match(/OS (\d+)/);return e&&e[1]?(t=parseInt(e[1],10),u.matchUserAgent("(iPhone|iPod|iPad)")&&t>=9):!1}var u=t(201);e.exports={isAndroid:i,isIpad:o,isIpod:r,isIphone:s,isIos:a,isIos9OrHigher:c}},{201:201}],201:[function(t,e,n){"use strict";function i(){return r}function o(t){var e=n.getNativeUserAgent(),i=e.match(t);return i?!0:!1}var r=window.navigator.userAgent;n.getNativeUserAgent=i,n.matchUserAgent=o},{}],202:[function(t,e,n){"use strict";function i(){return o()&&window.outerWidth<600}function o(){return y.test(m)}function r(){return Boolean(window.postMessage)}function s(){if(h.isOperaMini())return!1;if(d.isIos9OrHigher()&&h.isChrome())return!0;if(p.isDesktop())return!0;if(p.isMobile()||p.isTablet()){if(h.isIE())return!1;if(d.isAndroid())return h.isAndroidWebView()?!1:!0;if(d.isIos())return h.isChrome()?!1:h.isSafari()&&f.matchUserAgent(/OS (?:8_1|8_0|8)(?!_\d)/i)?!1:h.isIosWebView()?!1:!0}return!1}function a(){if(h.isIE8())return!1;try{return window.self===window.top}catch(t){return!1}}function c(){return h.isIE()}function u(){var t=null,e="";try{new ActiveXObject("")}catch(n){e=n.name}try{t=Boolean(new ActiveXObject("htmlfile"))}catch(n){t=!1}return t="ReferenceError"!==e&&t===!1?!1:!0,!t}function l(){return h.isIosWebView()&&!window.indexedDB}var h=t(198),p=t(199),d=t(200),f=t(201),m=window.navigator.userAgent,y=/[Mm]obi|tablet|iOS|Android|IEMobile|Windows\sPhone/;e.exports={isMobile:i,isMobileDevice:o,detectedPostMessage:r,isPopupSupported:s,isOverlaySupported:a,isBridgeIframeRequired:c,isMetroBrowser:u,isIosUIWebView:l}},{198:198,199:199,200:200,201:201}],203:[function(t,e,n){"use strict";function i(t,e){var n="innerText";document&&document.body&&"textContent"in document.body&&(n="textContent"),t[n]=e}e.exports={setTextContent:i}},{}],204:[function(t,e,n){"use strict";function i(){var t,e,n="";for(t=0;32>t;t++)e=Math.floor(16*Math.random()),n+=e.toString(16);return n}function o(t){return/^(true|1)$/i.test(t)}function r(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&apos;")}function s(t){var e,n,i,o,r,s,a,c,u=t.indexOf("?"),l={};if(u>=0&&(t=t.substr(u+1)),0===t.length)return null;for(e=t.split("&"),n=0,i=e.length;i>n;n++)o=e[n],r=o.indexOf("="),s=o.substr(0,r),c=o.substr(r+1),a=decodeURIComponent(c),a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),"false"===a&&(a=!1),(null==a||"true"===a)&&(a=!0),l[s]=a;return l}function a(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function c(t){var e;return e=Boolean(t.merchantConfiguration.paypal.amount)&&Boolean(t.merchantConfiguration.paypal.currency)?d.CONFIGURATION_TYPES.HERMES_ONETIME:d.CONFIGURATION_TYPES.LEGACY_ONETIME}function u(t){var e;return e=t.gatewayConfiguration.paypal.billingAgreementsEnabled?d.CONFIGURATION_TYPES.HERMES_BILLING_AGREEMENTS:d.CONFIGURATION_TYPES.LEGACY_FUTURE_PAYMENTS}function l(t){var e;return e=t.merchantConfiguration.paypal.singleUse?c(t):u(t)}function h(t){var e=l(t);return e===d.CONFIGURATION_TYPES.HERMES_ONETIME||e===d.CONFIGURATION_TYPES.HERMES_BILLING_AGREEMENTS}function p(t){var e=l(t);return e===d.CONFIGURATION_TYPES.HERMES_ONETIME}var d=t(194),f="function"==typeof String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^\s+|\s+$/,"")},m="function"==typeof window.btoa?function(t){return window.btoa(t)}:function(t){for(var e,n,i,o,r,s,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;l<t.length;)e=t.charCodeAt(l++),n=t.charCodeAt(l++),i=t.charCodeAt(l++),o=e>>2,r=(3&e)<<4|n>>4,s=(15&n)<<2|i>>6,a=63&i,isNaN(n)?s=a=64:isNaN(i)&&(a=64),u=u+c.charAt(o)+c.charAt(r)+c.charAt(s)+c.charAt(a);return u};e.exports={trim:f,btoa:m,generateUid:i,castToBoolean:o,htmlEscape:r,parseUrlParams:s,preventDefault:a,isHermesConfiguration:h,isOnetimeHermesConfiguration:p,getConfigurationType:l}},{194:194}]},{},[147])(147)});
/**
 * Assign SXA jquery to $ namespace, to allow the usage of $ in CXA code base
 */
if (!window.$ && window.$xa) {
  window.$ = window.$xa;
}

/*!
 * jsUri
 * https://github.com/derek-watson/jsUri
 *
 * Copyright 2013, Derek Watson
 * Released under the MIT license.
 *
 * Includes parseUri regular expressions
 * http://blog.stevenlevithan.com/archives/parseuri
 * Copyright 2007, Steven Levithan
 * Released under the MIT license.
 */

 /*globals define, module */

 (function(global) {

    var re = {
      starts_with_slashes: /^\/+/,
      ends_with_slashes: /\/+$/,
      pluses: /\+/g,
      query_separator: /[&;]/,
      uri_parser: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?(\[[0-9a-fA-F:.]+\]|[^:\/?#]*)(?::(\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
    };
  
    /**
     * Define forEach for older js environments
     * @see https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach#Compatibility
     */
    if (!Array.prototype.forEach) {
      Array.prototype.forEach = function(callback, thisArg) {
        var T, k;
  
        if (this == null) {
          throw new TypeError(' this is null or not defined');
        }
  
        var O = Object(this);
        var len = O.length >>> 0;
  
        if (typeof callback !== "function") {
          throw new TypeError(callback + ' is not a function');
        }
  
        if (arguments.length > 1) {
          T = thisArg;
        }
  
        k = 0;
  
        while (k < len) {
          var kValue;
          if (k in O) {
            kValue = O[k];
            callback.call(T, kValue, k, O);
          }
          k++;
        }
      };
    }
  
    /**
     * unescape a query param value
     * @param  {string} s encoded value
     * @return {string}   decoded value
     */
    function decode(s) {
      if (s) {
          s = s.toString().replace(re.pluses, '%20');
          s = decodeURIComponent(s);
      }
      return s;
    }
  
    /**
     * Breaks a uri string down into its individual parts
     * @param  {string} str uri
     * @return {object}     parts
     */
    function parseUri(str) {
      var parser = re.uri_parser;
      var parserKeys = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "isColonUri", "relative", "path", "directory", "file", "query", "anchor"];
      var m = parser.exec(str || '');
      var parts = {};
  
      parserKeys.forEach(function(key, i) {
        parts[key] = m[i] || '';
      });
  
      return parts;
    }
  
    /**
     * Breaks a query string down into an array of key/value pairs
     * @param  {string} str query
     * @return {array}      array of arrays (key/value pairs)
     */
    function parseQuery(str) {
      var i, ps, p, n, k, v, l;
      var pairs = [];
  
      if (typeof(str) === 'undefined' || str === null || str === '') {
        return pairs;
      }
  
      if (str.indexOf('?') === 0) {
        str = str.substring(1);
      }
  
      ps = str.toString().split(re.query_separator);
  
      for (i = 0, l = ps.length; i < l; i++) {
        p = ps[i];
        n = p.indexOf('=');
  
        if (n !== 0) {
          k = decode(p.substring(0, n));
          v = decode(p.substring(n + 1));
          pairs.push(n === -1 ? [p, null] : [k, v]);
        }
  
      }
      return pairs;
    }
  
    /**
     * Creates a new Uri object
     * @constructor
     * @param {string} str
     */
    function Uri(str) {
      this.uriParts = parseUri(str);
      this.queryPairs = parseQuery(this.uriParts.query);
      this.hasAuthorityPrefixUserPref = null;
    }
  
    /**
     * Define getter/setter methods
     */
    ['protocol', 'userInfo', 'host', 'port', 'path', 'anchor'].forEach(function(key) {
      Uri.prototype[key] = function(val) {
        if (typeof val !== 'undefined') {
          this.uriParts[key] = val;
        }
        return this.uriParts[key];
      };
    });
  
    /**
     * if there is no protocol, the leading // can be enabled or disabled
     * @param  {Boolean}  val
     * @return {Boolean}
     */
    Uri.prototype.hasAuthorityPrefix = function(val) {
      if (typeof val !== 'undefined') {
        this.hasAuthorityPrefixUserPref = val;
      }
  
      if (this.hasAuthorityPrefixUserPref === null) {
        return (this.uriParts.source.indexOf('//') !== -1);
      } else {
        return this.hasAuthorityPrefixUserPref;
      }
    };
  
    Uri.prototype.isColonUri = function (val) {
      if (typeof val !== 'undefined') {
        this.uriParts.isColonUri = !!val;
      } else {
        return !!this.uriParts.isColonUri;
      }
    };
  
    /**
     * Serializes the internal state of the query pairs
     * @param  {string} [val]   set a new query string
     * @return {string}         query string
     */
    Uri.prototype.query = function(val) {
      var s = '', i, param, l;
  
      if (typeof val !== 'undefined') {
        this.queryPairs = parseQuery(val);
      }
  
      for (i = 0, l = this.queryPairs.length; i < l; i++) {
        param = this.queryPairs[i];
        if (s.length > 0) {
          s += '&';
        }
        if (param[1] === null) {
          s += param[0];
        } else {
          s += param[0];
          s += '=';
          if (typeof param[1] !== 'undefined') {
            s += encodeURIComponent(param[1]);
          }
        }
      }
      return s.length > 0 ? '?' + s : s;
    };
  
    /**
     * returns the first query param value found for the key
     * @param  {string} key query key
     * @return {string}     first value found for key
     */
    Uri.prototype.getQueryParamValue = function (key) {
      var param, i, l;
      for (i = 0, l = this.queryPairs.length; i < l; i++) {
        param = this.queryPairs[i];
        if (key === param[0]) {
          return param[1];
        }
      }
    };
  
    /**
     * returns an array of query param values for the key
     * @param  {string} key query key
     * @return {array}      array of values
     */
    Uri.prototype.getQueryParamValues = function (key) {
      var arr = [], i, param, l;
      for (i = 0, l = this.queryPairs.length; i < l; i++) {
        param = this.queryPairs[i];
        if (key === param[0]) {
          arr.push(param[1]);
        }
      }
      return arr;
    };
  
    /**
     * removes query parameters
     * @param  {string} key     remove values for key
     * @param  {val}    [val]   remove a specific value, otherwise removes all
     * @return {Uri}            returns self for fluent chaining
     */
    Uri.prototype.deleteQueryParam = function (key, val) {
      var arr = [], i, param, keyMatchesFilter, valMatchesFilter, l;
  
      for (i = 0, l = this.queryPairs.length; i < l; i++) {
  
        param = this.queryPairs[i];
        keyMatchesFilter = decode(param[0]) === decode(key);
        valMatchesFilter = param[1] === val;
  
        if ((arguments.length === 1 && !keyMatchesFilter) || (arguments.length === 2 && (!keyMatchesFilter || !valMatchesFilter))) {
          arr.push(param);
        }
      }
  
      this.queryPairs = arr;
  
      return this;
    };
  
    /**
     * adds a query parameter
     * @param  {string}  key        add values for key
     * @param  {string}  val        value to add
     * @param  {integer} [index]    specific index to add the value at
     * @return {Uri}                returns self for fluent chaining
     */
    Uri.prototype.addQueryParam = function (key, val, index) {
      if (arguments.length === 3 && index !== -1) {
        index = Math.min(index, this.queryPairs.length);
        this.queryPairs.splice(index, 0, [key, val]);
      } else if (arguments.length > 0) {
        this.queryPairs.push([key, val]);
      }
      return this;
    };
  
    /**
     * test for the existence of a query parameter
     * @param  {string}  key        check values for key
     * @return {Boolean}            true if key exists, otherwise false
     */
    Uri.prototype.hasQueryParam = function (key) {
      var i, len = this.queryPairs.length;
      for (i = 0; i < len; i++) {
        if (this.queryPairs[i][0] == key)
          return true;
      }
      return false;
    };
  
    /**
     * replaces query param values
     * @param  {string} key         key to replace value for
     * @param  {string} newVal      new value
     * @param  {string} [oldVal]    replace only one specific value (otherwise replaces all)
     * @return {Uri}                returns self for fluent chaining
     */
    Uri.prototype.replaceQueryParam = function (key, newVal, oldVal) {
      var index = -1, len = this.queryPairs.length, i, param;
  
      if (arguments.length === 3) {
        for (i = 0; i < len; i++) {
          param = this.queryPairs[i];
          if (decode(param[0]) === decode(key) && decodeURIComponent(param[1]) === decode(oldVal)) {
            index = i;
            break;
          }
        }
        if (index >= 0) {
          this.deleteQueryParam(key, decode(oldVal)).addQueryParam(key, newVal, index);
        }
      } else {
        for (i = 0; i < len; i++) {
          param = this.queryPairs[i];
          if (decode(param[0]) === decode(key)) {
            index = i;
            break;
          }
        }
        this.deleteQueryParam(key);
        this.addQueryParam(key, newVal, index);
      }
      return this;
    };
  
    /**
     * Define fluent setter methods (setProtocol, setHasAuthorityPrefix, etc)
     */
    ['protocol', 'hasAuthorityPrefix', 'isColonUri', 'userInfo', 'host', 'port', 'path', 'query', 'anchor'].forEach(function(key) {
      var method = 'set' + key.charAt(0).toUpperCase() + key.slice(1);
      Uri.prototype[method] = function(val) {
        this[key](val);
        return this;
      };
    });
  
    /**
     * Scheme name, colon and doubleslash, as required
     * @return {string} http:// or possibly just //
     */
    Uri.prototype.scheme = function() {
      var s = '';
  
      if (this.protocol()) {
        s += this.protocol();
        if (this.protocol().indexOf(':') !== this.protocol().length - 1) {
          s += ':';
        }
        s += '//';
      } else {
        if (this.hasAuthorityPrefix() && this.host()) {
          s += '//';
        }
      }
  
      return s;
    };
  
    /**
     * Same as Mozilla nsIURI.prePath
     * @return {string} scheme://user:password@host:port
     * @see  https://developer.mozilla.org/en/nsIURI
     */
    Uri.prototype.origin = function() {
      var s = this.scheme();
  
      if (this.userInfo() && this.host()) {
        s += this.userInfo();
        if (this.userInfo().indexOf('@') !== this.userInfo().length - 1) {
          s += '@';
        }
      }
  
      if (this.host()) {
        s += this.host();
        if (this.port() || (this.path() && this.path().substr(0, 1).match(/[0-9]/))) {
          s += ':' + this.port();
        }
      }
  
      return s;
    };
  
    /**
     * Adds a trailing slash to the path
     */
    Uri.prototype.addTrailingSlash = function() {
      var path = this.path() || '';
  
      if (path.substr(-1) !== '/') {
        this.path(path + '/');
      }
  
      return this;
    };
  
    /**
     * Serializes the internal state of the Uri object
     * @return {string}
     */
    Uri.prototype.toString = function() {
      var path, s = this.origin();
  
      if (this.isColonUri()) {
        if (this.path()) {
          s += ':'+this.path();
        }
      } else if (this.path()) {
        path = this.path();
        if (!(re.ends_with_slashes.test(s) || re.starts_with_slashes.test(path))) {
          s += '/';
        } else {
          if (s) {
            s.replace(re.ends_with_slashes, '/');
          }
          path = path.replace(re.starts_with_slashes, '/');
        }
        s += path;
      } else {
        if (this.host() && (this.query().toString() || this.anchor())) {
          s += '/';
        }
      }
      if (this.query().toString()) {
        s += this.query().toString();
      }
  
      if (this.anchor()) {
        if (this.anchor().indexOf('#') !== 0) {
          s += '#';
        }
        s += this.anchor();
      }
  
      return s;
    };
  
    /**
     * Clone a Uri object
     * @return {Uri} duplicate copy of the Uri
     */
    Uri.prototype.clone = function() {
      return new Uri(this.toString());
    };
  
    /**
     * export via AMD or CommonJS, otherwise leak a global
     */
    if (typeof define === 'function' && define.amd) {
      define(function() {
        return Uri;
      });
    } else if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {
      module.exports = Uri;
    } else {
      global.Uri = Uri;
    }
  }(this));
/*!
 * Knockout JavaScript library v3.4.2
 * (c) The Knockout.js team - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */

(function() {(function(n){var x=this||(0,eval)("this"),t=x.document,M=x.navigator,u=x.jQuery,H=x.JSON;(function(n){"function"===typeof define&&define.amd?define(["exports","require"],n):"object"===typeof exports&&"object"===typeof module?n(module.exports||exports):n(x.ko={})})(function(N,O){function J(a,c){return null===a||typeof a in R?a===c:!1}function S(b,c){var d;return function(){d||(d=a.a.setTimeout(function(){d=n;b()},c))}}function T(b,c){var d;return function(){clearTimeout(d);d=a.a.setTimeout(b,c)}}function U(a,
c){c&&c!==E?"beforeChange"===c?this.Ob(a):this.Ja(a,c):this.Pb(a)}function V(a,c){null!==c&&c.k&&c.k()}function W(a,c){var d=this.Mc,e=d[s];e.T||(this.ob&&this.Oa[c]?(d.Sb(c,a,this.Oa[c]),this.Oa[c]=null,--this.ob):e.s[c]||d.Sb(c,a,e.t?{$:a}:d.yc(a)),a.Ha&&a.Hc())}function K(b,c,d,e){a.d[b]={init:function(b,g,h,l,m){var k,r;a.m(function(){var q=g(),p=a.a.c(q),p=!d!==!p,A=!r;if(A||c||p!==k)A&&a.xa.Ca()&&(r=a.a.wa(a.f.childNodes(b),!0)),p?(A||a.f.fa(b,a.a.wa(r)),a.hb(e?e(m,q):m,b)):a.f.za(b),k=p},null,
{i:b});return{controlsDescendantBindings:!0}}};a.h.va[b]=!1;a.f.aa[b]=!0}var a="undefined"!==typeof N?N:{};a.b=function(b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++)e=e[d[f]];e[d[d.length-1]]=c};a.H=function(a,c,d){a[c]=d};a.version="3.4.2";a.b("version",a.version);a.options={deferUpdates:!1,useOnlyNativeEvents:!1};a.a=function(){function b(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])}function c(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function d(a,b){a.__proto__=
b;return a}function e(b,c,d,e){var m=b[c].match(r)||[];a.a.r(d.match(r),function(b){a.a.ra(m,b,e)});b[c]=m.join(" ")}var f={__proto__:[]}instanceof Array,g="function"===typeof Symbol,h={},l={};h[M&&/Firefox\/2/i.test(M.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];h.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");b(h,function(a,b){if(b.length)for(var c=0,d=b.length;c<d;c++)l[b[c]]=a});var m={propertychange:!0},k=
t&&function(){for(var a=3,b=t.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",c[0];);return 4<a?a:n}(),r=/\S+/g;return{gc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],r:function(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)},o:function(a,b){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(a,b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},Vb:function(a,b,c){for(var d=
0,e=a.length;d<e;d++)if(b.call(c,a[d],d))return a[d];return null},Na:function(b,c){var d=a.a.o(b,c);0<d?b.splice(d,1):0===d&&b.shift()},Wb:function(b){b=b||[];for(var c=[],d=0,e=b.length;d<e;d++)0>a.a.o(c,b[d])&&c.push(b[d]);return c},ib:function(a,b){a=a||[];for(var c=[],d=0,e=a.length;d<e;d++)c.push(b(a[d],d));return c},Ma:function(a,b){a=a||[];for(var c=[],d=0,e=a.length;d<e;d++)b(a[d],d)&&c.push(a[d]);return c},ta:function(a,b){if(b instanceof Array)a.push.apply(a,b);else for(var c=0,d=b.length;c<
d;c++)a.push(b[c]);return a},ra:function(b,c,d){var e=a.a.o(a.a.Bb(b),c);0>e?d&&b.push(c):d||b.splice(e,1)},la:f,extend:c,$a:d,ab:f?d:c,D:b,Ea:function(a,b){if(!a)return a;var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=b(a[d],d,a));return c},rb:function(b){for(;b.firstChild;)a.removeNode(b.firstChild)},nc:function(b){b=a.a.W(b);for(var c=(b[0]&&b[0].ownerDocument||t).createElement("div"),d=0,e=b.length;d<e;d++)c.appendChild(a.ba(b[d]));return c},wa:function(b,c){for(var d=0,e=b.length,m=[];d<e;d++){var k=
b[d].cloneNode(!0);m.push(c?a.ba(k):k)}return m},fa:function(b,c){a.a.rb(b);if(c)for(var d=0,e=c.length;d<e;d++)b.appendChild(c[d])},uc:function(b,c){var d=b.nodeType?[b]:b;if(0<d.length){for(var e=d[0],m=e.parentNode,k=0,f=c.length;k<f;k++)m.insertBefore(c[k],e);k=0;for(f=d.length;k<f;k++)a.removeNode(d[k])}},Ba:function(a,b){if(a.length){for(b=8===b.nodeType&&b.parentNode||b;a.length&&a[0].parentNode!==b;)a.splice(0,1);for(;1<a.length&&a[a.length-1].parentNode!==b;)a.length--;if(1<a.length){var c=
a[0],d=a[a.length-1];for(a.length=0;c!==d;)a.push(c),c=c.nextSibling;a.push(d)}}return a},wc:function(a,b){7>k?a.setAttribute("selected",b):a.selected=b},cb:function(a){return null===a||a===n?"":a.trim?a.trim():a.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},sd:function(a,b){a=a||"";return b.length>a.length?!1:a.substring(0,b.length)===b},Rc:function(a,b){if(a===b)return!0;if(11===a.nodeType)return!1;if(b.contains)return b.contains(3===a.nodeType?a.parentNode:a);if(b.compareDocumentPosition)return 16==
(b.compareDocumentPosition(a)&16);for(;a&&a!=b;)a=a.parentNode;return!!a},qb:function(b){return a.a.Rc(b,b.ownerDocument.documentElement)},Tb:function(b){return!!a.a.Vb(b,a.a.qb)},A:function(a){return a&&a.tagName&&a.tagName.toLowerCase()},Zb:function(b){return a.onError?function(){try{return b.apply(this,arguments)}catch(c){throw a.onError&&a.onError(c),c;}}:b},setTimeout:function(b,c){return setTimeout(a.a.Zb(b),c)},dc:function(b){setTimeout(function(){a.onError&&a.onError(b);throw b;},0)},q:function(b,
c,d){var e=a.a.Zb(d);d=k&&m[c];if(a.options.useOnlyNativeEvents||d||!u)if(d||"function"!=typeof b.addEventListener)if("undefined"!=typeof b.attachEvent){var f=function(a){e.call(b,a)},l="on"+c;b.attachEvent(l,f);a.a.G.qa(b,function(){b.detachEvent(l,f)})}else throw Error("Browser doesn't support addEventListener or attachEvent");else b.addEventListener(c,e,!1);else u(b).bind(c,e)},Fa:function(b,c){if(!b||!b.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var d;"input"===
a.a.A(b)&&b.type&&"click"==c.toLowerCase()?(d=b.type,d="checkbox"==d||"radio"==d):d=!1;if(a.options.useOnlyNativeEvents||!u||d)if("function"==typeof t.createEvent)if("function"==typeof b.dispatchEvent)d=t.createEvent(l[c]||"HTMLEvents"),d.initEvent(c,!0,!0,x,0,0,0,0,0,!1,!1,!1,!1,0,b),b.dispatchEvent(d);else throw Error("The supplied element doesn't support dispatchEvent");else if(d&&b.click)b.click();else if("undefined"!=typeof b.fireEvent)b.fireEvent("on"+c);else throw Error("Browser doesn't support triggering events");
else u(b).trigger(c)},c:function(b){return a.I(b)?b():b},Bb:function(b){return a.I(b)?b.p():b},fb:function(b,c,d){var k;c&&("object"===typeof b.classList?(k=b.classList[d?"add":"remove"],a.a.r(c.match(r),function(a){k.call(b.classList,a)})):"string"===typeof b.className.baseVal?e(b.className,"baseVal",c,d):e(b,"className",c,d))},bb:function(b,c){var d=a.a.c(c);if(null===d||d===n)d="";var e=a.f.firstChild(b);!e||3!=e.nodeType||a.f.nextSibling(e)?a.f.fa(b,[b.ownerDocument.createTextNode(d)]):e.data=
d;a.a.Wc(b)},vc:function(a,b){a.name=b;if(7>=k)try{a.mergeAttributes(t.createElement("<input name='"+a.name+"'/>"),!1)}catch(c){}},Wc:function(a){9<=k&&(a=1==a.nodeType?a:a.parentNode,a.style&&(a.style.zoom=a.style.zoom))},Sc:function(a){if(k){var b=a.style.width;a.style.width=0;a.style.width=b}},nd:function(b,c){b=a.a.c(b);c=a.a.c(c);for(var d=[],e=b;e<=c;e++)d.push(e);return d},W:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b},bc:function(a){return g?Symbol(a):a},xd:6===k,
yd:7===k,C:k,ic:function(b,c){for(var d=a.a.W(b.getElementsByTagName("input")).concat(a.a.W(b.getElementsByTagName("textarea"))),e="string"==typeof c?function(a){return a.name===c}:function(a){return c.test(a.name)},k=[],m=d.length-1;0<=m;m--)e(d[m])&&k.push(d[m]);return k},kd:function(b){return"string"==typeof b&&(b=a.a.cb(b))?H&&H.parse?H.parse(b):(new Function("return "+b))():null},Gb:function(b,c,d){if(!H||!H.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");
return H.stringify(a.a.c(b),c,d)},ld:function(c,d,e){e=e||{};var k=e.params||{},m=e.includeFields||this.gc,f=c;if("object"==typeof c&&"form"===a.a.A(c))for(var f=c.action,l=m.length-1;0<=l;l--)for(var g=a.a.ic(c,m[l]),h=g.length-1;0<=h;h--)k[g[h].name]=g[h].value;d=a.a.c(d);var r=t.createElement("form");r.style.display="none";r.action=f;r.method="post";for(var n in d)c=t.createElement("input"),c.type="hidden",c.name=n,c.value=a.a.Gb(a.a.c(d[n])),r.appendChild(c);b(k,function(a,b){var c=t.createElement("input");
c.type="hidden";c.name=a;c.value=b;r.appendChild(c)});t.body.appendChild(r);e.submitter?e.submitter(r):r.submit();setTimeout(function(){r.parentNode.removeChild(r)},0)}}}();a.b("utils",a.a);a.b("utils.arrayForEach",a.a.r);a.b("utils.arrayFirst",a.a.Vb);a.b("utils.arrayFilter",a.a.Ma);a.b("utils.arrayGetDistinctValues",a.a.Wb);a.b("utils.arrayIndexOf",a.a.o);a.b("utils.arrayMap",a.a.ib);a.b("utils.arrayPushAll",a.a.ta);a.b("utils.arrayRemoveItem",a.a.Na);a.b("utils.extend",a.a.extend);a.b("utils.fieldsIncludedWithJsonPost",
a.a.gc);a.b("utils.getFormFields",a.a.ic);a.b("utils.peekObservable",a.a.Bb);a.b("utils.postJson",a.a.ld);a.b("utils.parseJson",a.a.kd);a.b("utils.registerEventHandler",a.a.q);a.b("utils.stringifyJson",a.a.Gb);a.b("utils.range",a.a.nd);a.b("utils.toggleDomNodeCssClass",a.a.fb);a.b("utils.triggerEvent",a.a.Fa);a.b("utils.unwrapObservable",a.a.c);a.b("utils.objectForEach",a.a.D);a.b("utils.addOrRemoveItem",a.a.ra);a.b("utils.setTextContent",a.a.bb);a.b("unwrap",a.a.c);Function.prototype.bind||(Function.prototype.bind=
function(a){var c=this;if(1===arguments.length)return function(){return c.apply(a,arguments)};var d=Array.prototype.slice.call(arguments,1);return function(){var e=d.slice(0);e.push.apply(e,arguments);return c.apply(a,e)}});a.a.e=new function(){function a(b,g){var h=b[d];if(!h||"null"===h||!e[h]){if(!g)return n;h=b[d]="ko"+c++;e[h]={}}return e[h]}var c=0,d="__ko__"+(new Date).getTime(),e={};return{get:function(c,d){var e=a(c,!1);return e===n?n:e[d]},set:function(c,d,e){if(e!==n||a(c,!1)!==n)a(c,!0)[d]=
e},clear:function(a){var b=a[d];return b?(delete e[b],a[d]=null,!0):!1},J:function(){return c++ +d}}};a.b("utils.domData",a.a.e);a.b("utils.domData.clear",a.a.e.clear);a.a.G=new function(){function b(b,c){var e=a.a.e.get(b,d);e===n&&c&&(e=[],a.a.e.set(b,d,e));return e}function c(d){var e=b(d,!1);if(e)for(var e=e.slice(0),l=0;l<e.length;l++)e[l](d);a.a.e.clear(d);a.a.G.cleanExternalData(d);if(f[d.nodeType])for(e=d.firstChild;d=e;)e=d.nextSibling,8===d.nodeType&&c(d)}var d=a.a.e.J(),e={1:!0,8:!0,9:!0},
f={1:!0,9:!0};return{qa:function(a,c){if("function"!=typeof c)throw Error("Callback must be a function");b(a,!0).push(c)},tc:function(c,e){var f=b(c,!1);f&&(a.a.Na(f,e),0==f.length&&a.a.e.set(c,d,n))},ba:function(b){if(e[b.nodeType]&&(c(b),f[b.nodeType])){var d=[];a.a.ta(d,b.getElementsByTagName("*"));for(var l=0,m=d.length;l<m;l++)c(d[l])}return b},removeNode:function(b){a.ba(b);b.parentNode&&b.parentNode.removeChild(b)},cleanExternalData:function(a){u&&"function"==typeof u.cleanData&&u.cleanData([a])}}};
a.ba=a.a.G.ba;a.removeNode=a.a.G.removeNode;a.b("cleanNode",a.ba);a.b("removeNode",a.removeNode);a.b("utils.domNodeDisposal",a.a.G);a.b("utils.domNodeDisposal.addDisposeCallback",a.a.G.qa);a.b("utils.domNodeDisposal.removeDisposeCallback",a.a.G.tc);(function(){var b=[0,"",""],c=[1,"<table>","</table>"],d=[3,"<table><tbody><tr>","</tr></tbody></table>"],e=[1,"<select multiple='multiple'>","</select>"],f={thead:c,tbody:c,tfoot:c,tr:[2,"<table><tbody>","</tbody></table>"],td:d,th:d,option:e,optgroup:e},
g=8>=a.a.C;a.a.na=function(c,d){var e;if(u)if(u.parseHTML)e=u.parseHTML(c,d)||[];else{if((e=u.clean([c],d))&&e[0]){for(var k=e[0];k.parentNode&&11!==k.parentNode.nodeType;)k=k.parentNode;k.parentNode&&k.parentNode.removeChild(k)}}else{(e=d)||(e=t);var k=e.parentWindow||e.defaultView||x,r=a.a.cb(c).toLowerCase(),q=e.createElement("div"),p;p=(r=r.match(/^<([a-z]+)[ >]/))&&f[r[1]]||b;r=p[0];p="ignored<div>"+p[1]+c+p[2]+"</div>";"function"==typeof k.innerShiv?q.appendChild(k.innerShiv(p)):(g&&e.appendChild(q),
q.innerHTML=p,g&&q.parentNode.removeChild(q));for(;r--;)q=q.lastChild;e=a.a.W(q.lastChild.childNodes)}return e};a.a.Eb=function(b,c){a.a.rb(b);c=a.a.c(c);if(null!==c&&c!==n)if("string"!=typeof c&&(c=c.toString()),u)u(b).html(c);else for(var d=a.a.na(c,b.ownerDocument),e=0;e<d.length;e++)b.appendChild(d[e])}})();a.b("utils.parseHtmlFragment",a.a.na);a.b("utils.setHtml",a.a.Eb);a.N=function(){function b(c,e){if(c)if(8==c.nodeType){var f=a.N.pc(c.nodeValue);null!=f&&e.push({Qc:c,hd:f})}else if(1==c.nodeType)for(var f=
0,g=c.childNodes,h=g.length;f<h;f++)b(g[f],e)}var c={};return{yb:function(a){if("function"!=typeof a)throw Error("You can only pass a function to ko.memoization.memoize()");var b=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);c[b]=a;return"\x3c!--[ko_memo:"+b+"]--\x3e"},Bc:function(a,b){var f=c[a];if(f===n)throw Error("Couldn't find any memo with ID "+a+". Perhaps it's already been unmemoized.");try{return f.apply(null,b||[]),
!0}finally{delete c[a]}},Cc:function(c,e){var f=[];b(c,f);for(var g=0,h=f.length;g<h;g++){var l=f[g].Qc,m=[l];e&&a.a.ta(m,e);a.N.Bc(f[g].hd,m);l.nodeValue="";l.parentNode&&l.parentNode.removeChild(l)}},pc:function(a){return(a=a.match(/^\[ko_memo\:(.*?)\]$/))?a[1]:null}}}();a.b("memoization",a.N);a.b("memoization.memoize",a.N.yb);a.b("memoization.unmemoize",a.N.Bc);a.b("memoization.parseMemoText",a.N.pc);a.b("memoization.unmemoizeDomNodeAndDescendants",a.N.Cc);a.Z=function(){function b(){if(e)for(var b=
e,c=0,m;g<e;)if(m=d[g++]){if(g>b){if(5E3<=++c){g=e;a.a.dc(Error("'Too much recursion' after processing "+c+" task groups."));break}b=e}try{m()}catch(k){a.a.dc(k)}}}function c(){b();g=e=d.length=0}var d=[],e=0,f=1,g=0;return{scheduler:x.MutationObserver?function(a){var b=t.createElement("div");(new MutationObserver(a)).observe(b,{attributes:!0});return function(){b.classList.toggle("foo")}}(c):t&&"onreadystatechange"in t.createElement("script")?function(a){var b=t.createElement("script");b.onreadystatechange=
function(){b.onreadystatechange=null;t.documentElement.removeChild(b);b=null;a()};t.documentElement.appendChild(b)}:function(a){setTimeout(a,0)},Za:function(b){e||a.Z.scheduler(c);d[e++]=b;return f++},cancel:function(a){a-=f-e;a>=g&&a<e&&(d[a]=null)},resetForTesting:function(){var a=e-g;g=e=d.length=0;return a},rd:b}}();a.b("tasks",a.Z);a.b("tasks.schedule",a.Z.Za);a.b("tasks.runEarly",a.Z.rd);a.Aa={throttle:function(b,c){b.throttleEvaluation=c;var d=null;return a.B({read:b,write:function(e){clearTimeout(d);
d=a.a.setTimeout(function(){b(e)},c)}})},rateLimit:function(a,c){var d,e,f;"number"==typeof c?d=c:(d=c.timeout,e=c.method);a.gb=!1;f="notifyWhenChangesStop"==e?T:S;a.Wa(function(a){return f(a,d)})},deferred:function(b,c){if(!0!==c)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");b.gb||(b.gb=!0,b.Wa(function(c){var e,f=!1;return function(){if(!f){a.Z.cancel(e);e=a.Z.Za(c);try{f=!0,b.notifySubscribers(n,"dirty")}finally{f=
!1}}}}))},notify:function(a,c){a.equalityComparer="always"==c?null:J}};var R={undefined:1,"boolean":1,number:1,string:1};a.b("extenders",a.Aa);a.zc=function(b,c,d){this.$=b;this.jb=c;this.Pc=d;this.T=!1;a.H(this,"dispose",this.k)};a.zc.prototype.k=function(){this.T=!0;this.Pc()};a.K=function(){a.a.ab(this,D);D.ub(this)};var E="change",D={ub:function(a){a.F={change:[]};a.Qb=1},Y:function(b,c,d){var e=this;d=d||E;var f=new a.zc(e,c?b.bind(c):b,function(){a.a.Na(e.F[d],f);e.Ka&&e.Ka(d)});e.ua&&e.ua(d);
e.F[d]||(e.F[d]=[]);e.F[d].push(f);return f},notifySubscribers:function(b,c){c=c||E;c===E&&this.Kb();if(this.Ra(c)){var d=c===E&&this.Fc||this.F[c].slice(0);try{a.l.Xb();for(var e=0,f;f=d[e];++e)f.T||f.jb(b)}finally{a.l.end()}}},Pa:function(){return this.Qb},Zc:function(a){return this.Pa()!==a},Kb:function(){++this.Qb},Wa:function(b){var c=this,d=a.I(c),e,f,g,h;c.Ja||(c.Ja=c.notifySubscribers,c.notifySubscribers=U);var l=b(function(){c.Ha=!1;d&&h===c&&(h=c.Mb?c.Mb():c());var a=f||c.Ua(g,h);f=e=!1;
a&&c.Ja(g=h)});c.Pb=function(a){c.Fc=c.F[E].slice(0);c.Ha=e=!0;h=a;l()};c.Ob=function(a){e||(g=a,c.Ja(a,"beforeChange"))};c.Hc=function(){c.Ua(g,c.p(!0))&&(f=!0)}},Ra:function(a){return this.F[a]&&this.F[a].length},Xc:function(b){if(b)return this.F[b]&&this.F[b].length||0;var c=0;a.a.D(this.F,function(a,b){"dirty"!==a&&(c+=b.length)});return c},Ua:function(a,c){return!this.equalityComparer||!this.equalityComparer(a,c)},extend:function(b){var c=this;b&&a.a.D(b,function(b,e){var f=a.Aa[b];"function"==
typeof f&&(c=f(c,e)||c)});return c}};a.H(D,"subscribe",D.Y);a.H(D,"extend",D.extend);a.H(D,"getSubscriptionsCount",D.Xc);a.a.la&&a.a.$a(D,Function.prototype);a.K.fn=D;a.lc=function(a){return null!=a&&"function"==typeof a.Y&&"function"==typeof a.notifySubscribers};a.b("subscribable",a.K);a.b("isSubscribable",a.lc);a.xa=a.l=function(){function b(a){d.push(e);e=a}function c(){e=d.pop()}var d=[],e,f=0;return{Xb:b,end:c,sc:function(b){if(e){if(!a.lc(b))throw Error("Only subscribable things can act as dependencies");
e.jb.call(e.Lc,b,b.Gc||(b.Gc=++f))}},w:function(a,d,e){try{return b(),a.apply(d,e||[])}finally{c()}},Ca:function(){if(e)return e.m.Ca()},Va:function(){if(e)return e.Va}}}();a.b("computedContext",a.xa);a.b("computedContext.getDependenciesCount",a.xa.Ca);a.b("computedContext.isInitial",a.xa.Va);a.b("ignoreDependencies",a.wd=a.l.w);var F=a.a.bc("_latestValue");a.O=function(b){function c(){if(0<arguments.length)return c.Ua(c[F],arguments[0])&&(c.ia(),c[F]=arguments[0],c.ha()),this;a.l.sc(c);return c[F]}
c[F]=b;a.a.la||a.a.extend(c,a.K.fn);a.K.fn.ub(c);a.a.ab(c,B);a.options.deferUpdates&&a.Aa.deferred(c,!0);return c};var B={equalityComparer:J,p:function(){return this[F]},ha:function(){this.notifySubscribers(this[F])},ia:function(){this.notifySubscribers(this[F],"beforeChange")}};a.a.la&&a.a.$a(B,a.K.fn);var I=a.O.md="__ko_proto__";B[I]=a.O;a.Qa=function(b,c){return null===b||b===n||b[I]===n?!1:b[I]===c?!0:a.Qa(b[I],c)};a.I=function(b){return a.Qa(b,a.O)};a.Da=function(b){return"function"==typeof b&&
b[I]===a.O||"function"==typeof b&&b[I]===a.B&&b.$c?!0:!1};a.b("observable",a.O);a.b("isObservable",a.I);a.b("isWriteableObservable",a.Da);a.b("isWritableObservable",a.Da);a.b("observable.fn",B);a.H(B,"peek",B.p);a.H(B,"valueHasMutated",B.ha);a.H(B,"valueWillMutate",B.ia);a.ma=function(b){b=b||[];if("object"!=typeof b||!("length"in b))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");b=a.O(b);a.a.ab(b,a.ma.fn);return b.extend({trackArrayChanges:!0})};
a.ma.fn={remove:function(b){for(var c=this.p(),d=[],e="function"!=typeof b||a.I(b)?function(a){return a===b}:b,f=0;f<c.length;f++){var g=c[f];e(g)&&(0===d.length&&this.ia(),d.push(g),c.splice(f,1),f--)}d.length&&this.ha();return d},removeAll:function(b){if(b===n){var c=this.p(),d=c.slice(0);this.ia();c.splice(0,c.length);this.ha();return d}return b?this.remove(function(c){return 0<=a.a.o(b,c)}):[]},destroy:function(b){var c=this.p(),d="function"!=typeof b||a.I(b)?function(a){return a===b}:b;this.ia();
for(var e=c.length-1;0<=e;e--)d(c[e])&&(c[e]._destroy=!0);this.ha()},destroyAll:function(b){return b===n?this.destroy(function(){return!0}):b?this.destroy(function(c){return 0<=a.a.o(b,c)}):[]},indexOf:function(b){var c=this();return a.a.o(c,b)},replace:function(a,c){var d=this.indexOf(a);0<=d&&(this.ia(),this.p()[d]=c,this.ha())}};a.a.la&&a.a.$a(a.ma.fn,a.O.fn);a.a.r("pop push reverse shift sort splice unshift".split(" "),function(b){a.ma.fn[b]=function(){var a=this.p();this.ia();this.Yb(a,b,arguments);
var d=a[b].apply(a,arguments);this.ha();return d===a?this:d}});a.a.r(["slice"],function(b){a.ma.fn[b]=function(){var a=this();return a[b].apply(a,arguments)}});a.b("observableArray",a.ma);a.Aa.trackArrayChanges=function(b,c){function d(){if(!e){e=!0;l=b.notifySubscribers;b.notifySubscribers=function(a,b){b&&b!==E||++h;return l.apply(this,arguments)};var c=[].concat(b.p()||[]);f=null;g=b.Y(function(d){d=[].concat(d||[]);if(b.Ra("arrayChange")){var e;if(!f||1<h)f=a.a.lb(c,d,b.kb);e=f}c=d;f=null;h=0;
e&&e.length&&b.notifySubscribers(e,"arrayChange")})}}b.kb={};c&&"object"==typeof c&&a.a.extend(b.kb,c);b.kb.sparse=!0;if(!b.Yb){var e=!1,f=null,g,h=0,l,m=b.ua,k=b.Ka;b.ua=function(a){m&&m.call(b,a);"arrayChange"===a&&d()};b.Ka=function(a){k&&k.call(b,a);"arrayChange"!==a||b.Ra("arrayChange")||(l&&(b.notifySubscribers=l,l=n),g.k(),e=!1)};b.Yb=function(b,c,d){function k(a,b,c){return m[m.length]={status:a,value:b,index:c}}if(e&&!h){var m=[],l=b.length,g=d.length,G=0;switch(c){case "push":G=l;case "unshift":for(c=
0;c<g;c++)k("added",d[c],G+c);break;case "pop":G=l-1;case "shift":l&&k("deleted",b[G],G);break;case "splice":c=Math.min(Math.max(0,0>d[0]?l+d[0]:d[0]),l);for(var l=1===g?l:Math.min(c+(d[1]||0),l),g=c+g-2,G=Math.max(l,g),n=[],s=[],w=2;c<G;++c,++w)c<l&&s.push(k("deleted",b[c],c)),c<g&&n.push(k("added",d[w],c));a.a.hc(s,n);break;default:return}f=m}}}};var s=a.a.bc("_state");a.m=a.B=function(b,c,d){function e(){if(0<arguments.length){if("function"===typeof f)f.apply(g.sb,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");
return this}a.l.sc(e);(g.V||g.t&&e.Sa())&&e.U();return g.M}"object"===typeof b?d=b:(d=d||{},b&&(d.read=b));if("function"!=typeof d.read)throw Error("Pass a function that returns the value of the ko.computed");var f=d.write,g={M:n,da:!0,V:!0,Ta:!1,Hb:!1,T:!1,Ya:!1,t:!1,od:d.read,sb:c||d.owner,i:d.disposeWhenNodeIsRemoved||d.i||null,ya:d.disposeWhen||d.ya,pb:null,s:{},L:0,fc:null};e[s]=g;e.$c="function"===typeof f;a.a.la||a.a.extend(e,a.K.fn);a.K.fn.ub(e);a.a.ab(e,z);d.pure?(g.Ya=!0,g.t=!0,a.a.extend(e,
Y)):d.deferEvaluation&&a.a.extend(e,Z);a.options.deferUpdates&&a.Aa.deferred(e,!0);g.i&&(g.Hb=!0,g.i.nodeType||(g.i=null));g.t||d.deferEvaluation||e.U();g.i&&e.ca()&&a.a.G.qa(g.i,g.pb=function(){e.k()});return e};var z={equalityComparer:J,Ca:function(){return this[s].L},Sb:function(a,c,d){if(this[s].Ya&&c===this)throw Error("A 'pure' computed must not be called recursively");this[s].s[a]=d;d.Ia=this[s].L++;d.pa=c.Pa()},Sa:function(){var a,c,d=this[s].s;for(a in d)if(d.hasOwnProperty(a)&&(c=d[a],this.oa&&
c.$.Ha||c.$.Zc(c.pa)))return!0},gd:function(){this.oa&&!this[s].Ta&&this.oa(!1)},ca:function(){var a=this[s];return a.V||0<a.L},qd:function(){this.Ha?this[s].V&&(this[s].da=!0):this.ec()},yc:function(a){if(a.gb&&!this[s].i){var c=a.Y(this.gd,this,"dirty"),d=a.Y(this.qd,this);return{$:a,k:function(){c.k();d.k()}}}return a.Y(this.ec,this)},ec:function(){var b=this,c=b.throttleEvaluation;c&&0<=c?(clearTimeout(this[s].fc),this[s].fc=a.a.setTimeout(function(){b.U(!0)},c)):b.oa?b.oa(!0):b.U(!0)},U:function(b){var c=
this[s],d=c.ya,e=!1;if(!c.Ta&&!c.T){if(c.i&&!a.a.qb(c.i)||d&&d()){if(!c.Hb){this.k();return}}else c.Hb=!1;c.Ta=!0;try{e=this.Vc(b)}finally{c.Ta=!1}c.L||this.k();return e}},Vc:function(b){var c=this[s],d=!1,e=c.Ya?n:!c.L,f={Mc:this,Oa:c.s,ob:c.L};a.l.Xb({Lc:f,jb:W,m:this,Va:e});c.s={};c.L=0;f=this.Uc(c,f);this.Ua(c.M,f)&&(c.t||this.notifySubscribers(c.M,"beforeChange"),c.M=f,c.t?this.Kb():b&&this.notifySubscribers(c.M),d=!0);e&&this.notifySubscribers(c.M,"awake");return d},Uc:function(b,c){try{var d=
b.od;return b.sb?d.call(b.sb):d()}finally{a.l.end(),c.ob&&!b.t&&a.a.D(c.Oa,V),b.da=b.V=!1}},p:function(a){var c=this[s];(c.V&&(a||!c.L)||c.t&&this.Sa())&&this.U();return c.M},Wa:function(b){a.K.fn.Wa.call(this,b);this.Mb=function(){this[s].da?this.U():this[s].V=!1;return this[s].M};this.oa=function(a){this.Ob(this[s].M);this[s].V=!0;a&&(this[s].da=!0);this.Pb(this)}},k:function(){var b=this[s];!b.t&&b.s&&a.a.D(b.s,function(a,b){b.k&&b.k()});b.i&&b.pb&&a.a.G.tc(b.i,b.pb);b.s=null;b.L=0;b.T=!0;b.da=
!1;b.V=!1;b.t=!1;b.i=null}},Y={ua:function(b){var c=this,d=c[s];if(!d.T&&d.t&&"change"==b){d.t=!1;if(d.da||c.Sa())d.s=null,d.L=0,c.U()&&c.Kb();else{var e=[];a.a.D(d.s,function(a,b){e[b.Ia]=a});a.a.r(e,function(a,b){var e=d.s[a],l=c.yc(e.$);l.Ia=b;l.pa=e.pa;d.s[a]=l})}d.T||c.notifySubscribers(d.M,"awake")}},Ka:function(b){var c=this[s];c.T||"change"!=b||this.Ra("change")||(a.a.D(c.s,function(a,b){b.k&&(c.s[a]={$:b.$,Ia:b.Ia,pa:b.pa},b.k())}),c.t=!0,this.notifySubscribers(n,"asleep"))},Pa:function(){var b=
this[s];b.t&&(b.da||this.Sa())&&this.U();return a.K.fn.Pa.call(this)}},Z={ua:function(a){"change"!=a&&"beforeChange"!=a||this.p()}};a.a.la&&a.a.$a(z,a.K.fn);var P=a.O.md;a.m[P]=a.O;z[P]=a.m;a.bd=function(b){return a.Qa(b,a.m)};a.cd=function(b){return a.Qa(b,a.m)&&b[s]&&b[s].Ya};a.b("computed",a.m);a.b("dependentObservable",a.m);a.b("isComputed",a.bd);a.b("isPureComputed",a.cd);a.b("computed.fn",z);a.H(z,"peek",z.p);a.H(z,"dispose",z.k);a.H(z,"isActive",z.ca);a.H(z,"getDependenciesCount",z.Ca);a.rc=
function(b,c){if("function"===typeof b)return a.m(b,c,{pure:!0});b=a.a.extend({},b);b.pure=!0;return a.m(b,c)};a.b("pureComputed",a.rc);(function(){function b(a,f,g){g=g||new d;a=f(a);if("object"!=typeof a||null===a||a===n||a instanceof RegExp||a instanceof Date||a instanceof String||a instanceof Number||a instanceof Boolean)return a;var h=a instanceof Array?[]:{};g.save(a,h);c(a,function(c){var d=f(a[c]);switch(typeof d){case "boolean":case "number":case "string":case "function":h[c]=d;break;case "object":case "undefined":var k=
g.get(d);h[c]=k!==n?k:b(d,f,g)}});return h}function c(a,b){if(a instanceof Array){for(var c=0;c<a.length;c++)b(c);"function"==typeof a.toJSON&&b("toJSON")}else for(c in a)b(c)}function d(){this.keys=[];this.Lb=[]}a.Ac=function(c){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return b(c,function(b){for(var c=0;a.I(b)&&10>c;c++)b=b();return b})};a.toJSON=function(b,c,d){b=a.Ac(b);return a.a.Gb(b,c,d)};d.prototype={save:function(b,c){var d=a.a.o(this.keys,
b);0<=d?this.Lb[d]=c:(this.keys.push(b),this.Lb.push(c))},get:function(b){b=a.a.o(this.keys,b);return 0<=b?this.Lb[b]:n}}})();a.b("toJS",a.Ac);a.b("toJSON",a.toJSON);(function(){a.j={u:function(b){switch(a.a.A(b)){case "option":return!0===b.__ko__hasDomDataOptionValue__?a.a.e.get(b,a.d.options.zb):7>=a.a.C?b.getAttributeNode("value")&&b.getAttributeNode("value").specified?b.value:b.text:b.value;case "select":return 0<=b.selectedIndex?a.j.u(b.options[b.selectedIndex]):n;default:return b.value}},ja:function(b,
c,d){switch(a.a.A(b)){case "option":switch(typeof c){case "string":a.a.e.set(b,a.d.options.zb,n);"__ko__hasDomDataOptionValue__"in b&&delete b.__ko__hasDomDataOptionValue__;b.value=c;break;default:a.a.e.set(b,a.d.options.zb,c),b.__ko__hasDomDataOptionValue__=!0,b.value="number"===typeof c?c:""}break;case "select":if(""===c||null===c)c=n;for(var e=-1,f=0,g=b.options.length,h;f<g;++f)if(h=a.j.u(b.options[f]),h==c||""==h&&c===n){e=f;break}if(d||0<=e||c===n&&1<b.size)b.selectedIndex=e;break;default:if(null===
c||c===n)c="";b.value=c}}}})();a.b("selectExtensions",a.j);a.b("selectExtensions.readValue",a.j.u);a.b("selectExtensions.writeValue",a.j.ja);a.h=function(){function b(b){b=a.a.cb(b);123===b.charCodeAt(0)&&(b=b.slice(1,-1));var c=[],d=b.match(e),r,h=[],p=0;if(d){d.push(",");for(var A=0,y;y=d[A];++A){var v=y.charCodeAt(0);if(44===v){if(0>=p){c.push(r&&h.length?{key:r,value:h.join("")}:{unknown:r||h.join("")});r=p=0;h=[];continue}}else if(58===v){if(!p&&!r&&1===h.length){r=h.pop();continue}}else 47===
v&&A&&1<y.length?(v=d[A-1].match(f))&&!g[v[0]]&&(b=b.substr(b.indexOf(y)+1),d=b.match(e),d.push(","),A=-1,y="/"):40===v||123===v||91===v?++p:41===v||125===v||93===v?--p:r||h.length||34!==v&&39!==v||(y=y.slice(1,-1));h.push(y)}}return c}var c=["true","false","null","undefined"],d=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,e=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),f=/[\])"'A-Za-z0-9_$]+$/,
g={"in":1,"return":1,"typeof":1},h={};return{va:[],ga:h,Ab:b,Xa:function(e,m){function k(b,e){var m;if(!A){var l=a.getBindingHandler(b);if(l&&l.preprocess&&!(e=l.preprocess(e,b,k)))return;if(l=h[b])m=e,0<=a.a.o(c,m)?m=!1:(l=m.match(d),m=null===l?!1:l[1]?"Object("+l[1]+")"+l[2]:m),l=m;l&&g.push("'"+b+"':function(_z){"+m+"=_z}")}p&&(e="function(){return "+e+" }");f.push("'"+b+"':"+e)}m=m||{};var f=[],g=[],p=m.valueAccessors,A=m.bindingParams,y="string"===typeof e?b(e):e;a.a.r(y,function(a){k(a.key||
a.unknown,a.value)});g.length&&k("_ko_property_writers","{"+g.join(",")+" }");return f.join(",")},fd:function(a,b){for(var c=0;c<a.length;c++)if(a[c].key==b)return!0;return!1},Ga:function(b,c,d,e,f){if(b&&a.I(b))!a.Da(b)||f&&b.p()===e||b(e);else if((b=c.get("_ko_property_writers"))&&b[d])b[d](e)}}}();a.b("expressionRewriting",a.h);a.b("expressionRewriting.bindingRewriteValidators",a.h.va);a.b("expressionRewriting.parseObjectLiteral",a.h.Ab);a.b("expressionRewriting.preProcessBindings",a.h.Xa);a.b("expressionRewriting._twoWayBindings",
a.h.ga);a.b("jsonExpressionRewriting",a.h);a.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",a.h.Xa);(function(){function b(a){return 8==a.nodeType&&g.test(f?a.text:a.nodeValue)}function c(a){return 8==a.nodeType&&h.test(f?a.text:a.nodeValue)}function d(a,d){for(var e=a,f=1,l=[];e=e.nextSibling;){if(c(e)&&(f--,0===f))return l;l.push(e);b(e)&&f++}if(!d)throw Error("Cannot find closing comment tag to match: "+a.nodeValue);return null}function e(a,b){var c=d(a,b);return c?0<c.length?c[c.length-
1].nextSibling:a.nextSibling:null}var f=t&&"\x3c!--test--\x3e"===t.createComment("test").text,g=f?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,h=f?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0};a.f={aa:{},childNodes:function(a){return b(a)?d(a):a.childNodes},za:function(c){if(b(c)){c=a.f.childNodes(c);for(var d=0,e=c.length;d<e;d++)a.removeNode(c[d])}else a.a.rb(c)},fa:function(c,d){if(b(c)){a.f.za(c);for(var e=c.nextSibling,f=0,l=d.length;f<l;f++)e.parentNode.insertBefore(d[f],
e)}else a.a.fa(c,d)},qc:function(a,c){b(a)?a.parentNode.insertBefore(c,a.nextSibling):a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)},kc:function(c,d,e){e?b(c)?c.parentNode.insertBefore(d,e.nextSibling):e.nextSibling?c.insertBefore(d,e.nextSibling):c.appendChild(d):a.f.qc(c,d)},firstChild:function(a){return b(a)?!a.nextSibling||c(a.nextSibling)?null:a.nextSibling:a.firstChild},nextSibling:function(a){b(a)&&(a=e(a));return a.nextSibling&&c(a.nextSibling)?null:a.nextSibling},Yc:b,vd:function(a){return(a=
(f?a.text:a.nodeValue).match(g))?a[1]:null},oc:function(d){if(l[a.a.A(d)]){var k=d.firstChild;if(k){do if(1===k.nodeType){var f;f=k.firstChild;var g=null;if(f){do if(g)g.push(f);else if(b(f)){var h=e(f,!0);h?f=h:g=[f]}else c(f)&&(g=[f]);while(f=f.nextSibling)}if(f=g)for(g=k.nextSibling,h=0;h<f.length;h++)g?d.insertBefore(f[h],g):d.appendChild(f[h])}while(k=k.nextSibling)}}}}})();a.b("virtualElements",a.f);a.b("virtualElements.allowedBindings",a.f.aa);a.b("virtualElements.emptyNode",a.f.za);a.b("virtualElements.insertAfter",
a.f.kc);a.b("virtualElements.prepend",a.f.qc);a.b("virtualElements.setDomNodeChildren",a.f.fa);(function(){a.S=function(){this.Kc={}};a.a.extend(a.S.prototype,{nodeHasBindings:function(b){switch(b.nodeType){case 1:return null!=b.getAttribute("data-bind")||a.g.getComponentNameForNode(b);case 8:return a.f.Yc(b);default:return!1}},getBindings:function(b,c){var d=this.getBindingsString(b,c),d=d?this.parseBindingsString(d,c,b):null;return a.g.Rb(d,b,c,!1)},getBindingAccessors:function(b,c){var d=this.getBindingsString(b,
c),d=d?this.parseBindingsString(d,c,b,{valueAccessors:!0}):null;return a.g.Rb(d,b,c,!0)},getBindingsString:function(b){switch(b.nodeType){case 1:return b.getAttribute("data-bind");case 8:return a.f.vd(b);default:return null}},parseBindingsString:function(b,c,d,e){try{var f=this.Kc,g=b+(e&&e.valueAccessors||""),h;if(!(h=f[g])){var l,m="with($context){with($data||{}){return{"+a.h.Xa(b,e)+"}}}";l=new Function("$context","$element",m);h=f[g]=l}return h(c,d)}catch(k){throw k.message="Unable to parse bindings.\nBindings value: "+
b+"\nMessage: "+k.message,k;}}});a.S.instance=new a.S})();a.b("bindingProvider",a.S);(function(){function b(a){return function(){return a}}function c(a){return a()}function d(b){return a.a.Ea(a.l.w(b),function(a,c){return function(){return b()[c]}})}function e(c,e,k){return"function"===typeof c?d(c.bind(null,e,k)):a.a.Ea(c,b)}function f(a,b){return d(this.getBindings.bind(this,a,b))}function g(b,c,d){var e,k=a.f.firstChild(c),f=a.S.instance,m=f.preprocessNode;if(m){for(;e=k;)k=a.f.nextSibling(e),
m.call(f,e);k=a.f.firstChild(c)}for(;e=k;)k=a.f.nextSibling(e),h(b,e,d)}function h(b,c,d){var e=!0,k=1===c.nodeType;k&&a.f.oc(c);if(k&&d||a.S.instance.nodeHasBindings(c))e=m(c,null,b,d).shouldBindDescendants;e&&!r[a.a.A(c)]&&g(b,c,!k)}function l(b){var c=[],d={},e=[];a.a.D(b,function X(k){if(!d[k]){var f=a.getBindingHandler(k);f&&(f.after&&(e.push(k),a.a.r(f.after,function(c){if(b[c]){if(-1!==a.a.o(e,c))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+e.join(", "));
X(c)}}),e.length--),c.push({key:k,jc:f}));d[k]=!0}});return c}function m(b,d,e,k){var m=a.a.e.get(b,q);if(!d){if(m)throw Error("You cannot apply bindings multiple times to the same element.");a.a.e.set(b,q,!0)}!m&&k&&a.xc(b,e);var g;if(d&&"function"!==typeof d)g=d;else{var h=a.S.instance,r=h.getBindingAccessors||f,p=a.B(function(){(g=d?d(e,b):r.call(h,b,e))&&e.Q&&e.Q();return g},null,{i:b});g&&p.ca()||(p=null)}var s;if(g){var t=p?function(a){return function(){return c(p()[a])}}:function(a){return g[a]},
u=function(){return a.a.Ea(p?p():g,c)};u.get=function(a){return g[a]&&c(t(a))};u.has=function(a){return a in g};k=l(g);a.a.r(k,function(c){var d=c.jc.init,k=c.jc.update,f=c.key;if(8===b.nodeType&&!a.f.aa[f])throw Error("The binding '"+f+"' cannot be used with virtual elements");try{"function"==typeof d&&a.l.w(function(){var a=d(b,t(f),u,e.$data,e);if(a&&a.controlsDescendantBindings){if(s!==n)throw Error("Multiple bindings ("+s+" and "+f+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");
s=f}}),"function"==typeof k&&a.B(function(){k(b,t(f),u,e.$data,e)},null,{i:b})}catch(m){throw m.message='Unable to process binding "'+f+": "+g[f]+'"\nMessage: '+m.message,m;}})}return{shouldBindDescendants:s===n}}function k(b){return b&&b instanceof a.R?b:new a.R(b)}a.d={};var r={script:!0,textarea:!0,template:!0};a.getBindingHandler=function(b){return a.d[b]};a.R=function(b,c,d,e,k){function f(){var k=g?b():b,m=a.a.c(k);c?(c.Q&&c.Q(),a.a.extend(l,c),l.Q=r):(l.$parents=[],l.$root=m,l.ko=a);l.$rawData=
k;l.$data=m;d&&(l[d]=m);e&&e(l,c,m);return l.$data}function m(){return h&&!a.a.Tb(h)}var l=this,g="function"==typeof b&&!a.I(b),h,r;k&&k.exportDependencies?f():(r=a.B(f,null,{ya:m,i:!0}),r.ca()&&(l.Q=r,r.equalityComparer=null,h=[],r.Dc=function(b){h.push(b);a.a.G.qa(b,function(b){a.a.Na(h,b);h.length||(r.k(),l.Q=r=n)})}))};a.R.prototype.createChildContext=function(b,c,d,e){return new a.R(b,this,c,function(a,b){a.$parentContext=b;a.$parent=b.$data;a.$parents=(b.$parents||[]).slice(0);a.$parents.unshift(a.$parent);
d&&d(a)},e)};a.R.prototype.extend=function(b){return new a.R(this.Q||this.$data,this,null,function(c,d){c.$rawData=d.$rawData;a.a.extend(c,"function"==typeof b?b():b)})};a.R.prototype.ac=function(a,b){return this.createChildContext(a,b,null,{exportDependencies:!0})};var q=a.a.e.J(),p=a.a.e.J();a.xc=function(b,c){if(2==arguments.length)a.a.e.set(b,p,c),c.Q&&c.Q.Dc(b);else return a.a.e.get(b,p)};a.La=function(b,c,d){1===b.nodeType&&a.f.oc(b);return m(b,c,k(d),!0)};a.Ic=function(b,c,d){d=k(d);return a.La(b,
e(c,d,b),d)};a.hb=function(a,b){1!==b.nodeType&&8!==b.nodeType||g(k(a),b,!0)};a.Ub=function(a,b){!u&&x.jQuery&&(u=x.jQuery);if(b&&1!==b.nodeType&&8!==b.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");b=b||x.document.body;h(k(a),b,!0)};a.nb=function(b){switch(b.nodeType){case 1:case 8:var c=a.xc(b);if(c)return c;if(b.parentNode)return a.nb(b.parentNode)}return n};a.Oc=function(b){return(b=a.nb(b))?b.$data:n};a.b("bindingHandlers",
a.d);a.b("applyBindings",a.Ub);a.b("applyBindingsToDescendants",a.hb);a.b("applyBindingAccessorsToNode",a.La);a.b("applyBindingsToNode",a.Ic);a.b("contextFor",a.nb);a.b("dataFor",a.Oc)})();(function(b){function c(c,e){var m=f.hasOwnProperty(c)?f[c]:b,k;m?m.Y(e):(m=f[c]=new a.K,m.Y(e),d(c,function(b,d){var e=!(!d||!d.synchronous);g[c]={definition:b,dd:e};delete f[c];k||e?m.notifySubscribers(b):a.Z.Za(function(){m.notifySubscribers(b)})}),k=!0)}function d(a,b){e("getConfig",[a],function(c){c?e("loadComponent",
[a,c],function(a){b(a,c)}):b(null,null)})}function e(c,d,f,k){k||(k=a.g.loaders.slice(0));var g=k.shift();if(g){var q=g[c];if(q){var p=!1;if(q.apply(g,d.concat(function(a){p?f(null):null!==a?f(a):e(c,d,f,k)}))!==b&&(p=!0,!g.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.");}else e(c,d,f,k)}else f(null)}var f={},g={};a.g={get:function(d,e){var f=g.hasOwnProperty(d)?g[d]:b;f?f.dd?a.l.w(function(){e(f.definition)}):
a.Z.Za(function(){e(f.definition)}):c(d,e)},$b:function(a){delete g[a]},Nb:e};a.g.loaders=[];a.b("components",a.g);a.b("components.get",a.g.get);a.b("components.clearCachedDefinition",a.g.$b)})();(function(){function b(b,c,d,e){function g(){0===--y&&e(h)}var h={},y=2,v=d.template;d=d.viewModel;v?f(c,v,function(c){a.g.Nb("loadTemplate",[b,c],function(a){h.template=a;g()})}):g();d?f(c,d,function(c){a.g.Nb("loadViewModel",[b,c],function(a){h[l]=a;g()})}):g()}function c(a,b,d){if("function"===typeof b)d(function(a){return new b(a)});
else if("function"===typeof b[l])d(b[l]);else if("instance"in b){var e=b.instance;d(function(){return e})}else"viewModel"in b?c(a,b.viewModel,d):a("Unknown viewModel value: "+b)}function d(b){switch(a.a.A(b)){case "script":return a.a.na(b.text);case "textarea":return a.a.na(b.value);case "template":if(e(b.content))return a.a.wa(b.content.childNodes)}return a.a.wa(b.childNodes)}function e(a){return x.DocumentFragment?a instanceof DocumentFragment:a&&11===a.nodeType}function f(a,b,c){"string"===typeof b.require?
O||x.require?(O||x.require)([b.require],c):a("Uses require, but no AMD loader is present"):c(b)}function g(a){return function(b){throw Error("Component '"+a+"': "+b);}}var h={};a.g.register=function(b,c){if(!c)throw Error("Invalid configuration for "+b);if(a.g.wb(b))throw Error("Component "+b+" is already registered");h[b]=c};a.g.wb=function(a){return h.hasOwnProperty(a)};a.g.ud=function(b){delete h[b];a.g.$b(b)};a.g.cc={getConfig:function(a,b){b(h.hasOwnProperty(a)?h[a]:null)},loadComponent:function(a,
c,d){var e=g(a);f(e,c,function(c){b(a,e,c,d)})},loadTemplate:function(b,c,f){b=g(b);if("string"===typeof c)f(a.a.na(c));else if(c instanceof Array)f(c);else if(e(c))f(a.a.W(c.childNodes));else if(c.element)if(c=c.element,x.HTMLElement?c instanceof HTMLElement:c&&c.tagName&&1===c.nodeType)f(d(c));else if("string"===typeof c){var l=t.getElementById(c);l?f(d(l)):b("Cannot find element with ID "+c)}else b("Unknown element type: "+c);else b("Unknown template value: "+c)},loadViewModel:function(a,b,d){c(g(a),
b,d)}};var l="createViewModel";a.b("components.register",a.g.register);a.b("components.isRegistered",a.g.wb);a.b("components.unregister",a.g.ud);a.b("components.defaultLoader",a.g.cc);a.g.loaders.push(a.g.cc);a.g.Ec=h})();(function(){function b(b,e){var f=b.getAttribute("params");if(f){var f=c.parseBindingsString(f,e,b,{valueAccessors:!0,bindingParams:!0}),f=a.a.Ea(f,function(c){return a.m(c,null,{i:b})}),g=a.a.Ea(f,function(c){var e=c.p();return c.ca()?a.m({read:function(){return a.a.c(c())},write:a.Da(e)&&
function(a){c()(a)},i:b}):e});g.hasOwnProperty("$raw")||(g.$raw=f);return g}return{$raw:{}}}a.g.getComponentNameForNode=function(b){var c=a.a.A(b);if(a.g.wb(c)&&(-1!=c.indexOf("-")||"[object HTMLUnknownElement]"==""+b||8>=a.a.C&&b.tagName===c))return c};a.g.Rb=function(c,e,f,g){if(1===e.nodeType){var h=a.g.getComponentNameForNode(e);if(h){c=c||{};if(c.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var l={name:h,params:b(e,f)};c.component=g?function(){return l}:
l}}return c};var c=new a.S;9>a.a.C&&(a.g.register=function(a){return function(b){t.createElement(b);return a.apply(this,arguments)}}(a.g.register),t.createDocumentFragment=function(b){return function(){var c=b(),f=a.g.Ec,g;for(g in f)f.hasOwnProperty(g)&&c.createElement(g);return c}}(t.createDocumentFragment))})();(function(b){function c(b,c,d){c=c.template;if(!c)throw Error("Component '"+b+"' has no template");b=a.a.wa(c);a.f.fa(d,b)}function d(a,b,c,d){var e=a.createViewModel;return e?e.call(a,
d,{element:b,templateNodes:c}):d}var e=0;a.d.component={init:function(f,g,h,l,m){function k(){var a=r&&r.dispose;"function"===typeof a&&a.call(r);q=r=null}var r,q,p=a.a.W(a.f.childNodes(f));a.a.G.qa(f,k);a.m(function(){var l=a.a.c(g()),h,v;"string"===typeof l?h=l:(h=a.a.c(l.name),v=a.a.c(l.params));if(!h)throw Error("No component name specified");var n=q=++e;a.g.get(h,function(e){if(q===n){k();if(!e)throw Error("Unknown component '"+h+"'");c(h,e,f);var l=d(e,f,p,v);e=m.createChildContext(l,b,function(a){a.$component=
l;a.$componentTemplateNodes=p});r=l;a.hb(e,f)}})},null,{i:f});return{controlsDescendantBindings:!0}}};a.f.aa.component=!0})();var Q={"class":"className","for":"htmlFor"};a.d.attr={update:function(b,c){var d=a.a.c(c())||{};a.a.D(d,function(c,d){d=a.a.c(d);var g=!1===d||null===d||d===n;g&&b.removeAttribute(c);8>=a.a.C&&c in Q?(c=Q[c],g?b.removeAttribute(c):b[c]=d):g||b.setAttribute(c,d.toString());"name"===c&&a.a.vc(b,g?"":d.toString())})}};(function(){a.d.checked={after:["value","attr"],init:function(b,
c,d){function e(){var e=b.checked,f=p?g():e;if(!a.xa.Va()&&(!l||e)){var h=a.l.w(c);if(k){var m=r?h.p():h;q!==f?(e&&(a.a.ra(m,f,!0),a.a.ra(m,q,!1)),q=f):a.a.ra(m,f,e);r&&a.Da(h)&&h(m)}else a.h.Ga(h,d,"checked",f,!0)}}function f(){var d=a.a.c(c());b.checked=k?0<=a.a.o(d,g()):h?d:g()===d}var g=a.rc(function(){return d.has("checkedValue")?a.a.c(d.get("checkedValue")):d.has("value")?a.a.c(d.get("value")):b.value}),h="checkbox"==b.type,l="radio"==b.type;if(h||l){var m=c(),k=h&&a.a.c(m)instanceof Array,
r=!(k&&m.push&&m.splice),q=k?g():n,p=l||k;l&&!b.name&&a.d.uniqueName.init(b,function(){return!0});a.m(e,null,{i:b});a.a.q(b,"click",e);a.m(f,null,{i:b});m=n}}};a.h.ga.checked=!0;a.d.checkedValue={update:function(b,c){b.value=a.a.c(c())}}})();a.d.css={update:function(b,c){var d=a.a.c(c());null!==d&&"object"==typeof d?a.a.D(d,function(c,d){d=a.a.c(d);a.a.fb(b,c,d)}):(d=a.a.cb(String(d||"")),a.a.fb(b,b.__ko__cssValue,!1),b.__ko__cssValue=d,a.a.fb(b,d,!0))}};a.d.enable={update:function(b,c){var d=a.a.c(c());
d&&b.disabled?b.removeAttribute("disabled"):d||b.disabled||(b.disabled=!0)}};a.d.disable={update:function(b,c){a.d.enable.update(b,function(){return!a.a.c(c())})}};a.d.event={init:function(b,c,d,e,f){var g=c()||{};a.a.D(g,function(g){"string"==typeof g&&a.a.q(b,g,function(b){var m,k=c()[g];if(k){try{var r=a.a.W(arguments);e=f.$data;r.unshift(e);m=k.apply(e,r)}finally{!0!==m&&(b.preventDefault?b.preventDefault():b.returnValue=!1)}!1===d.get(g+"Bubble")&&(b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation())}})})}};
a.d.foreach={mc:function(b){return function(){var c=b(),d=a.a.Bb(c);if(!d||"number"==typeof d.length)return{foreach:c,templateEngine:a.X.vb};a.a.c(c);return{foreach:d.data,as:d.as,includeDestroyed:d.includeDestroyed,afterAdd:d.afterAdd,beforeRemove:d.beforeRemove,afterRender:d.afterRender,beforeMove:d.beforeMove,afterMove:d.afterMove,templateEngine:a.X.vb}}},init:function(b,c){return a.d.template.init(b,a.d.foreach.mc(c))},update:function(b,c,d,e,f){return a.d.template.update(b,a.d.foreach.mc(c),
d,e,f)}};a.h.va.foreach=!1;a.f.aa.foreach=!0;a.d.hasfocus={init:function(b,c,d){function e(e){b.__ko_hasfocusUpdating=!0;var f=b.ownerDocument;if("activeElement"in f){var g;try{g=f.activeElement}catch(k){g=f.body}e=g===b}f=c();a.h.Ga(f,d,"hasfocus",e,!0);b.__ko_hasfocusLastValue=e;b.__ko_hasfocusUpdating=!1}var f=e.bind(null,!0),g=e.bind(null,!1);a.a.q(b,"focus",f);a.a.q(b,"focusin",f);a.a.q(b,"blur",g);a.a.q(b,"focusout",g)},update:function(b,c){var d=!!a.a.c(c());b.__ko_hasfocusUpdating||b.__ko_hasfocusLastValue===
d||(d?b.focus():b.blur(),!d&&b.__ko_hasfocusLastValue&&b.ownerDocument.body.focus(),a.l.w(a.a.Fa,null,[b,d?"focusin":"focusout"]))}};a.h.ga.hasfocus=!0;a.d.hasFocus=a.d.hasfocus;a.h.ga.hasFocus=!0;a.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(b,c){a.a.Eb(b,c())}};K("if");K("ifnot",!1,!0);K("with",!0,!1,function(a,c){return a.ac(c)});var L={};a.d.options={init:function(b){if("select"!==a.a.A(b))throw Error("options binding applies only to SELECT elements");for(;0<
b.length;)b.remove(0);return{controlsDescendantBindings:!0}},update:function(b,c,d){function e(){return a.a.Ma(b.options,function(a){return a.selected})}function f(a,b,c){var d=typeof b;return"function"==d?b(a):"string"==d?a[b]:c}function g(c,e){if(A&&k)a.j.ja(b,a.a.c(d.get("value")),!0);else if(p.length){var f=0<=a.a.o(p,a.j.u(e[0]));a.a.wc(e[0],f);A&&!f&&a.l.w(a.a.Fa,null,[b,"change"])}}var h=b.multiple,l=0!=b.length&&h?b.scrollTop:null,m=a.a.c(c()),k=d.get("valueAllowUnset")&&d.has("value"),r=
d.get("optionsIncludeDestroyed");c={};var q,p=[];k||(h?p=a.a.ib(e(),a.j.u):0<=b.selectedIndex&&p.push(a.j.u(b.options[b.selectedIndex])));m&&("undefined"==typeof m.length&&(m=[m]),q=a.a.Ma(m,function(b){return r||b===n||null===b||!a.a.c(b._destroy)}),d.has("optionsCaption")&&(m=a.a.c(d.get("optionsCaption")),null!==m&&m!==n&&q.unshift(L)));var A=!1;c.beforeRemove=function(a){b.removeChild(a)};m=g;d.has("optionsAfterRender")&&"function"==typeof d.get("optionsAfterRender")&&(m=function(b,c){g(0,c);
a.l.w(d.get("optionsAfterRender"),null,[c[0],b!==L?b:n])});a.a.Db(b,q,function(c,e,g){g.length&&(p=!k&&g[0].selected?[a.j.u(g[0])]:[],A=!0);e=b.ownerDocument.createElement("option");c===L?(a.a.bb(e,d.get("optionsCaption")),a.j.ja(e,n)):(g=f(c,d.get("optionsValue"),c),a.j.ja(e,a.a.c(g)),c=f(c,d.get("optionsText"),g),a.a.bb(e,c));return[e]},c,m);a.l.w(function(){k?a.j.ja(b,a.a.c(d.get("value")),!0):(h?p.length&&e().length<p.length:p.length&&0<=b.selectedIndex?a.j.u(b.options[b.selectedIndex])!==p[0]:
p.length||0<=b.selectedIndex)&&a.a.Fa(b,"change")});a.a.Sc(b);l&&20<Math.abs(l-b.scrollTop)&&(b.scrollTop=l)}};a.d.options.zb=a.a.e.J();a.d.selectedOptions={after:["options","foreach"],init:function(b,c,d){a.a.q(b,"change",function(){var e=c(),f=[];a.a.r(b.getElementsByTagName("option"),function(b){b.selected&&f.push(a.j.u(b))});a.h.Ga(e,d,"selectedOptions",f)})},update:function(b,c){if("select"!=a.a.A(b))throw Error("values binding applies only to SELECT elements");var d=a.a.c(c()),e=b.scrollTop;
d&&"number"==typeof d.length&&a.a.r(b.getElementsByTagName("option"),function(b){var c=0<=a.a.o(d,a.j.u(b));b.selected!=c&&a.a.wc(b,c)});b.scrollTop=e}};a.h.ga.selectedOptions=!0;a.d.style={update:function(b,c){var d=a.a.c(c()||{});a.a.D(d,function(c,d){d=a.a.c(d);if(null===d||d===n||!1===d)d="";b.style[c]=d})}};a.d.submit={init:function(b,c,d,e,f){if("function"!=typeof c())throw Error("The value for a submit binding must be a function");a.a.q(b,"submit",function(a){var d,e=c();try{d=e.call(f.$data,
b)}finally{!0!==d&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}})}};a.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(b,c){a.a.bb(b,c())}};a.f.aa.text=!0;(function(){if(x&&x.navigator)var b=function(a){if(a)return parseFloat(a[1])},c=x.opera&&x.opera.version&&parseInt(x.opera.version()),d=x.navigator.userAgent,e=b(d.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),f=b(d.match(/Firefox\/([^ ]*)/));if(10>a.a.C)var g=a.a.e.J(),h=a.a.e.J(),l=function(b){var c=
this.activeElement;(c=c&&a.a.e.get(c,h))&&c(b)},m=function(b,c){var d=b.ownerDocument;a.a.e.get(d,g)||(a.a.e.set(d,g,!0),a.a.q(d,"selectionchange",l));a.a.e.set(b,h,c)};a.d.textInput={init:function(b,d,g){function l(c,d){a.a.q(b,c,d)}function h(){var c=a.a.c(d());if(null===c||c===n)c="";u!==n&&c===u?a.a.setTimeout(h,4):b.value!==c&&(s=c,b.value=c)}function y(){t||(u=b.value,t=a.a.setTimeout(v,4))}function v(){clearTimeout(t);u=t=n;var c=b.value;s!==c&&(s=c,a.h.Ga(d(),g,"textInput",c))}var s=b.value,
t,u,x=9==a.a.C?y:v;10>a.a.C?(l("propertychange",function(a){"value"===a.propertyName&&x(a)}),8==a.a.C&&(l("keyup",v),l("keydown",v)),8<=a.a.C&&(m(b,x),l("dragend",y))):(l("input",v),5>e&&"textarea"===a.a.A(b)?(l("keydown",y),l("paste",y),l("cut",y)):11>c?l("keydown",y):4>f&&(l("DOMAutoComplete",v),l("dragdrop",v),l("drop",v)));l("change",v);a.m(h,null,{i:b})}};a.h.ga.textInput=!0;a.d.textinput={preprocess:function(a,b,c){c("textInput",a)}}})();a.d.uniqueName={init:function(b,c){if(c()){var d="ko_unique_"+
++a.d.uniqueName.Nc;a.a.vc(b,d)}}};a.d.uniqueName.Nc=0;a.d.value={after:["options","foreach"],init:function(b,c,d){if("input"!=b.tagName.toLowerCase()||"checkbox"!=b.type&&"radio"!=b.type){var e=["change"],f=d.get("valueUpdate"),g=!1,h=null;f&&("string"==typeof f&&(f=[f]),a.a.ta(e,f),e=a.a.Wb(e));var l=function(){h=null;g=!1;var e=c(),f=a.j.u(b);a.h.Ga(e,d,"value",f)};!a.a.C||"input"!=b.tagName.toLowerCase()||"text"!=b.type||"off"==b.autocomplete||b.form&&"off"==b.form.autocomplete||-1!=a.a.o(e,"propertychange")||
(a.a.q(b,"propertychange",function(){g=!0}),a.a.q(b,"focus",function(){g=!1}),a.a.q(b,"blur",function(){g&&l()}));a.a.r(e,function(c){var d=l;a.a.sd(c,"after")&&(d=function(){h=a.j.u(b);a.a.setTimeout(l,0)},c=c.substring(5));a.a.q(b,c,d)});var m=function(){var e=a.a.c(c()),f=a.j.u(b);if(null!==h&&e===h)a.a.setTimeout(m,0);else if(e!==f)if("select"===a.a.A(b)){var g=d.get("valueAllowUnset"),f=function(){a.j.ja(b,e,g)};f();g||e===a.j.u(b)?a.a.setTimeout(f,0):a.l.w(a.a.Fa,null,[b,"change"])}else a.j.ja(b,
e)};a.m(m,null,{i:b})}else a.La(b,{checkedValue:c})},update:function(){}};a.h.ga.value=!0;a.d.visible={update:function(b,c){var d=a.a.c(c()),e="none"!=b.style.display;d&&!e?b.style.display="":!d&&e&&(b.style.display="none")}};(function(b){a.d[b]={init:function(c,d,e,f,g){return a.d.event.init.call(this,c,function(){var a={};a[b]=d();return a},e,f,g)}}})("click");a.P=function(){};a.P.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource");};a.P.prototype.createJavaScriptEvaluatorBlock=
function(){throw Error("Override createJavaScriptEvaluatorBlock");};a.P.prototype.makeTemplateSource=function(b,c){if("string"==typeof b){c=c||t;var d=c.getElementById(b);if(!d)throw Error("Cannot find template with ID "+b);return new a.v.n(d)}if(1==b.nodeType||8==b.nodeType)return new a.v.sa(b);throw Error("Unknown template type: "+b);};a.P.prototype.renderTemplate=function(a,c,d,e){a=this.makeTemplateSource(a,e);return this.renderTemplateSource(a,c,d,e)};a.P.prototype.isTemplateRewritten=function(a,
c){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(a,c).data("isRewritten")};a.P.prototype.rewriteTemplate=function(a,c,d){a=this.makeTemplateSource(a,d);c=c(a.text());a.text(c);a.data("isRewritten",!0)};a.b("templateEngine",a.P);a.Ib=function(){function b(b,c,d,h){b=a.h.Ab(b);for(var l=a.h.va,m=0;m<b.length;m++){var k=b[m].key;if(l.hasOwnProperty(k)){var r=l[k];if("function"===typeof r){if(k=r(b[m].value))throw Error(k);}else if(!r)throw Error("This template engine does not support the '"+
k+"' binding within its templates");}}d="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+a.h.Xa(b,{valueAccessors:!0})+" } })()},'"+d.toLowerCase()+"')";return h.createJavaScriptEvaluatorBlock(d)+c}var c=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,d=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Tc:function(b,c,d){c.isTemplateRewritten(b,d)||c.rewriteTemplate(b,function(b){return a.Ib.jd(b,
c)},d)},jd:function(a,f){return a.replace(c,function(a,c,d,e,k){return b(k,c,d,f)}).replace(d,function(a,c){return b(c,"\x3c!-- ko --\x3e","#comment",f)})},Jc:function(b,c){return a.N.yb(function(d,h){var l=d.nextSibling;l&&l.nodeName.toLowerCase()===c&&a.La(l,b,h)})}}}();a.b("__tr_ambtns",a.Ib.Jc);(function(){a.v={};a.v.n=function(b){if(this.n=b){var c=a.a.A(b);this.eb="script"===c?1:"textarea"===c?2:"template"==c&&b.content&&11===b.content.nodeType?3:4}};a.v.n.prototype.text=function(){var b=1===
this.eb?"text":2===this.eb?"value":"innerHTML";if(0==arguments.length)return this.n[b];var c=arguments[0];"innerHTML"===b?a.a.Eb(this.n,c):this.n[b]=c};var b=a.a.e.J()+"_";a.v.n.prototype.data=function(c){if(1===arguments.length)return a.a.e.get(this.n,b+c);a.a.e.set(this.n,b+c,arguments[1])};var c=a.a.e.J();a.v.n.prototype.nodes=function(){var b=this.n;if(0==arguments.length)return(a.a.e.get(b,c)||{}).mb||(3===this.eb?b.content:4===this.eb?b:n);a.a.e.set(b,c,{mb:arguments[0]})};a.v.sa=function(a){this.n=
a};a.v.sa.prototype=new a.v.n;a.v.sa.prototype.text=function(){if(0==arguments.length){var b=a.a.e.get(this.n,c)||{};b.Jb===n&&b.mb&&(b.Jb=b.mb.innerHTML);return b.Jb}a.a.e.set(this.n,c,{Jb:arguments[0]})};a.b("templateSources",a.v);a.b("templateSources.domElement",a.v.n);a.b("templateSources.anonymousTemplate",a.v.sa)})();(function(){function b(b,c,d){var e;for(c=a.f.nextSibling(c);b&&(e=b)!==c;)b=a.f.nextSibling(e),d(e,b)}function c(c,d){if(c.length){var e=c[0],f=c[c.length-1],g=e.parentNode,h=
a.S.instance,n=h.preprocessNode;if(n){b(e,f,function(a,b){var c=a.previousSibling,d=n.call(h,a);d&&(a===e&&(e=d[0]||b),a===f&&(f=d[d.length-1]||c))});c.length=0;if(!e)return;e===f?c.push(e):(c.push(e,f),a.a.Ba(c,g))}b(e,f,function(b){1!==b.nodeType&&8!==b.nodeType||a.Ub(d,b)});b(e,f,function(b){1!==b.nodeType&&8!==b.nodeType||a.N.Cc(b,[d])});a.a.Ba(c,g)}}function d(a){return a.nodeType?a:0<a.length?a[0]:null}function e(b,e,f,h,q){q=q||{};var p=(b&&d(b)||f||{}).ownerDocument,n=q.templateEngine||g;
a.Ib.Tc(f,n,p);f=n.renderTemplate(f,h,q,p);if("number"!=typeof f.length||0<f.length&&"number"!=typeof f[0].nodeType)throw Error("Template engine must return an array of DOM nodes");p=!1;switch(e){case "replaceChildren":a.f.fa(b,f);p=!0;break;case "replaceNode":a.a.uc(b,f);p=!0;break;case "ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+e);}p&&(c(f,h),q.afterRender&&a.l.w(q.afterRender,null,[f,h.$data]));return f}function f(b,c,d){return a.I(b)?b():"function"===typeof b?b(c,d):b}
var g;a.Fb=function(b){if(b!=n&&!(b instanceof a.P))throw Error("templateEngine must inherit from ko.templateEngine");g=b};a.Cb=function(b,c,k,h,q){k=k||{};if((k.templateEngine||g)==n)throw Error("Set a template engine before calling renderTemplate");q=q||"replaceChildren";if(h){var p=d(h);return a.B(function(){var g=c&&c instanceof a.R?c:new a.R(c,null,null,null,{exportDependencies:!0}),n=f(b,g.$data,g),g=e(h,q,n,g,k);"replaceNode"==q&&(h=g,p=d(h))},null,{ya:function(){return!p||!a.a.qb(p)},i:p&&
"replaceNode"==q?p.parentNode:p})}return a.N.yb(function(d){a.Cb(b,c,k,d,"replaceNode")})};a.pd=function(b,d,g,h,q){function p(a,b){c(b,t);g.afterRender&&g.afterRender(b,a);t=null}function s(a,c){t=q.createChildContext(a,g.as,function(a){a.$index=c});var d=f(b,a,t);return e(null,"ignoreTargetNode",d,t,g)}var t;return a.B(function(){var b=a.a.c(d)||[];"undefined"==typeof b.length&&(b=[b]);b=a.a.Ma(b,function(b){return g.includeDestroyed||b===n||null===b||!a.a.c(b._destroy)});a.l.w(a.a.Db,null,[h,b,
s,g,p])},null,{i:h})};var h=a.a.e.J();a.d.template={init:function(b,c){var d=a.a.c(c());if("string"==typeof d||d.name)a.f.za(b);else{if("nodes"in d){if(d=d.nodes||[],a.I(d))throw Error('The "nodes" option must be a plain, non-observable array.');}else d=a.f.childNodes(b);d=a.a.nc(d);(new a.v.sa(b)).nodes(d)}return{controlsDescendantBindings:!0}},update:function(b,c,d,e,f){var g=c();c=a.a.c(g);d=!0;e=null;"string"==typeof c?c={}:(g=c.name,"if"in c&&(d=a.a.c(c["if"])),d&&"ifnot"in c&&(d=!a.a.c(c.ifnot)));
"foreach"in c?e=a.pd(g||b,d&&c.foreach||[],c,b,f):d?(f="data"in c?f.ac(c.data,c.as):f,e=a.Cb(g||b,f,c,b)):a.f.za(b);f=e;(c=a.a.e.get(b,h))&&"function"==typeof c.k&&c.k();a.a.e.set(b,h,f&&f.ca()?f:n)}};a.h.va.template=function(b){b=a.h.Ab(b);return 1==b.length&&b[0].unknown||a.h.fd(b,"name")?null:"This template engine does not support anonymous templates nested within its templates"};a.f.aa.template=!0})();a.b("setTemplateEngine",a.Fb);a.b("renderTemplate",a.Cb);a.a.hc=function(a,c,d){if(a.length&&
c.length){var e,f,g,h,l;for(e=f=0;(!d||e<d)&&(h=a[f]);++f){for(g=0;l=c[g];++g)if(h.value===l.value){h.moved=l.index;l.moved=h.index;c.splice(g,1);e=g=0;break}e+=g}}};a.a.lb=function(){function b(b,d,e,f,g){var h=Math.min,l=Math.max,m=[],k,n=b.length,q,p=d.length,s=p-n||1,t=n+p+1,v,u,x;for(k=0;k<=n;k++)for(u=v,m.push(v=[]),x=h(p,k+s),q=l(0,k-1);q<=x;q++)v[q]=q?k?b[k-1]===d[q-1]?u[q-1]:h(u[q]||t,v[q-1]||t)+1:q+1:k+1;h=[];l=[];s=[];k=n;for(q=p;k||q;)p=m[k][q]-1,q&&p===m[k][q-1]?l.push(h[h.length]={status:e,
value:d[--q],index:q}):k&&p===m[k-1][q]?s.push(h[h.length]={status:f,value:b[--k],index:k}):(--q,--k,g.sparse||h.push({status:"retained",value:d[q]}));a.a.hc(s,l,!g.dontLimitMoves&&10*n);return h.reverse()}return function(a,d,e){e="boolean"===typeof e?{dontLimitMoves:e}:e||{};a=a||[];d=d||[];return a.length<d.length?b(a,d,"added","deleted",e):b(d,a,"deleted","added",e)}}();a.b("utils.compareArrays",a.a.lb);(function(){function b(b,c,d,h,l){var m=[],k=a.B(function(){var k=c(d,l,a.a.Ba(m,b))||[];0<
m.length&&(a.a.uc(m,k),h&&a.l.w(h,null,[d,k,l]));m.length=0;a.a.ta(m,k)},null,{i:b,ya:function(){return!a.a.Tb(m)}});return{ea:m,B:k.ca()?k:n}}var c=a.a.e.J(),d=a.a.e.J();a.a.Db=function(e,f,g,h,l){function m(b,c){w=q[c];u!==c&&(D[b]=w);w.tb(u++);a.a.Ba(w.ea,e);t.push(w);z.push(w)}function k(b,c){if(b)for(var d=0,e=c.length;d<e;d++)c[d]&&a.a.r(c[d].ea,function(a){b(a,d,c[d].ka)})}f=f||[];h=h||{};var r=a.a.e.get(e,c)===n,q=a.a.e.get(e,c)||[],p=a.a.ib(q,function(a){return a.ka}),s=a.a.lb(p,f,h.dontLimitMoves),
t=[],v=0,u=0,x=[],z=[];f=[];for(var D=[],p=[],w,C=0,B,E;B=s[C];C++)switch(E=B.moved,B.status){case "deleted":E===n&&(w=q[v],w.B&&(w.B.k(),w.B=n),a.a.Ba(w.ea,e).length&&(h.beforeRemove&&(t.push(w),z.push(w),w.ka===d?w=null:f[C]=w),w&&x.push.apply(x,w.ea)));v++;break;case "retained":m(C,v++);break;case "added":E!==n?m(C,E):(w={ka:B.value,tb:a.O(u++)},t.push(w),z.push(w),r||(p[C]=w))}a.a.e.set(e,c,t);k(h.beforeMove,D);a.a.r(x,h.beforeRemove?a.ba:a.removeNode);for(var C=0,r=a.f.firstChild(e),F;w=z[C];C++){w.ea||
a.a.extend(w,b(e,g,w.ka,l,w.tb));for(v=0;s=w.ea[v];r=s.nextSibling,F=s,v++)s!==r&&a.f.kc(e,s,F);!w.ad&&l&&(l(w.ka,w.ea,w.tb),w.ad=!0)}k(h.beforeRemove,f);for(C=0;C<f.length;++C)f[C]&&(f[C].ka=d);k(h.afterMove,D);k(h.afterAdd,p)}})();a.b("utils.setDomNodeChildrenFromArrayMapping",a.a.Db);a.X=function(){this.allowTemplateRewriting=!1};a.X.prototype=new a.P;a.X.prototype.renderTemplateSource=function(b,c,d,e){if(c=(9>a.a.C?0:b.nodes)?b.nodes():null)return a.a.W(c.cloneNode(!0).childNodes);b=b.text();
return a.a.na(b,e)};a.X.vb=new a.X;a.Fb(a.X.vb);a.b("nativeTemplateEngine",a.X);(function(){a.xb=function(){var a=this.ed=function(){if(!u||!u.tmpl)return 0;try{if(0<=u.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(a){}return 1}();this.renderTemplateSource=function(b,e,f,g){g=g||t;f=f||{};if(2>a)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var h=b.data("precompiled");h||(h=b.text()||"",h=u.template(null,"{{ko_with $item.koBindingContext}}"+
h+"{{/ko_with}}"),b.data("precompiled",h));b=[e.$data];e=u.extend({koBindingContext:e},f.templateOptions);e=u.tmpl(h,b,e);e.appendTo(g.createElement("div"));u.fragments={};return e};this.createJavaScriptEvaluatorBlock=function(a){return"{{ko_code ((function() { return "+a+" })()) }}"};this.addTemplate=function(a,b){t.write("<script type='text/html' id='"+a+"'>"+b+"\x3c/script>")};0<a&&(u.tmpl.tag.ko_code={open:"__.push($1 || '');"},u.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};a.xb.prototype=
new a.P;var b=new a.xb;0<b.ed&&a.Fb(b);a.b("jqueryTmplTemplateEngine",a.xb)})()})})();})();

/*=============================================================================
	Author:			Eric M. Barnard - @ericmbarnard								
	License:		MIT (http://opensource.org/licenses/mit-license.php)		
																				
	Description:	Validation Library for KnockoutJS							
	Version:		2.0.0											
===============================================================================
*/
/*globals require: false, exports: false, define: false, ko: false */

(function (factory) {
	// Module systems magic dance.

	if (typeof require === "function" && typeof exports === "object" && typeof module === "object") {
		// CommonJS or Node: hard-coded dependency on "knockout"
		factory(require("knockout"), exports);
	} else if (typeof define === "function" && define["amd"]) {
		// AMD anonymous module with hard-coded dependency on "knockout"
		define(["knockout", "exports"], factory);
	} else {
		// <script> tag: use the global `ko` object, attaching a `mapping` property
		factory(ko, ko.validation = {});
	}
}(function ( ko, exports ) {

	if (typeof (ko) === 'undefined') {
		throw new Error('Knockout is required, please ensure it is loaded before loading this validation plug-in');
	}

	// create our namespace object
	ko.validation = exports;

	var kv = ko.validation,
		koUtils = ko.utils,
		unwrap = koUtils.unwrapObservable,
		forEach = koUtils.arrayForEach,
		extend = koUtils.extend;
;/*global ko: false*/

var defaults = {
	registerExtenders: true,
	messagesOnModified: true,
	errorsAsTitle: true,            // enables/disables showing of errors as title attribute of the target element.
	errorsAsTitleOnModified: false, // shows the error when hovering the input field (decorateElement must be true)
	messageTemplate: null,
	insertMessages: true,           // automatically inserts validation messages as <span></span>
	parseInputAttributes: false,    // parses the HTML5 validation attribute from a form element and adds that to the object
	writeInputAttributes: false,    // adds HTML5 input validation attributes to form elements that ko observable's are bound to
	decorateInputElement: false,         // false to keep backward compatibility
	decorateElementOnModified: true,// true to keep backward compatibility
	errorClass: null,               // single class for error message and element
	errorElementClass: 'validationElement',  // class to decorate error element
	errorMessageClass: 'validationMessage',  // class to decorate error message
	allowHtmlMessages: false,		// allows HTML in validation messages
	grouping: {
		deep: false,        //by default grouping is shallow
		observable: true,   //and using observables
		live: false		    //react to changes to observableArrays if observable === true
	},
	validate: {
		// throttle: 10
	}
};

// make a copy  so we can use 'reset' later
var configuration = extend({}, defaults);

configuration.html5Attributes = ['required', 'pattern', 'min', 'max', 'step'];
configuration.html5InputTypes = ['email', 'number', 'date'];

configuration.reset = function () {
	extend(configuration, defaults);
};

kv.configuration = configuration;
;kv.utils = (function () {
	var seedId = new Date().getTime();

	var domData = {}; //hash of data objects that we reference from dom elements
	var domDataKey = '__ko_validation__';

	return {
		isArray: function (o) {
			return o.isArray || Object.prototype.toString.call(o) === '[object Array]';
		},
		isObject: function (o) {
			return o !== null && typeof o === 'object';
		},
		isNumber: function(o) {
			return !isNaN(o);	
		},
		isObservableArray: function(instance) {
			return !!instance &&
					typeof instance["remove"] === "function" &&
					typeof instance["removeAll"] === "function" &&
					typeof instance["destroy"] === "function" &&
					typeof instance["destroyAll"] === "function" &&
					typeof instance["indexOf"] === "function" &&
					typeof instance["replace"] === "function";
		},
		values: function (o) {
			var r = [];
			for (var i in o) {
				if (o.hasOwnProperty(i)) {
					r.push(o[i]);
				}
			}
			return r;
		},
		getValue: function (o) {
			return (typeof o === 'function' ? o() : o);
		},
		hasAttribute: function (node, attr) {
			return node.getAttribute(attr) !== null;
		},
		getAttribute: function (element, attr) {
			return element.getAttribute(attr);
		},
		setAttribute: function (element, attr, value) {
			return element.setAttribute(attr, value);
		},
		isValidatable: function (o) {
			return !!(o && o.rules && o.isValid && o.isModified);
		},
		insertAfter: function (node, newNode) {
			node.parentNode.insertBefore(newNode, node.nextSibling);
		},
		newId: function () {
			return seedId += 1;
		},
		getConfigOptions: function (element) {
			var options = kv.utils.contextFor(element);

			return options || kv.configuration;
		},
		setDomData: function (node, data) {
			var key = node[domDataKey];

			if (!key) {
				node[domDataKey] = key = kv.utils.newId();
			}

			domData[key] = data;
		},
		getDomData: function (node) {
			var key = node[domDataKey];

			if (!key) {
				return undefined;
			}

			return domData[key];
		},
		contextFor: function (node) {
			switch (node.nodeType) {
				case 1:
				case 8:
					var context = kv.utils.getDomData(node);
					if (context) { return context; }
					if (node.parentNode) { return kv.utils.contextFor(node.parentNode); }
					break;
			}
			return undefined;
		},
		isEmptyVal: function (val) {
			if (val === undefined) {
				return true;
			}
			if (val === null) {
				return true;
			}
			if (val === "") {
				return true;
			}
		},
		getOriginalElementTitle: function (element) {
			var savedOriginalTitle = kv.utils.getAttribute(element, 'data-orig-title'),
				currentTitle = element.title,
				hasSavedOriginalTitle = kv.utils.hasAttribute(element, 'data-orig-title');

			return hasSavedOriginalTitle ?
				savedOriginalTitle : currentTitle;
		},
		async: function (expr) {
			if (window.setImmediate) { window.setImmediate(expr); }
			else { window.setTimeout(expr, 0); }
		},
		forEach: function (object, callback) {
			if (kv.utils.isArray(object)) {
				return forEach(object, callback);
			}
			for (var prop in object) {
				if (object.hasOwnProperty(prop)) {
					callback(object[prop], prop);
				}
			}
		}
	};
}());;var api = (function () {

	var isInitialized = 0,
		configuration = kv.configuration,
		utils = kv.utils;

	function cleanUpSubscriptions(context) {
		forEach(context.subscriptions, function (subscription) {
			subscription.dispose();
		});
		context.subscriptions = [];
	}

	function dispose(context) {
		if (context.options.deep) {
			forEach(context.flagged, function (obj) {
				delete obj.__kv_traversed;
			});
			context.flagged.length = 0;
		}

		if (!context.options.live) {
			cleanUpSubscriptions(context);
		}
	}

	function runTraversal(obj, context) {
		context.validatables = [];
		cleanUpSubscriptions(context);
		traverseGraph(obj, context);
		dispose(context);
	}

	function traverseGraph(obj, context, level) {
		var objValues = [],
			val = obj.peek ? obj.peek() : obj;

		if (obj.__kv_traversed === true) {
			return;
		}

		if (context.options.deep) {
			obj.__kv_traversed = true;
			context.flagged.push(obj);
		}

		//default level value depends on deep option.
		level = (level !== undefined ? level : context.options.deep ? 1 : -1);

		// if object is observable then add it to the list
		if (ko.isObservable(obj)) {
			// ensure it's validatable but don't extend validatedObservable because it
			// would overwrite isValid property.
			if (!obj.errors && !utils.isValidatable(obj)) {
				obj.extend({ validatable: true });
			}
			context.validatables.push(obj);

			if (context.options.live && utils.isObservableArray(obj)) {
				context.subscriptions.push(obj.subscribe(function () {
					context.graphMonitor.valueHasMutated();
				}));
			}
		}

		//get list of values either from array or object but ignore non-objects
		// and destroyed objects
		if (val && !val._destroy) {
			if (utils.isArray(val)) {
				objValues = val;
			}
			else if (utils.isObject(val)) {
				objValues = utils.values(val);
			}
		}

		//process recursively if it is deep grouping
		if (level !== 0) {
			utils.forEach(objValues, function (observable) {
				//but not falsy things and not HTML Elements
				if (observable && !observable.nodeType && (!ko.isComputed(observable) || observable.rules)) {
					traverseGraph(observable, context, level + 1);
				}
			});
		}
	}

	function collectErrors(array) {
		var errors = [];
		forEach(array, function (observable) {
			// Do not collect validatedObservable errors
			if (utils.isValidatable(observable) && !observable.isValid()) {
				// Use peek because we don't want a dependency for 'error' property because it
				// changes before 'isValid' does. (Issue #99)
				errors.push(observable.error.peek());
			}
		});
		return errors;
	}

	return {
		//Call this on startup
		//any config can be overridden with the passed in options
		init: function (options, force) {
			//done run this multiple times if we don't really want to
			if (isInitialized > 0 && !force) {
				return;
			}

			//because we will be accessing options properties it has to be an object at least
			options = options || {};
			//if specific error classes are not provided then apply generic errorClass
			//it has to be done on option so that options.errorClass can override default
			//errorElementClass and errorMessage class but not those provided in options
			options.errorElementClass = options.errorElementClass || options.errorClass || configuration.errorElementClass;
			options.errorMessageClass = options.errorMessageClass || options.errorClass || configuration.errorMessageClass;

			extend(configuration, options);

			if (configuration.registerExtenders) {
				kv.registerExtenders();
			}

			isInitialized = 1;
		},

		// resets the config back to its original state
		reset: kv.configuration.reset,

		// recursively walks a viewModel and creates an object that
		// provides validation information for the entire viewModel
		// obj -> the viewModel to walk
		// options -> {
		//	  deep: false, // if true, will walk past the first level of viewModel properties
		//	  observable: false // if true, returns a computed observable indicating if the viewModel is valid
		// }
		group: function group(obj, options) { // array of observables or viewModel
			options = extend(extend({}, configuration.grouping), options);

			var context = {
				options: options,
				graphMonitor: ko.observable(),
				flagged: [],
				subscriptions: [],
				validatables: []
			};

			var result = null;

			//if using observables then traverse structure once and add observables
			if (options.observable) {
				result = ko.computed(function () {
					context.graphMonitor(); //register dependency
					runTraversal(obj, context);
					return collectErrors(context.validatables);
				});
			}
			else { //if not using observables then every call to error() should traverse the structure
				result = function () {
					runTraversal(obj, context);
					return collectErrors(context.validatables);
				};
			}

			result.showAllMessages = function (show) { // thanks @heliosPortal
				if (show === undefined) {//default to true
					show = true;
				}

				result.forEach(function (observable) {
					if (utils.isValidatable(observable)) {
						observable.isModified(show);
					}
				});
			};

			result.isAnyMessageShown = function () {
				var invalidAndModifiedPresent;

				invalidAndModifiedPresent = !!result.find(function (observable) {
					return utils.isValidatable(observable) && !observable.isValid() && observable.isModified();
				});
				return invalidAndModifiedPresent;
			};

			result.filter = function(predicate) {
				predicate = predicate || function () { return true; };
				// ensure we have latest changes
				result();

				return koUtils.arrayFilter(context.validatables, predicate);
			};

			result.find = function(predicate) {
				predicate = predicate || function () { return true; };
				// ensure we have latest changes
				result();

				return koUtils.arrayFirst(context.validatables, predicate);
			};

			result.forEach = function(callback) {
				callback = callback || function () { };
				// ensure we have latest changes
				result();

				forEach(context.validatables, callback);
			};

			result.map = function(mapping) {
				mapping = mapping || function (item) { return item; };
				// ensure we have latest changes
				result();

				return koUtils.arrayMap(context.validatables, mapping);
			};

			/**
			 * @private You should not rely on this method being here.
			 * It's a private method and it may change in the future.
			 *
			 * @description Updates the validated object and collects errors from it.
			 */
			result._updateState = function(newValue) {
				if (!utils.isObject(newValue)) {
					throw new Error('An object is required.');
				}
				obj = newValue;
				if (options.observable) {
					context.graphMonitor.valueHasMutated();
				}
				else {
					runTraversal(newValue, context);
					return collectErrors(context.validatables);
				}
			};
			return result;
		},

		formatMessage: function (message, params, observable) {
			if (utils.isObject(params) && params.typeAttr) {
				params = params.value;
			}
			if (typeof (message) === 'function') {
				return message(params, observable);
			}
			var replacements = unwrap(params) || [];
			if (!utils.isArray(replacements)) {
				replacements = [replacements];
			}
			return message.replace(/{(\d+)}/gi, function(match, index) {
				if (typeof replacements[index] !== 'undefined') {
					return replacements[index];
				}
				return match;
			});
		},

		// addRule:
		// This takes in a ko.observable and a Rule Context - which is just a rule name and params to supply to the validator
		// ie: kv.addRule(myObservable, {
		//		  rule: 'required',
		//		  params: true
		//	  });
		//
		addRule: function (observable, rule) {
			observable.extend({ validatable: true });

			var hasRule = !!koUtils.arrayFirst(observable.rules(), function(item) {
				return item.rule && item.rule === rule.rule;
			});

			if (!hasRule) {
				//push a Rule Context to the observables local array of Rule Contexts
				observable.rules.push(rule);
			}
			return observable;
		},

		// addAnonymousRule:
		// Anonymous Rules essentially have all the properties of a Rule, but are only specific for a certain property
		// and developers typically are wanting to add them on the fly or not register a rule with the 'kv.rules' object
		//
		// Example:
		// var test = ko.observable('something').extend{(
		//	  validation: {
		//		  validator: function(val, someOtherVal){
		//			  return true;
		//		  },
		//		  message: "Something must be really wrong!',
		//		  params: true
		//	  }
		//  )};
		addAnonymousRule: function (observable, ruleObj) {
			if (ruleObj['message'] === undefined) {
				ruleObj['message'] = 'Error';
			}

			//make sure onlyIf is honoured
			if (ruleObj.onlyIf) {
				ruleObj.condition = ruleObj.onlyIf;
			}

			//add the anonymous rule to the observable
			kv.addRule(observable, ruleObj);
		},

		addExtender: function (ruleName) {
			ko.extenders[ruleName] = function (observable, params) {
				//params can come in a few flavors
				// 1. Just the params to be passed to the validator
				// 2. An object containing the Message to be used and the Params to pass to the validator
				// 3. A condition when the validation rule to be applied
				//
				// Example:
				// var test = ko.observable(3).extend({
				//	  max: {
				//		  message: 'This special field has a Max of {0}',
				//		  params: 2,
				//		  onlyIf: function() {
				//					  return specialField.IsVisible();
				//				  }
				//	  }
				//  )};
				//
				if (params && (params.message || params.onlyIf)) { //if it has a message or condition object, then its an object literal to use
					return kv.addRule(observable, {
						rule: ruleName,
						message: params.message,
						params: utils.isEmptyVal(params.params) ? true : params.params,
						condition: params.onlyIf
					});
				} else {
					return kv.addRule(observable, {
						rule: ruleName,
						params: params
					});
				}
			};
		},

		// loops through all kv.rules and adds them as extenders to
		// ko.extenders
		registerExtenders: function () { // root extenders optional, use 'validation' extender if would cause conflicts
			if (configuration.registerExtenders) {
				for (var ruleName in kv.rules) {
					if (kv.rules.hasOwnProperty(ruleName)) {
						if (!ko.extenders[ruleName]) {
							kv.addExtender(ruleName);
						}
					}
				}
			}
		},

		//creates a span next to the @element with the specified error class
		insertValidationMessage: function (element) {
			var span = document.createElement('SPAN');
			span.className = utils.getConfigOptions(element).errorMessageClass;
			utils.insertAfter(element, span);
			return span;
		},

		// if html-5 validation attributes have been specified, this parses
		// the attributes on @element
		parseInputValidationAttributes: function (element, valueAccessor) {
			forEach(kv.configuration.html5Attributes, function (attr) {
				if (utils.hasAttribute(element, attr)) {

					var params = element.getAttribute(attr) || true;

					if (attr === 'min' || attr === 'max')
					{
						// If we're validating based on the min and max attributes, we'll
						// need to know what the 'type' attribute is set to
						var typeAttr = element.getAttribute('type');
						if (typeof typeAttr === "undefined" || !typeAttr)
						{
							// From http://www.w3.org/TR/html-markup/input:
							//   An input element with no type attribute specified represents the
							//   same thing as an input element with its type attribute set to "text".
							typeAttr = "text";
						}
						params = {typeAttr: typeAttr, value: params};
					}

					kv.addRule(valueAccessor(), {
						rule: attr,
						params: params
					});
				}
			});

			var currentType = element.getAttribute('type');
			forEach(kv.configuration.html5InputTypes, function (type) {
				if (type === currentType) {
					kv.addRule(valueAccessor(), {
						rule: (type === 'date') ? 'dateISO' : type,
						params: true
					});
				}
			});
		},

		// writes html5 validation attributes on the element passed in
		writeInputValidationAttributes: function (element, valueAccessor) {
			var observable = valueAccessor();

			if (!observable || !observable.rules) {
				return;
			}

			var contexts = observable.rules(); // observable array

			// loop through the attributes and add the information needed
			forEach(kv.configuration.html5Attributes, function (attr) {
				var ctx = koUtils.arrayFirst(contexts, function (ctx) {
					return ctx.rule && ctx.rule.toLowerCase() === attr.toLowerCase();
				});

				if (!ctx) {
					return;
				}

				// we have a rule matching a validation attribute at this point
				// so lets add it to the element along with the params
				ko.computed({
					read: function() {
						var params = ko.unwrap(ctx.params);

						// we have to do some special things for the pattern validation
						if (ctx.rule === "pattern" && params instanceof RegExp) {
							// we need the pure string representation of the RegExpr without the //gi stuff
							params = params.source;
						}

						element.setAttribute(attr, params);
					},
					disposeWhenNodeIsRemoved: element
				});
			});

			contexts = null;
		},

		//take an existing binding handler and make it cause automatic validations
		makeBindingHandlerValidatable: function (handlerName) {
			var init = ko.bindingHandlers[handlerName].init;

			ko.bindingHandlers[handlerName].init = function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {

				init(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext);

				return ko.bindingHandlers['validationCore'].init(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext);
			};
		},

		// visit an objects properties and apply validation rules from a definition
		setRules: function (target, definition) {
			var setRules = function (target, definition) {
				if (!target || !definition) { return; }

				for (var prop in definition) {
					if (!definition.hasOwnProperty(prop)) { continue; }
					var ruleDefinitions = definition[prop];

					//check the target property exists and has a value
					if (!target[prop]) { continue; }
					var targetValue = target[prop],
						unwrappedTargetValue = unwrap(targetValue),
						rules = {},
						nonRules = {};

					for (var rule in ruleDefinitions) {
						if (!ruleDefinitions.hasOwnProperty(rule)) { continue; }
						if (kv.rules[rule]) {
							rules[rule] = ruleDefinitions[rule];
						} else {
							nonRules[rule] = ruleDefinitions[rule];
						}
					}

					//apply rules
					if (ko.isObservable(targetValue)) {
						targetValue.extend(rules);
					}

					//then apply child rules
					//if it's an array, apply rules to all children
					if (unwrappedTargetValue && utils.isArray(unwrappedTargetValue)) {
						for (var i = 0; i < unwrappedTargetValue.length; i++) {
							setRules(unwrappedTargetValue[i], nonRules);
						}
						//otherwise, just apply to this property
					} else {
						setRules(unwrappedTargetValue, nonRules);
					}
				}
			};
			setRules(target, definition);
		}
	};

}());

// expose api publicly
extend(ko.validation, api);
;//Validation Rules:
// You can view and override messages or rules via:
// kv.rules[ruleName]
//
// To implement a custom Rule, simply use this template:
// kv.rules['<custom rule name>'] = {
//      validator: function (val, param) {
//          <custom logic>
//          return <true or false>;
//      },
//      message: '<custom validation message>' //optionally you can also use a '{0}' to denote a placeholder that will be replaced with your 'param'
// };
//
// Example:
// kv.rules['mustEqual'] = {
//      validator: function( val, mustEqualVal ){
//          return val === mustEqualVal;
//      },
//      message: 'This field must equal {0}'
// };
//
kv.rules = {};
kv.rules['required'] = {
	validator: function (val, required) {
		var testVal;

		if (val === undefined || val === null) {
			return !required;
		}

		testVal = val;
		if (typeof (val) === 'string') {
			if (String.prototype.trim) {
				testVal = val.trim();
			}
			else {
				testVal = val.replace(/^\s+|\s+$/g, '');
			}
		}

		if (!required) {// if they passed: { required: false }, then don't require this
			return true;
		}

		return ((testVal + '').length > 0);
	},
	message: 'This field is required.'
};

function minMaxValidatorFactory(validatorName) {
    var isMaxValidation = validatorName === "max";

    return function (val, options) {
        if (kv.utils.isEmptyVal(val)) {
            return true;
        }

        var comparisonValue, type;
        if (options.typeAttr === undefined) {
            // This validator is being called from javascript rather than
            // being bound from markup
            type = "text";
            comparisonValue = options;
        } else {
            type = options.typeAttr;
            comparisonValue = options.value;
        }

        // From http://www.w3.org/TR/2012/WD-html5-20121025/common-input-element-attributes.html#attr-input-min,
        // if the value is parseable to a number, then the minimum should be numeric
        if (!isNaN(comparisonValue) && !(comparisonValue instanceof Date)) {
            type = "number";
        }

        var regex, valMatches, comparisonValueMatches;
        switch (type.toLowerCase()) {
            case "week":
                regex = /^(\d{4})-W(\d{2})$/;
                valMatches = val.match(regex);
                if (valMatches === null) {
                    throw new Error("Invalid value for " + validatorName + " attribute for week input.  Should look like " +
                        "'2000-W33' http://www.w3.org/TR/html-markup/input.week.html#input.week.attrs.min");
                }
                comparisonValueMatches = comparisonValue.match(regex);
                // If no regex matches were found, validation fails
                if (!comparisonValueMatches) {
                    return false;
                }

                if (isMaxValidation) {
                    return (valMatches[1] < comparisonValueMatches[1]) || // older year
                        // same year, older week
                        ((valMatches[1] === comparisonValueMatches[1]) && (valMatches[2] <= comparisonValueMatches[2]));
                } else {
                    return (valMatches[1] > comparisonValueMatches[1]) || // newer year
                        // same year, newer week
                        ((valMatches[1] === comparisonValueMatches[1]) && (valMatches[2] >= comparisonValueMatches[2]));
                }
                break;

            case "month":
                regex = /^(\d{4})-(\d{2})$/;
                valMatches = val.match(regex);
                if (valMatches === null) {
                    throw new Error("Invalid value for " + validatorName + " attribute for month input.  Should look like " +
                        "'2000-03' http://www.w3.org/TR/html-markup/input.month.html#input.month.attrs.min");
                }
                comparisonValueMatches = comparisonValue.match(regex);
                // If no regex matches were found, validation fails
                if (!comparisonValueMatches) {
                    return false;
                }

                if (isMaxValidation) {
                    return ((valMatches[1] < comparisonValueMatches[1]) || // older year
                        // same year, older month
                        ((valMatches[1] === comparisonValueMatches[1]) && (valMatches[2] <= comparisonValueMatches[2])));
                } else {
                    return (valMatches[1] > comparisonValueMatches[1]) || // newer year
                        // same year, newer month
                        ((valMatches[1] === comparisonValueMatches[1]) && (valMatches[2] >= comparisonValueMatches[2]));
                }
                break;

            case "number":
            case "range":
                if (isMaxValidation) {
                    return (!isNaN(val) && parseFloat(val) <= parseFloat(comparisonValue));
                } else {
                    return (!isNaN(val) && parseFloat(val) >= parseFloat(comparisonValue));
                }
                break;

            default:
                if (isMaxValidation) {
                    return val <= comparisonValue;
                } else {
                    return val >= comparisonValue;
                }
        }
    };
}

kv.rules['min'] = {
	validator: minMaxValidatorFactory("min"),
	message: 'Please enter a value greater than or equal to {0}.'
};

kv.rules['max'] = {
	validator: minMaxValidatorFactory("max"),
	message: 'Please enter a value less than or equal to {0}.'
};

kv.rules['minLength'] = {
	validator: function (val, minLength) {
		if(kv.utils.isEmptyVal(val)) { return true; }
		var normalizedVal = kv.utils.isNumber(val) ? ('' + val) : val;
		return normalizedVal.length >= minLength;
	},
	message: 'Please enter at least {0} characters.'
};

kv.rules['maxLength'] = {
	validator: function (val, maxLength) {
		if(kv.utils.isEmptyVal(val)) { return true; }
		var normalizedVal = kv.utils.isNumber(val) ? ('' + val) : val;
		return normalizedVal.length <= maxLength;
	},
	message: 'Please enter no more than {0} characters.'
};

kv.rules['pattern'] = {
	validator: function (val, regex) {
		return kv.utils.isEmptyVal(val) || val.toString().match(regex) !== null;
	},
	message: 'Please check this value.'
};

kv.rules['step'] = {
	validator: function (val, step) {

		// in order to handle steps of .1 & .01 etc.. Modulus won't work
		// if the value is a decimal, so we have to correct for that
		if (kv.utils.isEmptyVal(val) || step === 'any') { return true; }
		var dif = (val * 100) % (step * 100);
		return Math.abs(dif) < 0.00001 || Math.abs(1 - dif) < 0.00001;
	},
	message: 'The value must increment by {0}.'
};

kv.rules['email'] = {
	validator: function (val, validate) {
		if (!validate) { return true; }

		//I think an empty email address is also a valid entry
		//if one want's to enforce entry it should be done with 'required: true'
		return kv.utils.isEmptyVal(val) || (
			// jquery validate regex - thanks Scott Gonzalez
			validate && /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(val)
		);
	},
	message: 'Please enter a proper email address.'
};

kv.rules['date'] = {
	validator: function (value, validate) {
		if (!validate) { return true; }
		return kv.utils.isEmptyVal(value) || (validate && !/Invalid|NaN/.test(new Date(value)));
	},
	message: 'Please enter a proper date.'
};

kv.rules['dateISO'] = {
	validator: function (value, validate) {
		if (!validate) { return true; }
		return kv.utils.isEmptyVal(value) || (validate && /^\d{4}[-/](?:0?[1-9]|1[012])[-/](?:0?[1-9]|[12][0-9]|3[01])$/.test(value));
	},
	message: 'Please enter a proper date.'
};

kv.rules['number'] = {
	validator: function (value, validate) {
		if (!validate) { return true; }
		return kv.utils.isEmptyVal(value) || (validate && /^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(value));
	},
	message: 'Please enter a number.'
};

kv.rules['digit'] = {
	validator: function (value, validate) {
		if (!validate) { return true; }
		return kv.utils.isEmptyVal(value) || (validate && /^\d+$/.test(value));
	},
	message: 'Please enter a digit.'
};

kv.rules['phoneUS'] = {
	validator: function (phoneNumber, validate) {
		if (!validate) { return true; }
		if (kv.utils.isEmptyVal(phoneNumber)) { return true; } // makes it optional, use 'required' rule if it should be required
		if (typeof (phoneNumber) !== 'string') { return false; }
		phoneNumber = phoneNumber.replace(/\s+/g, "");
		return validate && phoneNumber.length > 9 && phoneNumber.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/);
	},
	message: 'Please specify a valid phone number.'
};

kv.rules['equal'] = {
	validator: function (val, params) {
		var otherValue = params;
		return val === kv.utils.getValue(otherValue);
	},
	message: 'Values must equal.'
};

kv.rules['notEqual'] = {
	validator: function (val, params) {
		var otherValue = params;
		return val !== kv.utils.getValue(otherValue);
	},
	message: 'Please choose another value.'
};

//unique in collection
// options are:
//    collection: array or function returning (observable) array
//              in which the value has to be unique
//    valueAccessor: function that returns value from an object stored in collection
//              if it is null the value is compared directly
//    external: set to true when object you are validating is automatically updating collection
kv.rules['unique'] = {
	validator: function (val, options) {
		var c = kv.utils.getValue(options.collection),
			external = kv.utils.getValue(options.externalValue),
			counter = 0;

		if (!val || !c) { return true; }

		koUtils.arrayFilter(c, function (item) {
			if (val === (options.valueAccessor ? options.valueAccessor(item) : item)) { counter++; }
		});
		// if value is external even 1 same value in collection means the value is not unique
		return counter < (!!external ? 1 : 2);
	},
	message: 'Please make sure the value is unique.'
};


//now register all of these!
(function () {
	kv.registerExtenders();
}());
;// The core binding handler
// this allows us to setup any value binding that internally always
// performs the same functionality
ko.bindingHandlers['validationCore'] = (function () {

	return {
		init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
			var config = kv.utils.getConfigOptions(element);
			var observable = valueAccessor();

			// parse html5 input validation attributes, optional feature
			if (config.parseInputAttributes) {
				kv.utils.async(function () { kv.parseInputValidationAttributes(element, valueAccessor); });
			}

			// if requested insert message element and apply bindings
			if (config.insertMessages && kv.utils.isValidatable(observable)) {

				// insert the <span></span>
				var validationMessageElement = kv.insertValidationMessage(element);

				// if we're told to use a template, make sure that gets rendered
				if (config.messageTemplate) {
					ko.renderTemplate(config.messageTemplate, { field: observable }, null, validationMessageElement, 'replaceNode');
				} else {
					ko.applyBindingsToNode(validationMessageElement, { validationMessage: observable });
				}
			}

			// write the html5 attributes if indicated by the config
			if (config.writeInputAttributes && kv.utils.isValidatable(observable)) {

				kv.writeInputValidationAttributes(element, valueAccessor);
			}

			// if requested, add binding to decorate element
			if (config.decorateInputElement && kv.utils.isValidatable(observable)) {
				ko.applyBindingsToNode(element, { validationElement: observable });
			}
		}
	};

}());

// override for KO's default 'value', 'checked', 'textInput' and selectedOptions bindings
kv.makeBindingHandlerValidatable("value");
kv.makeBindingHandlerValidatable("checked");
if (ko.bindingHandlers.textInput) {
	kv.makeBindingHandlerValidatable("textInput");
}
kv.makeBindingHandlerValidatable("selectedOptions");


ko.bindingHandlers['validationMessage'] = { // individual error message, if modified or post binding
	update: function (element, valueAccessor) {
		var obsv = valueAccessor(),
			config = kv.utils.getConfigOptions(element),
			val = unwrap(obsv),
			msg = null,
			isModified = false,
			isValid = false;

		if (obsv === null || typeof obsv === 'undefined') {
			throw new Error('Cannot bind validationMessage to undefined value. data-bind expression: ' +
				element.getAttribute('data-bind'));
		}

		if (!obsv.isValid || !obsv.isModified) {
			throw new Error("Observable is not validatable");
		}

		isModified = obsv.isModified();
		isValid = obsv.isValid();

		var error = null;
		if (!config.messagesOnModified || isModified) {
			error = isValid ? null : obsv.error;
		}

		var isVisible = !config.messagesOnModified || isModified ? !isValid : false;
		var isCurrentlyVisible = element.style.display !== "none";

		if (config.allowHtmlMessages) {
			koUtils.setHtml(element, error);
		} else {
			ko.bindingHandlers.text.update(element, function () { return error; });
		}

		if (isCurrentlyVisible && !isVisible) {
			element.style.display = 'none';
		} else if (!isCurrentlyVisible && isVisible) {
			element.style.display = '';
		}
	}
};

ko.bindingHandlers['validationElement'] = {
	update: function (element, valueAccessor, allBindingsAccessor) {
		var obsv = valueAccessor(),
			config = kv.utils.getConfigOptions(element),
			val = unwrap(obsv),
			msg = null,
			isModified = false,
			isValid = false;

		if (obsv === null || typeof obsv === 'undefined') {
			throw new Error('Cannot bind validationElement to undefined value. data-bind expression: ' +
				element.getAttribute('data-bind'));
		}

		if (!obsv.isValid || !obsv.isModified) {
			throw new Error("Observable is not validatable");
		}

		isModified = obsv.isModified();
		isValid = obsv.isValid();

		// create an evaluator function that will return something like:
		// css: { validationElement: true }
		var cssSettingsAccessor = function () {
			var css = {};

			var shouldShow = ((!config.decorateElementOnModified || isModified) ? !isValid : false);

			// css: { validationElement: false }
			css[config.errorElementClass] = shouldShow;

			return css;
		};

		//add or remove class on the element;
		ko.bindingHandlers.css.update(element, cssSettingsAccessor, allBindingsAccessor);
		if (!config.errorsAsTitle) { return; }

		ko.bindingHandlers.attr.update(element, function () {
			var
				hasModification = !config.errorsAsTitleOnModified || isModified,
				title = kv.utils.getOriginalElementTitle(element);

			if (hasModification && !isValid) {
				return { title: obsv.error, 'data-orig-title': title };
			} else if (!hasModification || isValid) {
				return { title: title, 'data-orig-title': null };
			}
		});
	}
};

// ValidationOptions:
// This binding handler allows you to override the initial config by setting any of the options for a specific element or context of elements
//
// Example:
// <div data-bind="validationOptions: { insertMessages: true, messageTemplate: 'customTemplate', errorMessageClass: 'mySpecialClass'}">
//      <input type="text" data-bind="value: someValue"/>
//      <input type="text" data-bind="value: someValue2"/>
// </div>
ko.bindingHandlers['validationOptions'] = (function () {
	return {
		init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
			var options = unwrap(valueAccessor());
			if (options) {
				var newConfig = extend({}, kv.configuration);
				extend(newConfig, options);

				//store the validation options on the node so we can retrieve it later
				kv.utils.setDomData(element, newConfig);
			}
		}
	};
}());
;// Validation Extender:
// This is for creating custom validation logic on the fly
// Example:
// var test = ko.observable('something').extend{(
//      validation: {
//          validator: function(val, someOtherVal){
//              return true;
//          },
//          message: "Something must be really wrong!',
//          params: true
//      }
//  )};
ko.extenders['validation'] = function (observable, rules) { // allow single rule or array
	forEach(kv.utils.isArray(rules) ? rules : [rules], function (rule) {
		// the 'rule' being passed in here has no name to identify a core Rule,
		// so we add it as an anonymous rule
		// If the developer is wanting to use a core Rule, but use a different message see the 'addExtender' logic for examples
		kv.addAnonymousRule(observable, rule);
	});
	return observable;
};

//This is the extender that makes a Knockout Observable also 'Validatable'
//examples include:
// 1. var test = ko.observable('something').extend({validatable: true});
// this will ensure that the Observable object is setup properly to respond to rules
//
// 2. test.extend({validatable: false});
// this will remove the validation properties from the Observable object should you need to do that.
ko.extenders['validatable'] = function (observable, options) {
	if (!kv.utils.isObject(options)) {
		options = { enable: options };
	}

	if (!('enable' in options)) {
		options.enable = true;
	}

	if (options.enable && !kv.utils.isValidatable(observable)) {
		var config = kv.configuration.validate || {};
		var validationOptions = {
			throttleEvaluation : options.throttle || config.throttle
		};

		observable.error = ko.observable(null); // holds the error message, we only need one since we stop processing validators when one is invalid

		// observable.rules:
		// ObservableArray of Rule Contexts, where a Rule Context is simply the name of a rule and the params to supply to it
		//
		// Rule Context = { rule: '<rule name>', params: '<passed in params>', message: '<Override of default Message>' }
		observable.rules = ko.observableArray(); //holds the rule Contexts to use as part of validation

		//in case async validation is occurring
		observable.isValidating = ko.observable(false);

		//the true holder of whether the observable is valid or not
		observable.__valid__ = ko.observable(true);

		observable.isModified = ko.observable(false);

		// a semi-protected observable
		observable.isValid = ko.computed(observable.__valid__);

		//manually set error state
		observable.setError = function (error) {
			var previousError = observable.error.peek();
			var previousIsValid = observable.__valid__.peek();

			observable.error(error);
			observable.__valid__(false);

			if (previousError !== error && !previousIsValid) {
				// if the observable was not valid before then isValid will not mutate,
				// hence causing any grouping to not display the latest error.
				observable.isValid.notifySubscribers();
			}
		};

		//manually clear error state
		observable.clearError = function () {
			observable.error(null);
			observable.__valid__(true);
			return observable;
		};

		//subscribe to changes in the observable
		var h_change = observable.subscribe(function () {
			observable.isModified(true);
		});

		// we use a computed here to ensure that anytime a dependency changes, the
		// validation logic evaluates
		var h_obsValidationTrigger = ko.computed(extend({
			read: function () {
				var obs = observable(),
					ruleContexts = observable.rules();

				kv.validateObservable(observable);

				return true;
			}
		}, validationOptions));

		extend(h_obsValidationTrigger, validationOptions);

		observable._disposeValidation = function () {
			//first dispose of the subscriptions
			observable.isValid.dispose();
			observable.rules.removeAll();
			if (observable.isModified.getSubscriptionsCount() > 0) {
				observable.isModified._subscriptions['change'] = [];
			}
			if (observable.isValidating.getSubscriptionsCount() > 0) {
				observable.isValidating._subscriptions['change'] = [];
			}
			if (observable.__valid__.getSubscriptionsCount() > 0) {
				observable.__valid__._subscriptions['change'] = [];
			}
			h_change.dispose();
			h_obsValidationTrigger.dispose();

			delete observable['rules'];
			delete observable['error'];
			delete observable['isValid'];
			delete observable['isValidating'];
			delete observable['__valid__'];
			delete observable['isModified'];
		};
	} else if (options.enable === false && observable._disposeValidation) {
		observable._disposeValidation();
	}
	return observable;
};

function validateSync(observable, rule, ctx) {
	//Execute the validator and see if its valid
	if (!rule.validator(observable(), (ctx.params === undefined ? true : unwrap(ctx.params)))) { // default param is true, eg. required = true

		//not valid, so format the error message and stick it in the 'error' variable
		observable.setError(kv.formatMessage(
					ctx.message || rule.message,
					unwrap(ctx.params),
					observable));
		return false;
	} else {
		return true;
	}
}

function validateAsync(observable, rule, ctx) {
	observable.isValidating(true);

	var callBack = function (valObj) {
		var isValid = false,
			msg = '';

		if (!observable.__valid__()) {

			// since we're returning early, make sure we turn this off
			observable.isValidating(false);

			return; //if its already NOT valid, don't add to that
		}

		//we were handed back a complex object
		if (valObj['message']) {
			isValid = valObj.isValid;
			msg = valObj.message;
		} else {
			isValid = valObj;
		}

		if (!isValid) {
			//not valid, so format the error message and stick it in the 'error' variable
			observable.error(kv.formatMessage(
				msg || ctx.message || rule.message,
				unwrap(ctx.params),
				observable));
			observable.__valid__(isValid);
		}

		// tell it that we're done
		observable.isValidating(false);
	};

	//fire the validator and hand it the callback
	rule.validator(observable(), unwrap(ctx.params || true), callBack);
}

kv.validateObservable = function (observable) {
	var i = 0,
		rule, // the rule validator to execute
		ctx, // the current Rule Context for the loop
		ruleContexts = observable.rules(), //cache for iterator
		len = ruleContexts.length; //cache for iterator

	for (; i < len; i++) {

		//get the Rule Context info to give to the core Rule
		ctx = ruleContexts[i];

		// checks an 'onlyIf' condition
		if (ctx.condition && !ctx.condition()) {
			continue;
		}

		//get the core Rule to use for validation
		rule = ctx.rule ? kv.rules[ctx.rule] : ctx;

		if (rule['async'] || ctx['async']) {
			//run async validation
			validateAsync(observable, rule, ctx);

		} else {
			//run normal sync validation
			if (!validateSync(observable, rule, ctx)) {
				return false; //break out of the loop
			}
		}
	}
	//finally if we got this far, make the observable valid again!
	observable.clearError();
	return true;
};
;
var _locales = {};
var _currentLocale;

kv.defineLocale = function(name, values) {
	if (name && values) {
		_locales[name.toLowerCase()] = values;
		return values;
	}
	return null;
};

kv.locale = function(name) {
	if (name) {
		name = name.toLowerCase();

		if (_locales.hasOwnProperty(name)) {
			kv.localize(_locales[name]);
			_currentLocale = name;
		}
		else {
			throw new Error('Localization ' + name + ' has not been loaded.');
		}
	}
	return _currentLocale;
};

//quick function to override rule messages
kv.localize = function (msgTranslations) {
	var rules = kv.rules;

	//loop the properties in the object and assign the msg to the rule
	for (var ruleName in msgTranslations) {
		if (rules.hasOwnProperty(ruleName)) {
			rules[ruleName].message = msgTranslations[ruleName];
		}
	}
};

// Populate default locale (this will make en-US.js somewhat redundant)
(function() {
	var localeData = {};
	var rules = kv.rules;

	for (var ruleName in rules) {
		if (rules.hasOwnProperty(ruleName)) {
			localeData[ruleName] = rules[ruleName].message;
		}
	}
	kv.defineLocale('en-us', localeData);
})();

// No need to invoke locale because the messages are already defined along with the rules for en-US
_currentLocale = 'en-us';
;/**
 * Possible invocations:
 * 		applyBindingsWithValidation(viewModel)
 * 		applyBindingsWithValidation(viewModel, options)
 * 		applyBindingsWithValidation(viewModel, rootNode)
 *		applyBindingsWithValidation(viewModel, rootNode, options)
 */
ko.applyBindingsWithValidation = function (viewModel, rootNode, options) {
	var node = document.body,
		config;

	if (rootNode && rootNode.nodeType) {
		node = rootNode;
		config = options;
	}
	else {
		config = rootNode;
	}

	kv.init();

	if (config) {
		config = extend(extend({}, kv.configuration), config);
		kv.utils.setDomData(node, config);
	}

	ko.applyBindings(viewModel, node);
};

//override the original applyBindings so that we can ensure all new rules and what not are correctly registered
var origApplyBindings = ko.applyBindings;
ko.applyBindings = function (viewModel, rootNode) {

	kv.init();

	origApplyBindings(viewModel, rootNode);
};

ko.validatedObservable = function (initialValue, options) {
	if (!options && !kv.utils.isObject(initialValue)) {
		return ko.observable(initialValue).extend({ validatable: true });
	}

	var obsv = ko.observable(initialValue);
	obsv.errors = kv.group(kv.utils.isObject(initialValue) ? initialValue : {}, options);
	obsv.isValid = ko.observable(obsv.errors().length === 0);

	if (ko.isObservable(obsv.errors)) {
		obsv.errors.subscribe(function(errors) {
			obsv.isValid(errors.length === 0);
		});
	}
	else {
		ko.computed(obsv.errors).subscribe(function (errors) {
			obsv.isValid(errors.length === 0);
		});
	}

	obsv.subscribe(function(newValue) {
		if (!kv.utils.isObject(newValue)) {
			/*
			 * The validation group works on objects.
			 * Since the new value is a primitive (scalar, null or undefined) we need
			 * to create an empty object to pass along.
			 */
			newValue = {};
		}
		// Force the group to refresh
		obsv.errors._updateState(newValue);
		obsv.isValid(obsv.errors().length === 0);
	});

	return obsv;
};
;}));
/*!
 * typeahead.js 0.11.1
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
 *
 * LICENSE
 * Copyright (c) 2013-2014 Twitter, Inc
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE. 
 */

(function(root, factory) {
    if (typeof define === "function" && define.amd) {
        define("bloodhound", [ "jquery" ], function(a0) {
            return root["Bloodhound"] = factory(a0);
        });
    } else if (typeof exports === "object") {
        module.exports = factory(require("jquery"));
    } else {
        root["Bloodhound"] = factory(jQuery);
    }
})(this, function($) {
    var _ = function() {
        "use strict";
        return {
            isMsie: function() {
                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2] : false;
            },
            isBlankString: function(str) {
                return !str || /^\s*$/.test(str);
            },
            escapeRegExChars: function(str) {
                return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
            },
            isString: function(obj) {
                return typeof obj === "string";
            },
            isNumber: function(obj) {
                return typeof obj === "number";
            },
            isArray: $.isArray,
            isFunction: $.isFunction,
            isObject: $.isPlainObject,
            isUndefined: function(obj) {
                return typeof obj === "undefined";
            },
            isElement: function(obj) {
                return !!(obj && obj.nodeType === 1);
            },
            isJQuery: function(obj) {
                return obj instanceof $;
            },
            toStr: function toStr(s) {
                return _.isUndefined(s) || s === null ? "" : s + "";
            },
            bind: $.proxy,
            each: function(collection, cb) {
                $.each(collection, reverseArgs);
                function reverseArgs(index, value) {
                    return cb(value, index);
                }
            },
            map: $.map,
            filter: $.grep,
            every: function(obj, test) {
                var result = true;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (!(result = test.call(null, val, key, obj))) {
                        return false;
                    }
                });
                return !!result;
            },
            some: function(obj, test) {
                var result = false;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (result = test.call(null, val, key, obj)) {
                        return false;
                    }
                });
                return !!result;
            },
            mixin: $.extend,
            identity: function(x) {
                return x;
            },
            clone: function(obj) {
                return $.extend(true, {}, obj);
            },
            getIdGenerator: function() {
                var counter = 0;
                return function() {
                    return counter++;
                };
            },
            templatify: function templatify(obj) {
                return $.isFunction(obj) ? obj : template;
                function template() {
                    return String(obj);
                }
            },
            defer: function(fn) {
                setTimeout(fn, 0);
            },
            debounce: function(func, wait, immediate) {
                var timeout, result;
                return function() {
                    var context = this, args = arguments, later, callNow;
                    later = function() {
                        timeout = null;
                        if (!immediate) {
                            result = func.apply(context, args);
                        }
                    };
                    callNow = immediate && !timeout;
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                    if (callNow) {
                        result = func.apply(context, args);
                    }
                    return result;
                };
            },
            throttle: function(func, wait) {
                var context, args, timeout, result, previous, later;
                previous = 0;
                later = function() {
                    previous = new Date();
                    timeout = null;
                    result = func.apply(context, args);
                };
                return function() {
                    var now = new Date(), remaining = wait - (now - previous);
                    context = this;
                    args = arguments;
                    if (remaining <= 0) {
                        clearTimeout(timeout);
                        timeout = null;
                        previous = now;
                        result = func.apply(context, args);
                    } else if (!timeout) {
                        timeout = setTimeout(later, remaining);
                    }
                    return result;
                };
            },
            stringify: function(val) {
                return _.isString(val) ? val : JSON.stringify(val);
            },
            noop: function() {}
        };
    }();
    var VERSION = "0.11.1";
    var tokenizers = function() {
        "use strict";
        return {
            nonword: nonword,
            whitespace: whitespace,
            obj: {
                nonword: getObjTokenizer(nonword),
                whitespace: getObjTokenizer(whitespace)
            }
        };
        function whitespace(str) {
            str = _.toStr(str);
            return str ? str.split(/\s+/) : [];
        }
        function nonword(str) {
            str = _.toStr(str);
            return str ? str.split(/\W+/) : [];
        }
        function getObjTokenizer(tokenizer) {
            return function setKey(keys) {
                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);
                return function tokenize(o) {
                    var tokens = [];
                    _.each(keys, function(k) {
                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));
                    });
                    return tokens;
                };
            };
        }
    }();
    var LruCache = function() {
        "use strict";
        function LruCache(maxSize) {
            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;
            this.reset();
            if (this.maxSize <= 0) {
                this.set = this.get = $.noop;
            }
        }
        _.mixin(LruCache.prototype, {
            set: function set(key, val) {
                var tailItem = this.list.tail, node;
                if (this.size >= this.maxSize) {
                    this.list.remove(tailItem);
                    delete this.hash[tailItem.key];
                    this.size--;
                }
                if (node = this.hash[key]) {
                    node.val = val;
                    this.list.moveToFront(node);
                } else {
                    node = new Node(key, val);
                    this.list.add(node);
                    this.hash[key] = node;
                    this.size++;
                }
            },
            get: function get(key) {
                var node = this.hash[key];
                if (node) {
                    this.list.moveToFront(node);
                    return node.val;
                }
            },
            reset: function reset() {
                this.size = 0;
                this.hash = {};
                this.list = new List();
            }
        });
        function List() {
            this.head = this.tail = null;
        }
        _.mixin(List.prototype, {
            add: function add(node) {
                if (this.head) {
                    node.next = this.head;
                    this.head.prev = node;
                }
                this.head = node;
                this.tail = this.tail || node;
            },
            remove: function remove(node) {
                node.prev ? node.prev.next = node.next : this.head = node.next;
                node.next ? node.next.prev = node.prev : this.tail = node.prev;
            },
            moveToFront: function(node) {
                this.remove(node);
                this.add(node);
            }
        });
        function Node(key, val) {
            this.key = key;
            this.val = val;
            this.prev = this.next = null;
        }
        return LruCache;
    }();
    var PersistentStorage = function() {
        "use strict";
        var LOCAL_STORAGE;
        try {
            LOCAL_STORAGE = window.localStorage;
            LOCAL_STORAGE.setItem("~~~", "!");
            LOCAL_STORAGE.removeItem("~~~");
        } catch (err) {
            LOCAL_STORAGE = null;
        }
        function PersistentStorage(namespace, override) {
            this.prefix = [ "__", namespace, "__" ].join("");
            this.ttlKey = "__ttl__";
            this.keyMatcher = new RegExp("^" + _.escapeRegExChars(this.prefix));
            this.ls = override || LOCAL_STORAGE;
            !this.ls && this._noop();
        }
        _.mixin(PersistentStorage.prototype, {
            _prefix: function(key) {
                return this.prefix + key;
            },
            _ttlKey: function(key) {
                return this._prefix(key) + this.ttlKey;
            },
            _noop: function() {
                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;
            },
            _safeSet: function(key, val) {
                try {
                    this.ls.setItem(key, val);
                } catch (err) {
                    if (err.name === "QuotaExceededError") {
                        this.clear();
                        this._noop();
                    }
                }
            },
            get: function(key) {
                if (this.isExpired(key)) {
                    this.remove(key);
                }
                return decode(this.ls.getItem(this._prefix(key)));
            },
            set: function(key, val, ttl) {
                if (_.isNumber(ttl)) {
                    this._safeSet(this._ttlKey(key), encode(now() + ttl));
                } else {
                    this.ls.removeItem(this._ttlKey(key));
                }
                return this._safeSet(this._prefix(key), encode(val));
            },
            remove: function(key) {
                this.ls.removeItem(this._ttlKey(key));
                this.ls.removeItem(this._prefix(key));
                return this;
            },
            clear: function() {
                var i, keys = gatherMatchingKeys(this.keyMatcher);
                for (i = keys.length; i--; ) {
                    this.remove(keys[i]);
                }
                return this;
            },
            isExpired: function(key) {
                var ttl = decode(this.ls.getItem(this._ttlKey(key)));
                return _.isNumber(ttl) && now() > ttl ? true : false;
            }
        });
        return PersistentStorage;
        function now() {
            return new Date().getTime();
        }
        function encode(val) {
            return JSON.stringify(_.isUndefined(val) ? null : val);
        }
        function decode(val) {
            return $.parseJSON(val);
        }
        function gatherMatchingKeys(keyMatcher) {
            var i, key, keys = [], len = LOCAL_STORAGE.length;
            for (i = 0; i < len; i++) {
                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {
                    keys.push(key.replace(keyMatcher, ""));
                }
            }
            return keys;
        }
    }();
    var Transport = function() {
        "use strict";
        var pendingRequestsCount = 0, pendingRequests = {}, maxPendingRequests = 6, sharedCache = new LruCache(10);
        function Transport(o) {
            o = o || {};
            this.cancelled = false;
            this.lastReq = null;
            this._send = o.transport;
            this._get = o.limiter ? o.limiter(this._get) : this._get;
            this._cache = o.cache === false ? new LruCache(0) : sharedCache;
        }
        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {
            maxPendingRequests = num;
        };
        Transport.resetCache = function resetCache() {
            sharedCache.reset();
        };
        _.mixin(Transport.prototype, {
            _fingerprint: function fingerprint(o) {
                o = o || {};
                return o.url + o.type + $.param(o.data || {});
            },
            _get: function(o, cb) {
                var that = this, fingerprint, jqXhr;
                fingerprint = this._fingerprint(o);
                if (this.cancelled || fingerprint !== this.lastReq) {
                    return;
                }
                if (jqXhr = pendingRequests[fingerprint]) {
                    jqXhr.done(done).fail(fail);
                } else if (pendingRequestsCount < maxPendingRequests) {
                    pendingRequestsCount++;
                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);
                } else {
                    this.onDeckRequestArgs = [].slice.call(arguments, 0);
                }
                function done(resp) {
                    cb(null, resp);
                    that._cache.set(fingerprint, resp);
                }
                function fail() {
                    cb(true);
                }
                function always() {
                    pendingRequestsCount--;
                    delete pendingRequests[fingerprint];
                    if (that.onDeckRequestArgs) {
                        that._get.apply(that, that.onDeckRequestArgs);
                        that.onDeckRequestArgs = null;
                    }
                }
            },
            get: function(o, cb) {
                var resp, fingerprint;
                cb = cb || $.noop;
                o = _.isString(o) ? {
                    url: o
                } : o || {};
                fingerprint = this._fingerprint(o);
                this.cancelled = false;
                this.lastReq = fingerprint;
                if (resp = this._cache.get(fingerprint)) {
                    cb(null, resp);
                } else {
                    this._get(o, cb);
                }
            },
            cancel: function() {
                this.cancelled = true;
            }
        });
        return Transport;
    }();
    var SearchIndex = window.SearchIndex = function() {
        "use strict";
        var CHILDREN = "c", IDS = "i";
        function SearchIndex(o) {
            o = o || {};
            if (!o.datumTokenizer || !o.queryTokenizer) {
                $.error("datumTokenizer and queryTokenizer are both required");
            }
            this.identify = o.identify || _.stringify;
            this.datumTokenizer = o.datumTokenizer;
            this.queryTokenizer = o.queryTokenizer;
            this.reset();
        }
        _.mixin(SearchIndex.prototype, {
            bootstrap: function bootstrap(o) {
                this.datums = o.datums;
                this.trie = o.trie;
            },
            add: function(data) {
                var that = this;
                data = _.isArray(data) ? data : [ data ];
                _.each(data, function(datum) {
                    var id, tokens;
                    that.datums[id = that.identify(datum)] = datum;
                    tokens = normalizeTokens(that.datumTokenizer(datum));
                    _.each(tokens, function(token) {
                        var node, chars, ch;
                        node = that.trie;
                        chars = token.split("");
                        while (ch = chars.shift()) {
                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());
                            node[IDS].push(id);
                        }
                    });
                });
            },
            get: function get(ids) {
                var that = this;
                return _.map(ids, function(id) {
                    return that.datums[id];
                });
            },
            search: function search(query) {
                var that = this, tokens, matches;
                tokens = normalizeTokens(this.queryTokenizer(query));
                _.each(tokens, function(token) {
                    var node, chars, ch, ids;
                    if (matches && matches.length === 0) {
                        return false;
                    }
                    node = that.trie;
                    chars = token.split("");
                    while (node && (ch = chars.shift())) {
                        node = node[CHILDREN][ch];
                    }
                    if (node && chars.length === 0) {
                        ids = node[IDS].slice(0);
                        matches = matches ? getIntersection(matches, ids) : ids;
                    } else {
                        matches = [];
                        return false;
                    }
                });
                return matches ? _.map(unique(matches), function(id) {
                    return that.datums[id];
                }) : [];
            },
            all: function all() {
                var values = [];
                for (var key in this.datums) {
                    values.push(this.datums[key]);
                }
                return values;
            },
            reset: function reset() {
                this.datums = {};
                this.trie = newNode();
            },
            serialize: function serialize() {
                return {
                    datums: this.datums,
                    trie: this.trie
                };
            }
        });
        return SearchIndex;
        function normalizeTokens(tokens) {
            tokens = _.filter(tokens, function(token) {
                return !!token;
            });
            tokens = _.map(tokens, function(token) {
                return token.toLowerCase();
            });
            return tokens;
        }
        function newNode() {
            var node = {};
            node[IDS] = [];
            node[CHILDREN] = {};
            return node;
        }
        function unique(array) {
            var seen = {}, uniques = [];
            for (var i = 0, len = array.length; i < len; i++) {
                if (!seen[array[i]]) {
                    seen[array[i]] = true;
                    uniques.push(array[i]);
                }
            }
            return uniques;
        }
        function getIntersection(arrayA, arrayB) {
            var ai = 0, bi = 0, intersection = [];
            arrayA = arrayA.sort();
            arrayB = arrayB.sort();
            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;
            while (ai < lenArrayA && bi < lenArrayB) {
                if (arrayA[ai] < arrayB[bi]) {
                    ai++;
                } else if (arrayA[ai] > arrayB[bi]) {
                    bi++;
                } else {
                    intersection.push(arrayA[ai]);
                    ai++;
                    bi++;
                }
            }
            return intersection;
        }
    }();
    var Prefetch = function() {
        "use strict";
        var keys;
        keys = {
            data: "data",
            protocol: "protocol",
            thumbprint: "thumbprint"
        };
        function Prefetch(o) {
            this.url = o.url;
            this.ttl = o.ttl;
            this.cache = o.cache;
            this.prepare = o.prepare;
            this.transform = o.transform;
            this.transport = o.transport;
            this.thumbprint = o.thumbprint;
            this.storage = new PersistentStorage(o.cacheKey);
        }
        _.mixin(Prefetch.prototype, {
            _settings: function settings() {
                return {
                    url: this.url,
                    type: "GET",
                    dataType: "json"
                };
            },
            store: function store(data) {
                if (!this.cache) {
                    return;
                }
                this.storage.set(keys.data, data, this.ttl);
                this.storage.set(keys.protocol, location.protocol, this.ttl);
                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);
            },
            fromCache: function fromCache() {
                var stored = {}, isExpired;
                if (!this.cache) {
                    return null;
                }
                stored.data = this.storage.get(keys.data);
                stored.protocol = this.storage.get(keys.protocol);
                stored.thumbprint = this.storage.get(keys.thumbprint);
                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;
                return stored.data && !isExpired ? stored.data : null;
            },
            fromNetwork: function(cb) {
                var that = this, settings;
                if (!cb) {
                    return;
                }
                settings = this.prepare(this._settings());
                this.transport(settings).fail(onError).done(onResponse);
                function onError() {
                    cb(true);
                }
                function onResponse(resp) {
                    cb(null, that.transform(resp));
                }
            },
            clear: function clear() {
                this.storage.clear();
                return this;
            }
        });
        return Prefetch;
    }();
    var Remote = function() {
        "use strict";
        function Remote(o) {
            this.url = o.url;
            this.prepare = o.prepare;
            this.transform = o.transform;
            this.transport = new Transport({
                cache: o.cache,
                limiter: o.limiter,
                transport: o.transport
            });
        }
        _.mixin(Remote.prototype, {
            _settings: function settings() {
                return {
                    url: this.url,
                    type: "GET",
                    dataType: "json"
                };
            },
            get: function get(query, cb) {
                var that = this, settings;
                if (!cb) {
                    return;
                }
                query = query || "";
                settings = this.prepare(query, this._settings());
                return this.transport.get(settings, onResponse);
                function onResponse(err, resp) {
                    err ? cb([]) : cb(that.transform(resp));
                }
            },
            cancelLastRequest: function cancelLastRequest() {
                this.transport.cancel();
            }
        });
        return Remote;
    }();
    var oParser = function() {
        "use strict";
        return function parse(o) {
            var defaults, sorter;
            defaults = {
                initialize: true,
                identify: _.stringify,
                datumTokenizer: null,
                queryTokenizer: null,
                sufficient: 5,
                sorter: null,
                local: [],
                prefetch: null,
                remote: null
            };
            o = _.mixin(defaults, o || {});
            !o.datumTokenizer && $.error("datumTokenizer is required");
            !o.queryTokenizer && $.error("queryTokenizer is required");
            sorter = o.sorter;
            o.sorter = sorter ? function(x) {
                return x.sort(sorter);
            } : _.identity;
            o.local = _.isFunction(o.local) ? o.local() : o.local;
            o.prefetch = parsePrefetch(o.prefetch);
            o.remote = parseRemote(o.remote);
            return o;
        };
        function parsePrefetch(o) {
            var defaults;
            if (!o) {
                return null;
            }
            defaults = {
                url: null,
                ttl: 24 * 60 * 60 * 1e3,
                cache: true,
                cacheKey: null,
                thumbprint: "",
                prepare: _.identity,
                transform: _.identity,
                transport: null
            };
            o = _.isString(o) ? {
                url: o
            } : o;
            o = _.mixin(defaults, o);
            !o.url && $.error("prefetch requires url to be set");
            o.transform = o.filter || o.transform;
            o.cacheKey = o.cacheKey || o.url;
            o.thumbprint = VERSION + o.thumbprint;
            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;
            return o;
        }
        function parseRemote(o) {
            var defaults;
            if (!o) {
                return;
            }
            defaults = {
                url: null,
                cache: true,
                prepare: null,
                replace: null,
                wildcard: null,
                limiter: null,
                rateLimitBy: "debounce",
                rateLimitWait: 300,
                transform: _.identity,
                transport: null
            };
            o = _.isString(o) ? {
                url: o
            } : o;
            o = _.mixin(defaults, o);
            !o.url && $.error("remote requires url to be set");
            o.transform = o.filter || o.transform;
            o.prepare = toRemotePrepare(o);
            o.limiter = toLimiter(o);
            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;
            delete o.replace;
            delete o.wildcard;
            delete o.rateLimitBy;
            delete o.rateLimitWait;
            return o;
        }
        function toRemotePrepare(o) {
            var prepare, replace, wildcard;
            prepare = o.prepare;
            replace = o.replace;
            wildcard = o.wildcard;
            if (prepare) {
                return prepare;
            }
            if (replace) {
                prepare = prepareByReplace;
            } else if (o.wildcard) {
                prepare = prepareByWildcard;
            } else {
                prepare = idenityPrepare;
            }
            return prepare;
            function prepareByReplace(query, settings) {
                settings.url = replace(settings.url, query);
                return settings;
            }
            function prepareByWildcard(query, settings) {
                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));
                return settings;
            }
            function idenityPrepare(query, settings) {
                return settings;
            }
        }
        function toLimiter(o) {
            var limiter, method, wait;
            limiter = o.limiter;
            method = o.rateLimitBy;
            wait = o.rateLimitWait;
            if (!limiter) {
                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);
            }
            return limiter;
            function debounce(wait) {
                return function debounce(fn) {
                    return _.debounce(fn, wait);
                };
            }
            function throttle(wait) {
                return function throttle(fn) {
                    return _.throttle(fn, wait);
                };
            }
        }
        function callbackToDeferred(fn) {
            return function wrapper(o) {
                var deferred = $.Deferred();
                fn(o, onSuccess, onError);
                return deferred;
                function onSuccess(resp) {
                    _.defer(function() {
                        deferred.resolve(resp);
                    });
                }
                function onError(err) {
                    _.defer(function() {
                        deferred.reject(err);
                    });
                }
            };
        }
    }();
    var Bloodhound = function() {
        "use strict";
        var old;
        old = window && window.Bloodhound;
        function Bloodhound(o) {
            o = oParser(o);
            this.sorter = o.sorter;
            this.identify = o.identify;
            this.sufficient = o.sufficient;
            this.local = o.local;
            this.remote = o.remote ? new Remote(o.remote) : null;
            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;
            this.index = new SearchIndex({
                identify: this.identify,
                datumTokenizer: o.datumTokenizer,
                queryTokenizer: o.queryTokenizer
            });
            o.initialize !== false && this.initialize();
        }
        Bloodhound.noConflict = function noConflict() {
            window && (window.Bloodhound = old);
            return Bloodhound;
        };
        Bloodhound.tokenizers = tokenizers;
        _.mixin(Bloodhound.prototype, {
            __ttAdapter: function ttAdapter() {
                var that = this;
                return this.remote ? withAsync : withoutAsync;
                function withAsync(query, sync, async) {
                    return that.search(query, sync, async);
                }
                function withoutAsync(query, sync) {
                    return that.search(query, sync);
                }
            },
            _loadPrefetch: function loadPrefetch() {
                var that = this, deferred, serialized;
                deferred = $.Deferred();
                if (!this.prefetch) {
                    deferred.resolve();
                } else if (serialized = this.prefetch.fromCache()) {
                    this.index.bootstrap(serialized);
                    deferred.resolve();
                } else {
                    this.prefetch.fromNetwork(done);
                }
                return deferred.promise();
                function done(err, data) {
                    if (err) {
                        return deferred.reject();
                    }
                    that.add(data);
                    that.prefetch.store(that.index.serialize());
                    deferred.resolve();
                }
            },
            _initialize: function initialize() {
                var that = this, deferred;
                this.clear();
                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);
                return this.initPromise;
                function addLocalToIndex() {
                    that.add(that.local);
                }
            },
            initialize: function initialize(force) {
                return !this.initPromise || force ? this._initialize() : this.initPromise;
            },
            add: function add(data) {
                this.index.add(data);
                return this;
            },
            get: function get(ids) {
                ids = _.isArray(ids) ? ids : [].slice.call(arguments);
                return this.index.get(ids);
            },
            search: function search(query, sync, async) {
                var that = this, local;
                local = this.sorter(this.index.search(query));
                sync(this.remote ? local.slice() : local);
                if (this.remote && local.length < this.sufficient) {
                    this.remote.get(query, processRemote);
                } else if (this.remote) {
                    this.remote.cancelLastRequest();
                }
                return this;
                function processRemote(remote) {
                    var nonDuplicates = [];
                    _.each(remote, function(r) {
                        !_.some(local, function(l) {
                            return that.identify(r) === that.identify(l);
                        }) && nonDuplicates.push(r);
                    });
                    async && async(nonDuplicates);
                }
            },
            all: function all() {
                return this.index.all();
            },
            clear: function clear() {
                this.index.reset();
                return this;
            },
            clearPrefetchCache: function clearPrefetchCache() {
                this.prefetch && this.prefetch.clear();
                return this;
            },
            clearRemoteCache: function clearRemoteCache() {
                Transport.resetCache();
                return this;
            },
            ttAdapter: function ttAdapter() {
                return this.__ttAdapter();
            }
        });
        return Bloodhound;
    }();
    return Bloodhound;
});

(function(root, factory) {
    if (typeof define === "function" && define.amd) {
        define("typeahead.js", [ "jquery" ], function(a0) {
            return factory(a0);
        });
    } else if (typeof exports === "object") {
        module.exports = factory(require("jquery"));
    } else {
        factory(jQuery);
    }
})(this, function($) {
    var _ = function() {
        "use strict";
        return {
            isMsie: function() {
                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2] : false;
            },
            isBlankString: function(str) {
                return !str || /^\s*$/.test(str);
            },
            escapeRegExChars: function(str) {
                return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
            },
            isString: function(obj) {
                return typeof obj === "string";
            },
            isNumber: function(obj) {
                return typeof obj === "number";
            },
            isArray: $.isArray,
            isFunction: $.isFunction,
            isObject: $.isPlainObject,
            isUndefined: function(obj) {
                return typeof obj === "undefined";
            },
            isElement: function(obj) {
                return !!(obj && obj.nodeType === 1);
            },
            isJQuery: function(obj) {
                return obj instanceof $;
            },
            toStr: function toStr(s) {
                return _.isUndefined(s) || s === null ? "" : s + "";
            },
            bind: $.proxy,
            each: function(collection, cb) {
                $.each(collection, reverseArgs);
                function reverseArgs(index, value) {
                    return cb(value, index);
                }
            },
            map: $.map,
            filter: $.grep,
            every: function(obj, test) {
                var result = true;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (!(result = test.call(null, val, key, obj))) {
                        return false;
                    }
                });
                return !!result;
            },
            some: function(obj, test) {
                var result = false;
                if (!obj) {
                    return result;
                }
                $.each(obj, function(key, val) {
                    if (result = test.call(null, val, key, obj)) {
                        return false;
                    }
                });
                return !!result;
            },
            mixin: $.extend,
            identity: function(x) {
                return x;
            },
            clone: function(obj) {
                return $.extend(true, {}, obj);
            },
            getIdGenerator: function() {
                var counter = 0;
                return function() {
                    return counter++;
                };
            },
            templatify: function templatify(obj) {
                return $.isFunction(obj) ? obj : template;
                function template() {
                    return String(obj);
                }
            },
            defer: function(fn) {
                setTimeout(fn, 0);
            },
            debounce: function(func, wait, immediate) {
                var timeout, result;
                return function() {
                    var context = this, args = arguments, later, callNow;
                    later = function() {
                        timeout = null;
                        if (!immediate) {
                            result = func.apply(context, args);
                        }
                    };
                    callNow = immediate && !timeout;
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                    if (callNow) {
                        result = func.apply(context, args);
                    }
                    return result;
                };
            },
            throttle: function(func, wait) {
                var context, args, timeout, result, previous, later;
                previous = 0;
                later = function() {
                    previous = new Date();
                    timeout = null;
                    result = func.apply(context, args);
                };
                return function() {
                    var now = new Date(), remaining = wait - (now - previous);
                    context = this;
                    args = arguments;
                    if (remaining <= 0) {
                        clearTimeout(timeout);
                        timeout = null;
                        previous = now;
                        result = func.apply(context, args);
                    } else if (!timeout) {
                        timeout = setTimeout(later, remaining);
                    }
                    return result;
                };
            },
            stringify: function(val) {
                return _.isString(val) ? val : JSON.stringify(val);
            },
            noop: function() {}
        };
    }();
    var WWW = function() {
        "use strict";
        var defaultClassNames = {
            wrapper: "twitter-typeahead",
            input: "tt-input",
            hint: "tt-hint",
            menu: "tt-menu",
            dataset: "tt-dataset",
            suggestion: "tt-suggestion",
            selectable: "tt-selectable",
            empty: "tt-empty",
            open: "tt-open",
            cursor: "tt-cursor",
            highlight: "tt-highlight"
        };
        return build;
        function build(o) {
            var www, classes;
            classes = _.mixin({}, defaultClassNames, o);
            www = {
                css: buildCss(),
                classes: classes,
                html: buildHtml(classes),
                selectors: buildSelectors(classes)
            };
            return {
                css: www.css,
                html: www.html,
                classes: www.classes,
                selectors: www.selectors,
                mixin: function(o) {
                    _.mixin(o, www);
                }
            };
        }
        function buildHtml(c) {
            return {
                wrapper: '<span class="' + c.wrapper + '"></span>',
                menu: '<div class="' + c.menu + '"></div>'
            };
        }
        function buildSelectors(classes) {
            var selectors = {};
            _.each(classes, function(v, k) {
                selectors[k] = "." + v;
            });
            return selectors;
        }
        function buildCss() {
            var css = {
                wrapper: {
                    position: "relative",
                    display: "inline-block"
                },
                hint: {
                    position: "absolute",
                    top: "0",
                    left: "0",
                    borderColor: "transparent",
                    boxShadow: "none",
                    opacity: "1"
                },
                input: {
                    position: "relative",
                    verticalAlign: "top",
                    backgroundColor: "transparent"
                },
                inputWithNoHint: {
                    position: "relative",
                    verticalAlign: "top"
                },
                menu: {
                    position: "absolute",
                    top: "100%",
                    left: "0",
                    zIndex: "100",
                    display: "none"
                },
                ltr: {
                    left: "0",
                    right: "auto"
                },
                rtl: {
                    left: "auto",
                    right: " 0"
                }
            };
            if (_.isMsie()) {
                _.mixin(css.input, {
                    backgroundImage: "url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"
                });
            }
            return css;
        }
    }();
    var EventBus = function() {
        "use strict";
        var namespace, deprecationMap;
        namespace = "typeahead:";
        deprecationMap = {
            render: "rendered",
            cursorchange: "cursorchanged",
            select: "selected",
            autocomplete: "autocompleted"
        };
        function EventBus(o) {
            if (!o || !o.el) {
                $.error("EventBus initialized without el");
            }
            this.$el = $(o.el);
        }
        _.mixin(EventBus.prototype, {
            _trigger: function(type, args) {
                var $e;
                $e = $.Event(namespace + type);
                (args = args || []).unshift($e);
                this.$el.trigger.apply(this.$el, args);
                return $e;
            },
            before: function(type) {
                var args, $e;
                args = [].slice.call(arguments, 1);
                $e = this._trigger("before" + type, args);
                return $e.isDefaultPrevented();
            },
            trigger: function(type) {
                var deprecatedType;
                this._trigger(type, [].slice.call(arguments, 1));
                if (deprecatedType = deprecationMap[type]) {
                    this._trigger(deprecatedType, [].slice.call(arguments, 1));
                }
            }
        });
        return EventBus;
    }();
    var EventEmitter = function() {
        "use strict";
        var splitter = /\s+/, nextTick = getNextTick();
        return {
            onSync: onSync,
            onAsync: onAsync,
            off: off,
            trigger: trigger
        };
        function on(method, types, cb, context) {
            var type;
            if (!cb) {
                return this;
            }
            types = types.split(splitter);
            cb = context ? bindContext(cb, context) : cb;
            this._callbacks = this._callbacks || {};
            while (type = types.shift()) {
                this._callbacks[type] = this._callbacks[type] || {
                    sync: [],
                    async: []
                };
                this._callbacks[type][method].push(cb);
            }
            return this;
        }
        function onAsync(types, cb, context) {
            return on.call(this, "async", types, cb, context);
        }
        function onSync(types, cb, context) {
            return on.call(this, "sync", types, cb, context);
        }
        function off(types) {
            var type;
            if (!this._callbacks) {
                return this;
            }
            types = types.split(splitter);
            while (type = types.shift()) {
                delete this._callbacks[type];
            }
            return this;
        }
        function trigger(types) {
            var type, callbacks, args, syncFlush, asyncFlush;
            if (!this._callbacks) {
                return this;
            }
            types = types.split(splitter);
            args = [].slice.call(arguments, 1);
            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {
                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));
                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));
                syncFlush() && nextTick(asyncFlush);
            }
            return this;
        }
        function getFlush(callbacks, context, args) {
            return flush;
            function flush() {
                var cancelled;
                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {
                    cancelled = callbacks[i].apply(context, args) === false;
                }
                return !cancelled;
            }
        }
        function getNextTick() {
            var nextTickFn;
            if (window.setImmediate) {
                nextTickFn = function nextTickSetImmediate(fn) {
                    setImmediate(function() {
                        fn();
                    });
                };
            } else {
                nextTickFn = function nextTickSetTimeout(fn) {
                    setTimeout(function() {
                        fn();
                    }, 0);
                };
            }
            return nextTickFn;
        }
        function bindContext(fn, context) {
            return fn.bind ? fn.bind(context) : function() {
                fn.apply(context, [].slice.call(arguments, 0));
            };
        }
    }();
    var highlight = function(doc) {
        "use strict";
        var defaults = {
            node: null,
            pattern: null,
            tagName: "strong",
            className: null,
            wordsOnly: false,
            caseSensitive: false
        };
        return function hightlight(o) {
            var regex;
            o = _.mixin({}, defaults, o);
            if (!o.node || !o.pattern) {
                return;
            }
            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];
            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly);
            traverse(o.node, hightlightTextNode);
            function hightlightTextNode(textNode) {
                var match, patternNode, wrapperNode;
                if (match = regex.exec(textNode.data)) {
                    wrapperNode = doc.createElement(o.tagName);
                    o.className && (wrapperNode.className = o.className);
                    patternNode = textNode.splitText(match.index);
                    patternNode.splitText(match[0].length);
                    wrapperNode.appendChild(patternNode.cloneNode(true));
                    textNode.parentNode.replaceChild(wrapperNode, patternNode);
                }
                return !!match;
            }
            function traverse(el, hightlightTextNode) {
                var childNode, TEXT_NODE_TYPE = 3;
                for (var i = 0; i < el.childNodes.length; i++) {
                    childNode = el.childNodes[i];
                    if (childNode.nodeType === TEXT_NODE_TYPE) {
                        i += hightlightTextNode(childNode) ? 1 : 0;
                    } else {
                        traverse(childNode, hightlightTextNode);
                    }
                }
            }
        };
        function getRegex(patterns, caseSensitive, wordsOnly) {
            var escapedPatterns = [], regexStr;
            for (var i = 0, len = patterns.length; i < len; i++) {
                escapedPatterns.push(_.escapeRegExChars(patterns[i]));
            }
            regexStr = wordsOnly ? "\\b(" + escapedPatterns.join("|") + ")\\b" : "(" + escapedPatterns.join("|") + ")";
            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, "i");
        }
    }(window.document);
    var Input = function() {
        "use strict";
        var specialKeyCodeMap;
        specialKeyCodeMap = {
            9: "tab",
            27: "esc",
            37: "left",
            39: "right",
            13: "enter",
            38: "up",
            40: "down"
        };
        function Input(o, www) {
            o = o || {};
            if (!o.input) {
                $.error("input is missing");
            }
            www.mixin(this);
            this.$hint = $(o.hint);
            this.$input = $(o.input);
            this.query = this.$input.val();
            this.queryWhenFocused = this.hasFocus() ? this.query : null;
            this.$overflowHelper = buildOverflowHelper(this.$input);
            this._checkLanguageDirection();
            if (this.$hint.length === 0) {
                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;
            }
        }
        Input.normalizeQuery = function(str) {
            return _.toStr(str).replace(/^\s*/g, "").replace(/\s{2,}/g, " ");
        };
        _.mixin(Input.prototype, EventEmitter, {
            _onBlur: function onBlur() {
                this.resetInputValue();
                this.trigger("blurred");
            },
            _onFocus: function onFocus() {
                this.queryWhenFocused = this.query;
                this.trigger("focused");
            },
            _onKeydown: function onKeydown($e) {
                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];
                this._managePreventDefault(keyName, $e);
                if (keyName && this._shouldTrigger(keyName, $e)) {
                    this.trigger(keyName + "Keyed", $e);
                }
            },
            _onInput: function onInput() {
                this._setQuery(this.getInputValue());
                this.clearHintIfInvalid();
                this._checkLanguageDirection();
            },
            _managePreventDefault: function managePreventDefault(keyName, $e) {
                var preventDefault;
                switch (keyName) {
                  case "up":
                  case "down":
                    preventDefault = !withModifier($e);
                    break;

                  default:
                    preventDefault = false;
                }
                preventDefault && $e.preventDefault();
            },
            _shouldTrigger: function shouldTrigger(keyName, $e) {
                var trigger;
                switch (keyName) {
                  case "tab":
                    trigger = !withModifier($e);
                    break;

                  default:
                    trigger = true;
                }
                return trigger;
            },
            _checkLanguageDirection: function checkLanguageDirection() {
                var dir = (this.$input.css("direction") || "ltr").toLowerCase();
                if (this.dir !== dir) {
                    this.dir = dir;
                    this.$hint.attr("dir", dir);
                    this.trigger("langDirChanged", dir);
                }
            },
            _setQuery: function setQuery(val, silent) {
                var areEquivalent, hasDifferentWhitespace;
                areEquivalent = areQueriesEquivalent(val, this.query);
                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;
                this.query = val;
                if (!silent && !areEquivalent) {
                    this.trigger("queryChanged", this.query);
                } else if (!silent && hasDifferentWhitespace) {
                    this.trigger("whitespaceChanged", this.query);
                }
            },
            bind: function() {
                var that = this, onBlur, onFocus, onKeydown, onInput;
                onBlur = _.bind(this._onBlur, this);
                onFocus = _.bind(this._onFocus, this);
                onKeydown = _.bind(this._onKeydown, this);
                onInput = _.bind(this._onInput, this);
                this.$input.on("blur.tt", onBlur).on("focus.tt", onFocus).on("keydown.tt", onKeydown);
                if (!_.isMsie() || _.isMsie() > 9) {
                    this.$input.on("input.tt", onInput);
                } else {
                    this.$input.on("keydown.tt keypress.tt cut.tt paste.tt", function($e) {
                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {
                            return;
                        }
                        _.defer(_.bind(that._onInput, that, $e));
                    });
                }
                return this;
            },
            focus: function focus() {
                this.$input.focus();
            },
            blur: function blur() {
                this.$input.blur();
            },
            getLangDir: function getLangDir() {
                return this.dir;
            },
            getQuery: function getQuery() {
                return this.query || "";
            },
            setQuery: function setQuery(val, silent) {
                this.setInputValue(val);
                this._setQuery(val, silent);
            },
            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {
                return this.query !== this.queryWhenFocused;
            },
            getInputValue: function getInputValue() {
                return this.$input.val();
            },
            setInputValue: function setInputValue(value) {
                this.$input.val(value);
                this.clearHintIfInvalid();
                this._checkLanguageDirection();
            },
            resetInputValue: function resetInputValue() {
                this.setInputValue(this.query);
            },
            getHint: function getHint() {
                return this.$hint.val();
            },
            setHint: function setHint(value) {
                this.$hint.val(value);
            },
            clearHint: function clearHint() {
                this.setHint("");
            },
            clearHintIfInvalid: function clearHintIfInvalid() {
                var val, hint, valIsPrefixOfHint, isValid;
                val = this.getInputValue();
                hint = this.getHint();
                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;
                isValid = val !== "" && valIsPrefixOfHint && !this.hasOverflow();
                !isValid && this.clearHint();
            },
            hasFocus: function hasFocus() {
                return this.$input.is(":focus");
            },
            hasOverflow: function hasOverflow() {
                var constraint = this.$input.width() - 2;
                this.$overflowHelper.text(this.getInputValue());
                return this.$overflowHelper.width() >= constraint;
            },
            isCursorAtEnd: function() {
                var valueLength, selectionStart, range;
                valueLength = this.$input.val().length;
                selectionStart = this.$input[0].selectionStart;
                if (_.isNumber(selectionStart)) {
                    return selectionStart === valueLength;
                } else if (document.selection) {
                    range = document.selection.createRange();
                    range.moveStart("character", -valueLength);
                    return valueLength === range.text.length;
                }
                return true;
            },
            destroy: function destroy() {
                this.$hint.off(".tt");
                this.$input.off(".tt");
                this.$overflowHelper.remove();
                this.$hint = this.$input = this.$overflowHelper = $("<div>");
            }
        });
        return Input;
        function buildOverflowHelper($input) {
            return $('<pre aria-hidden="true"></pre>').css({
                position: "absolute",
                visibility: "hidden",
                whiteSpace: "pre",
                fontFamily: $input.css("font-family"),
                fontSize: $input.css("font-size"),
                fontStyle: $input.css("font-style"),
                fontVariant: $input.css("font-variant"),
                fontWeight: $input.css("font-weight"),
                wordSpacing: $input.css("word-spacing"),
                letterSpacing: $input.css("letter-spacing"),
                textIndent: $input.css("text-indent"),
                textRendering: $input.css("text-rendering"),
                textTransform: $input.css("text-transform")
            }).insertAfter($input);
        }
        function areQueriesEquivalent(a, b) {
            return Input.normalizeQuery(a) === Input.normalizeQuery(b);
        }
        function withModifier($e) {
            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;
        }
    }();
    var Dataset = function() {
        "use strict";
        var keys, nameGenerator;
        keys = {
            val: "tt-selectable-display",
            obj: "tt-selectable-object"
        };
        nameGenerator = _.getIdGenerator();
        function Dataset(o, www) {
            o = o || {};
            o.templates = o.templates || {};
            o.templates.notFound = o.templates.notFound || o.templates.empty;
            if (!o.source) {
                $.error("missing source");
            }
            if (!o.node) {
                $.error("missing node");
            }
            if (o.name && !isValidName(o.name)) {
                $.error("invalid dataset name: " + o.name);
            }
            www.mixin(this);
            this.highlight = !!o.highlight;
            this.name = o.name || nameGenerator();
            this.limit = o.limit || 5;
            this.displayFn = getDisplayFn(o.display || o.displayKey);
            this.templates = getTemplates(o.templates, this.displayFn);
            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;
            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;
            this._resetLastSuggestion();
            this.$el = $(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset + "-" + this.name);
        }
        Dataset.extractData = function extractData(el) {
            var $el = $(el);
            if ($el.data(keys.obj)) {
                return {
                    val: $el.data(keys.val) || "",
                    obj: $el.data(keys.obj) || null
                };
            }
            return null;
        };
        _.mixin(Dataset.prototype, EventEmitter, {
            _overwrite: function overwrite(query, suggestions) {
                suggestions = suggestions || [];
                if (suggestions.length) {
                    this._renderSuggestions(query, suggestions);
                } else if (this.async && this.templates.pending) {
                    this._renderPending(query);
                } else if (!this.async && this.templates.notFound) {
                    this._renderNotFound(query);
                } else {
                    this._empty();
                }
                this.trigger("rendered", this.name, suggestions, false);
            },
            _append: function append(query, suggestions) {
                suggestions = suggestions || [];
                if (suggestions.length && this.$lastSuggestion.length) {
                    this._appendSuggestions(query, suggestions);
                } else if (suggestions.length) {
                    this._renderSuggestions(query, suggestions);
                } else if (!this.$lastSuggestion.length && this.templates.notFound) {
                    this._renderNotFound(query);
                }
                this.trigger("rendered", this.name, suggestions, true);
            },
            _renderSuggestions: function renderSuggestions(query, suggestions) {
                var $fragment;
                $fragment = this._getSuggestionsFragment(query, suggestions);
                this.$lastSuggestion = $fragment.children().last();
                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));
            },
            _appendSuggestions: function appendSuggestions(query, suggestions) {
                var $fragment, $lastSuggestion;
                $fragment = this._getSuggestionsFragment(query, suggestions);
                $lastSuggestion = $fragment.children().last();
                this.$lastSuggestion.after($fragment);
                this.$lastSuggestion = $lastSuggestion;
            },
            _renderPending: function renderPending(query) {
                var template = this.templates.pending;
                this._resetLastSuggestion();
                template && this.$el.html(template({
                    query: query,
                    dataset: this.name
                }));
            },
            _renderNotFound: function renderNotFound(query) {
                var template = this.templates.notFound;
                this._resetLastSuggestion();
                template && this.$el.html(template({
                    query: query,
                    dataset: this.name
                }));
            },
            _empty: function empty() {
                this.$el.empty();
                this._resetLastSuggestion();
            },
            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {
                var that = this, fragment;
                fragment = document.createDocumentFragment();
                _.each(suggestions, function getSuggestionNode(suggestion) {
                    var $el, context;
                    context = that._injectQuery(query, suggestion);
                    $el = $(that.templates.suggestion(context)).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + " " + that.classes.selectable);
                    fragment.appendChild($el[0]);
                });
                this.highlight && highlight({
                    className: this.classes.highlight,
                    node: fragment,
                    pattern: query
                });
                return $(fragment);
            },
            _getFooter: function getFooter(query, suggestions) {
                return this.templates.footer ? this.templates.footer({
                    query: query,
                    suggestions: suggestions,
                    dataset: this.name
                }) : null;
            },
            _getHeader: function getHeader(query, suggestions) {
                return this.templates.header ? this.templates.header({
                    query: query,
                    suggestions: suggestions,
                    dataset: this.name
                }) : null;
            },
            _resetLastSuggestion: function resetLastSuggestion() {
                this.$lastSuggestion = $();
            },
            _injectQuery: function injectQuery(query, obj) {
                return _.isObject(obj) ? _.mixin({
                    _query: query
                }, obj) : obj;
            },
            update: function update(query) {
                var that = this, canceled = false, syncCalled = false, rendered = 0;
                this.cancel();
                this.cancel = function cancel() {
                    canceled = true;
                    that.cancel = $.noop;
                    that.async && that.trigger("asyncCanceled", query);
                };
                this.source(query, sync, async);
                !syncCalled && sync([]);
                function sync(suggestions) {
                    if (syncCalled) {
                        return;
                    }
                    syncCalled = true;
                    suggestions = (suggestions || []).slice(0, that.limit);
                    rendered = suggestions.length;
                    that._overwrite(query, suggestions);
                    if (rendered < that.limit && that.async) {
                        that.trigger("asyncRequested", query);
                    }
                }
                function async(suggestions) {
                    suggestions = suggestions || [];
                    if (!canceled && rendered < that.limit) {
                        that.cancel = $.noop;
                        rendered += suggestions.length;
                        that._append(query, suggestions.slice(0, that.limit - rendered));
                        that.async && that.trigger("asyncReceived", query);
                    }
                }
            },
            cancel: $.noop,
            clear: function clear() {
                this._empty();
                this.cancel();
                this.trigger("cleared");
            },
            isEmpty: function isEmpty() {
                return this.$el.is(":empty");
            },
            destroy: function destroy() {
                this.$el = $("<div>");
            }
        });
        return Dataset;
        function getDisplayFn(display) {
            display = display || _.stringify;
            return _.isFunction(display) ? display : displayFn;
            function displayFn(obj) {
                return obj[display];
            }
        }
        function getTemplates(templates, displayFn) {
            return {
                notFound: templates.notFound && _.templatify(templates.notFound),
                pending: templates.pending && _.templatify(templates.pending),
                header: templates.header && _.templatify(templates.header),
                footer: templates.footer && _.templatify(templates.footer),
                suggestion: templates.suggestion || suggestionTemplate
            };
            function suggestionTemplate(context) {
                return $("<div>").text(displayFn(context));
            }
        }
        function isValidName(str) {
            return /^[_a-zA-Z0-9-]+$/.test(str);
        }
    }();
    var Menu = function() {
        "use strict";
        function Menu(o, www) {
            var that = this;
            o = o || {};
            if (!o.node) {
                $.error("node is required");
            }
            www.mixin(this);
            this.$node = $(o.node);
            this.query = null;
            this.datasets = _.map(o.datasets, initializeDataset);
            function initializeDataset(oDataset) {
                var node = that.$node.find(oDataset.node).first();
                oDataset.node = node.length ? node : $("<div>").appendTo(that.$node);
                return new Dataset(oDataset, www);
            }
        }
        _.mixin(Menu.prototype, EventEmitter, {
            _onSelectableClick: function onSelectableClick($e) {
                this.trigger("selectableClicked", $($e.currentTarget));
            },
            _onRendered: function onRendered(type, dataset, suggestions, async) {
                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());
                this.trigger("datasetRendered", dataset, suggestions, async);
            },
            _onCleared: function onCleared() {
                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());
                this.trigger("datasetCleared");
            },
            _propagate: function propagate() {
                this.trigger.apply(this, arguments);
            },
            _allDatasetsEmpty: function allDatasetsEmpty() {
                return _.every(this.datasets, isDatasetEmpty);
                function isDatasetEmpty(dataset) {
                    return dataset.isEmpty();
                }
            },
            _getSelectables: function getSelectables() {
                return this.$node.find(this.selectors.selectable);
            },
            _removeCursor: function _removeCursor() {
                var $selectable = this.getActiveSelectable();
                $selectable && $selectable.removeClass(this.classes.cursor);
            },
            _ensureVisible: function ensureVisible($el) {
                var elTop, elBottom, nodeScrollTop, nodeHeight;
                elTop = $el.position().top;
                elBottom = elTop + $el.outerHeight(true);
                nodeScrollTop = this.$node.scrollTop();
                nodeHeight = this.$node.height() + parseInt(this.$node.css("paddingTop"), 10) + parseInt(this.$node.css("paddingBottom"), 10);
                if (elTop < 0) {
                    this.$node.scrollTop(nodeScrollTop + elTop);
                } else if (nodeHeight < elBottom) {
                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));
                }
            },
            bind: function() {
                var that = this, onSelectableClick;
                onSelectableClick = _.bind(this._onSelectableClick, this);
                this.$node.on("click.tt", this.selectors.selectable, onSelectableClick);
                _.each(this.datasets, function(dataset) {
                    dataset.onSync("asyncRequested", that._propagate, that).onSync("asyncCanceled", that._propagate, that).onSync("asyncReceived", that._propagate, that).onSync("rendered", that._onRendered, that).onSync("cleared", that._onCleared, that);
                });
                return this;
            },
            isOpen: function isOpen() {
                return this.$node.hasClass(this.classes.open);
            },
            open: function open() {
                this.$node.addClass(this.classes.open);
            },
            close: function close() {
                this.$node.removeClass(this.classes.open);
                this._removeCursor();
            },
            setLanguageDirection: function setLanguageDirection(dir) {
                this.$node.attr("dir", dir);
            },
            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {
                var $selectables, $oldCursor, oldIndex, newIndex;
                $oldCursor = this.getActiveSelectable();
                $selectables = this._getSelectables();
                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;
                newIndex = oldIndex + delta;
                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;
                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;
                return newIndex === -1 ? null : $selectables.eq(newIndex);
            },
            setCursor: function setCursor($selectable) {
                this._removeCursor();
                if ($selectable = $selectable && $selectable.first()) {
                    $selectable.addClass(this.classes.cursor);
                    this._ensureVisible($selectable);
                }
            },
            getSelectableData: function getSelectableData($el) {
                return $el && $el.length ? Dataset.extractData($el) : null;
            },
            getActiveSelectable: function getActiveSelectable() {
                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();
                return $selectable.length ? $selectable : null;
            },
            getTopSelectable: function getTopSelectable() {
                var $selectable = this._getSelectables().first();
                return $selectable.length ? $selectable : null;
            },
            update: function update(query) {
                var isValidUpdate = query !== this.query;
                if (isValidUpdate) {
                    this.query = query;
                    _.each(this.datasets, updateDataset);
                }
                return isValidUpdate;
                function updateDataset(dataset) {
                    dataset.update(query);
                }
            },
            empty: function empty() {
                _.each(this.datasets, clearDataset);
                this.query = null;
                this.$node.addClass(this.classes.empty);
                function clearDataset(dataset) {
                    dataset.clear();
                }
            },
            destroy: function destroy() {
                this.$node.off(".tt");
                this.$node = $("<div>");
                _.each(this.datasets, destroyDataset);
                function destroyDataset(dataset) {
                    dataset.destroy();
                }
            }
        });
        return Menu;
    }();
    var DefaultMenu = function() {
        "use strict";
        var s = Menu.prototype;
        function DefaultMenu() {
            Menu.apply(this, [].slice.call(arguments, 0));
        }
        _.mixin(DefaultMenu.prototype, Menu.prototype, {
            open: function open() {
                !this._allDatasetsEmpty() && this._show();
                return s.open.apply(this, [].slice.call(arguments, 0));
            },
            close: function close() {
                this._hide();
                return s.close.apply(this, [].slice.call(arguments, 0));
            },
            _onRendered: function onRendered() {
                if (this._allDatasetsEmpty()) {
                    this._hide();
                } else {
                    this.isOpen() && this._show();
                }
                return s._onRendered.apply(this, [].slice.call(arguments, 0));
            },
            _onCleared: function onCleared() {
                if (this._allDatasetsEmpty()) {
                    this._hide();
                } else {
                    this.isOpen() && this._show();
                }
                return s._onCleared.apply(this, [].slice.call(arguments, 0));
            },
            setLanguageDirection: function setLanguageDirection(dir) {
                this.$node.css(dir === "ltr" ? this.css.ltr : this.css.rtl);
                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));
            },
            _hide: function hide() {
                this.$node.hide();
            },
            _show: function show() {
                this.$node.css("display", "block");
            }
        });
        return DefaultMenu;
    }();
    var Typeahead = function() {
        "use strict";
        function Typeahead(o, www) {
            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;
            o = o || {};
            if (!o.input) {
                $.error("missing input");
            }
            if (!o.menu) {
                $.error("missing menu");
            }
            if (!o.eventBus) {
                $.error("missing event bus");
            }
            www.mixin(this);
            this.eventBus = o.eventBus;
            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;
            this.input = o.input;
            this.menu = o.menu;
            this.enabled = true;
            this.active = false;
            this.input.hasFocus() && this.activate();
            this.dir = this.input.getLangDir();
            this._hacks();
            this.menu.bind().onSync("selectableClicked", this._onSelectableClicked, this).onSync("asyncRequested", this._onAsyncRequested, this).onSync("asyncCanceled", this._onAsyncCanceled, this).onSync("asyncReceived", this._onAsyncReceived, this).onSync("datasetRendered", this._onDatasetRendered, this).onSync("datasetCleared", this._onDatasetCleared, this);
            onFocused = c(this, "activate", "open", "_onFocused");
            onBlurred = c(this, "deactivate", "_onBlurred");
            onEnterKeyed = c(this, "isActive", "isOpen", "_onEnterKeyed");
            onTabKeyed = c(this, "isActive", "isOpen", "_onTabKeyed");
            onEscKeyed = c(this, "isActive", "_onEscKeyed");
            onUpKeyed = c(this, "isActive", "open", "_onUpKeyed");
            onDownKeyed = c(this, "isActive", "open", "_onDownKeyed");
            onLeftKeyed = c(this, "isActive", "isOpen", "_onLeftKeyed");
            onRightKeyed = c(this, "isActive", "isOpen", "_onRightKeyed");
            onQueryChanged = c(this, "_openIfActive", "_onQueryChanged");
            onWhitespaceChanged = c(this, "_openIfActive", "_onWhitespaceChanged");
            this.input.bind().onSync("focused", onFocused, this).onSync("blurred", onBlurred, this).onSync("enterKeyed", onEnterKeyed, this).onSync("tabKeyed", onTabKeyed, this).onSync("escKeyed", onEscKeyed, this).onSync("upKeyed", onUpKeyed, this).onSync("downKeyed", onDownKeyed, this).onSync("leftKeyed", onLeftKeyed, this).onSync("rightKeyed", onRightKeyed, this).onSync("queryChanged", onQueryChanged, this).onSync("whitespaceChanged", onWhitespaceChanged, this).onSync("langDirChanged", this._onLangDirChanged, this);
        }
        _.mixin(Typeahead.prototype, {
            _hacks: function hacks() {
                var $input, $menu;
                $input = this.input.$input || $("<div>");
                $menu = this.menu.$node || $("<div>");
                $input.on("blur.tt", function($e) {
                    var active, isActive, hasActive;
                    active = document.activeElement;
                    isActive = $menu.is(active);
                    hasActive = $menu.has(active).length > 0;
                    if (_.isMsie() && (isActive || hasActive)) {
                        $e.preventDefault();
                        $e.stopImmediatePropagation();
                        _.defer(function() {
                            $input.focus();
                        });
                    }
                });
                $menu.on("mousedown.tt", function($e) {
                    $e.preventDefault();
                });
            },
            _onSelectableClicked: function onSelectableClicked(type, $el) {
                this.select($el);
            },
            _onDatasetCleared: function onDatasetCleared() {
                this._updateHint();
            },
            _onDatasetRendered: function onDatasetRendered(type, dataset, suggestions, async) {
                this._updateHint();
                this.eventBus.trigger("render", suggestions, async, dataset);
            },
            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {
                this.eventBus.trigger("asyncrequest", query, dataset);
            },
            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {
                this.eventBus.trigger("asynccancel", query, dataset);
            },
            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {
                this.eventBus.trigger("asyncreceive", query, dataset);
            },
            _onFocused: function onFocused() {
                this._minLengthMet() && this.menu.update(this.input.getQuery());
            },
            _onBlurred: function onBlurred() {
                if (this.input.hasQueryChangedSinceLastFocus()) {
                    this.eventBus.trigger("change", this.input.getQuery());
                }
            },
            _onEnterKeyed: function onEnterKeyed(type, $e) {
                var $selectable;
                if ($selectable = this.menu.getActiveSelectable()) {
                    this.select($selectable) && $e.preventDefault();
                }
            },
            _onTabKeyed: function onTabKeyed(type, $e) {
                var $selectable;
                if ($selectable = this.menu.getActiveSelectable()) {
                    this.select($selectable) && $e.preventDefault();
                } else if ($selectable = this.menu.getTopSelectable()) {
                    this.autocomplete($selectable) && $e.preventDefault();
                }
            },
            _onEscKeyed: function onEscKeyed() {
                this.close();
            },
            _onUpKeyed: function onUpKeyed() {
                this.moveCursor(-1);
            },
            _onDownKeyed: function onDownKeyed() {
                this.moveCursor(+1);
            },
            _onLeftKeyed: function onLeftKeyed() {
                if (this.dir === "rtl" && this.input.isCursorAtEnd()) {
                    this.autocomplete(this.menu.getTopSelectable());
                }
            },
            _onRightKeyed: function onRightKeyed() {
                if (this.dir === "ltr" && this.input.isCursorAtEnd()) {
                    this.autocomplete(this.menu.getTopSelectable());
                }
            },
            _onQueryChanged: function onQueryChanged(e, query) {
                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();
            },
            _onWhitespaceChanged: function onWhitespaceChanged() {
                this._updateHint();
            },
            _onLangDirChanged: function onLangDirChanged(e, dir) {
                if (this.dir !== dir) {
                    this.dir = dir;
                    this.menu.setLanguageDirection(dir);
                }
            },
            _openIfActive: function openIfActive() {
                this.isActive() && this.open();
            },
            _minLengthMet: function minLengthMet(query) {
                query = _.isString(query) ? query : this.input.getQuery() || "";
                return query.length >= this.minLength;
            },
            _updateHint: function updateHint() {
                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;
                $selectable = this.menu.getTopSelectable();
                data = this.menu.getSelectableData($selectable);
                val = this.input.getInputValue();
                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {
                    query = Input.normalizeQuery(val);
                    escapedQuery = _.escapeRegExChars(query);
                    frontMatchRegEx = new RegExp("^(?:" + escapedQuery + ")(.+$)", "i");
                    match = frontMatchRegEx.exec(data.val);
                    match && this.input.setHint(val + match[1]);
                } else {
                    this.input.clearHint();
                }
            },
            isEnabled: function isEnabled() {
                return this.enabled;
            },
            enable: function enable() {
                this.enabled = true;
            },
            disable: function disable() {
                this.enabled = false;
            },
            isActive: function isActive() {
                return this.active;
            },
            activate: function activate() {
                if (this.isActive()) {
                    return true;
                } else if (!this.isEnabled() || this.eventBus.before("active")) {
                    return false;
                } else {
                    this.active = true;
                    this.eventBus.trigger("active");
                    return true;
                }
            },
            deactivate: function deactivate() {
                if (!this.isActive()) {
                    return true;
                } else if (this.eventBus.before("idle")) {
                    return false;
                } else {
                    this.active = false;
                    this.close();
                    this.eventBus.trigger("idle");
                    return true;
                }
            },
            isOpen: function isOpen() {
                return this.menu.isOpen();
            },
            open: function open() {
                if (!this.isOpen() && !this.eventBus.before("open")) {
                    this.menu.open();
                    this._updateHint();
                    this.eventBus.trigger("open");
                }
                return this.isOpen();
            },
            close: function close() {
                if (this.isOpen() && !this.eventBus.before("close")) {
                    this.menu.close();
                    this.input.clearHint();
                    this.input.resetInputValue();
                    this.eventBus.trigger("close");
                }
                return !this.isOpen();
            },
            setVal: function setVal(val) {
                this.input.setQuery(_.toStr(val));
            },
            getVal: function getVal() {
                return this.input.getQuery();
            },
            select: function select($selectable) {
                var data = this.menu.getSelectableData($selectable);
                if (data && !this.eventBus.before("select", data.obj)) {
                    this.input.setQuery(data.val, true);
                    this.eventBus.trigger("select", data.obj);
                    this.close();
                    return true;
                }
                return false;
            },
            autocomplete: function autocomplete($selectable) {
                var query, data, isValid;
                query = this.input.getQuery();
                data = this.menu.getSelectableData($selectable);
                isValid = data && query !== data.val;
                if (isValid && !this.eventBus.before("autocomplete", data.obj)) {
                    this.input.setQuery(data.val);
                    this.eventBus.trigger("autocomplete", data.obj);
                    return true;
                }
                return false;
            },
            moveCursor: function moveCursor(delta) {
                var query, $candidate, data, payload, cancelMove;
                query = this.input.getQuery();
                $candidate = this.menu.selectableRelativeToCursor(delta);
                data = this.menu.getSelectableData($candidate);
                payload = data ? data.obj : null;
                cancelMove = this._minLengthMet() && this.menu.update(query);
                if (!cancelMove && !this.eventBus.before("cursorchange", payload)) {
                    this.menu.setCursor($candidate);
                    if (data) {
                        this.input.setInputValue(data.val);
                    } else {
                        this.input.resetInputValue();
                        this._updateHint();
                    }
                    this.eventBus.trigger("cursorchange", payload);
                    return true;
                }
                return false;
            },
            destroy: function destroy() {
                this.input.destroy();
                this.menu.destroy();
            }
        });
        return Typeahead;
        function c(ctx) {
            var methods = [].slice.call(arguments, 1);
            return function() {
                var args = [].slice.call(arguments);
                _.each(methods, function(method) {
                    return ctx[method].apply(ctx, args);
                });
            };
        }
    }();
    (function() {
        "use strict";
        var old, keys, methods;
        old = $.fn.typeahead;
        keys = {
            www: "tt-www",
            attrs: "tt-attrs",
            typeahead: "tt-typeahead"
        };
        methods = {
            initialize: function initialize(o, datasets) {
                var www;
                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);
                o = o || {};
                www = WWW(o.classNames);
                return this.each(attach);
                function attach() {
                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, typeahead, MenuConstructor;
                    _.each(datasets, function(d) {
                        d.highlight = !!o.highlight;
                    });
                    $input = $(this);
                    $wrapper = $(www.html.wrapper);
                    $hint = $elOrNull(o.hint);
                    $menu = $elOrNull(o.menu);
                    defaultHint = o.hint !== false && !$hint;
                    defaultMenu = o.menu !== false && !$menu;
                    defaultHint && ($hint = buildHintFromInput($input, www));
                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));
                    $hint && $hint.val("");
                    $input = prepInput($input, www);
                    if (defaultHint || defaultMenu) {
                        $wrapper.css(www.css.wrapper);
                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);
                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);
                    }
                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;
                    eventBus = new EventBus({
                        el: $input
                    });
                    input = new Input({
                        hint: $hint,
                        input: $input
                    }, www);
                    menu = new MenuConstructor({
                        node: $menu,
                        datasets: datasets
                    }, www);
                    typeahead = new Typeahead({
                        input: input,
                        menu: menu,
                        eventBus: eventBus,
                        minLength: o.minLength
                    }, www);
                    $input.data(keys.www, www);
                    $input.data(keys.typeahead, typeahead);
                }
            },
            isEnabled: function isEnabled() {
                var enabled;
                ttEach(this.first(), function(t) {
                    enabled = t.isEnabled();
                });
                return enabled;
            },
            enable: function enable() {
                ttEach(this, function(t) {
                    t.enable();
                });
                return this;
            },
            disable: function disable() {
                ttEach(this, function(t) {
                    t.disable();
                });
                return this;
            },
            isActive: function isActive() {
                var active;
                ttEach(this.first(), function(t) {
                    active = t.isActive();
                });
                return active;
            },
            activate: function activate() {
                ttEach(this, function(t) {
                    t.activate();
                });
                return this;
            },
            deactivate: function deactivate() {
                ttEach(this, function(t) {
                    t.deactivate();
                });
                return this;
            },
            isOpen: function isOpen() {
                var open;
                ttEach(this.first(), function(t) {
                    open = t.isOpen();
                });
                return open;
            },
            open: function open() {
                ttEach(this, function(t) {
                    t.open();
                });
                return this;
            },
            close: function close() {
                ttEach(this, function(t) {
                    t.close();
                });
                return this;
            },
            select: function select(el) {
                var success = false, $el = $(el);
                ttEach(this.first(), function(t) {
                    success = t.select($el);
                });
                return success;
            },
            autocomplete: function autocomplete(el) {
                var success = false, $el = $(el);
                ttEach(this.first(), function(t) {
                    success = t.autocomplete($el);
                });
                return success;
            },
            moveCursor: function moveCursoe(delta) {
                var success = false;
                ttEach(this.first(), function(t) {
                    success = t.moveCursor(delta);
                });
                return success;
            },
            val: function val(newVal) {
                var query;
                if (!arguments.length) {
                    ttEach(this.first(), function(t) {
                        query = t.getVal();
                    });
                    return query;
                } else {
                    ttEach(this, function(t) {
                        t.setVal(newVal);
                    });
                    return this;
                }
            },
            destroy: function destroy() {
                ttEach(this, function(typeahead, $input) {
                    revert($input);
                    typeahead.destroy();
                });
                return this;
            }
        };
        $.fn.typeahead = function(method) {
            if (methods[method]) {
                return methods[method].apply(this, [].slice.call(arguments, 1));
            } else {
                return methods.initialize.apply(this, arguments);
            }
        };
        $.fn.typeahead.noConflict = function noConflict() {
            $.fn.typeahead = old;
            return this;
        };
        function ttEach($els, fn) {
            $els.each(function() {
                var $input = $(this), typeahead;
                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);
            });
        }
        function buildHintFromInput($input, www) {
            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop("readonly", true).removeAttr("id name placeholder required").attr({
                autocomplete: "off",
                spellcheck: "false",
                tabindex: -1
            });
        }
        function prepInput($input, www) {
            $input.data(keys.attrs, {
                dir: $input.attr("dir"),
                autocomplete: $input.attr("autocomplete"),
                spellcheck: $input.attr("spellcheck"),
                style: $input.attr("style")
            });
            $input.addClass(www.classes.input).attr({
                autocomplete: "off",
                spellcheck: false
            });
            try {
                !$input.attr("dir") && $input.attr("dir", "auto");
            } catch (e) {}
            return $input;
        }
        function getBackgroundStyles($el) {
            return {
                backgroundAttachment: $el.css("background-attachment"),
                backgroundClip: $el.css("background-clip"),
                backgroundColor: $el.css("background-color"),
                backgroundImage: $el.css("background-image"),
                backgroundOrigin: $el.css("background-origin"),
                backgroundPosition: $el.css("background-position"),
                backgroundRepeat: $el.css("background-repeat"),
                backgroundSize: $el.css("background-size")
            };
        }
        function revert($input) {
            var www, $wrapper;
            www = $input.data(keys.www);
            $wrapper = $input.parent().filter(www.selectors.wrapper);
            _.each($input.data(keys.attrs), function(val, key) {
                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);
            });
            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);
            if ($wrapper.length) {
                $input.detach().insertAfter($wrapper);
                $wrapper.remove();
            }
        }
        function $elOrNull(obj) {
            var isValid, $el;
            isValid = _.isJQuery(obj) || _.isElement(obj);
            $el = isValid ? $(obj).first() : [];
            return $el.length ? $el : null;
        }
    })();
});
/*!
 * MediaElement.js
 * http://www.mediaelementjs.com/
 *
 * Wrapper that mimics native HTML5 MediaElement (audio and video)
 * using a variety of technologies (pure JavaScript, Flash, iframe)
 *
 * Copyright 2010-2017, John Dyer (http://j.hn/)
 * License: MIT
 *
 */
!function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return i(n||e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){},{}],2:[function(e,t,n){(function(n){var o,i=void 0!==n?n:"undefined"!=typeof window?window:{},r=e(1);"undefined"!=typeof document?o=document:(o=i["__GLOBAL_DOCUMENT_CACHE@4"])||(o=i["__GLOBAL_DOCUMENT_CACHE@4"]=r),t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1}],3:[function(e,t,n){(function(e){var n;n="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){!function(e){var n=setTimeout;function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function r(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(e){return void s(t.promise,e)}a(t.promise,o)}else(1===e._state?a:s)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void d((o=n,r=t,function(){o.apply(r,arguments)}),e)}e._state=1,e._value=t,l(e)}catch(t){s(e,t)}var o,r}function s(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function d(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return r(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){if(0===t.length)return e([]);var o=t.length;function i(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){i(r,e)},n)}t[r]=a,0==--o&&e(t)}catch(e){n(e)}}for(var r=0;r<t.length;r++)i(r,t[r])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var o=0,i=e.length;o<i;o++)e[o].then(t,n)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){n(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==t&&t.exports?t.exports=i:e.Promise||(e.Promise=i)}(this)},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e(7),a=(o=r)&&o.__esModule?o:{default:o},s=e(15),l=e(27);var d={lang:"en",en:s.EN,language:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(null!=t&&t.length){if("string"!=typeof t[0])throw new TypeError("Language code must be a string value");if(!/^[a-z]{2,3}((\-|_)[a-z]{2})?$/i.test(t[0]))throw new TypeError("Language code must have format 2-3 letters and. optionally, hyphen, underscore followed by 2 more letters");d.lang=t[0],void 0===d[t[0]]?(t[1]=null!==t[1]&&void 0!==t[1]&&"object"===i(t[1])?t[1]:{},d[t[0]]=(0,l.isObjectEmpty)(t[1])?s.EN:t[1]):null!==t[1]&&void 0!==t[1]&&"object"===i(t[1])&&(d[t[0]]=t[1])}return d.lang},t:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e&&e.length){var n=void 0,o=void 0,r=d.language(),a=function(e,t,n){return"object"!==(void 0===e?"undefined":i(e))||"number"!=typeof t||"number"!=typeof n?e:[function(){return arguments.length<=1?void 0:arguments[1]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]},function(){return 0===(arguments.length<=0?void 0:arguments[0])||1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]},function(){return(arguments.length<=0?void 0:arguments[0])%10==1&&(arguments.length<=0?void 0:arguments[0])%100!=11?arguments.length<=1?void 0:arguments[1]:0!==(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 1===(arguments.length<=0?void 0:arguments[0])||11===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=0?void 0:arguments[0])||12===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:(arguments.length<=0?void 0:arguments[0])>2&&(arguments.length<=0?void 0:arguments[0])<20?arguments.length<=3?void 0:arguments[3]:arguments.length<=4?void 0:arguments[4]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:0===(arguments.length<=0?void 0:arguments[0])||(arguments.length<=0?void 0:arguments[0])%100>0&&(arguments.length<=0?void 0:arguments[0])%100<20?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return(arguments.length<=0?void 0:arguments[0])%10==1&&(arguments.length<=0?void 0:arguments[0])%100!=11?arguments.length<=1?void 0:arguments[1]:(arguments.length<=0?void 0:arguments[0])%10>=2&&((arguments.length<=0?void 0:arguments[0])%100<10||(arguments.length<=0?void 0:arguments[0])%100>=20)?arguments.length<=2?void 0:arguments[2]:[3]},function(){return(arguments.length<=0?void 0:arguments[0])%10==1&&(arguments.length<=0?void 0:arguments[0])%100!=11?arguments.length<=1?void 0:arguments[1]:(arguments.length<=0?void 0:arguments[0])%10>=2&&(arguments.length<=0?void 0:arguments[0])%10<=4&&((arguments.length<=0?void 0:arguments[0])%100<10||(arguments.length<=0?void 0:arguments[0])%100>=20)?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:(arguments.length<=0?void 0:arguments[0])>=2&&(arguments.length<=0?void 0:arguments[0])<=4?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:(arguments.length<=0?void 0:arguments[0])%10>=2&&(arguments.length<=0?void 0:arguments[0])%10<=4&&((arguments.length<=0?void 0:arguments[0])%100<10||(arguments.length<=0?void 0:arguments[0])%100>=20)?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return(arguments.length<=0?void 0:arguments[0])%100==1?arguments.length<=2?void 0:arguments[2]:(arguments.length<=0?void 0:arguments[0])%100==2?arguments.length<=3?void 0:arguments[3]:(arguments.length<=0?void 0:arguments[0])%100==3||(arguments.length<=0?void 0:arguments[0])%100==4?arguments.length<=4?void 0:arguments[4]:arguments.length<=1?void 0:arguments[1]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:(arguments.length<=0?void 0:arguments[0])>2&&(arguments.length<=0?void 0:arguments[0])<7?arguments.length<=3?void 0:arguments[3]:(arguments.length<=0?void 0:arguments[0])>6&&(arguments.length<=0?void 0:arguments[0])<11?arguments.length<=4?void 0:arguments[4]:arguments.length<=5?void 0:arguments[5]},function(){return 0===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:2===(arguments.length<=0?void 0:arguments[0])?arguments.length<=3?void 0:arguments[3]:(arguments.length<=0?void 0:arguments[0])%100>=3&&(arguments.length<=0?void 0:arguments[0])%100<=10?arguments.length<=4?void 0:arguments[4]:(arguments.length<=0?void 0:arguments[0])%100>=11?arguments.length<=5?void 0:arguments[5]:arguments.length<=6?void 0:arguments[6]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:0===(arguments.length<=0?void 0:arguments[0])||(arguments.length<=0?void 0:arguments[0])%100>1&&(arguments.length<=0?void 0:arguments[0])%100<11?arguments.length<=2?void 0:arguments[2]:(arguments.length<=0?void 0:arguments[0])%100>10&&(arguments.length<=0?void 0:arguments[0])%100<20?arguments.length<=3?void 0:arguments[3]:arguments.length<=4?void 0:arguments[4]},function(){return(arguments.length<=0?void 0:arguments[0])%10==1?arguments.length<=1?void 0:arguments[1]:(arguments.length<=0?void 0:arguments[0])%10==2?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 11!==(arguments.length<=0?void 0:arguments[0])&&(arguments.length<=0?void 0:arguments[0])%10==1?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:(arguments.length<=0?void 0:arguments[0])%10>=2&&(arguments.length<=0?void 0:arguments[0])%10<=4&&((arguments.length<=0?void 0:arguments[0])%100<10||(arguments.length<=0?void 0:arguments[0])%100>=20)?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:8!==(arguments.length<=0?void 0:arguments[0])&&11!==(arguments.length<=0?void 0:arguments[0])?arguments.length<=3?void 0:arguments[3]:arguments.length<=4?void 0:arguments[4]},function(){return 0===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]},function(){return 1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:3===(arguments.length<=0?void 0:arguments[0])?arguments.length<=3?void 0:arguments[3]:arguments.length<=4?void 0:arguments[4]},function(){return 0===(arguments.length<=0?void 0:arguments[0])?arguments.length<=1?void 0:arguments[1]:1===(arguments.length<=0?void 0:arguments[0])?arguments.length<=2?void 0:arguments[2]:arguments.length<=3?void 0:arguments[3]}][n].apply(null,[t].concat(e))};return void 0!==d[r]&&(n=d[r][e],null!==t&&"number"==typeof t&&(o=d[r]["mejs.plural-form"],n=a.apply(null,[n,t,o]))),!n&&d.en&&(n=d.en[e],null!==t&&"number"==typeof t&&(o=d.en["mejs.plural-form"],n=a.apply(null,[n,t,o]))),n=n||e,null!==t&&"number"==typeof t&&(n=n.replace("%1",t)),(0,l.escapeHTML)(n)}return e}};a.default.i18n=d,"undefined"!=typeof mejsL10n&&a.default.i18n.language(mejsL10n.language,mejsL10n.strings),n.default=d},{15:15,27:27,7:7}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=c(e(3)),r=c(e(2)),a=c(e(7)),s=e(27),l=e(28),d=e(8),u=e(25);function c(e){return e&&e.__esModule?e:{default:e}}var f=function e(t,n,c){var f=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var p=this;c=Array.isArray(c)?c:null,p.defaults={renderers:[],fakeNodeName:"mediaelementwrapper",pluginPath:"build/",shimScriptAccess:"sameDomain"},n=Object.assign(p.defaults,n),p.mediaElement=r.default.createElement(n.fakeNodeName);var m=t,h=!1;if("string"==typeof t?p.mediaElement.originalNode=r.default.getElementById(t):(p.mediaElement.originalNode=t,m=t.id),void 0===p.mediaElement.originalNode||null===p.mediaElement.originalNode)return null;p.mediaElement.options=n,m=m||"mejs_"+Math.random().toString().slice(2),p.mediaElement.originalNode.setAttribute("id",m+"_from_mejs");var v=p.mediaElement.originalNode.tagName.toLowerCase();["video","audio"].indexOf(v)>-1&&!p.mediaElement.originalNode.getAttribute("preload")&&p.mediaElement.originalNode.setAttribute("preload","none"),p.mediaElement.originalNode.parentNode.insertBefore(p.mediaElement,p.mediaElement.originalNode),p.mediaElement.appendChild(p.mediaElement.originalNode);var g=function(e,t){if("https:"===i.default.location.protocol&&0===e.indexOf("http:")&&u.IS_IOS&&a.default.html5media.mediaTypes.indexOf(t)>-1){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=(i.default.URL||i.default.webkitURL).createObjectURL(this.response);return p.mediaElement.originalNode.setAttribute("src",t),t}return e},n.open("GET",e),n.responseType="blob",n.send()}return e},y=void 0;if(null!==c)y=c;else if(null!==p.mediaElement.originalNode)switch(y=[],p.mediaElement.originalNode.nodeName.toLowerCase()){case"iframe":y.push({type:"",src:p.mediaElement.originalNode.getAttribute("src")});break;case"audio":case"video":var E=p.mediaElement.originalNode.children.length,b=p.mediaElement.originalNode.getAttribute("src");if(b){var S=p.mediaElement.originalNode,x=(0,l.formatType)(b,S.getAttribute("type"));y.push({type:x,src:g(b,x)})}for(var w=0;w<E;w++){var P=p.mediaElement.originalNode.children[w];if("source"===P.tagName.toLowerCase()){var T=P.getAttribute("src"),C=(0,l.formatType)(T,P.getAttribute("type"));y.push({type:C,src:g(T,C)})}}}p.mediaElement.id=m,p.mediaElement.renderers={},p.mediaElement.events={},p.mediaElement.promises=[],p.mediaElement.renderer=null,p.mediaElement.rendererName=null,p.mediaElement.changeRenderer=function(e,t){var n=f,o=Object.keys(t[0]).length>2?t[0]:t[0].src;if(void 0!==n.mediaElement.renderer&&null!==n.mediaElement.renderer&&n.mediaElement.renderer.name===e)return n.mediaElement.renderer.pause(),n.mediaElement.renderer.stop&&n.mediaElement.renderer.stop(),n.mediaElement.renderer.show(),n.mediaElement.renderer.setSrc(o),!0;void 0!==n.mediaElement.renderer&&null!==n.mediaElement.renderer&&(n.mediaElement.renderer.pause(),n.mediaElement.renderer.stop&&n.mediaElement.renderer.stop(),n.mediaElement.renderer.hide());var i=n.mediaElement.renderers[e],r=null;if(null!=i)return i.show(),i.setSrc(o),n.mediaElement.renderer=i,n.mediaElement.rendererName=e,!0;for(var a=n.mediaElement.options.renderers.length?n.mediaElement.options.renderers:d.renderer.order,s=0,l=a.length;s<l;s++){var u=a[s];if(u===e){r=d.renderer.renderers[u];var c=Object.assign(r.options,n.mediaElement.options);return(i=r.create(n.mediaElement,c,t)).name=e,n.mediaElement.renderers[r.name]=i,n.mediaElement.renderer=i,n.mediaElement.rendererName=e,i.show(),!0}}return!1},p.mediaElement.setSize=function(e,t){void 0!==p.mediaElement.renderer&&null!==p.mediaElement.renderer&&p.mediaElement.renderer.setSize(e,t)},p.mediaElement.generateError=function(e,t){e=e||"",t=Array.isArray(t)?t:[];var n=(0,s.createEvent)("error",p.mediaElement);n.message=e,n.urls=t,p.mediaElement.dispatchEvent(n),h=!0};var k=a.default.html5media.properties,_=a.default.html5media.methods,N=function(e,t,n,o){var i=e[t];Object.defineProperty(e,t,{get:function(){return n.apply(e,[i])},set:function(t){return i=o.apply(e,[t])}})},A=function(e){if("src"!==e){var t=""+e.substring(0,1).toUpperCase()+e.substring(1),n=function(){return void 0!==p.mediaElement.renderer&&null!==p.mediaElement.renderer&&"function"==typeof p.mediaElement.renderer["get"+t]?p.mediaElement.renderer["get"+t]():null},o=function(e){void 0!==p.mediaElement.renderer&&null!==p.mediaElement.renderer&&"function"==typeof p.mediaElement.renderer["set"+t]&&p.mediaElement.renderer["set"+t](e)};N(p.mediaElement,e,n,o),p.mediaElement["get"+t]=n,p.mediaElement["set"+t]=o}},L=function(){return void 0!==p.mediaElement.renderer&&null!==p.mediaElement.renderer?p.mediaElement.renderer.getSrc():null},F=function(e){var t=[];if("string"==typeof e)t.push({src:e,type:e?(0,l.getTypeFromFile)(e):""});else if("object"===(void 0===e?"undefined":o(e))&&void 0!==e.src){var n=(0,l.absolutizeUrl)(e.src),i=e.type,r=Object.assign(e,{src:n,type:""!==i&&null!=i||!n?i:(0,l.getTypeFromFile)(n)});t.push(r)}else if(Array.isArray(e))for(var a=0,u=e.length;a<u;a++){var c=(0,l.absolutizeUrl)(e[a].src),f=e[a].type,m=Object.assign(e[a],{src:c,type:""!==f&&null!=f||!c?f:(0,l.getTypeFromFile)(c)});t.push(m)}var h=d.renderer.select(t,p.mediaElement.options.renderers.length?p.mediaElement.options.renderers:[]),v=void 0;if(p.mediaElement.paused||(p.mediaElement.pause(),v=(0,s.createEvent)("pause",p.mediaElement),p.mediaElement.dispatchEvent(v)),p.mediaElement.originalNode.src=t[0].src||"",null!==h||!t[0].src)return t[0].src?p.mediaElement.changeRenderer(h.rendererName,t):null;p.mediaElement.generateError("No renderer found",t)},j=function(e,t){try{if("play"===e&&"native_dash"===p.mediaElement.rendererName){var n=p.mediaElement.renderer[e](t);n&&"function"==typeof n.then&&n.catch(function(){p.mediaElement.paused&&setTimeout(function(){var e=p.mediaElement.renderer.play();void 0!==e&&e.catch(function(){p.mediaElement.renderer.paused||p.mediaElement.renderer.pause()})},150)})}else p.mediaElement.renderer[e](t)}catch(e){p.mediaElement.generateError(e,y)}},I=function(e){p.mediaElement[e]=function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return void 0!==p.mediaElement.renderer&&null!==p.mediaElement.renderer&&"function"==typeof p.mediaElement.renderer[e]&&(p.mediaElement.promises.length?Promise.all(p.mediaElement.promises).then(function(){j(e,n)}).catch(function(e){p.mediaElement.generateError(e,y)}):j(e,n)),null}};N(p.mediaElement,"src",L,F),p.mediaElement.getSrc=L,p.mediaElement.setSrc=F;for(var M=0,O=k.length;M<O;M++)A(k[M]);for(var D=0,V=_.length;D<V;D++)I(_[D]);return p.mediaElement.addEventListener=function(e,t){p.mediaElement.events[e]=p.mediaElement.events[e]||[],p.mediaElement.events[e].push(t)},p.mediaElement.removeEventListener=function(e,t){if(!e)return p.mediaElement.events={},!0;var n=p.mediaElement.events[e];if(!n)return!0;if(!t)return p.mediaElement.events[e]=[],!0;for(var o=0;o<n.length;o++)if(n[o]===t)return p.mediaElement.events[e].splice(o,1),!0;return!1},p.mediaElement.dispatchEvent=function(e){var t=p.mediaElement.events[e.type];if(t)for(var n=0;n<t.length;n++)t[n].apply(null,[e])},p.mediaElement.destroy=function(){var e=p.mediaElement.originalNode.cloneNode(!0),t=p.mediaElement.parentElement;e.removeAttribute("id"),e.remove(),p.mediaElement.remove(),t.append(e)},y.length&&(p.mediaElement.src=y),p.mediaElement.promises.length?Promise.all(p.mediaElement.promises).then(function(){p.mediaElement.options.success&&p.mediaElement.options.success(p.mediaElement,p.mediaElement.originalNode)}).catch(function(){h&&p.mediaElement.options.error&&p.mediaElement.options.error(p.mediaElement,p.mediaElement.originalNode)}):(p.mediaElement.options.success&&p.mediaElement.options.success(p.mediaElement,p.mediaElement.originalNode),h&&p.mediaElement.options.error&&p.mediaElement.options.error(p.mediaElement,p.mediaElement.originalNode)),p.mediaElement};i.default.MediaElement=f,a.default.MediaElement=f,n.default=f},{2:2,25:25,27:27,28:28,3:3,7:7,8:8}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i=e(3);var r={version:"4.2.8",html5media:{properties:["volume","src","currentTime","muted","duration","paused","ended","buffered","error","networkState","readyState","seeking","seekable","currentSrc","preload","bufferedBytes","bufferedTime","initialTime","startOffsetTime","defaultPlaybackRate","playbackRate","played","autoplay","loop","controls"],readOnlyProperties:["duration","paused","ended","buffered","error","networkState","readyState","seeking","seekable"],methods:["load","play","pause","canPlayType"],events:["loadstart","durationchange","loadedmetadata","loadeddata","progress","canplay","canplaythrough","suspend","abort","error","emptied","stalled","play","playing","pause","waiting","seeking","seeked","timeupdate","ended","ratechange","volumechange"],mediaTypes:["audio/mp3","audio/ogg","audio/oga","audio/wav","audio/x-wav","audio/wave","audio/x-pn-wav","audio/mpeg","audio/mp4","video/mp4","video/webm","video/ogg","video/ogv"]}};((o=i)&&o.__esModule?o:{default:o}).default.mejs=r,n.default=r},{3:3}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.renderer=void 0;var o,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=e(7),s=(o=a)&&o.__esModule?o:{default:o};var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderers={},this.order=[]}return r(e,[{key:"add",value:function(e){if(void 0===e.name)throw new TypeError("renderer must contain at least `name` property");this.renderers[e.name]=e,this.order.push(e.name)}},{key:"select",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.length;if(t=t.length?t:this.order,!n){var o=[/^(html5|native)/i,/^flash/i,/iframe$/i],i=function(e){for(var t=0,n=o.length;t<n;t++)if(o[t].test(e))return t;return o.length};t.sort(function(e,t){return i(e)-i(t)})}for(var r=0,a=t.length;r<a;r++){var s=t[r],l=this.renderers[s];if(null!=l)for(var d=0,u=e.length;d<u;d++)if("function"==typeof l.canPlayType&&"string"==typeof e[d].type&&l.canPlayType(e[d].type))return{rendererName:l.name,src:e[d].src}}return null}},{key:"order",set:function(e){if(!Array.isArray(e))throw new TypeError("order must be an array of strings.");this._order=e},get:function(){return this._order}},{key:"renderers",set:function(e){if(null!==e&&"object"!==(void 0===e?"undefined":i(e)))throw new TypeError("renderers must be an array of objects.");this._renderers=e},get:function(){return this._renderers}}]),e}(),d=n.renderer=new l;s.default.Renderers=d},{7:7}],9:[function(e,t,n){"use strict";var o=f(e(3)),i=f(e(2)),r=f(e(5)),a=e(16),s=f(a),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e(25)),d=e(27),u=e(26),c=e(28);function f(e){return e&&e.__esModule?e:{default:e}}Object.assign(a.config,{usePluginFullScreen:!0,fullscreenText:null,useFakeFullscreen:!1}),Object.assign(s.default.prototype,{isFullScreen:!1,isNativeFullScreen:!1,isInIframe:!1,isPluginClickThroughCreated:!1,fullscreenMode:"",containerSizeTimeout:null,buildfullscreen:function(e){if(e.isVideo){e.isInIframe=o.default.location!==o.default.parent.location,e.detectFullscreenMode();var t=this,n=(0,d.isString)(t.options.fullscreenText)?t.options.fullscreenText:r.default.t("mejs.fullscreen"),a=i.default.createElement("div");if(a.className=t.options.classPrefix+"button "+t.options.classPrefix+"fullscreen-button",a.innerHTML='<button type="button" aria-controls="'+t.id+'" title="'+n+'" aria-label="'+n+'" tabindex="0"></button>',t.addControlElement(a,"fullscreen"),a.addEventListener("click",function(){l.HAS_TRUE_NATIVE_FULLSCREEN&&l.IS_FULLSCREEN||e.isFullScreen?e.exitFullScreen():e.enterFullScreen()}),e.fullscreenBtn=a,t.options.keyActions.push({keys:[70],action:function(e,t,n,o){o.ctrlKey||void 0!==e.enterFullScreen&&(e.isFullScreen?e.exitFullScreen():e.enterFullScreen())}}),t.exitFullscreenCallback=function(n){27===(n.which||n.keyCode||0)&&(l.HAS_TRUE_NATIVE_FULLSCREEN&&l.IS_FULLSCREEN||t.isFullScreen)&&e.exitFullScreen()},t.globalBind("keydown",t.exitFullscreenCallback),t.normalHeight=0,t.normalWidth=0,l.HAS_TRUE_NATIVE_FULLSCREEN){e.globalBind(l.FULLSCREEN_EVENT_NAME,function(){e.isFullScreen&&(l.isFullScreen()?(e.isNativeFullScreen=!0,e.setControlsSize()):(e.isNativeFullScreen=!1,e.exitFullScreen()))})}}},cleanfullscreen:function(e){e.exitFullScreen(),e.globalUnbind("keydown",e.exitFullscreenCallback)},detectFullscreenMode:function(){var e=this,t=null!==e.media.rendererName&&/(native|html5)/i.test(e.media.rendererName),n="";return l.HAS_TRUE_NATIVE_FULLSCREEN&&t?n="native-native":l.HAS_TRUE_NATIVE_FULLSCREEN&&!t?n="plugin-native":e.usePluginFullScreen&&l.SUPPORT_POINTER_EVENTS&&(n="plugin-click"),e.fullscreenMode=n,n},enterFullScreen:function(){var e=this,t=null!==e.media.rendererName&&/(html5|native)/i.test(e.media.rendererName),n=getComputedStyle(e.getElement(e.container));if(!1===e.options.useFakeFullscreen&&l.IS_IOS&&l.HAS_IOS_FULLSCREEN&&"function"==typeof e.media.originalNode.webkitEnterFullscreen&&e.media.originalNode.canPlayType((0,c.getTypeFromFile)(e.media.getSrc())))e.media.originalNode.webkitEnterFullscreen();else{if((0,u.addClass)(i.default.documentElement,e.options.classPrefix+"fullscreen"),(0,u.addClass)(e.getElement(e.container),e.options.classPrefix+"container-fullscreen"),e.normalHeight=parseFloat(n.height),e.normalWidth=parseFloat(n.width),"native-native"!==e.fullscreenMode&&"plugin-native"!==e.fullscreenMode||(l.requestFullScreen(e.getElement(e.container)),e.isInIframe&&setTimeout(function t(){if(e.isNativeFullScreen){var n=o.default.innerWidth||i.default.documentElement.clientWidth||i.default.body.clientWidth,r=screen.width;Math.abs(r-n)>.002*r?e.exitFullScreen():setTimeout(t,500)}},1e3)),e.getElement(e.container).style.width="100%",e.getElement(e.container).style.height="100%",e.containerSizeTimeout=setTimeout(function(){e.getElement(e.container).style.width="100%",e.getElement(e.container).style.height="100%",e.setControlsSize()},500),t)e.node.style.width="100%",e.node.style.height="100%";else for(var r=e.getElement(e.container).querySelectorAll("embed, object, video"),a=r.length,s=0;s<a;s++)r[s].style.width="100%",r[s].style.height="100%";e.options.setDimensions&&"function"==typeof e.media.setSize&&e.media.setSize(screen.width,screen.height);for(var f=e.getElement(e.layers).children,p=f.length,m=0;m<p;m++)f[m].style.width="100%",f[m].style.height="100%";e.fullscreenBtn&&((0,u.removeClass)(e.fullscreenBtn,e.options.classPrefix+"fullscreen"),(0,u.addClass)(e.fullscreenBtn,e.options.classPrefix+"unfullscreen")),e.setControlsSize(),e.isFullScreen=!0;var h=Math.min(screen.width/e.width,screen.height/e.height),v=e.getElement(e.container).querySelector("."+e.options.classPrefix+"captions-text");v&&(v.style.fontSize=100*h+"%",v.style.lineHeight="normal",e.getElement(e.container).querySelector("."+e.options.classPrefix+"captions-position").style.bottom=(screen.height-e.normalHeight)/2-e.getElement(e.controls).offsetHeight/2+h+15+"px");var g=(0,d.createEvent)("enteredfullscreen",e.getElement(e.container));e.getElement(e.container).dispatchEvent(g)}},exitFullScreen:function(){var e=this,t=null!==e.media.rendererName&&/(native|html5)/i.test(e.media.rendererName);if(clearTimeout(e.containerSizeTimeout),l.HAS_TRUE_NATIVE_FULLSCREEN&&(l.IS_FULLSCREEN||e.isFullScreen)&&l.cancelFullScreen(),(0,u.removeClass)(i.default.documentElement,e.options.classPrefix+"fullscreen"),(0,u.removeClass)(e.getElement(e.container),e.options.classPrefix+"container-fullscreen"),e.options.setDimensions){if(e.getElement(e.container).style.width=e.normalWidth+"px",e.getElement(e.container).style.height=e.normalHeight+"px",t)e.node.style.width=e.normalWidth+"px",e.node.style.height=e.normalHeight+"px";else for(var n=e.getElement(e.container).querySelectorAll("embed, object, video"),o=n.length,r=0;r<o;r++)n[r].style.width=e.normalWidth+"px",n[r].style.height=e.normalHeight+"px";"function"==typeof e.media.setSize&&e.media.setSize(e.normalWidth,e.normalHeight);for(var a=e.getElement(e.layers).children,s=a.length,c=0;c<s;c++)a[c].style.width=e.normalWidth+"px",a[c].style.height=e.normalHeight+"px"}e.fullscreenBtn&&((0,u.removeClass)(e.fullscreenBtn,e.options.classPrefix+"unfullscreen"),(0,u.addClass)(e.fullscreenBtn,e.options.classPrefix+"fullscreen")),e.setControlsSize(),e.isFullScreen=!1;var f=e.getElement(e.container).querySelector("."+e.options.classPrefix+"captions-text");f&&(f.style.fontSize="",f.style.lineHeight="",e.getElement(e.container).querySelector("."+e.options.classPrefix+"captions-position").style.bottom="");var p=(0,d.createEvent)("exitedfullscreen",e.getElement(e.container));e.getElement(e.container).dispatchEvent(p)}})},{16:16,2:2,25:25,26:26,27:27,28:28,3:3,5:5}],10:[function(e,t,n){"use strict";var o=d(e(2)),i=e(16),r=d(i),a=d(e(5)),s=e(27),l=e(26);function d(e){return e&&e.__esModule?e:{default:e}}Object.assign(i.config,{playText:null,pauseText:null}),Object.assign(r.default.prototype,{buildplaypause:function(e,t,n,i){var r=this,d=r.options,u=(0,s.isString)(d.playText)?d.playText:a.default.t("mejs.play"),c=(0,s.isString)(d.pauseText)?d.pauseText:a.default.t("mejs.pause"),f=o.default.createElement("div");f.className=r.options.classPrefix+"button "+r.options.classPrefix+"playpause-button "+r.options.classPrefix+"play",f.innerHTML='<button type="button" aria-controls="'+r.id+'" title="'+u+'" aria-label="'+c+'" tabindex="0"></button>',f.addEventListener("click",function(){r.paused?r.play():r.pause()});var p=f.querySelector("button");function m(e){"play"===e?((0,l.removeClass)(f,r.options.classPrefix+"play"),(0,l.removeClass)(f,r.options.classPrefix+"replay"),(0,l.addClass)(f,r.options.classPrefix+"pause"),p.setAttribute("title",c),p.setAttribute("aria-label",c)):((0,l.removeClass)(f,r.options.classPrefix+"pause"),(0,l.removeClass)(f,r.options.classPrefix+"replay"),(0,l.addClass)(f,r.options.classPrefix+"play"),p.setAttribute("title",u),p.setAttribute("aria-label",u))}r.addControlElement(f,"playpause"),m("pse"),i.addEventListener("loadedmetadata",function(){-1===i.rendererName.indexOf("flash")&&m("pse")}),i.addEventListener("play",function(){m("play")}),i.addEventListener("playing",function(){m("play")}),i.addEventListener("pause",function(){m("pse")}),i.addEventListener("ended",function(){e.options.loop||((0,l.removeClass)(f,r.options.classPrefix+"pause"),(0,l.removeClass)(f,r.options.classPrefix+"play"),(0,l.addClass)(f,r.options.classPrefix+"replay"),p.setAttribute("title",u),p.setAttribute("aria-label",u))})}})},{16:16,2:2,26:26,27:27,5:5}],11:[function(e,t,n){"use strict";var o=u(e(2)),i=e(16),r=u(i),a=u(e(5)),s=e(25),l=e(30),d=e(26);function u(e){return e&&e.__esModule?e:{default:e}}Object.assign(i.config,{enableProgressTooltip:!0,useSmoothHover:!0,forceLive:!1}),Object.assign(r.default.prototype,{buildprogress:function(e,t,n,r){var u=0,c=!1,f=!1,p=this,m=e.options.autoRewind,h=e.options.enableProgressTooltip?'<span class="'+p.options.classPrefix+'time-float"><span class="'+p.options.classPrefix+'time-float-current">00:00</span><span class="'+p.options.classPrefix+'time-float-corner"></span></span>':"",v=o.default.createElement("div");v.className=p.options.classPrefix+"time-rail",v.innerHTML='<span class="'+p.options.classPrefix+"time-total "+p.options.classPrefix+'time-slider"><span class="'+p.options.classPrefix+'time-buffering"></span><span class="'+p.options.classPrefix+'time-loaded"></span><span class="'+p.options.classPrefix+'time-current"></span><span class="'+p.options.classPrefix+'time-hovered no-hover"></span><span class="'+p.options.classPrefix+'time-handle"><span class="'+p.options.classPrefix+'time-handle-content"></span></span>'+h+"</span>",p.addControlElement(v,"progress"),p.options.keyActions.push({keys:[37,227],action:function(e){if(!isNaN(e.duration)&&e.duration>0){e.isVideo&&(e.showControls(),e.startControlsTimer()),e.getElement(e.container).querySelector("."+i.config.classPrefix+"time-total").focus();var t=Math.max(e.currentTime-e.options.defaultSeekBackwardInterval(e),0);e.setCurrentTime(t)}}},{keys:[39,228],action:function(e){if(!isNaN(e.duration)&&e.duration>0){e.isVideo&&(e.showControls(),e.startControlsTimer()),e.getElement(e.container).querySelector("."+i.config.classPrefix+"time-total").focus();var t=Math.min(e.currentTime+e.options.defaultSeekForwardInterval(e),e.duration);e.setCurrentTime(t)}}}),p.rail=t.querySelector("."+p.options.classPrefix+"time-rail"),p.total=t.querySelector("."+p.options.classPrefix+"time-total"),p.loaded=t.querySelector("."+p.options.classPrefix+"time-loaded"),p.current=t.querySelector("."+p.options.classPrefix+"time-current"),p.handle=t.querySelector("."+p.options.classPrefix+"time-handle"),p.timefloat=t.querySelector("."+p.options.classPrefix+"time-float"),p.timefloatcurrent=t.querySelector("."+p.options.classPrefix+"time-float-current"),p.slider=t.querySelector("."+p.options.classPrefix+"time-slider"),p.hovered=t.querySelector("."+p.options.classPrefix+"time-hovered"),p.buffer=t.querySelector("."+p.options.classPrefix+"time-buffering"),p.newTime=0,p.forcedHandlePause=!1,p.setTransformStyle=function(e,t){e.style.transform=t,e.style.webkitTransform=t,e.style.MozTransform=t,e.style.msTransform=t,e.style.OTransform=t},p.buffer.style.display="none";var g=function(t){var n=getComputedStyle(p.total),o=(0,d.offset)(p.total),i=p.total.offsetWidth,r=void 0!==n.webkitTransform?"webkitTransform":void 0!==n.mozTransform?"mozTransform ":void 0!==n.oTransform?"oTransform":void 0!==n.msTransform?"msTransform":"transform",a="WebKitCSSMatrix"in window?"WebKitCSSMatrix":"MSCSSMatrix"in window?"MSCSSMatrix":"CSSMatrix"in window?"CSSMatrix":void 0,u=0,f=0,m=0,h=void 0;if(h=t.originalEvent&&t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageX:t.changedTouches?t.changedTouches[0].pageX:t.pageX,p.getDuration()){if(h<o.left?h=o.left:h>i+o.left&&(h=i+o.left),u=(m=h-o.left)/i,p.newTime=u<=.02?0:u*p.getDuration(),c&&null!==p.getCurrentTime()&&p.newTime.toFixed(4)!==p.getCurrentTime().toFixed(4)&&(p.setCurrentRailHandle(p.newTime),p.updateCurrent(p.newTime)),!s.IS_IOS&&!s.IS_ANDROID){if(m<0&&(m=0),p.options.useSmoothHover&&null!==a&&void 0!==window[a]){var v=new window[a](getComputedStyle(p.handle)[r]).m41,g=m/parseFloat(getComputedStyle(p.total).width)-v/parseFloat(getComputedStyle(p.total).width);p.hovered.style.left=v+"px",p.setTransformStyle(p.hovered,"scaleX("+g+")"),p.hovered.setAttribute("pos",m),g>=0?(0,d.removeClass)(p.hovered,"negative"):(0,d.addClass)(p.hovered,"negative")}if(p.timefloat){var y=p.timefloat.offsetWidth/2,E=mejs.Utils.offset(p.getElement(p.container)),b=getComputedStyle(p.timefloat);f=h-E.left<p.timefloat.offsetWidth?y:h-E.left>=p.getElement(p.container).offsetWidth-y?p.total.offsetWidth-y:m,(0,d.hasClass)(p.getElement(p.container),p.options.classPrefix+"long-video")&&(f+=parseFloat(b.marginLeft)/2+p.timefloat.offsetWidth/2),p.timefloat.style.left=f+"px",p.timefloatcurrent.innerHTML=(0,l.secondsToTimeCode)(p.newTime,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond,e.options.secondsDecimalLength,e.options.timeFormat),p.timefloat.style.display="block"}}}else s.IS_IOS||s.IS_ANDROID||!p.timefloat||(f=p.timefloat.offsetWidth+i>=p.getElement(p.container).offsetWidth?p.timefloat.offsetWidth/2:0,p.timefloat.style.left=f+"px",p.timefloat.style.left=f+"px",p.timefloat.style.display="block")},y=function(){new Date-u>=1e3&&p.play()};p.slider.addEventListener("focus",function(){e.options.autoRewind=!1}),p.slider.addEventListener("blur",function(){e.options.autoRewind=m}),p.slider.addEventListener("keydown",function(t){if(new Date-u>=1e3&&(f=p.paused),p.options.keyActions.length){var n=t.which||t.keyCode||0,o=p.getDuration(),i=e.options.defaultSeekForwardInterval(r),a=e.options.defaultSeekBackwardInterval(r),l=p.getCurrentTime(),d=p.getElement(p.container).querySelector("."+p.options.classPrefix+"volume-slider");if(38===n||40===n){d&&(d.style.display="block"),p.isVideo&&(p.showControls(),p.startControlsTimer());var c=38===n?Math.min(p.volume+.1,1):Math.max(p.volume-.1,0),m=c<=0;return p.setVolume(c),void p.setMuted(m)}switch(d&&(d.style.display="none"),n){case 37:p.getDuration()!==1/0&&(l-=a);break;case 39:p.getDuration()!==1/0&&(l+=i);break;case 36:l=0;break;case 35:l=o;break;case 13:case 32:return void(s.IS_FIREFOX&&(p.paused?p.play():p.pause()));default:return}l=l<0?0:l>=o?o:Math.floor(l),u=new Date,f||e.pause(),l<p.getDuration()&&!f&&setTimeout(y,1100),p.setCurrentTime(l),e.showControls(),t.preventDefault(),t.stopPropagation()}});var E=["mousedown","touchstart"];p.slider.addEventListener("dragstart",function(){return!1});for(var b=0,S=E.length;b<S;b++)p.slider.addEventListener(E[b],function(e){if(p.forcedHandlePause=!1,p.getDuration()!==1/0&&(1===e.which||0===e.which)){p.paused||(p.pause(),p.forcedHandlePause=!0),c=!0,g(e);for(var t=["mouseup","touchend"],n=0,o=t.length;n<o;n++)p.getElement(p.container).addEventListener(t[n],function(e){var t=e.target;(t===p.slider||t.closest("."+p.options.classPrefix+"time-slider"))&&g(e)});p.globalBind("mouseup.dur touchend.dur",function(){c&&null!==p.getCurrentTime()&&p.newTime.toFixed(4)!==p.getCurrentTime().toFixed(4)&&(p.setCurrentTime(p.newTime),p.setCurrentRail(),p.updateCurrent(p.newTime)),p.forcedHandlePause&&(p.slider.focus(),p.play()),p.forcedHandlePause=!1,c=!1,p.timefloat&&(p.timefloat.style.display="none")})}},!(!s.SUPPORT_PASSIVE_EVENT||"touchstart"!==E[b])&&{passive:!0});p.slider.addEventListener("mouseenter",function(e){e.target===p.slider&&p.getDuration()!==1/0&&(p.getElement(p.container).addEventListener("mousemove",function(e){var t=e.target;(t===p.slider||t.closest("."+p.options.classPrefix+"time-slider"))&&g(e)}),!p.timefloat||s.IS_IOS||s.IS_ANDROID||(p.timefloat.style.display="block"),p.hovered&&!s.IS_IOS&&!s.IS_ANDROID&&p.options.useSmoothHover&&(0,d.removeClass)(p.hovered,"no-hover"))}),p.slider.addEventListener("mouseleave",function(){p.getDuration()!==1/0&&(c||(p.timefloat&&(p.timefloat.style.display="none"),p.hovered&&p.options.useSmoothHover&&(0,d.addClass)(p.hovered,"no-hover")))}),p.broadcastCallback=function(n){var i,s,d,u,c=t.querySelector("."+p.options.classPrefix+"broadcast");if(p.options.forceLive||p.getDuration()===1/0){if(!c||p.options.forceLive){var f=o.default.createElement("span");f.className=p.options.classPrefix+"broadcast",f.innerText=a.default.t("mejs.live-broadcast"),p.slider.style.display="none",p.rail.appendChild(f)}}else c&&(p.slider.style.display="",c.remove()),e.setProgressRail(n),p.forcedHandlePause||e.setCurrentRail(n),i=p.getCurrentTime(),s=a.default.t("mejs.time-slider"),d=(0,l.secondsToTimeCode)(i,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond,e.options.secondsDecimalLength,e.options.timeFormat),u=p.getDuration(),p.slider.setAttribute("role","slider"),p.slider.tabIndex=0,r.paused?(p.slider.setAttribute("aria-label",s),p.slider.setAttribute("aria-valuemin",0),p.slider.setAttribute("aria-valuemax",u),p.slider.setAttribute("aria-valuenow",i),p.slider.setAttribute("aria-valuetext",d)):(p.slider.removeAttribute("aria-label"),p.slider.removeAttribute("aria-valuemin"),p.slider.removeAttribute("aria-valuemax"),p.slider.removeAttribute("aria-valuenow"),p.slider.removeAttribute("aria-valuetext"))},r.addEventListener("progress",p.broadcastCallback),r.addEventListener("timeupdate",p.broadcastCallback),r.addEventListener("play",function(){p.buffer.style.display="none"}),r.addEventListener("playing",function(){p.buffer.style.display="none"}),r.addEventListener("seeking",function(){p.buffer.style.display=""}),r.addEventListener("seeked",function(){p.buffer.style.display="none"}),r.addEventListener("pause",function(){p.buffer.style.display="none"}),r.addEventListener("waiting",function(){p.buffer.style.display=""}),r.addEventListener("loadeddata",function(){p.buffer.style.display=""}),r.addEventListener("canplay",function(){p.buffer.style.display="none"}),r.addEventListener("error",function(){p.buffer.style.display="none"}),p.getElement(p.container).addEventListener("controlsresize",function(t){p.getDuration()!==1/0&&(e.setProgressRail(t),p.forcedHandlePause||e.setCurrentRail(t))})},cleanprogress:function(e,t,n,o){o.removeEventListener("progress",e.broadcastCallback),o.removeEventListener("timeupdate",e.broadcastCallback),e.rail&&e.rail.remove()},setProgressRail:function(e){var t=this,n=void 0!==e?e.detail.target||e.target:t.media,o=null;n&&n.buffered&&n.buffered.length>0&&n.buffered.end&&t.getDuration()?o=n.buffered.end(n.buffered.length-1)/t.getDuration():n&&void 0!==n.bytesTotal&&n.bytesTotal>0&&void 0!==n.bufferedBytes?o=n.bufferedBytes/n.bytesTotal:e&&e.lengthComputable&&0!==e.total&&(o=e.loaded/e.total),null!==o&&(o=Math.min(1,Math.max(0,o)),t.loaded&&t.setTransformStyle(t.loaded,"scaleX("+o+")"))},setCurrentRailHandle:function(e){this.setCurrentRailMain(this,e)},setCurrentRail:function(){this.setCurrentRailMain(this)},setCurrentRailMain:function(e,t){if(void 0!==e.getCurrentTime()&&e.getDuration()){var n=void 0===t?e.getCurrentTime():t;if(e.total&&e.handle){var o=parseFloat(getComputedStyle(e.total).width),i=Math.round(o*n/e.getDuration()),r=i-Math.round(e.handle.offsetWidth/2);if(r=r<0?0:r,e.setTransformStyle(e.current,"scaleX("+i/o+")"),e.setTransformStyle(e.handle,"translateX("+r+"px)"),e.options.useSmoothHover&&!(0,d.hasClass)(e.hovered,"no-hover")){var a=parseInt(e.hovered.getAttribute("pos"),10),s=(a=isNaN(a)?0:a)/o-r/o;e.hovered.style.left=r+"px",e.setTransformStyle(e.hovered,"scaleX("+s+")"),s>=0?(0,d.removeClass)(e.hovered,"negative"):(0,d.addClass)(e.hovered,"negative")}}}}})},{16:16,2:2,25:25,26:26,30:30,5:5}],12:[function(e,t,n){"use strict";var o=l(e(2)),i=e(16),r=l(i),a=e(30),s=e(26);function l(e){return e&&e.__esModule?e:{default:e}}Object.assign(i.config,{duration:0,timeAndDurationSeparator:"<span> | </span>"}),Object.assign(r.default.prototype,{buildcurrent:function(e,t,n,i){var r=this,s=o.default.createElement("div");s.className=r.options.classPrefix+"time",s.setAttribute("role","timer"),s.setAttribute("aria-live","off"),s.innerHTML='<span class="'+r.options.classPrefix+'currenttime">'+(0,a.secondsToTimeCode)(0,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond,e.options.secondsDecimalLength,e.options.timeFormat)+"</span>",r.addControlElement(s,"current"),e.updateCurrent(),r.updateTimeCallback=function(){r.controlsAreVisible&&e.updateCurrent()},i.addEventListener("timeupdate",r.updateTimeCallback)},cleancurrent:function(e,t,n,o){o.removeEventListener("timeupdate",e.updateTimeCallback)},buildduration:function(e,t,n,i){var r=this;if(t.lastChild.querySelector("."+r.options.classPrefix+"currenttime"))t.querySelector("."+r.options.classPrefix+"time").innerHTML+=r.options.timeAndDurationSeparator+'<span class="'+r.options.classPrefix+'duration">'+(0,a.secondsToTimeCode)(r.options.duration,r.options.alwaysShowHours,r.options.showTimecodeFrameCount,r.options.framesPerSecond,r.options.secondsDecimalLength,r.options.timeFormat)+"</span>";else{t.querySelector("."+r.options.classPrefix+"currenttime")&&(0,s.addClass)(t.querySelector("."+r.options.classPrefix+"currenttime").parentNode,r.options.classPrefix+"currenttime-container");var l=o.default.createElement("div");l.className=r.options.classPrefix+"time "+r.options.classPrefix+"duration-container",l.innerHTML='<span class="'+r.options.classPrefix+'duration">'+(0,a.secondsToTimeCode)(r.options.duration,r.options.alwaysShowHours,r.options.showTimecodeFrameCount,r.options.framesPerSecond,r.options.secondsDecimalLength,r.options.timeFormat)+"</span>",r.addControlElement(l,"duration")}r.updateDurationCallback=function(){r.controlsAreVisible&&e.updateDuration()},i.addEventListener("timeupdate",r.updateDurationCallback)},cleanduration:function(e,t,n,o){o.removeEventListener("timeupdate",e.updateDurationCallback)},updateCurrent:function(){var e=this,t=e.getCurrentTime();isNaN(t)&&(t=0);var n=(0,a.secondsToTimeCode)(t,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond,e.options.secondsDecimalLength,e.options.timeFormat);n.length>5?(0,s.addClass)(e.getElement(e.container),e.options.classPrefix+"long-video"):(0,s.removeClass)(e.getElement(e.container),e.options.classPrefix+"long-video"),e.getElement(e.controls).querySelector("."+e.options.classPrefix+"currenttime")&&(e.getElement(e.controls).querySelector("."+e.options.classPrefix+"currenttime").innerText=n)},updateDuration:function(){var e=this,t=e.getDuration();(isNaN(t)||t===1/0||t<0)&&(e.media.duration=e.options.duration=t=0),e.options.duration>0&&(t=e.options.duration);var n=(0,a.secondsToTimeCode)(t,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond,e.options.secondsDecimalLength,e.options.timeFormat);n.length>5?(0,s.addClass)(e.getElement(e.container),e.options.classPrefix+"long-video"):(0,s.removeClass)(e.getElement(e.container),e.options.classPrefix+"long-video"),e.getElement(e.controls).querySelector("."+e.options.classPrefix+"duration")&&t>0&&(e.getElement(e.controls).querySelector("."+e.options.classPrefix+"duration").innerHTML=n)}})},{16:16,2:2,26:26,30:30}],13:[function(e,t,n){"use strict";var o=c(e(2)),i=c(e(7)),r=c(e(5)),a=e(16),s=c(a),l=e(30),d=e(27),u=e(26);function c(e){return e&&e.__esModule?e:{default:e}}Object.assign(a.config,{startLanguage:"",tracksText:null,chaptersText:null,tracksAriaLive:!1,hideCaptionsButtonWhenEmpty:!0,toggleCaptionsButtonWhenOnlyOne:!1,slidesSelector:""}),Object.assign(s.default.prototype,{hasChapters:!1,buildtracks:function(e,t,n,i){if(this.findTracks(),e.tracks.length||e.trackFiles&&0!==!e.trackFiles.length){var a=this,s=a.options.tracksAriaLive?' role="log" aria-live="assertive" aria-atomic="false"':"",l=(0,d.isString)(a.options.tracksText)?a.options.tracksText:r.default.t("mejs.captions-subtitles"),c=(0,d.isString)(a.options.chaptersText)?a.options.chaptersText:r.default.t("mejs.captions-chapters"),f=null===e.trackFiles?e.tracks.length:e.trackFiles.length;if(a.domNode.textTracks)for(var p=a.domNode.textTracks.length-1;p>=0;p--)a.domNode.textTracks[p].mode="hidden";a.cleartracks(e),e.captions=o.default.createElement("div"),e.captions.className=a.options.classPrefix+"captions-layer "+a.options.classPrefix+"layer",e.captions.innerHTML='<div class="'+a.options.classPrefix+"captions-position "+a.options.classPrefix+'captions-position-hover"'+s+'><span class="'+a.options.classPrefix+'captions-text"></span></div>',e.captions.style.display="none",n.insertBefore(e.captions,n.firstChild),e.captionsText=e.captions.querySelector("."+a.options.classPrefix+"captions-text"),e.captionsButton=o.default.createElement("div"),e.captionsButton.className=a.options.classPrefix+"button "+a.options.classPrefix+"captions-button",e.captionsButton.innerHTML='<button type="button" aria-controls="'+a.id+'" title="'+l+'" aria-label="'+l+'" tabindex="0"></button><div class="'+a.options.classPrefix+"captions-selector "+a.options.classPrefix+'offscreen"><ul class="'+a.options.classPrefix+'captions-selector-list"><li class="'+a.options.classPrefix+'captions-selector-list-item"><input type="radio" class="'+a.options.classPrefix+'captions-selector-input" name="'+e.id+'_captions" id="'+e.id+'_captions_none" value="none" checked disabled><label class="'+a.options.classPrefix+"captions-selector-label "+a.options.classPrefix+'captions-selected" for="'+e.id+'_captions_none">'+r.default.t("mejs.none")+"</label></li></ul></div>",a.addControlElement(e.captionsButton,"tracks"),e.captionsButton.querySelector("."+a.options.classPrefix+"captions-selector-input").disabled=!1,e.chaptersButton=o.default.createElement("div"),e.chaptersButton.className=a.options.classPrefix+"button "+a.options.classPrefix+"chapters-button",e.chaptersButton.innerHTML='<button type="button" aria-controls="'+a.id+'" title="'+c+'" aria-label="'+c+'" tabindex="0"></button><div class="'+a.options.classPrefix+"chapters-selector "+a.options.classPrefix+'offscreen"><ul class="'+a.options.classPrefix+'chapters-selector-list"></ul></div>';for(var m=0,h=0;h<f;h++){var v=e.tracks[h].kind;e.tracks[h].src.trim()&&("subtitles"===v||"captions"===v?m++:"chapters"!==v||t.querySelector("."+a.options.classPrefix+"chapter-selector")||e.captionsButton.parentNode.insertBefore(e.chaptersButton,e.captionsButton))}e.trackToLoad=-1,e.selectedTrack=null,e.isLoadingTrack=!1;for(var g=0;g<f;g++){var y=e.tracks[g].kind;!e.tracks[g].src.trim()||"subtitles"!==y&&"captions"!==y||e.addTrackButton(e.tracks[g].trackId,e.tracks[g].srclang,e.tracks[g].label)}e.loadNextTrack();var E=["mouseenter","focusin"],b=["mouseleave","focusout"];if(a.options.toggleCaptionsButtonWhenOnlyOne&&1===m)e.captionsButton.addEventListener("click",function(t){var n="none";null===e.selectedTrack&&(n=e.tracks[0].trackId);var o=t.keyCode||t.which;e.setTrack(n,void 0!==o)});else{for(var S=e.captionsButton.querySelectorAll("."+a.options.classPrefix+"captions-selector-label"),x=e.captionsButton.querySelectorAll("input[type=radio]"),w=0,P=E.length;w<P;w++)e.captionsButton.addEventListener(E[w],function(){(0,u.removeClass)(this.querySelector("."+a.options.classPrefix+"captions-selector"),a.options.classPrefix+"offscreen")});for(var T=0,C=b.length;T<C;T++)e.captionsButton.addEventListener(b[T],function(){(0,u.addClass)(this.querySelector("."+a.options.classPrefix+"captions-selector"),a.options.classPrefix+"offscreen")});for(var k=0,_=x.length;k<_;k++)x[k].addEventListener("click",function(t){var n=t.keyCode||t.which;e.setTrack(this.value,void 0!==n)});for(var N=0,A=S.length;N<A;N++)S[N].addEventListener("click",function(e){var t=(0,u.siblings)(this,function(e){return"INPUT"===e.tagName})[0],n=(0,d.createEvent)("click",t);t.dispatchEvent(n),e.preventDefault()});e.captionsButton.addEventListener("keydown",function(e){e.stopPropagation()})}for(var L=0,F=E.length;L<F;L++)e.chaptersButton.addEventListener(E[L],function(){this.querySelector("."+a.options.classPrefix+"chapters-selector-list").children.length&&(0,u.removeClass)(this.querySelector("."+a.options.classPrefix+"chapters-selector"),a.options.classPrefix+"offscreen")});for(var j=0,I=b.length;j<I;j++)e.chaptersButton.addEventListener(b[j],function(){(0,u.addClass)(this.querySelector("."+a.options.classPrefix+"chapters-selector"),a.options.classPrefix+"offscreen")});e.chaptersButton.addEventListener("keydown",function(e){e.stopPropagation()}),e.options.alwaysShowControls?(0,u.addClass)(e.getElement(e.container).querySelector("."+a.options.classPrefix+"captions-position"),a.options.classPrefix+"captions-position-hover"):(e.getElement(e.container).addEventListener("controlsshown",function(){(0,u.addClass)(e.getElement(e.container).querySelector("."+a.options.classPrefix+"captions-position"),a.options.classPrefix+"captions-position-hover")}),e.getElement(e.container).addEventListener("controlshidden",function(){i.paused||(0,u.removeClass)(e.getElement(e.container).querySelector("."+a.options.classPrefix+"captions-position"),a.options.classPrefix+"captions-position-hover")})),i.addEventListener("timeupdate",function(){e.displayCaptions()}),""!==e.options.slidesSelector&&(e.slidesContainer=o.default.querySelectorAll(e.options.slidesSelector),i.addEventListener("timeupdate",function(){e.displaySlides()}))}},cleartracks:function(e){e&&(e.captions&&e.captions.remove(),e.chapters&&e.chapters.remove(),e.captionsText&&e.captionsText.remove(),e.captionsButton&&e.captionsButton.remove(),e.chaptersButton&&e.chaptersButton.remove())},rebuildtracks:function(){var e=this;e.findTracks(),e.buildtracks(e,e.getElement(e.controls),e.getElement(e.layers),e.media)},findTracks:function(){var e=this,t=null===e.trackFiles?e.node.querySelectorAll("track"):e.trackFiles,n=t.length;e.tracks=[];for(var o=0;o<n;o++){var i=t[o],r=i.getAttribute("srclang").toLowerCase()||"",a=e.id+"_track_"+o+"_"+i.getAttribute("kind")+"_"+r;e.tracks.push({trackId:a,srclang:r,src:i.getAttribute("src"),kind:i.getAttribute("kind"),label:i.getAttribute("label")||"",entries:[],isLoaded:!1})}},setTrack:function(e,t){for(var n=this,o=n.captionsButton.querySelectorAll('input[type="radio"]'),i=n.captionsButton.querySelectorAll("."+n.options.classPrefix+"captions-selected"),r=n.captionsButton.querySelector('input[value="'+e+'"]'),a=0,s=o.length;a<s;a++)o[a].checked=!1;for(var l=0,c=i.length;l<c;l++)(0,u.removeClass)(i[l],n.options.classPrefix+"captions-selected");r.checked=!0;for(var f=(0,u.siblings)(r,function(e){return(0,u.hasClass)(e,n.options.classPrefix+"captions-selector-label")}),p=0,m=f.length;p<m;p++)(0,u.addClass)(f[p],n.options.classPrefix+"captions-selected");if("none"===e)n.selectedTrack=null,(0,u.removeClass)(n.captionsButton,n.options.classPrefix+"captions-enabled");else for(var h=0,v=n.tracks.length;h<v;h++){var g=n.tracks[h];if(g.trackId===e){null===n.selectedTrack&&(0,u.addClass)(n.captionsButton,n.options.classPrefix+"captions-enabled"),n.selectedTrack=g,n.captions.setAttribute("lang",n.selectedTrack.srclang),n.displayCaptions();break}}var y=(0,d.createEvent)("captionschange",n.media);y.detail.caption=n.selectedTrack,n.media.dispatchEvent(y),t||setTimeout(function(){n.getElement(n.container).focus()},500)},loadNextTrack:function(){var e=this;e.trackToLoad++,e.trackToLoad<e.tracks.length?(e.isLoadingTrack=!0,e.loadTrack(e.trackToLoad)):(e.isLoadingTrack=!1,e.checkForTracks())},loadTrack:function(e){var t=this,n=t.tracks[e];void 0===n||void 0===n.src&&""===n.src||(0,u.ajax)(n.src,"text",function(e){n.entries="string"==typeof e&&/<tt\s+xml/gi.exec(e)?i.default.TrackFormatParser.dfxp.parse(e):i.default.TrackFormatParser.webvtt.parse(e),n.isLoaded=!0,t.enableTrackButton(n),t.loadNextTrack(),"slides"===n.kind?t.setupSlides(n):"chapters"!==n.kind||t.hasChapters||(t.drawChapters(n),t.hasChapters=!0)},function(){t.removeTrackButton(n.trackId),t.loadNextTrack()})},enableTrackButton:function(e){var t=this,n=e.srclang,a=o.default.getElementById(""+e.trackId);if(a){var s=e.label;""===s&&(s=r.default.t(i.default.language.codes[n])||n),a.disabled=!1;for(var l=(0,u.siblings)(a,function(e){return(0,u.hasClass)(e,t.options.classPrefix+"captions-selector-label")}),c=0,f=l.length;c<f;c++)l[c].innerHTML=s;if(t.options.startLanguage===n){a.checked=!0;var p=(0,d.createEvent)("click",a);a.dispatchEvent(p)}}},removeTrackButton:function(e){var t=o.default.getElementById(""+e);if(t){var n=t.closest("li");n&&n.remove()}},addTrackButton:function(e,t,n){var o=this;""===n&&(n=r.default.t(i.default.language.codes[t])||t),o.captionsButton.querySelector("ul").innerHTML+='<li class="'+o.options.classPrefix+'captions-selector-list-item"><input type="radio" class="'+o.options.classPrefix+'captions-selector-input" name="'+o.id+'_captions" id="'+e+'" value="'+e+'" disabled><label class="'+o.options.classPrefix+'captions-selector-label"for="'+e+'">'+n+" (loading)</label></li>"},checkForTracks:function(){var e=this,t=!1;if(e.options.hideCaptionsButtonWhenEmpty){for(var n=0,o=e.tracks.length;n<o;n++){var i=e.tracks[n].kind;if(("subtitles"===i||"captions"===i)&&e.tracks[n].isLoaded){t=!0;break}}e.captionsButton.style.display=t?"":"none",e.setControlsSize()}},displayCaptions:function(){if(void 0!==this.tracks){var e=this,t=e.selectedTrack;if(null!==t&&t.isLoaded){var n=e.searchTrackPosition(t.entries,e.media.currentTime);if(n>-1)return e.captionsText.innerHTML=function(e){var t=o.default.createElement("div");t.innerHTML=e;for(var n=t.getElementsByTagName("script"),i=n.length;i--;)n[i].remove();for(var r=t.getElementsByTagName("*"),a=0,s=r.length;a<s;a++)for(var l=r[a].attributes,d=Array.prototype.slice.call(l),u=0,c=d.length;u<c;u++)d[u].name.startsWith("on")||d[u].value.startsWith("javascript")?r[a].remove():"style"===d[u].name&&r[a].removeAttribute(d[u].name);return t.innerHTML}(t.entries[n].text),e.captionsText.className=e.options.classPrefix+"captions-text "+(t.entries[n].identifier||""),e.captions.style.display="",void(e.captions.style.height="0px");e.captions.style.display="none"}else e.captions.style.display="none"}},setupSlides:function(e){var t=this;t.slides=e,t.slides.entries.imgs=[t.slides.entries.length],t.showSlide(0)},showSlide:function(e){var t=this,n=this;if(void 0!==n.tracks&&void 0!==n.slidesContainer){var i=n.slides.entries[e].text,r=n.slides.entries[e].imgs;if(void 0===r||void 0===r.fadeIn){var a=o.default.createElement("img");a.src=i,a.addEventListener("load",function(){var e=t,o=(0,u.siblings)(e,function(e){return o(e)});e.style.display="none",n.slidesContainer.innerHTML+=e.innerHTML,(0,u.fadeIn)(n.slidesContainer.querySelector(a));for(var i=0,r=o.length;i<r;i++)(0,u.fadeOut)(o[i],400)}),n.slides.entries[e].imgs=r=a}else if(!(0,u.visible)(r)){var s=(0,u.siblings)(self,function(e){return s(e)});(0,u.fadeIn)(n.slidesContainer.querySelector(r));for(var l=0,d=s.length;l<d;l++)(0,u.fadeOut)(s[l])}}},displaySlides:function(){var e=this;if(void 0!==this.slides){var t=e.slides,n=e.searchTrackPosition(t.entries,e.media.currentTime);n>-1&&e.showSlide(n)}},drawChapters:function(e){var t=this,n=e.entries.length;if(n){t.chaptersButton.querySelector("ul").innerHTML="";for(var o=0;o<n;o++)t.chaptersButton.querySelector("ul").innerHTML+='<li class="'+t.options.classPrefix+'chapters-selector-list-item" role="menuitemcheckbox" aria-live="polite" aria-disabled="false" aria-checked="false"><input type="radio" class="'+t.options.classPrefix+'captions-selector-input" name="'+t.id+'_chapters" id="'+t.id+"_chapters_"+o+'" value="'+e.entries[o].start+'" disabled><label class="'+t.options.classPrefix+'chapters-selector-label"for="'+t.id+"_chapters_"+o+'">'+e.entries[o].text+"</label></li>";for(var i=t.chaptersButton.querySelectorAll('input[type="radio"]'),r=t.chaptersButton.querySelectorAll("."+t.options.classPrefix+"chapters-selector-label"),a=0,s=i.length;a<s;a++)i[a].disabled=!1,i[a].checked=!1,i[a].addEventListener("click",function(e){var n=t.chaptersButton.querySelectorAll("li"),o=(0,u.siblings)(this,function(e){return(0,u.hasClass)(e,t.options.classPrefix+"chapters-selector-label")})[0];this.checked=!0,this.parentNode.setAttribute("aria-checked",!0),(0,u.addClass)(o,t.options.classPrefix+"chapters-selected"),(0,u.removeClass)(t.chaptersButton.querySelector("."+t.options.classPrefix+"chapters-selected"),t.options.classPrefix+"chapters-selected");for(var i=0,r=n.length;i<r;i++)n[i].setAttribute("aria-checked",!1);void 0===(e.keyCode||e.which)&&setTimeout(function(){t.getElement(t.container).focus()},500),t.media.setCurrentTime(parseFloat(this.value)),t.media.paused&&t.media.play()});for(var l=0,c=r.length;l<c;l++)r[l].addEventListener("click",function(e){var t=(0,u.siblings)(this,function(e){return"INPUT"===e.tagName})[0],n=(0,d.createEvent)("click",t);t.dispatchEvent(n),e.preventDefault()})}},searchTrackPosition:function(e,t){for(var n=0,o=e.length-1,i=void 0,r=void 0,a=void 0;n<=o;){if(r=e[i=n+o>>1].start,a=e[i].stop,t>=r&&t<a)return i;r<t?n=i+1:r>t&&(o=i-1)}return-1}}),i.default.language={codes:{af:"mejs.afrikaans",sq:"mejs.albanian",ar:"mejs.arabic",be:"mejs.belarusian",bg:"mejs.bulgarian",ca:"mejs.catalan",zh:"mejs.chinese","zh-cn":"mejs.chinese-simplified","zh-tw":"mejs.chines-traditional",hr:"mejs.croatian",cs:"mejs.czech",da:"mejs.danish",nl:"mejs.dutch",en:"mejs.english",et:"mejs.estonian",fl:"mejs.filipino",fi:"mejs.finnish",fr:"mejs.french",gl:"mejs.galician",de:"mejs.german",el:"mejs.greek",ht:"mejs.haitian-creole",iw:"mejs.hebrew",hi:"mejs.hindi",hu:"mejs.hungarian",is:"mejs.icelandic",id:"mejs.indonesian",ga:"mejs.irish",it:"mejs.italian",ja:"mejs.japanese",ko:"mejs.korean",lv:"mejs.latvian",lt:"mejs.lithuanian",mk:"mejs.macedonian",ms:"mejs.malay",mt:"mejs.maltese",no:"mejs.norwegian",fa:"mejs.persian",pl:"mejs.polish",pt:"mejs.portuguese",ro:"mejs.romanian",ru:"mejs.russian",sr:"mejs.serbian",sk:"mejs.slovak",sl:"mejs.slovenian",es:"mejs.spanish",sw:"mejs.swahili",sv:"mejs.swedish",tl:"mejs.tagalog",th:"mejs.thai",tr:"mejs.turkish",uk:"mejs.ukrainian",vi:"mejs.vietnamese",cy:"mejs.welsh",yi:"mejs.yiddish"}},i.default.TrackFormatParser={webvtt:{pattern:/^((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,parse:function(e){for(var t=e.split(/\r?\n/),n=[],o=void 0,i=void 0,r=void 0,a=0,s=t.length;a<s;a++){if((o=this.pattern.exec(t[a]))&&a<t.length){for(a-1>=0&&""!==t[a-1]&&(r=t[a-1]),i=t[++a],a++;""!==t[a]&&a<t.length;)i=i+"\n"+t[a],a++;i=i.trim().replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),n.push({identifier:r,start:0===(0,l.convertSMPTEtoSeconds)(o[1])?.2:(0,l.convertSMPTEtoSeconds)(o[1]),stop:(0,l.convertSMPTEtoSeconds)(o[3]),text:i,settings:o[5]})}r=""}return n}},dfxp:{parse:function(e){var t=(e=$(e).filter("tt")).firstChild,n=t.querySelectorAll("p"),o=e.getElementById(""+t.attr("style")),i=[],r=void 0;if(o.length){o.removeAttribute("id");var a=o.attributes;if(a.length){r={};for(var s=0,d=a.length;s<d;s++)r[a[s].name.split(":")[1]]=a[s].value}}for(var u=0,c=n.length;u<c;u++){var f=void 0,p={start:null,stop:null,style:null,text:null};if(n.eq(u).attr("begin")&&(p.start=(0,l.convertSMPTEtoSeconds)(n.eq(u).attr("begin"))),!p.start&&n.eq(u-1).attr("end")&&(p.start=(0,l.convertSMPTEtoSeconds)(n.eq(u-1).attr("end"))),n.eq(u).attr("end")&&(p.stop=(0,l.convertSMPTEtoSeconds)(n.eq(u).attr("end"))),!p.stop&&n.eq(u+1).attr("begin")&&(p.stop=(0,l.convertSMPTEtoSeconds)(n.eq(u+1).attr("begin"))),r)for(var m in f="",r)f+=m+":"+r[m]+";";f&&(p.style=f),0===p.start&&(p.start=.2),p.text=n.eq(u).innerHTML.trim().replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),i.push(p)}return i}}}},{16:16,2:2,26:26,27:27,30:30,5:5,7:7}],14:[function(e,t,n){"use strict";var o=u(e(2)),i=e(16),r=u(i),a=u(e(5)),s=e(25),l=e(27),d=e(26);function u(e){return e&&e.__esModule?e:{default:e}}Object.assign(i.config,{muteText:null,unmuteText:null,allyVolumeControlText:null,hideVolumeOnTouchDevices:!0,audioVolume:"horizontal",videoVolume:"vertical",startVolume:.8}),Object.assign(r.default.prototype,{buildvolume:function(e,t,n,r){if(!s.IS_ANDROID&&!s.IS_IOS||!this.options.hideVolumeOnTouchDevices){var u=this,c=u.isVideo?u.options.videoVolume:u.options.audioVolume,f=(0,l.isString)(u.options.muteText)?u.options.muteText:a.default.t("mejs.mute"),p=(0,l.isString)(u.options.unmuteText)?u.options.unmuteText:a.default.t("mejs.unmute"),m=(0,l.isString)(u.options.allyVolumeControlText)?u.options.allyVolumeControlText:a.default.t("mejs.volume-help-text"),h=o.default.createElement("div");if(h.className=u.options.classPrefix+"button "+u.options.classPrefix+"volume-button "+u.options.classPrefix+"mute",h.innerHTML="horizontal"===c?'<button type="button" aria-controls="'+u.id+'" title="'+f+'" aria-label="'+f+'" tabindex="0"></button>':'<button type="button" aria-controls="'+u.id+'" title="'+f+'" aria-label="'+f+'" tabindex="0"></button><a href="javascript:void(0);" class="'+u.options.classPrefix+'volume-slider" aria-label="'+a.default.t("mejs.volume-slider")+'" aria-valuemin="0" aria-valuemax="100" role="slider" aria-orientation="vertical"><span class="'+u.options.classPrefix+'offscreen">'+m+'</span><div class="'+u.options.classPrefix+'volume-total"><div class="'+u.options.classPrefix+'volume-current"></div><div class="'+u.options.classPrefix+'volume-handle"></div></div></a>',u.addControlElement(h,"volume"),u.options.keyActions.push({keys:[38],action:function(e){var t=e.getElement(e.container).querySelector("."+i.config.classPrefix+"volume-slider");(t||e.getElement(e.container).querySelector("."+i.config.classPrefix+"volume-slider").matches(":focus"))&&(t.style.display="block"),e.isVideo&&(e.showControls(),e.startControlsTimer());var n=Math.min(e.volume+.1,1);e.setVolume(n),n>0&&e.setMuted(!1)}},{keys:[40],action:function(e){var t=e.getElement(e.container).querySelector("."+i.config.classPrefix+"volume-slider");t&&(t.style.display="block"),e.isVideo&&(e.showControls(),e.startControlsTimer());var n=Math.max(e.volume-.1,0);e.setVolume(n),n<=.1&&e.setMuted(!0)}},{keys:[77],action:function(e){e.getElement(e.container).querySelector("."+i.config.classPrefix+"volume-slider").style.display="block",e.isVideo&&(e.showControls(),e.startControlsTimer()),e.media.muted?e.setMuted(!1):e.setMuted(!0)}}),"horizontal"===c){var v=o.default.createElement("a");v.className=u.options.classPrefix+"horizontal-volume-slider",v.href="javascript:void(0);",v.setAttribute("aria-label",a.default.t("mejs.volume-slider")),v.setAttribute("aria-valuemin",0),v.setAttribute("aria-valuemax",100),v.setAttribute("role","slider"),v.innerHTML+='<span class="'+u.options.classPrefix+'offscreen">'+m+'</span><div class="'+u.options.classPrefix+'horizontal-volume-total"><div class="'+u.options.classPrefix+'horizontal-volume-current"></div><div class="'+u.options.classPrefix+'horizontal-volume-handle"></div></div>',h.parentNode.insertBefore(v,h.nextSibling)}var g=!1,y=!1,E=!1,b="vertical"===c?u.getElement(u.container).querySelector("."+u.options.classPrefix+"volume-slider"):u.getElement(u.container).querySelector("."+u.options.classPrefix+"horizontal-volume-slider"),S="vertical"===c?u.getElement(u.container).querySelector("."+u.options.classPrefix+"volume-total"):u.getElement(u.container).querySelector("."+u.options.classPrefix+"horizontal-volume-total"),x="vertical"===c?u.getElement(u.container).querySelector("."+u.options.classPrefix+"volume-current"):u.getElement(u.container).querySelector("."+u.options.classPrefix+"horizontal-volume-current"),w="vertical"===c?u.getElement(u.container).querySelector("."+u.options.classPrefix+"volume-handle"):u.getElement(u.container).querySelector("."+u.options.classPrefix+"horizontal-volume-handle"),P=function(e){if(null!==e&&!isNaN(e)&&void 0!==e){if(e=Math.max(0,e),0===(e=Math.min(e,1))){(0,d.removeClass)(h,u.options.classPrefix+"mute"),(0,d.addClass)(h,u.options.classPrefix+"unmute");var t=h.firstElementChild;t.setAttribute("title",p),t.setAttribute("aria-label",p)}else{(0,d.removeClass)(h,u.options.classPrefix+"unmute"),(0,d.addClass)(h,u.options.classPrefix+"mute");var n=h.firstElementChild;n.setAttribute("title",f),n.setAttribute("aria-label",f)}var o=100*e+"%",i=getComputedStyle(w);"vertical"===c?(x.style.bottom=0,x.style.height=o,w.style.bottom=o,w.style.marginBottom=-parseFloat(i.height)/2+"px"):(x.style.left=0,x.style.width=o,w.style.left=o,w.style.marginLeft=-parseFloat(i.width)/2+"px")}},T=function(e){var t=(0,d.offset)(S),n=getComputedStyle(S);E=!0;var o=null;if("vertical"===c){var i=parseFloat(n.height);if(o=(i-(e.pageY-t.top))/i,0===t.top||0===t.left)return}else{var r=parseFloat(n.width);o=(e.pageX-t.left)/r}o=Math.max(0,o),o=Math.min(o,1),P(o),u.setMuted(0===o),u.setVolume(o),e.preventDefault(),e.stopPropagation()},C=function(){u.muted?(P(0),(0,d.removeClass)(h,u.options.classPrefix+"mute"),(0,d.addClass)(h,u.options.classPrefix+"unmute")):(P(r.volume),(0,d.removeClass)(h,u.options.classPrefix+"unmute"),(0,d.addClass)(h,u.options.classPrefix+"mute"))};e.getElement(e.container).addEventListener("keydown",function(e){!!e.target.closest("."+u.options.classPrefix+"container")||"vertical"!==c||(b.style.display="none")}),h.addEventListener("mouseenter",function(e){e.target===h&&(b.style.display="block",y=!0,e.preventDefault(),e.stopPropagation())}),h.addEventListener("focusin",function(){b.style.display="block",y=!0}),h.addEventListener("focusout",function(e){e.relatedTarget&&(!e.relatedTarget||e.relatedTarget.matches("."+u.options.classPrefix+"volume-slider"))||"vertical"!==c||(b.style.display="none")}),h.addEventListener("mouseleave",function(){y=!1,g||"vertical"!==c||(b.style.display="none")}),h.addEventListener("focusout",function(){y=!1}),h.addEventListener("keydown",function(e){if(u.options.keyActions.length){var t=e.which||e.keyCode||0,n=r.volume;switch(t){case 38:n=Math.min(n+.1,1);break;case 40:n=Math.max(0,n-.1);break;default:return!0}g=!1,P(n),r.setVolume(n),e.preventDefault(),e.stopPropagation()}}),h.querySelector("button").addEventListener("click",function(){r.setMuted(!r.muted);var e=(0,l.createEvent)("volumechange",r);r.dispatchEvent(e)}),b.addEventListener("dragstart",function(){return!1}),b.addEventListener("mouseover",function(){y=!0}),b.addEventListener("focusin",function(){b.style.display="block",y=!0}),b.addEventListener("focusout",function(){y=!1,g||"vertical"!==c||(b.style.display="none")}),b.addEventListener("mousedown",function(e){T(e),u.globalBind("mousemove.vol",function(e){var t=e.target;g&&(t===b||t.closest("vertical"===c?"."+u.options.classPrefix+"volume-slider":"."+u.options.classPrefix+"horizontal-volume-slider"))&&T(e)}),u.globalBind("mouseup.vol",function(){g=!1,y||"vertical"!==c||(b.style.display="none")}),g=!0,e.preventDefault(),e.stopPropagation()}),r.addEventListener("volumechange",function(e){var t;g||C(),t=Math.floor(100*r.volume),b.setAttribute("aria-valuenow",t),b.setAttribute("aria-valuetext",t+"%")});var k=!1;r.addEventListener("rendererready",function(){E||setTimeout(function(){k=!0,(0===e.options.startVolume||r.originalNode.muted)&&(r.setMuted(!0),e.options.startVolume=0),r.setVolume(e.options.startVolume),u.setControlsSize()},250)}),r.addEventListener("loadedmetadata",function(){setTimeout(function(){E||k||((0===e.options.startVolume||r.originalNode.muted)&&r.setMuted(!0),r.setVolume(e.options.startVolume),u.setControlsSize()),k=!1},250)}),(0===e.options.startVolume||r.originalNode.muted)&&(r.setMuted(!0),e.options.startVolume=0,C()),u.getElement(u.container).addEventListener("controlsresize",function(){C()})}}})},{16:16,2:2,25:25,26:26,27:27,5:5}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.EN={"mejs.plural-form":1,"mejs.download-file":"Download File","mejs.install-flash":"You are using a browser that does not have Flash player enabled or installed. Please turn on your Flash player plugin or download the latest version from https://get.adobe.com/flashplayer/","mejs.fullscreen":"Fullscreen","mejs.play":"Play","mejs.pause":"Pause","mejs.time-slider":"Time Slider","mejs.time-help-text":"Use Left/Right Arrow keys to advance one second, Up/Down arrows to advance ten seconds.","mejs.live-broadcast":"Live Broadcast","mejs.volume-help-text":"Use Up/Down Arrow keys to increase or decrease volume.","mejs.unmute":"Unmute","mejs.mute":"Mute","mejs.volume-slider":"Volume Slider","mejs.video-player":"Video Player","mejs.audio-player":"Audio Player","mejs.captions-subtitles":"Captions/Subtitles","mejs.captions-chapters":"Chapters","mejs.none":"None","mejs.afrikaans":"Afrikaans","mejs.albanian":"Albanian","mejs.arabic":"Arabic","mejs.belarusian":"Belarusian","mejs.bulgarian":"Bulgarian","mejs.catalan":"Catalan","mejs.chinese":"Chinese","mejs.chinese-simplified":"Chinese (Simplified)","mejs.chinese-traditional":"Chinese (Traditional)","mejs.croatian":"Croatian","mejs.czech":"Czech","mejs.danish":"Danish","mejs.dutch":"Dutch","mejs.english":"English","mejs.estonian":"Estonian","mejs.filipino":"Filipino","mejs.finnish":"Finnish","mejs.french":"French","mejs.galician":"Galician","mejs.german":"German","mejs.greek":"Greek","mejs.haitian-creole":"Haitian Creole","mejs.hebrew":"Hebrew","mejs.hindi":"Hindi","mejs.hungarian":"Hungarian","mejs.icelandic":"Icelandic","mejs.indonesian":"Indonesian","mejs.irish":"Irish","mejs.italian":"Italian","mejs.japanese":"Japanese","mejs.korean":"Korean","mejs.latvian":"Latvian","mejs.lithuanian":"Lithuanian","mejs.macedonian":"Macedonian","mejs.malay":"Malay","mejs.maltese":"Maltese","mejs.norwegian":"Norwegian","mejs.persian":"Persian","mejs.polish":"Polish","mejs.portuguese":"Portuguese","mejs.romanian":"Romanian","mejs.russian":"Russian","mejs.serbian":"Serbian","mejs.slovak":"Slovak","mejs.slovenian":"Slovenian","mejs.spanish":"Spanish","mejs.swahili":"Swahili","mejs.swedish":"Swedish","mejs.tagalog":"Tagalog","mejs.thai":"Thai","mejs.turkish":"Turkish","mejs.ukrainian":"Ukrainian","mejs.vietnamese":"Vietnamese","mejs.welsh":"Welsh","mejs.yiddish":"Yiddish"}},{}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.config=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=v(e(3)),a=v(e(2)),s=v(e(7)),l=v(e(6)),d=v(e(17)),u=v(e(5)),c=e(25),f=e(27),p=e(30),m=e(28),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e(26));function v(e){return e&&e.__esModule?e:{default:e}}s.default.mepIndex=0,s.default.players={};var g=n.config={poster:"",showPosterWhenEnded:!1,showPosterWhenPaused:!1,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:40,defaultSeekBackwardInterval:function(e){return.05*e.getDuration()},defaultSeekForwardInterval:function(e){return.05*e.getDuration()},setDimensions:!0,audioWidth:-1,audioHeight:-1,loop:!1,autoRewind:!0,enableAutosize:!0,timeFormat:"",alwaysShowHours:!1,showTimecodeFrameCount:!1,framesPerSecond:25,alwaysShowControls:!1,hideVideoControlsOnLoad:!1,hideVideoControlsOnPause:!1,clickToPlayPause:!0,controlsTimeoutDefault:1500,controlsTimeoutMouseEnter:2500,controlsTimeoutMouseLeave:1e3,iPadUseNativeControls:!1,iPhoneUseNativeControls:!1,AndroidUseNativeControls:!1,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],useDefaultControls:!1,isVideo:!0,stretching:"auto",classPrefix:"mejs__",enableKeyboard:!0,pauseOtherPlayers:!0,secondsDecimalLength:0,customError:null,keyActions:[{keys:[32,179],action:function(e){c.IS_FIREFOX||(e.paused||e.ended?e.play():e.pause())}}]};s.default.MepDefaults=g;var y=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var o=this,i="string"==typeof t?a.default.getElementById(t):t;if(!(o instanceof e))return new e(i,n);if(o.node=o.media=i,o.node){if(o.media.player)return o.media.player;if(o.hasFocus=!1,o.controlsAreVisible=!0,o.controlsEnabled=!0,o.controlsTimer=null,o.currentMediaTime=0,o.proxy=null,void 0===n){var r=o.node.getAttribute("data-mejsoptions");n=r?JSON.parse(r):{}}return o.options=Object.assign({},g,n),o.options.loop&&!o.media.getAttribute("loop")?(o.media.loop=!0,o.node.loop=!0):o.media.loop&&(o.options.loop=!0),o.options.timeFormat||(o.options.timeFormat="mm:ss",o.options.alwaysShowHours&&(o.options.timeFormat="hh:mm:ss"),o.options.showTimecodeFrameCount&&(o.options.timeFormat+=":ff")),(0,p.calculateTimeFormat)(0,o.options,o.options.framesPerSecond||25),o.id="mep_"+s.default.mepIndex++,s.default.players[o.id]=o,o.init(),o}}return i(e,[{key:"getElement",value:function(e){return e}},{key:"init",value:function(){var e=this,t=Object.assign({},e.options,{success:function(t,n){e._meReady(t,n)},error:function(t){e._handleError(t)}}),n=e.node.tagName.toLowerCase();if(e.isDynamic="audio"!==n&&"video"!==n&&"iframe"!==n,e.isVideo=e.isDynamic?e.options.isVideo:"audio"!==n&&e.options.isVideo,e.mediaFiles=null,e.trackFiles=null,c.IS_IPAD&&e.options.iPadUseNativeControls||c.IS_IPHONE&&e.options.iPhoneUseNativeControls)e.node.setAttribute("controls",!0),c.IS_IPAD&&e.node.getAttribute("autoplay")&&e.play();else if(!e.isVideo&&(e.isVideo||!e.options.features.length&&!e.options.useDefaultControls)||c.IS_ANDROID&&e.options.AndroidUseNativeControls)e.isVideo||e.options.features.length||e.options.useDefaultControls||(e.node.style.display="none");else{e.node.removeAttribute("controls");var o=e.isVideo?u.default.t("mejs.video-player"):u.default.t("mejs.audio-player"),i=a.default.createElement("span");if(i.className=e.options.classPrefix+"offscreen",i.innerText=o,e.media.parentNode.insertBefore(i,e.media),e.container=a.default.createElement("div"),e.getElement(e.container).id=e.id,e.getElement(e.container).className=e.options.classPrefix+"container "+e.options.classPrefix+"container-keyboard-inactive "+e.media.className,e.getElement(e.container).tabIndex=0,e.getElement(e.container).setAttribute("role","application"),e.getElement(e.container).setAttribute("aria-label",o),e.getElement(e.container).innerHTML='<div class="'+e.options.classPrefix+'inner"><div class="'+e.options.classPrefix+'mediaelement"></div><div class="'+e.options.classPrefix+'layers"></div><div class="'+e.options.classPrefix+'controls"></div></div>',e.getElement(e.container).addEventListener("focus",function(t){if(!e.controlsAreVisible&&!e.hasFocus&&e.controlsEnabled){e.showControls(!0);var n=(0,f.isNodeAfter)(t.relatedTarget,e.getElement(e.container))?"."+e.options.classPrefix+"controls ."+e.options.classPrefix+"button:last-child > button":"."+e.options.classPrefix+"playpause-button > button";e.getElement(e.container).querySelector(n).focus()}}),e.node.parentNode.insertBefore(e.getElement(e.container),e.node),e.options.features.length||e.options.useDefaultControls||(e.getElement(e.container).style.background="transparent",e.getElement(e.container).querySelector("."+e.options.classPrefix+"controls").style.display="none"),e.isVideo&&"fill"===e.options.stretching&&!h.hasClass(e.getElement(e.container).parentNode,e.options.classPrefix+"fill-container")){e.outerContainer=e.media.parentNode;var r=a.default.createElement("div");r.className=e.options.classPrefix+"fill-container",e.getElement(e.container).parentNode.insertBefore(r,e.getElement(e.container)),r.appendChild(e.getElement(e.container))}if(c.IS_ANDROID&&h.addClass(e.getElement(e.container),e.options.classPrefix+"android"),c.IS_IOS&&h.addClass(e.getElement(e.container),e.options.classPrefix+"ios"),c.IS_IPAD&&h.addClass(e.getElement(e.container),e.options.classPrefix+"ipad"),c.IS_IPHONE&&h.addClass(e.getElement(e.container),e.options.classPrefix+"iphone"),h.addClass(e.getElement(e.container),e.isVideo?e.options.classPrefix+"video":e.options.classPrefix+"audio"),c.IS_SAFARI&&!c.IS_IOS){h.addClass(e.getElement(e.container),e.options.classPrefix+"hide-cues");for(var d=e.node.cloneNode(),p=e.node.children,v=[],g=[],y=0,E=p.length;y<E;y++){var b=p[y];!function(){switch(b.tagName.toLowerCase()){case"source":var e={};Array.prototype.slice.call(b.attributes).forEach(function(t){e[t.name]=t.value}),e.type=(0,m.formatType)(e.src,e.type),v.push(e);break;case"track":b.mode="hidden",g.push(b);break;default:d.appendChild(b)}}()}e.node.remove(),e.node=e.media=d,v.length&&(e.mediaFiles=v),g.length&&(e.trackFiles=g)}e.getElement(e.container).querySelector("."+e.options.classPrefix+"mediaelement").appendChild(e.node),e.media.player=e,e.controls=e.getElement(e.container).querySelector("."+e.options.classPrefix+"controls"),e.layers=e.getElement(e.container).querySelector("."+e.options.classPrefix+"layers");var S=e.isVideo?"video":"audio",x=S.substring(0,1).toUpperCase()+S.substring(1);e.options[S+"Width"]>0||e.options[S+"Width"].toString().indexOf("%")>-1?e.width=e.options[S+"Width"]:""!==e.node.style.width&&null!==e.node.style.width?e.width=e.node.style.width:e.node.getAttribute("width")?e.width=e.node.getAttribute("width"):e.width=e.options["default"+x+"Width"],e.options[S+"Height"]>0||e.options[S+"Height"].toString().indexOf("%")>-1?e.height=e.options[S+"Height"]:""!==e.node.style.height&&null!==e.node.style.height?e.height=e.node.style.height:e.node.getAttribute("height")?e.height=e.node.getAttribute("height"):e.height=e.options["default"+x+"Height"],e.initialAspectRatio=e.height>=e.width?e.width/e.height:e.height/e.width,e.setPlayerSize(e.width,e.height),t.pluginWidth=e.width,t.pluginHeight=e.height}if(s.default.MepDefaults=t,new l.default(e.media,t,e.mediaFiles),void 0!==e.getElement(e.container)&&e.options.features.length&&e.controlsAreVisible&&!e.options.hideVideoControlsOnLoad){var w=(0,f.createEvent)("controlsshown",e.getElement(e.container));e.getElement(e.container).dispatchEvent(w)}}},{key:"showControls",value:function(e){var t=this;if(e=void 0===e||e,!t.controlsAreVisible&&t.isVideo){if(e)!function(){h.fadeIn(t.getElement(t.controls),200,function(){h.removeClass(t.getElement(t.controls),t.options.classPrefix+"offscreen");var e=(0,f.createEvent)("controlsshown",t.getElement(t.container));t.getElement(t.container).dispatchEvent(e)});for(var e=t.getElement(t.container).querySelectorAll("."+t.options.classPrefix+"control"),n=function(n,o){h.fadeIn(e[n],200,function(){h.removeClass(e[n],t.options.classPrefix+"offscreen")})},o=0,i=e.length;o<i;o++)n(o)}();else{h.removeClass(t.getElement(t.controls),t.options.classPrefix+"offscreen"),t.getElement(t.controls).style.display="",t.getElement(t.controls).style.opacity=1;for(var n=t.getElement(t.container).querySelectorAll("."+t.options.classPrefix+"control"),o=0,i=n.length;o<i;o++)h.removeClass(n[o],t.options.classPrefix+"offscreen"),n[o].style.display="";var r=(0,f.createEvent)("controlsshown",t.getElement(t.container));t.getElement(t.container).dispatchEvent(r)}t.controlsAreVisible=!0,t.setControlsSize()}}},{key:"hideControls",value:function(e,t){var n=this;if(e=void 0===e||e,!0===t||!(!n.controlsAreVisible||n.options.alwaysShowControls||n.paused&&4===n.readyState&&(!n.options.hideVideoControlsOnLoad&&n.currentTime<=0||!n.options.hideVideoControlsOnPause&&n.currentTime>0)||n.isVideo&&!n.options.hideVideoControlsOnLoad&&!n.readyState||n.ended)){if(e)!function(){h.fadeOut(n.getElement(n.controls),200,function(){h.addClass(n.getElement(n.controls),n.options.classPrefix+"offscreen"),n.getElement(n.controls).style.display="";var e=(0,f.createEvent)("controlshidden",n.getElement(n.container));n.getElement(n.container).dispatchEvent(e)});for(var e=n.getElement(n.container).querySelectorAll("."+n.options.classPrefix+"control"),t=function(t,o){h.fadeOut(e[t],200,function(){h.addClass(e[t],n.options.classPrefix+"offscreen"),e[t].style.display=""})},o=0,i=e.length;o<i;o++)t(o)}();else{h.addClass(n.getElement(n.controls),n.options.classPrefix+"offscreen"),n.getElement(n.controls).style.display="",n.getElement(n.controls).style.opacity=0;for(var o=n.getElement(n.container).querySelectorAll("."+n.options.classPrefix+"control"),i=0,r=o.length;i<r;i++)h.addClass(o[i],n.options.classPrefix+"offscreen"),o[i].style.display="";var a=(0,f.createEvent)("controlshidden",n.getElement(n.container));n.getElement(n.container).dispatchEvent(a)}n.controlsAreVisible=!1}}},{key:"startControlsTimer",value:function(e){var t=this;e=void 0!==e?e:t.options.controlsTimeoutDefault,t.killControlsTimer("start"),t.controlsTimer=setTimeout(function(){t.hideControls(),t.killControlsTimer("hide")},e)}},{key:"killControlsTimer",value:function(){var e=this;null!==e.controlsTimer&&(clearTimeout(e.controlsTimer),delete e.controlsTimer,e.controlsTimer=null)}},{key:"disableControls",value:function(){var e=this;e.killControlsTimer(),e.controlsEnabled=!1,e.hideControls(!1,!0)}},{key:"enableControls",value:function(){this.controlsEnabled=!0,this.showControls(!1)}},{key:"_setDefaultPlayer",value:function(){var e=this;e.proxy&&e.proxy.pause(),e.proxy=new d.default(e),e.media.addEventListener("loadedmetadata",function(){e.getCurrentTime()>0&&e.currentMediaTime>0&&(e.setCurrentTime(e.currentMediaTime),c.IS_IOS||c.IS_ANDROID||e.play())})}},{key:"_meReady",value:function(e,t){var n=this,o=t.getAttribute("autoplay"),i=!(null==o||"false"===o),l=null!==e.rendererName&&/(native|html5)/i.test(n.media.rendererName);if(n.getElement(n.controls)&&n.enableControls(),n.getElement(n.container)&&n.getElement(n.container).querySelector("."+n.options.classPrefix+"overlay-play")&&(n.getElement(n.container).querySelector("."+n.options.classPrefix+"overlay-play").style.display=""),!n.created){if(n.created=!0,n.media=e,n.domNode=t,!(c.IS_ANDROID&&n.options.AndroidUseNativeControls||c.IS_IPAD&&n.options.iPadUseNativeControls||c.IS_IPHONE&&n.options.iPhoneUseNativeControls)){if(!n.isVideo&&!n.options.features.length&&!n.options.useDefaultControls)return i&&l&&n.play(),void(n.options.success&&("string"==typeof n.options.success?r.default[n.options.success](n.media,n.domNode,n):n.options.success(n.media,n.domNode,n)));if(n.featurePosition={},n._setDefaultPlayer(),n.buildposter(n,n.getElement(n.controls),n.getElement(n.layers),n.media),n.buildkeyboard(n,n.getElement(n.controls),n.getElement(n.layers),n.media),n.buildoverlays(n,n.getElement(n.controls),n.getElement(n.layers),n.media),n.options.useDefaultControls){var d=["playpause","current","progress","duration","tracks","volume","fullscreen"];n.options.features=d.concat(n.options.features.filter(function(e){return-1===d.indexOf(e)}))}n.buildfeatures(n,n.getElement(n.controls),n.getElement(n.layers),n.media);var u=(0,f.createEvent)("controlsready",n.getElement(n.container));n.getElement(n.container).dispatchEvent(u),n.setPlayerSize(n.width,n.height),n.setControlsSize(),n.isVideo&&(n.clickToPlayPauseCallback=function(){if(n.options.clickToPlayPause){var e=n.getElement(n.container).querySelector("."+n.options.classPrefix+"overlay-button"),t=e.getAttribute("aria-pressed");n.paused&&t?n.pause():n.paused?n.play():n.pause(),e.setAttribute("aria-pressed",!t),n.getElement(n.container).focus()}},n.createIframeLayer(),n.media.addEventListener("click",n.clickToPlayPauseCallback),!c.IS_ANDROID&&!c.IS_IOS||n.options.alwaysShowControls?(n.getElement(n.container).addEventListener("mouseenter",function(){n.controlsEnabled&&(n.options.alwaysShowControls||(n.killControlsTimer("enter"),n.showControls(),n.startControlsTimer(n.options.controlsTimeoutMouseEnter)))}),n.getElement(n.container).addEventListener("mousemove",function(){n.controlsEnabled&&(n.controlsAreVisible||n.showControls(),n.options.alwaysShowControls||n.startControlsTimer(n.options.controlsTimeoutMouseEnter))}),n.getElement(n.container).addEventListener("mouseleave",function(){n.controlsEnabled&&(n.paused||n.options.alwaysShowControls||n.startControlsTimer(n.options.controlsTimeoutMouseLeave))})):n.node.addEventListener("touchstart",function(){n.controlsAreVisible?n.hideControls(!1):n.controlsEnabled&&n.showControls(!1)},!!c.SUPPORT_PASSIVE_EVENT&&{passive:!0}),n.options.hideVideoControlsOnLoad&&n.hideControls(!1),n.options.enableAutosize&&n.media.addEventListener("loadedmetadata",function(e){var t=void 0!==e?e.detail.target||e.target:n.media;n.options.videoHeight<=0&&!n.domNode.getAttribute("height")&&!n.domNode.style.height&&null!==t&&!isNaN(t.videoHeight)&&(n.setPlayerSize(t.videoWidth,t.videoHeight),n.setControlsSize(),n.media.setSize(t.videoWidth,t.videoHeight))})),n.media.addEventListener("play",function(){for(var e in n.hasFocus=!0,s.default.players)if(s.default.players.hasOwnProperty(e)){var t=s.default.players[e];t.id===n.id||!n.options.pauseOtherPlayers||t.paused||t.ended||(t.pause(),t.hasFocus=!1)}c.IS_ANDROID||c.IS_IOS||n.options.alwaysShowControls||!n.isVideo||n.hideControls()}),n.media.addEventListener("ended",function(){if(n.options.autoRewind)try{n.setCurrentTime(0),setTimeout(function(){var e=n.getElement(n.container).querySelector("."+n.options.classPrefix+"overlay-loading");e&&e.parentNode&&(e.parentNode.style.display="none")},20)}catch(e){}"function"==typeof n.media.renderer.stop?n.media.renderer.stop():n.pause(),n.setProgressRail&&n.setProgressRail(),n.setCurrentRail&&n.setCurrentRail(),n.options.loop?n.play():!n.options.alwaysShowControls&&n.controlsEnabled&&n.showControls()}),n.media.addEventListener("loadedmetadata",function(){(0,p.calculateTimeFormat)(n.getDuration(),n.options,n.options.framesPerSecond||25),n.updateDuration&&n.updateDuration(),n.updateCurrent&&n.updateCurrent(),n.isFullScreen||(n.setPlayerSize(n.width,n.height),n.setControlsSize())});var m=null;n.media.addEventListener("timeupdate",function(){isNaN(n.getDuration())||m===n.getDuration()||(m=n.getDuration(),(0,p.calculateTimeFormat)(m,n.options,n.options.framesPerSecond||25),n.updateDuration&&n.updateDuration(),n.updateCurrent&&n.updateCurrent(),n.setControlsSize())}),n.getElement(n.container).addEventListener("click",function(e){h.addClass(e.currentTarget,n.options.classPrefix+"container-keyboard-inactive")}),n.getElement(n.container).addEventListener("focusin",function(e){h.removeClass(e.currentTarget,n.options.classPrefix+"container-keyboard-inactive"),!n.isVideo||c.IS_ANDROID||c.IS_IOS||!n.controlsEnabled||n.options.alwaysShowControls||(n.killControlsTimer("enter"),n.showControls(),n.startControlsTimer(n.options.controlsTimeoutMouseEnter))}),n.getElement(n.container).addEventListener("focusout",function(e){setTimeout(function(){e.relatedTarget&&n.keyboardAction&&!e.relatedTarget.closest("."+n.options.classPrefix+"container")&&(n.keyboardAction=!1,!n.isVideo||n.options.alwaysShowControls||n.paused||n.startControlsTimer(n.options.controlsTimeoutMouseLeave))},0)}),setTimeout(function(){n.setPlayerSize(n.width,n.height),n.setControlsSize()},0),n.globalResizeCallback=function(){n.isFullScreen||c.HAS_TRUE_NATIVE_FULLSCREEN&&a.default.webkitIsFullScreen||n.setPlayerSize(n.width,n.height),n.setControlsSize()},n.globalBind("resize",n.globalResizeCallback)}i&&l&&n.play(),n.options.success&&("string"==typeof n.options.success?r.default[n.options.success](n.media,n.domNode,n):n.options.success(n.media,n.domNode,n))}}},{key:"_handleError",value:function(e,t,n){var o=this,i=o.getElement(o.layers).querySelector("."+o.options.classPrefix+"overlay-play");i&&(i.style.display="none"),o.options.error&&o.options.error(e,t,n),o.getElement(o.container).querySelector("."+o.options.classPrefix+"cannotplay")&&o.getElement(o.container).querySelector("."+o.options.classPrefix+"cannotplay").remove();var r=a.default.createElement("div");r.className=o.options.classPrefix+"cannotplay",r.style.width="100%",r.style.height="100%";var l="function"==typeof o.options.customError?o.options.customError(o.media,o.media.originalNode):o.options.customError,d="";if(!l){var u=o.media.originalNode.getAttribute("poster");if(u&&(d='<img src="'+u+'" alt="'+s.default.i18n.t("mejs.download-file")+'">'),e.message&&(l="<p>"+e.message+"</p>"),e.urls)for(var c=0,f=e.urls.length;c<f;c++){var p=e.urls[c];l+='<a href="'+p.src+'" data-type="'+p.type+'"><span>'+s.default.i18n.t("mejs.download-file")+": "+p.src+"</span></a>"}}l&&o.getElement(o.layers).querySelector("."+o.options.classPrefix+"overlay-error")&&(r.innerHTML=l,o.getElement(o.layers).querySelector("."+o.options.classPrefix+"overlay-error").innerHTML=""+d+r.outerHTML,o.getElement(o.layers).querySelector("."+o.options.classPrefix+"overlay-error").parentNode.style.display="block"),o.controlsEnabled&&o.disableControls()}},{key:"setPlayerSize",value:function(e,t){var n=this;if(!n.options.setDimensions)return!1;switch(void 0!==e&&(n.width=e),void 0!==t&&(n.height=t),n.options.stretching){case"fill":n.isVideo?n.setFillMode():n.setDimensions(n.width,n.height);break;case"responsive":n.setResponsiveMode();break;case"none":n.setDimensions(n.width,n.height);break;default:!0===n.hasFluidMode()?n.setResponsiveMode():n.setDimensions(n.width,n.height)}}},{key:"hasFluidMode",value:function(){var e=this;return-1!==e.height.toString().indexOf("%")||e.node&&e.node.style.maxWidth&&"none"!==e.node.style.maxWidth&&e.node.style.maxWidth!==e.width||e.node&&e.node.currentStyle&&"100%"===e.node.currentStyle.maxWidth}},{key:"setResponsiveMode",value:function(){var e,t=this,n=function(){for(var e=void 0,n=t.getElement(t.container);n;){try{if(c.IS_FIREFOX&&"html"===n.tagName.toLowerCase()&&r.default.self!==r.default.top&&null!==r.default.frameElement)return r.default.frameElement;e=n.parentElement}catch(t){e=n.parentElement}if(e&&h.visible(e))return e;n=e}return null}(),o=n?getComputedStyle(n,null):getComputedStyle(a.default.body,null),i=t.isVideo?t.node.videoWidth&&t.node.videoWidth>0?t.node.videoWidth:t.node.getAttribute("width")?t.node.getAttribute("width"):t.options.defaultVideoWidth:t.options.defaultAudioWidth,s=t.isVideo?t.node.videoHeight&&t.node.videoHeight>0?t.node.videoHeight:t.node.getAttribute("height")?t.node.getAttribute("height"):t.options.defaultVideoHeight:t.options.defaultAudioHeight,l=(e=1,t.isVideo?(e=t.node.videoWidth&&t.node.videoWidth>0&&t.node.videoHeight&&t.node.videoHeight>0?t.height>=t.width?t.node.videoWidth/t.node.videoHeight:t.node.videoHeight/t.node.videoWidth:t.initialAspectRatio,(isNaN(e)||e<.01||e>100)&&(e=1),e):e),d=parseFloat(o.height),u=void 0,f=parseFloat(o.width);if(u=t.isVideo?"100%"===t.height?parseFloat(f*s/i,10):t.height>=t.width?parseFloat(f/l,10):parseFloat(f*l,10):s,isNaN(u)&&(u=d),t.getElement(t.container).parentNode.length>0&&"body"===t.getElement(t.container).parentNode.tagName.toLowerCase()&&(f=r.default.innerWidth||a.default.documentElement.clientWidth||a.default.body.clientWidth,u=r.default.innerHeight||a.default.documentElement.clientHeight||a.default.body.clientHeight),u&&f){t.getElement(t.container).style.width=f+"px",t.getElement(t.container).style.height=u+"px",t.node.style.width="100%",t.node.style.height="100%",t.isVideo&&t.media.setSize&&t.media.setSize(f,u);for(var p=t.getElement(t.layers).children,m=0,v=p.length;m<v;m++)p[m].style.width="100%",p[m].style.height="100%"}}},{key:"setFillMode",value:function(){var e=this,t=r.default.self!==r.default.top&&null!==r.default.frameElement,n=function(){for(var t=void 0,n=e.getElement(e.container);n;){try{if(c.IS_FIREFOX&&"html"===n.tagName.toLowerCase()&&r.default.self!==r.default.top&&null!==r.default.frameElement)return r.default.frameElement;t=n.parentElement}catch(e){t=n.parentElement}if(t&&h.visible(t))return t;n=t}return null}(),o=n?getComputedStyle(n,null):getComputedStyle(a.default.body,null);"none"!==e.node.style.height&&e.node.style.height!==e.height&&(e.node.style.height="auto"),"none"!==e.node.style.maxWidth&&e.node.style.maxWidth!==e.width&&(e.node.style.maxWidth="none"),"none"!==e.node.style.maxHeight&&e.node.style.maxHeight!==e.height&&(e.node.style.maxHeight="none"),e.node.currentStyle&&("100%"===e.node.currentStyle.height&&(e.node.currentStyle.height="auto"),"100%"===e.node.currentStyle.maxWidth&&(e.node.currentStyle.maxWidth="none"),"100%"===e.node.currentStyle.maxHeight&&(e.node.currentStyle.maxHeight="none")),t||parseFloat(o.width)||(n.style.width=e.media.offsetWidth+"px"),t||parseFloat(o.height)||(n.style.height=e.media.offsetHeight+"px"),o=getComputedStyle(n);var i=parseFloat(o.width),s=parseFloat(o.height);e.setDimensions("100%","100%");var l=e.getElement(e.container).querySelector("."+e.options.classPrefix+"poster>img");l&&(l.style.display="");for(var d=e.getElement(e.container).querySelectorAll("object, embed, iframe, video"),u=e.height,f=e.width,p=i,m=u*i/f,v=f*s/u,g=s,y=v>i==!1,E=y?Math.floor(p):Math.floor(v),b=y?Math.floor(m):Math.floor(g),S=y?i+"px":E+"px",x=y?b+"px":s+"px",w=0,P=d.length;w<P;w++)d[w].style.height=x,d[w].style.width=S,e.media.setSize&&e.media.setSize(S,x),d[w].style.marginLeft=Math.floor((i-E)/2)+"px",d[w].style.marginTop=0}},{key:"setDimensions",value:function(e,t){var n=this;e=(0,f.isString)(e)&&e.indexOf("%")>-1?e:parseFloat(e)+"px",t=(0,f.isString)(t)&&t.indexOf("%")>-1?t:parseFloat(t)+"px",n.getElement(n.container).style.width=e,n.getElement(n.container).style.height=t;for(var o=n.getElement(n.layers).children,i=0,r=o.length;i<r;i++)o[i].style.width=e,o[i].style.height=t}},{key:"setControlsSize",value:function(){var e=this;if(h.visible(e.getElement(e.container)))if(e.rail&&h.visible(e.rail)){for(var t=e.total?getComputedStyle(e.total,null):null,n=t?parseFloat(t.marginLeft)+parseFloat(t.marginRight):0,o=getComputedStyle(e.rail),i=parseFloat(o.marginLeft)+parseFloat(o.marginRight),r=0,a=h.siblings(e.rail,function(t){return t!==e.rail}),s=a.length,l=0;l<s;l++)r+=a[l].offsetWidth;r+=n+(0===n?2*i:i)+1,e.getElement(e.container).style.minWidth=r+"px";var d=(0,f.createEvent)("controlsresize",e.getElement(e.container));e.getElement(e.container).dispatchEvent(d)}else{for(var u=e.getElement(e.controls).children,c=0,p=0,m=u.length;p<m;p++)c+=u[p].offsetWidth;e.getElement(e.container).style.minWidth=c+"px"}}},{key:"addControlElement",value:function(e,t){var n=this;if(void 0!==n.featurePosition[t]){var o=n.getElement(n.controls).children[n.featurePosition[t]-1];o.parentNode.insertBefore(e,o.nextSibling)}else{n.getElement(n.controls).appendChild(e);for(var i=n.getElement(n.controls).children,r=0,a=i.length;r<a;r++)if(e===i[r]){n.featurePosition[t]=r;break}}}},{key:"createIframeLayer",value:function(){var e=this;if(e.isVideo&&null!==e.media.rendererName&&e.media.rendererName.indexOf("iframe")>-1&&!a.default.getElementById(e.media.id+"-iframe-overlay")){var t=a.default.createElement("div"),n=a.default.getElementById(e.media.id+"_"+e.media.rendererName);t.id=e.media.id+"-iframe-overlay",t.className=e.options.classPrefix+"iframe-overlay",t.addEventListener("click",function(t){e.options.clickToPlayPause&&(e.paused?e.play():e.pause(),t.preventDefault(),t.stopPropagation())}),n.parentNode.insertBefore(t,n)}}},{key:"resetSize",value:function(){var e=this;setTimeout(function(){e.setPlayerSize(e.width,e.height),e.setControlsSize()},50)}},{key:"setPoster",value:function(e){var t=this;if(t.getElement(t.container)){var n=t.getElement(t.container).querySelector("."+t.options.classPrefix+"poster");n||((n=a.default.createElement("div")).className=t.options.classPrefix+"poster "+t.options.classPrefix+"layer",t.getElement(t.layers).appendChild(n));var o=n.querySelector("img");!o&&e&&((o=a.default.createElement("img")).className=t.options.classPrefix+"poster-img",o.width="100%",o.height="100%",n.style.display="",n.appendChild(o)),e?(o.setAttribute("src",e),n.style.backgroundImage='url("'+e+'")',n.style.display=""):o?(n.style.backgroundImage="none",n.style.display="none",o.remove()):n.style.display="none"}else(c.IS_IPAD&&t.options.iPadUseNativeControls||c.IS_IPHONE&&t.options.iPhoneUseNativeControls||c.IS_ANDROID&&t.options.AndroidUseNativeControls)&&(t.media.originalNode.poster=e)}},{key:"changeSkin",value:function(e){var t=this;t.getElement(t.container).className=t.options.classPrefix+"container "+e,t.setPlayerSize(t.width,t.height),t.setControlsSize()}},{key:"globalBind",value:function(e,t){var n=this,o=n.node?n.node.ownerDocument:a.default;if((e=(0,f.splitEvents)(e,n.id)).d)for(var i=e.d.split(" "),s=0,l=i.length;s<l;s++)i[s].split(".").reduce(function(e,n){return o.addEventListener(n,t,!1),n},"");if(e.w)for(var d=e.w.split(" "),u=0,c=d.length;u<c;u++)d[u].split(".").reduce(function(e,n){return r.default.addEventListener(n,t,!1),n},"")}},{key:"globalUnbind",value:function(e,t){var n=this,o=n.node?n.node.ownerDocument:a.default;if((e=(0,f.splitEvents)(e,n.id)).d)for(var i=e.d.split(" "),s=0,l=i.length;s<l;s++)i[s].split(".").reduce(function(e,n){return o.removeEventListener(n,t,!1),n},"");if(e.w)for(var d=e.w.split(" "),u=0,c=d.length;u<c;u++)d[u].split(".").reduce(function(e,n){return r.default.removeEventListener(n,t,!1),n},"")}},{key:"buildfeatures",value:function(e,t,n,o){for(var i=this,r=0,a=i.options.features.length;r<a;r++){var s=i.options.features[r];if(i["build"+s])try{i["build"+s](e,t,n,o)}catch(e){console.error("error building "+s,e)}}}},{key:"buildposter",value:function(e,t,n,o){var i=this,r=a.default.createElement("div");r.className=i.options.classPrefix+"poster "+i.options.classPrefix+"layer",n.appendChild(r);var s=o.originalNode.getAttribute("poster");""!==e.options.poster&&(s&&c.IS_IOS&&o.originalNode.removeAttribute("poster"),s=e.options.poster),s?i.setPoster(s):null!==i.media.renderer&&"function"==typeof i.media.renderer.getPosterUrl?i.setPoster(i.media.renderer.getPosterUrl()):r.style.display="none",o.addEventListener("play",function(){r.style.display="none"}),o.addEventListener("playing",function(){r.style.display="none"}),e.options.showPosterWhenEnded&&e.options.autoRewind&&o.addEventListener("ended",function(){r.style.display=""}),o.addEventListener("error",function(){r.style.display="none"}),e.options.showPosterWhenPaused&&o.addEventListener("pause",function(){e.ended||(r.style.display="")})}},{key:"buildoverlays",value:function(e,t,n,o){if(e.isVideo){var i=this,r=a.default.createElement("div"),s=a.default.createElement("div"),l=a.default.createElement("div");r.style.display="none",r.className=i.options.classPrefix+"overlay "+i.options.classPrefix+"layer",r.innerHTML='<div class="'+i.options.classPrefix+'overlay-loading"><span class="'+i.options.classPrefix+'overlay-loading-bg-img"></span></div>',n.appendChild(r),s.style.display="none",s.className=i.options.classPrefix+"overlay "+i.options.classPrefix+"layer",s.innerHTML='<div class="'+i.options.classPrefix+'overlay-error"></div>',n.appendChild(s),l.className=i.options.classPrefix+"overlay "+i.options.classPrefix+"layer "+i.options.classPrefix+"overlay-play",l.innerHTML='<div class="'+i.options.classPrefix+'overlay-button" role="button" tabindex="0" aria-label="'+u.default.t("mejs.play")+'" aria-pressed="false"></div>',l.addEventListener("click",function(){if(i.options.clickToPlayPause){var e=i.getElement(i.container).querySelector("."+i.options.classPrefix+"overlay-button"),t=e.getAttribute("aria-pressed");i.paused?i.play():i.pause(),e.setAttribute("aria-pressed",!!t),i.getElement(i.container).focus()}}),l.addEventListener("keydown",function(e){var t=e.keyCode||e.which||0;if(13===t||c.IS_FIREFOX&&32===t){var n=(0,f.createEvent)("click",l);return l.dispatchEvent(n),!1}}),n.appendChild(l),null!==i.media.rendererName&&(/(youtube|facebook)/i.test(i.media.rendererName)&&!(i.media.originalNode.getAttribute("poster")||e.options.poster||"function"==typeof i.media.renderer.getPosterUrl&&i.media.renderer.getPosterUrl())||c.IS_STOCK_ANDROID||i.media.originalNode.getAttribute("autoplay"))&&(l.style.display="none");var d=!1;o.addEventListener("play",function(){l.style.display="none",r.style.display="none",s.style.display="none",d=!1}),o.addEventListener("playing",function(){l.style.display="none",r.style.display="none",s.style.display="none",d=!1}),o.addEventListener("seeking",function(){l.style.display="none",r.style.display="",d=!1}),o.addEventListener("seeked",function(){l.style.display=i.paused&&!c.IS_STOCK_ANDROID?"":"none",r.style.display="none",d=!1}),o.addEventListener("pause",function(){r.style.display="none",c.IS_STOCK_ANDROID||d||(l.style.display=""),d=!1}),o.addEventListener("waiting",function(){r.style.display="",d=!1}),o.addEventListener("loadeddata",function(){r.style.display="",c.IS_ANDROID&&(o.canplayTimeout=setTimeout(function(){if(a.default.createEvent){var e=a.default.createEvent("HTMLEvents");return e.initEvent("canplay",!0,!0),o.dispatchEvent(e)}},300)),d=!1}),o.addEventListener("canplay",function(){r.style.display="none",clearTimeout(o.canplayTimeout),d=!1}),o.addEventListener("error",function(e){i._handleError(e,i.media,i.node),r.style.display="none",l.style.display="none",d=!0}),o.addEventListener("loadedmetadata",function(){i.controlsEnabled||i.enableControls()}),o.addEventListener("keydown",function(t){i.onkeydown(e,o,t),d=!1})}}},{key:"buildkeyboard",value:function(e,t,n,o){var i=this;i.getElement(i.container).addEventListener("keydown",function(){i.keyboardAction=!0}),i.globalKeydownCallback=function(t){var n=a.default.activeElement.closest("."+i.options.classPrefix+"container"),r=i.media.closest("."+i.options.classPrefix+"container");return i.hasFocus=!(!n||!r||n.id!==r.id),i.onkeydown(e,o,t)},i.globalClickCallback=function(e){i.hasFocus=!!e.target.closest("."+i.options.classPrefix+"container")},i.globalBind("keydown",i.globalKeydownCallback),i.globalBind("click",i.globalClickCallback)}},{key:"onkeydown",value:function(e,t,n){if(e.hasFocus&&e.options.enableKeyboard)for(var o=0,i=e.options.keyActions.length;o<i;o++)for(var r=e.options.keyActions[o],a=0,s=r.keys.length;a<s;a++)if(n.keyCode===r.keys[a])return r.action(e,t,n.keyCode,n),n.preventDefault(),void n.stopPropagation();return!0}},{key:"play",value:function(){this.proxy.play()}},{key:"pause",value:function(){this.proxy.pause()}},{key:"load",value:function(){this.proxy.load()}},{key:"setCurrentTime",value:function(e){this.proxy.setCurrentTime(e)}},{key:"getCurrentTime",value:function(){return this.proxy.currentTime}},{key:"getDuration",value:function(){return this.proxy.duration}},{key:"setVolume",value:function(e){this.proxy.volume=e}},{key:"getVolume",value:function(){return this.proxy.getVolume()}},{key:"setMuted",value:function(e){this.proxy.setMuted(e)}},{key:"setSrc",value:function(e){this.controlsEnabled||this.enableControls(),this.proxy.setSrc(e)}},{key:"getSrc",value:function(){return this.proxy.getSrc()}},{key:"canPlayType",value:function(e){return this.proxy.canPlayType(e)}},{key:"remove",value:function(){var e=this,t=e.media.rendererName,n=e.media.originalNode.src;for(var i in e.options.features){var r=e.options.features[i];if(e["clean"+r])try{e["clean"+r](e,e.getElement(e.layers),e.getElement(e.controls),e.media)}catch(e){console.error("error cleaning "+r,e)}}var l=e.node.getAttribute("width"),d=e.node.getAttribute("height");(l?-1===l.indexOf("%")&&(l+="px"):l="auto",d?-1===d.indexOf("%")&&(d+="px"):d="auto",e.node.style.width=l,e.node.style.height=d,e.setPlayerSize(0,0),e.isDynamic?e.getElement(e.container).parentNode.insertBefore(e.node,e.getElement(e.container)):function(){e.node.setAttribute("controls",!0),e.node.setAttribute("id",e.node.getAttribute("id").replace("_"+t,"").replace("_from_mejs",""));var o=e.getElement(e.container).querySelector("."+e.options.classPrefix+"poster>img");(o&&e.node.setAttribute("poster",o.src),delete e.node.autoplay,""!==e.media.canPlayType((0,m.getTypeFromFile)(n))&&e.node.setAttribute("src",n),~t.indexOf("iframe"))&&a.default.getElementById(e.media.id+"-iframe-overlay").remove();var i=e.node.cloneNode();if(i.style.display="",e.getElement(e.container).parentNode.insertBefore(i,e.getElement(e.container)),e.node.remove(),e.mediaFiles)for(var r=0,s=e.mediaFiles.length;r<s;r++){var l=a.default.createElement("source");l.setAttribute("src",e.mediaFiles[r].src),l.setAttribute("type",e.mediaFiles[r].type),i.appendChild(l)}if(e.trackFiles)for(var d=function(t,n){var o=e.trackFiles[t],r=a.default.createElement("track");r.kind=o.kind,r.label=o.label,r.srclang=o.srclang,r.src=o.src,i.appendChild(r),r.addEventListener("load",function(){this.mode="showing",i.textTracks[t].mode="showing"})},u=0,c=e.trackFiles.length;u<c;u++)d(u);delete e.node,delete e.mediaFiles,delete e.trackFiles}(),"function"==typeof e.media.renderer.destroy&&e.media.renderer.destroy(),delete s.default.players[e.id],"object"===o(e.getElement(e.container)))&&(e.getElement(e.container).parentNode.querySelector("."+e.options.classPrefix+"offscreen").remove(),e.getElement(e.container).remove());e.globalUnbind("resize",e.globalResizeCallback),e.globalUnbind("keydown",e.globalKeydownCallback),e.globalUnbind("click",e.globalClickCallback),delete e.media.player}},{key:"paused",get:function(){return this.proxy.paused}},{key:"muted",get:function(){return this.proxy.muted},set:function(e){this.setMuted(e)}},{key:"ended",get:function(){return this.proxy.ended}},{key:"readyState",get:function(){return this.proxy.readyState}},{key:"currentTime",set:function(e){this.setCurrentTime(e)},get:function(){return this.getCurrentTime()}},{key:"duration",get:function(){return this.getDuration()}},{key:"volume",set:function(e){this.setVolume(e)},get:function(){return this.getVolume()}},{key:"src",set:function(e){this.setSrc(e)},get:function(){return this.getSrc()}}]),e}();r.default.MediaElementPlayer=y,s.default.MediaElementPlayer=y,n.default=y},{17:17,2:2,25:25,26:26,27:27,28:28,3:3,30:30,5:5,6:6,7:7}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e(3),a=(o=r)&&o.__esModule?o:{default:o};var s=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.media=t.media,this.isVideo=t.isVideo,this.classPrefix=t.options.classPrefix,this.createIframeLayer=function(){return t.createIframeLayer()},this.setPoster=function(e){return t.setPoster(e)},this}return i(e,[{key:"play",value:function(){this.media.play()}},{key:"pause",value:function(){this.media.pause()}},{key:"load",value:function(){var e=this;e.isLoaded||e.media.load(),e.isLoaded=!0}},{key:"setCurrentTime",value:function(e){this.media.setCurrentTime(e)}},{key:"getCurrentTime",value:function(){return this.media.currentTime}},{key:"getDuration",value:function(){return this.media.getDuration()}},{key:"setVolume",value:function(e){this.media.setVolume(e)}},{key:"getVolume",value:function(){return this.media.getVolume()}},{key:"setMuted",value:function(e){this.media.setMuted(e)}},{key:"setSrc",value:function(e){var t=this,n=document.getElementById(t.media.id+"-iframe-overlay");n&&n.remove(),t.media.setSrc(e),t.createIframeLayer(),null!==t.media.renderer&&"function"==typeof t.media.renderer.getPosterUrl&&t.setPoster(t.media.renderer.getPosterUrl())}},{key:"getSrc",value:function(){return this.media.getSrc()}},{key:"canPlayType",value:function(e){return this.media.canPlayType(e)}},{key:"paused",get:function(){return this.media.paused}},{key:"muted",set:function(e){this.setMuted(e)},get:function(){return this.media.muted}},{key:"ended",get:function(){return this.media.ended}},{key:"readyState",get:function(){return this.media.readyState}},{key:"currentTime",set:function(e){this.setCurrentTime(e)},get:function(){return this.getCurrentTime()}},{key:"duration",get:function(){return this.getDuration()}},{key:"volume",set:function(e){this.setVolume(e)},get:function(){return this.getVolume()}},{key:"src",set:function(e){this.setSrc(e)},get:function(){return this.getSrc()}}]),e}();n.default=s,a.default.DefaultPlayer=s},{3:3}],18:[function(e,t,n){"use strict";var o,i=s(e(3)),r=s(e(7)),a=s(e(16));function s(e){return e&&e.__esModule?e:{default:e}}"undefined"!=typeof jQuery?r.default.$=i.default.jQuery=i.default.$=jQuery:"undefined"!=typeof Zepto?r.default.$=i.default.Zepto=i.default.$=Zepto:"undefined"!=typeof ender&&(r.default.$=i.default.ender=i.default.$=ender),void 0!==(o=r.default.$)&&(o.fn.mediaelementplayer=function(e){return!1===e?this.each(function(){var e=o(this).data("mediaelementplayer");e&&e.remove(),o(this).removeData("mediaelementplayer")}):this.each(function(){o(this).data("mediaelementplayer",new a.default(this,e))}),this},o(document).ready(function(){o("."+r.default.MepDefaults.classPrefix+"player").mediaelementplayer()}))},{16:16,3:3,7:7}],19:[function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=c(e(3)),r=c(e(7)),a=e(8),s=e(27),l=e(28),d=e(25),u=e(26);function c(e){return e&&e.__esModule?e:{default:e}}var f={promise:null,load:function(e){return"undefined"!=typeof dashjs?f.promise=new Promise(function(e){e()}).then(function(){f._createPlayer(e)}):(e.options.path="string"==typeof e.options.path?e.options.path:"https://cdn.dashjs.org/latest/dash.all.min.js",f.promise=f.promise||(0,u.loadScript)(e.options.path),f.promise.then(function(){f._createPlayer(e)})),f.promise},_createPlayer:function(e){var t=dashjs.MediaPlayer().create();return i.default["__ready__"+e.id](t),t}},p={name:"native_dash",options:{prefix:"native_dash",dash:{path:"https://cdn.dashjs.org/latest/dash.all.min.js",debug:!1,drm:{},robustnessLevel:""}},canPlayType:function(e){return d.HAS_MSE&&["application/dash+xml"].indexOf(e.toLowerCase())>-1},create:function(e,t,n){var l=e.originalNode,d=e.id+"_"+t.prefix,u=l.autoplay,c=l.children,p=null,m=null;l.removeAttribute("type");for(var h=0,v=c.length;h<v;h++)c[h].removeAttribute("type");p=l.cloneNode(!0),t=Object.assign(t,e.options);for(var g=r.default.html5media.properties,y=r.default.html5media.events.concat(["click","mouseover","mouseout"]).filter(function(e){return"error"!==e}),E=function(t){var n=(0,s.createEvent)(t.type,e);e.dispatchEvent(n)},b=function(e){var n=""+e.substring(0,1).toUpperCase()+e.substring(1);p["get"+n]=function(){return null!==m?p[e]:null},p["set"+n]=function(n){if(-1===r.default.html5media.readOnlyProperties.indexOf(e))if("src"===e){var i="object"===(void 0===n?"undefined":o(n))&&n.src?n.src:n;if(p[e]=i,null!==m){m.reset();for(var a=0,l=y.length;a<l;a++)p.removeEventListener(y[a],E);m=f._createPlayer({options:t.dash,id:d}),n&&"object"===(void 0===n?"undefined":o(n))&&"object"===o(n.drm)&&(m.setProtectionData(n.drm),(0,s.isString)(t.dash.robustnessLevel)&&t.dash.robustnessLevel&&m.getProtectionController().setRobustnessLevel(t.dash.robustnessLevel)),m.attachSource(i),u&&m.play()}}else p[e]=n}},S=0,x=g.length;S<x;S++)b(g[S]);if(i.default["__ready__"+d]=function(n){e.dashPlayer=m=n;for(var i,a=dashjs.MediaPlayer.events,l=0,d=y.length;l<d;l++)"loadedmetadata"===(i=y[l])&&(m.getDebug().setLogToBrowserConsole(t.dash.debug),m.initialize(),m.setScheduleWhilePaused(!1),m.setFastSwitchEnabled(!0),m.attachView(p),m.setAutoPlay(!1),"object"!==o(t.dash.drm)||r.default.Utils.isObjectEmpty(t.dash.drm)||(m.setProtectionData(t.dash.drm),(0,s.isString)(t.dash.robustnessLevel)&&t.dash.robustnessLevel&&m.getProtectionController().setRobustnessLevel(t.dash.robustnessLevel)),m.attachSource(p.getSrc())),p.addEventListener(i,E);var u=function(t){if("error"===t.type.toLowerCase())e.generateError(t.message,p.src),console.error(t);else{var n=(0,s.createEvent)(t.type,e);n.data=t,e.dispatchEvent(n)}};for(var c in a)a.hasOwnProperty(c)&&m.on(a[c],function(e){return u(e)})},n&&n.length>0)for(var w=0,P=n.length;w<P;w++)if(a.renderer.renderers[t.prefix].canPlayType(n[w].type)){p.setAttribute("src",n[w].src),void 0!==n[w].drm&&(t.dash.drm=n[w].drm);break}p.setAttribute("id",d),l.parentNode.insertBefore(p,l),l.autoplay=!1,l.style.display="none",p.setSize=function(e,t){return p.style.width=e+"px",p.style.height=t+"px",p},p.hide=function(){return p.pause(),p.style.display="none",p},p.show=function(){return p.style.display="",p},p.destroy=function(){null!==m&&m.reset()};var T=(0,s.createEvent)("rendererready",p);return e.dispatchEvent(T),e.promises.push(f.load({options:t.dash,id:d})),p}};l.typeChecks.push(function(e){return~e.toLowerCase().indexOf(".mpd")?"application/dash+xml":null}),a.renderer.add(p)},{25:25,26:26,27:27,28:28,3:3,7:7,8:8}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PluginDetector=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=f(e(3)),r=f(e(2)),a=f(e(7)),s=f(e(5)),l=e(8),d=e(27),u=e(25),c=e(28);function f(e){return e&&e.__esModule?e:{default:e}}var p=n.PluginDetector={plugins:[],hasPluginVersion:function(e,t){var n=p.plugins[e];return t[1]=t[1]||0,t[2]=t[2]||0,n[0]>t[0]||n[0]===t[0]&&n[1]>t[1]||n[0]===t[0]&&n[1]===t[1]&&n[2]>=t[2]},addPlugin:function(e,t,n,o,i){p.plugins[e]=p.detectPlugin(t,n,o,i)},detectPlugin:function(e,t,n,r){var a=[0,0,0],s=void 0,l=void 0;if(null!==u.NAV.plugins&&void 0!==u.NAV.plugins&&"object"===o(u.NAV.plugins[e])){if((s=u.NAV.plugins[e].description)&&(void 0===u.NAV.mimeTypes||!u.NAV.mimeTypes[t]||u.NAV.mimeTypes[t].enabledPlugin))for(var d=0,c=(a=s.replace(e,"").replace(/^\s+/,"").replace(/\sr/gi,".").split(".")).length;d<c;d++)a[d]=parseInt(a[d].match(/\d+/),10)}else if(void 0!==i.default.ActiveXObject)try{(l=new ActiveXObject(n))&&(a=r(l))}catch(e){}return a}};p.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(e){var t=[],n=e.GetVariable("$version");return n&&(n=n.split(" ")[1].split(","),t=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]),t});var m={create:function(e,t,n){var o={},f=!1;o.options=t,o.id=e.id+"_"+o.options.prefix,o.mediaElement=e,o.flashState={},o.flashApi=null,o.flashApiStack=[];for(var p=a.default.html5media.properties,m=function(e){o.flashState[e]=null;var t=""+e.substring(0,1).toUpperCase()+e.substring(1);o["get"+t]=function(){if(null!==o.flashApi){if("function"==typeof o.flashApi["get_"+e]){var t=o.flashApi["get_"+e]();return"buffered"===e?{start:function(){return 0},end:function(){return t},length:1}:t}return null}return null},o["set"+t]=function(t){if("src"===e&&(t=(0,c.absolutizeUrl)(t)),null!==o.flashApi&&void 0!==o.flashApi["set_"+e])try{o.flashApi["set_"+e](t)}catch(e){}else o.flashApiStack.push({type:"set",propName:e,value:t})}},h=0,v=p.length;h<v;h++)m(p[h]);var g=a.default.html5media.methods,y=function(e){o[e]=function(){if(f)if(null!==o.flashApi){if(o.flashApi["fire_"+e])try{o.flashApi["fire_"+e]()}catch(e){}}else o.flashApiStack.push({type:"call",methodName:e})}};g.push("stop");for(var E=0,b=g.length;E<b;E++)y(g[E]);for(var S=["rendererready"],x=0,w=S.length;x<w;x++){var P=(0,d.createEvent)(S[x],o);e.dispatchEvent(P)}i.default["__ready__"+o.id]=function(){if(o.flashReady=!0,o.flashApi=r.default.getElementById("__"+o.id),o.flashApiStack.length)for(var e=0,t=o.flashApiStack.length;e<t;e++){var n=o.flashApiStack[e];if("set"===n.type){var i=n.propName,a=""+i.substring(0,1).toUpperCase()+i.substring(1);o["set"+a](n.value)}else"call"===n.type&&o[n.methodName]()}},i.default["__event__"+o.id]=function(e,t){var n=(0,d.createEvent)(e,o);if(t)try{n.data=JSON.parse(t),n.details.data=JSON.parse(t)}catch(e){n.message=t}o.mediaElement.dispatchEvent(n)},o.flashWrapper=r.default.createElement("div"),-1===["always","sameDomain"].indexOf(o.options.shimScriptAccess)&&(o.options.shimScriptAccess="sameDomain");var T=e.originalNode.autoplay,C=["uid="+o.id,"autoplay="+T,"allowScriptAccess="+o.options.shimScriptAccess,"preload="+(e.originalNode.getAttribute("preload")||"")],k=null!==e.originalNode&&"video"===e.originalNode.tagName.toLowerCase(),_=k?e.originalNode.height:1,N=k?e.originalNode.width:1;e.originalNode.getAttribute("src")&&C.push("src="+e.originalNode.getAttribute("src")),!0===o.options.enablePseudoStreaming&&(C.push("pseudostreamstart="+o.options.pseudoStreamingStartQueryParam),C.push("pseudostreamtype="+o.options.pseudoStreamingType)),o.options.streamDelimiter&&C.push("streamdelimiter="+encodeURIComponent(o.options.streamDelimiter)),o.options.proxyType&&C.push("proxytype="+o.options.proxyType),e.appendChild(o.flashWrapper),e.originalNode.style.display="none";var A=[];if(u.IS_IE||u.IS_EDGE){var L=r.default.createElement("div");o.flashWrapper.appendChild(L),A=u.IS_EDGE?['type="application/x-shockwave-flash"','data="'+o.options.pluginPath+o.options.filename+'"','id="__'+o.id+'"','width="'+N+'"','height="'+_+"'\""]:['classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"','codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"','id="__'+o.id+'"','width="'+N+'"','height="'+_+'"'],k||A.push('style="clip: rect(0 0 0 0); position: absolute;"'),L.outerHTML="<object "+A.join(" ")+'><param name="movie" value="'+o.options.pluginPath+o.options.filename+"?x="+new Date+'" /><param name="flashvars" value="'+C.join("&amp;")+'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="'+o.options.shimScriptAccess+'" /><param name="allowFullScreen" value="true" /><div>'+s.default.t("mejs.install-flash")+"</div></object>"}else A=['id="__'+o.id+'"','name="__'+o.id+'"','play="true"','loop="false"','quality="high"','bgcolor="#000000"','wmode="transparent"','allowScriptAccess="'+o.options.shimScriptAccess+'"','allowFullScreen="true"','type="application/x-shockwave-flash"','pluginspage="//www.macromedia.com/go/getflashplayer"','src="'+o.options.pluginPath+o.options.filename+'"','flashvars="'+C.join("&")+'"'],k?(A.push('width="'+N+'"'),A.push('height="'+_+'"')):A.push('style="position: fixed; left: -9999em; top: -9999em;"'),o.flashWrapper.innerHTML="<embed "+A.join(" ")+">";if(o.flashNode=o.flashWrapper.lastChild,o.hide=function(){f=!1,k&&(o.flashNode.style.display="none")},o.show=function(){f=!0,k&&(o.flashNode.style.display="")},o.setSize=function(e,t){o.flashNode.style.width=e+"px",o.flashNode.style.height=t+"px",null!==o.flashApi&&"function"==typeof o.flashApi.fire_setSize&&o.flashApi.fire_setSize(e,t)},o.destroy=function(){o.flashNode.remove()},n&&n.length>0)for(var F=0,j=n.length;F<j;F++)if(l.renderer.renderers[t.prefix].canPlayType(n[F].type)){o.setSrc(n[F].src);break}return o}};if(p.hasPluginVersion("flash",[10,0,0])){c.typeChecks.push(function(e){return(e=e.toLowerCase()).startsWith("rtmp")?~e.indexOf(".mp3")?"audio/rtmp":"video/rtmp":/\.og(a|g)/i.test(e)?"audio/ogg":~e.indexOf(".m3u8")?"application/x-mpegURL":~e.indexOf(".mpd")?"application/dash+xml":~e.indexOf(".flv")?"video/flv":null});var h={name:"flash_video",options:{prefix:"flash_video",filename:"mediaelement-flash-video.swf",enablePseudoStreaming:!1,pseudoStreamingStartQueryParam:"start",pseudoStreamingType:"byte",proxyType:"",streamDelimiter:""},canPlayType:function(e){return~["video/mp4","video/rtmp","audio/rtmp","rtmp/mp4","audio/mp4","video/flv","video/x-flv"].indexOf(e.toLowerCase())},create:m.create};l.renderer.add(h);var v={name:"flash_hls",options:{prefix:"flash_hls",filename:"mediaelement-flash-video-hls.swf"},canPlayType:function(e){return~["application/x-mpegurl","application/vnd.apple.mpegurl","audio/mpegurl","audio/hls","video/hls"].indexOf(e.toLowerCase())},create:m.create};l.renderer.add(v);var g={name:"flash_dash",options:{prefix:"flash_dash",filename:"mediaelement-flash-video-mdash.swf"},canPlayType:function(e){return~["application/dash+xml"].indexOf(e.toLowerCase())},create:m.create};l.renderer.add(g);var y={name:"flash_audio",options:{prefix:"flash_audio",filename:"mediaelement-flash-audio.swf"},canPlayType:function(e){return~["audio/mp3"].indexOf(e.toLowerCase())},create:m.create};l.renderer.add(y);var E={name:"flash_audio_ogg",options:{prefix:"flash_audio_ogg",filename:"mediaelement-flash-audio-ogg.swf"},canPlayType:function(e){return~["audio/ogg","audio/oga","audio/ogv"].indexOf(e.toLowerCase())},create:m.create};l.renderer.add(E)}},{2:2,25:25,27:27,28:28,3:3,5:5,7:7,8:8}],21:[function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=c(e(3)),r=c(e(7)),a=e(8),s=e(27),l=e(25),d=e(28),u=e(26);function c(e){return e&&e.__esModule?e:{default:e}}var f={promise:null,load:function(e){return"undefined"!=typeof flvjs?f.promise=new Promise(function(e){e()}).then(function(){f._createPlayer(e)}):(e.options.path="string"==typeof e.options.path?e.options.path:"https://cdn.jsdelivr.net/npm/flv.js@latest",f.promise=f.promise||(0,u.loadScript)(e.options.path),f.promise.then(function(){f._createPlayer(e)})),f.promise},_createPlayer:function(e){flvjs.LoggingControl.enableDebug=e.options.debug,flvjs.LoggingControl.enableVerbose=e.options.debug;var t=flvjs.createPlayer(e.options,e.configs);return i.default["__ready__"+e.id](t),t}},p={name:"native_flv",options:{prefix:"native_flv",flv:{path:"https://cdn.jsdelivr.net/npm/flv.js@latest",cors:!0,debug:!1}},canPlayType:function(e){return l.HAS_MSE&&["video/x-flv","video/flv"].indexOf(e.toLowerCase())>-1},create:function(e,t,n){var l=e.originalNode,d=e.id+"_"+t.prefix,u=null,c=null;u=l.cloneNode(!0),t=Object.assign(t,e.options);for(var p=r.default.html5media.properties,m=r.default.html5media.events.concat(["click","mouseover","mouseout"]).filter(function(e){return"error"!==e}),h=function(t){var n=(0,s.createEvent)(t.type,e);e.dispatchEvent(n)},v=function(e){var n=""+e.substring(0,1).toUpperCase()+e.substring(1);u["get"+n]=function(){return null!==c?u[e]:null},u["set"+n]=function(n){if(-1===r.default.html5media.readOnlyProperties.indexOf(e))if("src"===e){if(u[e]="object"===(void 0===n?"undefined":o(n))&&n.src?n.src:n,null!==c){var i={type:"flv"};i.url=n,i.cors=t.flv.cors,i.debug=t.flv.debug,i.path=t.flv.path;var a=t.flv.configs;c.destroy();for(var s=0,l=m.length;s<l;s++)u.removeEventListener(m[s],h);(c=f._createPlayer({options:i,configs:a,id:d})).attachMediaElement(u),c.load()}}else u[e]=n}},g=0,y=p.length;g<y;g++)v(p[g]);if(i.default["__ready__"+d]=function(t){e.flvPlayer=c=t;for(var n,o=flvjs.Events,i=0,r=m.length;i<r;i++)"loadedmetadata"===(n=m[i])&&(c.unload(),c.detachMediaElement(),c.attachMediaElement(u),c.load()),u.addEventListener(n,h);var a=function(t){o.hasOwnProperty(t)&&c.on(o[t],function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];return function(t,n){if("error"===t){var o=n[0]+": "+n[1]+" "+n[2].msg;e.generateError(o,u.src)}else{var i=(0,s.createEvent)(t,e);i.data=n,e.dispatchEvent(i)}}(o[t],i)})};for(var l in o)a(l)},n&&n.length>0)for(var E=0,b=n.length;E<b;E++)if(a.renderer.renderers[t.prefix].canPlayType(n[E].type)){u.setAttribute("src",n[E].src);break}u.setAttribute("id",d),l.parentNode.insertBefore(u,l),l.autoplay=!1,l.style.display="none";var S={type:"flv"};S.url=u.src,S.cors=t.flv.cors,S.debug=t.flv.debug,S.path=t.flv.path;var x=t.flv.configs;u.setSize=function(e,t){return u.style.width=e+"px",u.style.height=t+"px",u},u.hide=function(){return null!==c&&c.pause(),u.style.display="none",u},u.show=function(){return u.style.display="",u},u.destroy=function(){null!==c&&c.destroy()};var w=(0,s.createEvent)("rendererready",u);return e.dispatchEvent(w),e.promises.push(f.load({options:S,configs:x,id:d})),u}};d.typeChecks.push(function(e){return~e.toLowerCase().indexOf(".flv")?"video/flv":null}),a.renderer.add(p)},{25:25,26:26,27:27,28:28,3:3,7:7,8:8}],22:[function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=c(e(3)),r=c(e(7)),a=e(8),s=e(27),l=e(25),d=e(28),u=e(26);function c(e){return e&&e.__esModule?e:{default:e}}var f={promise:null,load:function(e){return"undefined"!=typeof Hls?f.promise=new Promise(function(e){e()}).then(function(){f._createPlayer(e)}):(e.options.path="string"==typeof e.options.path?e.options.path:"https://cdn.jsdelivr.net/npm/hls.js@latest",f.promise=f.promise||(0,u.loadScript)(e.options.path),f.promise.then(function(){f._createPlayer(e)})),f.promise},_createPlayer:function(e){var t=new Hls(e.options);return i.default["__ready__"+e.id](t),t}},p={name:"native_hls",options:{prefix:"native_hls",hls:{path:"https://cdn.jsdelivr.net/npm/hls.js@latest",autoStartLoad:!1,debug:!1}},canPlayType:function(e){return l.HAS_MSE&&["application/x-mpegurl","application/vnd.apple.mpegurl","audio/mpegurl","audio/hls","video/hls"].indexOf(e.toLowerCase())>-1},create:function(e,t,n){var l=e.originalNode,d=e.id+"_"+t.prefix,u=l.getAttribute("preload"),c=l.autoplay,p=null,m=null,h=0,v=n.length;m=l.cloneNode(!0),(t=Object.assign(t,e.options)).hls.autoStartLoad=u&&"none"!==u||c;for(var g=r.default.html5media.properties,y=r.default.html5media.events.concat(["click","mouseover","mouseout"]).filter(function(e){return"error"!==e}),E=function(t){var n=(0,s.createEvent)(t.type,e);e.dispatchEvent(n)},b=function(e){var n=""+e.substring(0,1).toUpperCase()+e.substring(1);m["get"+n]=function(){return null!==p?m[e]:null},m["set"+n]=function(n){if(-1===r.default.html5media.readOnlyProperties.indexOf(e))if("src"===e){if(m[e]="object"===(void 0===n?"undefined":o(n))&&n.src?n.src:n,null!==p){p.destroy();for(var i=0,a=y.length;i<a;i++)m.removeEventListener(y[i],E);(p=f._createPlayer({options:t.hls,id:d})).loadSource(n),p.attachMedia(m)}}else m[e]=n}},S=0,x=g.length;S<x;S++)b(g[S]);if(i.default["__ready__"+d]=function(t){e.hlsPlayer=p=t;for(var o=Hls.Events,i=function(t){if("loadedmetadata"===t){var n=e.originalNode.src;p.detachMedia(),p.loadSource(n),p.attachMedia(m)}m.addEventListener(t,E)},r=0,a=y.length;r<a;r++)i(y[r]);var l=void 0,d=void 0,u=function(t){o.hasOwnProperty(t)&&p.on(o[t],function(){for(var i=arguments.length,r=Array(i),a=0;a<i;a++)r[a]=arguments[a];return function(t,o){if("hlsError"===t){if(console.warn(o),(o=o[1]).fatal)switch(o.type){case"mediaError":var i=(new Date).getTime();if(!l||i-l>3e3)l=(new Date).getTime(),p.recoverMediaError();else if(!d||i-d>3e3)d=(new Date).getTime(),console.warn("Attempting to swap Audio Codec and recover from media error"),p.swapAudioCodec(),p.recoverMediaError();else{var r="Cannot recover, last media error recovery failed";e.generateError(r,m.src),console.error(r)}break;case"networkError":"manifestLoadError"===o.details&&h<v&&void 0!==n[h+1]?(m.setSrc(n[h++].src),m.load(),m.play()):(e.generateError("Network error",n),console.error("Network error"));break;default:p.destroy()}}else{var a=(0,s.createEvent)(t,e);a.data=o,e.dispatchEvent(a)}}(o[t],r)})};for(var c in o)u(c)},v>0)for(;h<v;h++)if(a.renderer.renderers[t.prefix].canPlayType(n[h].type)){m.setAttribute("src",n[h].src);break}"auto"===u||c||(m.addEventListener("play",function(){null!==p&&p.startLoad()}),m.addEventListener("pause",function(){null!==p&&p.stopLoad()})),m.setAttribute("id",d),l.parentNode.insertBefore(m,l),l.autoplay=!1,l.style.display="none",m.setSize=function(e,t){return m.style.width=e+"px",m.style.height=t+"px",m},m.hide=function(){return m.pause(),m.style.display="none",m},m.show=function(){return m.style.display="",m},m.destroy=function(){null!==p&&(p.stopLoad(),p.destroy())};var w=(0,s.createEvent)("rendererready",m);return e.dispatchEvent(w),e.promises.push(f.load({options:t.hls,id:d})),m}};d.typeChecks.push(function(e){return~e.toLowerCase().indexOf(".m3u8")?"application/x-mpegURL":null}),a.renderer.add(p)},{25:25,26:26,27:27,28:28,3:3,7:7,8:8}],23:[function(e,t,n){"use strict";var o=d(e(3)),i=d(e(2)),r=d(e(7)),a=e(8),s=e(27),l=e(25);function d(e){return e&&e.__esModule?e:{default:e}}var u={name:"html5",options:{prefix:"html5"},canPlayType:function(e){var t=i.default.createElement("video");return l.IS_ANDROID&&/\/mp(3|4)$/i.test(e)||~["application/x-mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/hls","video/hls"].indexOf(e.toLowerCase())&&l.SUPPORTS_NATIVE_HLS?"yes":t.canPlayType?t.canPlayType(e.toLowerCase()).replace(/no/,""):""},create:function(e,t,n){var o=e.id+"_"+t.prefix,l=!1,d=null;void 0===e.originalNode||null===e.originalNode?(d=i.default.createElement("audio"),e.appendChild(d)):d=e.originalNode,d.setAttribute("id",o);for(var u=r.default.html5media.properties,c=function(e){var t=""+e.substring(0,1).toUpperCase()+e.substring(1);d["get"+t]=function(){return d[e]},d["set"+t]=function(t){-1===r.default.html5media.readOnlyProperties.indexOf(e)&&(d[e]=t)}},f=0,p=u.length;f<p;f++)c(u[f]);for(var m,h=r.default.html5media.events.concat(["click","mouseover","mouseout"]).filter(function(e){return"error"!==e}),v=0,g=h.length;v<g;v++)m=h[v],d.addEventListener(m,function(t){if(l){var n=(0,s.createEvent)(t.type,t.target);e.dispatchEvent(n)}});d.setSize=function(e,t){return d.style.width=e+"px",d.style.height=t+"px",d},d.hide=function(){return l=!1,d.style.display="none",d},d.show=function(){return l=!0,d.style.display="",d};var y=0,E=n.length;if(E>0)for(;y<E;y++)if(a.renderer.renderers[t.prefix].canPlayType(n[y].type)){d.setAttribute("src",n[y].src);break}d.addEventListener("error",function(t){4===t.target.error.code&&l&&(y<E&&void 0!==n[y+1]?(d.src=n[y++].src,d.load(),d.play()):e.generateError("Media error: Format(s) not supported or source(s) not found",n))});var b=(0,s.createEvent)("rendererready",d);return e.dispatchEvent(b),d}};o.default.HtmlMediaElement=r.default.HtmlMediaElement=u,a.renderer.add(u)},{2:2,25:25,27:27,3:3,7:7,8:8}],24:[function(e,t,n){"use strict";var o=u(e(3)),i=u(e(2)),r=u(e(7)),a=e(8),s=e(27),l=e(28),d=e(26);function u(e){return e&&e.__esModule?e:{default:e}}var c={isIframeStarted:!1,isIframeLoaded:!1,iframeQueue:[],enqueueIframe:function(e){c.isLoaded="undefined"!=typeof YT&&YT.loaded,c.isLoaded?c.createIframe(e):(c.loadIframeApi(),c.iframeQueue.push(e))},loadIframeApi:function(){c.isIframeStarted||((0,d.loadScript)("https://www.youtube.com/player_api"),c.isIframeStarted=!0)},iFrameReady:function(){for(c.isLoaded=!0,c.isIframeLoaded=!0;c.iframeQueue.length>0;){var e=c.iframeQueue.pop();c.createIframe(e)}},createIframe:function(e){return new YT.Player(e.containerId,e)},getYouTubeId:function(e){var t="";return e.indexOf("?")>0?""===(t=c.getYouTubeIdFromParam(e))&&(t=c.getYouTubeIdFromUrl(e)):t=c.getYouTubeIdFromUrl(e),(t=t.substring(t.lastIndexOf("/")+1).split("?"))[0]},getYouTubeIdFromParam:function(e){if(null==e||!e.trim().length)return null;for(var t=e.split("?")[1].split("&"),n="",o=0,i=t.length;o<i;o++){var r=t[o].split("=");if("v"===r[0]){n=r[1];break}}return n},getYouTubeIdFromUrl:function(e){return null!=e&&e.trim().length?(e=e.split("?")[0]).substring(e.lastIndexOf("/")+1):null},getYouTubeNoCookieUrl:function(e){if(null==e||!e.trim().length||-1===e.indexOf("//www.youtube"))return e;var t=e.split("/");return t[2]=t[2].replace(".com","-nocookie.com"),t.join("/")}},f={name:"youtube_iframe",options:{prefix:"youtube_iframe",youtube:{autoplay:0,controls:0,disablekb:1,end:0,loop:0,modestbranding:0,playsinline:0,rel:0,showinfo:0,start:0,iv_load_policy:3,nocookie:!1,imageQuality:null}},canPlayType:function(e){return~["video/youtube","video/x-youtube"].indexOf(e.toLowerCase())},create:function(e,t,n){var a={},l=[],d=null,u=!0,f=!1,p=null;a.options=t,a.id=e.id+"_"+t.prefix,a.mediaElement=e;for(var m=r.default.html5media.properties,h=function(t){var n=""+t.substring(0,1).toUpperCase()+t.substring(1);a["get"+n]=function(){if(null!==d){switch(t){case"currentTime":return d.getCurrentTime();case"duration":return d.getDuration();case"volume":return d.getVolume()/100;case"paused":return u;case"ended":return f;case"muted":return d.isMuted();case"buffered":var e=d.getVideoLoadedFraction(),n=d.getDuration();return{start:function(){return 0},end:function(){return e*n},length:1};case"src":return d.getVideoUrl();case"readyState":return 4}return null}return null},a["set"+n]=function(n){if(null!==d)switch(t){case"src":var o="string"==typeof n?n:n[0].src,i=c.getYouTubeId(o);e.originalNode.autoplay?d.loadVideoById(i):d.cueVideoById(i);break;case"currentTime":d.seekTo(n);break;case"muted":n?d.mute():d.unMute(),setTimeout(function(){var t=(0,s.createEvent)("volumechange",a);e.dispatchEvent(t)},50);break;case"volume":n,d.setVolume(100*n),setTimeout(function(){var t=(0,s.createEvent)("volumechange",a);e.dispatchEvent(t)},50);break;case"readyState":var r=(0,s.createEvent)("canplay",a);e.dispatchEvent(r)}else l.push({type:"set",propName:t,value:n})}},v=0,g=m.length;v<g;v++)h(m[v]);for(var y=r.default.html5media.methods,E=function(e){a[e]=function(){if(null!==d)switch(e){case"play":return u=!1,d.playVideo();case"pause":return u=!0,d.pauseVideo();case"load":return null}else l.push({type:"call",methodName:e})}},b=0,S=y.length;b<S;b++)E(y[b]);var x=i.default.createElement("div");x.id=a.id,a.options.youtube.nocookie&&(e.originalNode.src=c.getYouTubeNoCookieUrl(n[0].src)),e.originalNode.parentNode.insertBefore(x,e.originalNode),e.originalNode.style.display="none";var w="audio"===e.originalNode.tagName.toLowerCase(),P=w?"1":e.originalNode.height,T=w?"1":e.originalNode.width,C=c.getYouTubeId(n[0].src),k={id:a.id,containerId:x.id,videoId:C,height:P,width:T,playerVars:Object.assign({controls:0,rel:0,disablekb:1,showinfo:0,modestbranding:0,html5:1,iv_load_policy:3},a.options.youtube),origin:o.default.location.host,events:{onReady:function(t){if(e.youTubeApi=d=t.target,e.youTubeState={paused:!0,ended:!1},l.length)for(var n=0,o=l.length;n<o;n++){var i=l[n];if("set"===i.type){var r=i.propName,u=""+r.substring(0,1).toUpperCase()+r.substring(1);a["set"+u](i.value)}else"call"===i.type&&a[i.methodName]()}p=d.getIframe(),e.originalNode.muted&&d.mute();for(var c=["mouseover","mouseout"],f=function(t){var n=(0,s.createEvent)(t.type,a);e.dispatchEvent(n)},m=0,h=c.length;m<h;m++)p.addEventListener(c[m],f,!1);for(var v=["rendererready","loadedmetadata","loadeddata","canplay"],g=0,y=v.length;g<y;g++){var E=(0,s.createEvent)(v[g],a);e.dispatchEvent(E)}},onStateChange:function(t){var n=[];switch(t.data){case-1:n=["loadedmetadata"],u=!0,f=!1;break;case 0:n=["ended"],u=!1,f=!a.options.youtube.loop,a.options.youtube.loop||a.stopInterval();break;case 1:n=["play","playing"],u=!1,f=!1,a.startInterval();break;case 2:n=["pause"],u=!0,f=!1,a.stopInterval();break;case 3:n=["progress"],f=!1;break;case 5:n=["loadeddata","loadedmetadata","canplay"],u=!0,f=!1}for(var o=0,i=n.length;o<i;o++){var r=(0,s.createEvent)(n[o],a);e.dispatchEvent(r)}},onError:function(t){return function(t){var o="";switch(t.data){case 2:o="The request contains an invalid parameter value. Verify that video ID has 11 characters and that contains no invalid characters, such as exclamation points or asterisks.";break;case 5:o="The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.";break;case 100:o="The video requested was not found. Either video has been removed or has been marked as private.";break;case 101:case 105:o="The owner of the requested video does not allow it to be played in embedded players.";break;default:o="Unknown error."}e.generateError("Code "+t.data+": "+o,n)}(t)}}};return(w||e.originalNode.hasAttribute("playsinline"))&&(k.playerVars.playsinline=1),e.originalNode.controls&&(k.playerVars.controls=1),e.originalNode.autoplay&&(k.playerVars.autoplay=1),e.originalNode.loop&&(k.playerVars.loop=1),(k.playerVars.loop&&1===parseInt(k.playerVars.loop,10)||e.originalNode.src.indexOf("loop=")>-1)&&!k.playerVars.playlist&&-1===e.originalNode.src.indexOf("playlist=")&&(k.playerVars.playlist=c.getYouTubeId(e.originalNode.src)),c.enqueueIframe(k),a.onEvent=function(t,n,o){null!=o&&(e.youTubeState=o)},a.setSize=function(e,t){null!==d&&d.setSize(e,t)},a.hide=function(){a.stopInterval(),a.pause(),p&&(p.style.display="none")},a.show=function(){p&&(p.style.display="")},a.destroy=function(){d.destroy()},a.interval=null,a.startInterval=function(){a.interval=setInterval(function(){var t=(0,s.createEvent)("timeupdate",a);e.dispatchEvent(t)},250)},a.stopInterval=function(){a.interval&&clearInterval(a.interval)},a.getPosterUrl=function(){var n=t.youtube.imageQuality,o=c.getYouTubeId(e.originalNode.src);return n&&["default","hqdefault","mqdefault","sddefault","maxresdefault"].indexOf(n)>-1&&o?"https://img.youtube.com/vi/"+o+"/"+n+".jpg":""},a}};o.default.onYouTubePlayerAPIReady=function(){c.iFrameReady()},l.typeChecks.push(function(e){return/\/\/(www\.youtube|youtu\.?be)/i.test(e)?"video/x-youtube":null}),a.renderer.add(f)},{2:2,26:26,27:27,28:28,3:3,7:7,8:8}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.cancelFullScreen=n.requestFullScreen=n.isFullScreen=n.FULLSCREEN_EVENT_NAME=n.HAS_NATIVE_FULLSCREEN_ENABLED=n.HAS_TRUE_NATIVE_FULLSCREEN=n.HAS_IOS_FULLSCREEN=n.HAS_MS_NATIVE_FULLSCREEN=n.HAS_MOZ_NATIVE_FULLSCREEN=n.HAS_WEBKIT_NATIVE_FULLSCREEN=n.HAS_NATIVE_FULLSCREEN=n.SUPPORTS_NATIVE_HLS=n.SUPPORT_PASSIVE_EVENT=n.SUPPORT_POINTER_EVENTS=n.HAS_MSE=n.IS_STOCK_ANDROID=n.IS_SAFARI=n.IS_FIREFOX=n.IS_CHROME=n.IS_EDGE=n.IS_IE=n.IS_ANDROID=n.IS_IOS=n.IS_IPOD=n.IS_IPHONE=n.IS_IPAD=n.UA=n.NAV=void 0;var o=a(e(3)),i=a(e(2)),r=a(e(7));function a(e){return e&&e.__esModule?e:{default:e}}for(var s=n.NAV=o.default.navigator,l=n.UA=s.userAgent.toLowerCase(),d=n.IS_IPAD=/ipad/i.test(l)&&!o.default.MSStream,u=n.IS_IPHONE=/iphone/i.test(l)&&!o.default.MSStream,c=n.IS_IPOD=/ipod/i.test(l)&&!o.default.MSStream,f=(n.IS_IOS=/ipad|iphone|ipod/i.test(l)&&!o.default.MSStream,n.IS_ANDROID=/android/i.test(l)),p=n.IS_IE=/(trident|microsoft)/i.test(s.appName),m=(n.IS_EDGE="msLaunchUri"in s&&!("documentMode"in i.default)),h=n.IS_CHROME=/chrome/i.test(l),v=n.IS_FIREFOX=/firefox/i.test(l),g=n.IS_SAFARI=/safari/i.test(l)&&!h,y=n.IS_STOCK_ANDROID=/^mozilla\/\d+\.\d+\s\(linux;\su;/i.test(l),E=(n.HAS_MSE="MediaSource"in o.default),b=n.SUPPORT_POINTER_EVENTS=function(e){var t=i.default.createElement("x"),n=i.default.documentElement,r=o.default.getComputedStyle;if(!("pointerEvents"in t.style))return!1;t.style.pointerEvents="auto",t.style.pointerEvents="x",n.appendChild(t);var a=r&&"auto"===r(t,"").pointerEvents;return e(t).remove(),!!a}(jQuery),S=n.SUPPORT_PASSIVE_EVENT=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});o.default.addEventListener("test",null,t)}catch(e){}return e}(),x=["source","track","audio","video"],w=void 0,P=0,T=x.length;P<T;P++)w=i.default.createElement(x[P]);var C=n.SUPPORTS_NATIVE_HLS=g||f&&(h||y)||p&&/edge/i.test(l),k=void 0!==w.webkitEnterFullscreen,_=void 0!==w.requestFullscreen;k&&/mac os x 10_5/i.test(l)&&(_=!1,k=!1);var N=void 0!==w.webkitRequestFullScreen,A=void 0!==w.mozRequestFullScreen,L=void 0!==w.msRequestFullscreen,F=N||A||L,j=F,I="",M=void 0,O=void 0,D=void 0;A?j=i.default.mozFullScreenEnabled:L&&(j=i.default.msFullscreenEnabled),h&&(k=!1),F&&(N?I="webkitfullscreenchange":A?I="mozfullscreenchange":L&&(I="MSFullscreenChange"),n.isFullScreen=M=function(){return A?i.default.mozFullScreen:N?i.default.webkitIsFullScreen:L?null!==i.default.msFullscreenElement:void 0},n.requestFullScreen=O=function(e){N?e.webkitRequestFullScreen():A?e.mozRequestFullScreen():L&&e.msRequestFullscreen()},n.cancelFullScreen=D=function(){N?i.default.webkitCancelFullScreen():A?i.default.mozCancelFullScreen():L&&i.default.msExitFullscreen()});var V=n.HAS_NATIVE_FULLSCREEN=_,R=n.HAS_WEBKIT_NATIVE_FULLSCREEN=N,H=n.HAS_MOZ_NATIVE_FULLSCREEN=A,U=n.HAS_MS_NATIVE_FULLSCREEN=L,q=n.HAS_IOS_FULLSCREEN=k,B=n.HAS_TRUE_NATIVE_FULLSCREEN=F,z=n.HAS_NATIVE_FULLSCREEN_ENABLED=j,W=n.FULLSCREEN_EVENT_NAME=I;n.isFullScreen=M,n.requestFullScreen=O,n.cancelFullScreen=D,r.default.Features=r.default.Features||{},r.default.Features.isiPad=d,r.default.Features.isiPod=c,r.default.Features.isiPhone=u,r.default.Features.isiOS=r.default.Features.isiPhone||r.default.Features.isiPad,r.default.Features.isAndroid=f,r.default.Features.isIE=p,r.default.Features.isEdge=m,r.default.Features.isChrome=h,r.default.Features.isFirefox=v,r.default.Features.isSafari=g,r.default.Features.isStockAndroid=y,r.default.Features.hasMSE=E,r.default.Features.supportsNativeHLS=C,r.default.Features.supportsPointerEvents=b,r.default.Features.supportsPassiveEvent=S,r.default.Features.hasiOSFullScreen=q,r.default.Features.hasNativeFullscreen=V,r.default.Features.hasWebkitNativeFullScreen=R,r.default.Features.hasMozNativeFullScreen=H,r.default.Features.hasMsNativeFullScreen=U,r.default.Features.hasTrueNativeFullScreen=B,r.default.Features.nativeFullScreenEnabled=z,r.default.Features.fullScreenEventName=W,r.default.Features.isFullScreen=M,r.default.Features.requestFullScreen=O,r.default.Features.cancelFullScreen=D},{2:2,3:3,7:7}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.removeClass=n.addClass=n.hasClass=void 0,n.loadScript=s,n.offset=l,n.toggleClass=h,n.fadeOut=v,n.fadeIn=g,n.siblings=y,n.visible=E,n.ajax=b;var o=a(e(3)),i=a(e(2)),r=a(e(7));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return new Promise(function(t,n){var o=i.default.createElement("script");o.src=e,o.async=!0,o.onload=function(){o.remove(),t()},o.onerror=function(){o.remove(),n()},i.default.head.appendChild(o)})}function l(e){var t=e.getBoundingClientRect(),n=o.default.pageXOffset||i.default.documentElement.scrollLeft,r=o.default.pageYOffset||i.default.documentElement.scrollTop;return{top:t.top+r,left:t.left+n}}var d=void 0,u=void 0,c=void 0;"classList"in i.default.documentElement?(d=function(e,t){return void 0!==e.classList&&e.classList.contains(t)},u=function(e,t){return e.classList.add(t)},c=function(e,t){return e.classList.remove(t)}):(d=function(e,t){return new RegExp("\\b"+t+"\\b").test(e.className)},u=function(e,t){f(e,t)||(e.className+=" "+t)},c=function(e,t){e.className=e.className.replace(new RegExp("\\b"+t+"\\b","g"),"")});var f=n.hasClass=d,p=n.addClass=u,m=n.removeClass=c;function h(e,t){f(e,t)?m(e,t):p(e,t)}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,n=arguments[2];e.style.opacity||(e.style.opacity=1);var i=null;o.default.requestAnimationFrame(function r(a){var s=a-(i=i||a),l=parseFloat(1-s/t,2);e.style.opacity=l<0?0:l,s>t?n&&"function"==typeof n&&n():o.default.requestAnimationFrame(r)})}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,n=arguments[2];e.style.opacity||(e.style.opacity=0);var i=null;o.default.requestAnimationFrame(function r(a){var s=a-(i=i||a),l=parseFloat(s/t,2);e.style.opacity=l>1?1:l,s>t?n&&"function"==typeof n&&n():o.default.requestAnimationFrame(r)})}function y(e,t){var n=[];e=e.parentNode.firstChild;do{t&&!t(e)||n.push(e)}while(e=e.nextSibling);return n}function E(e){return void 0!==e.getClientRects&&"function"===e.getClientRects?!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length):!(!e.offsetWidth&&!e.offsetHeight)}function b(e,t,n,i){var r=o.default.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a="application/x-www-form-urlencoded; charset=UTF-8",s=!1,l="*/".concat("*");switch(t){case"text":a="text/plain";break;case"json":a="application/json, text/javascript";break;case"html":a="text/html";break;case"xml":a="application/xml, text/xml"}"application/x-www-form-urlencoded"!==a&&(l=a+", */*; q=0.01"),r&&(r.open("GET",e,!0),r.setRequestHeader("Accept",l),r.onreadystatechange=function(){if(!s&&4===r.readyState)if(200===r.status){s=!0;var e=void 0;switch(t){case"json":e=JSON.parse(r.responseText);break;case"xml":e=r.responseXML;break;default:e=r.responseText}n(e)}else"function"==typeof i&&i(r.status)},r.send())}r.default.Utils=r.default.Utils||{},r.default.Utils.offset=l,r.default.Utils.hasClass=f,r.default.Utils.addClass=p,r.default.Utils.removeClass=m,r.default.Utils.toggleClass=h,r.default.Utils.fadeIn=g,r.default.Utils.fadeOut=v,r.default.Utils.siblings=y,r.default.Utils.visible=E,r.default.Utils.ajax=b,r.default.Utils.loadScript=s},{2:2,3:3,7:7}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.escapeHTML=a,n.debounce=s,n.isObjectEmpty=l,n.splitEvents=d,n.createEvent=u,n.isNodeAfter=c,n.isString=f;var o,i=e(7),r=(o=i)&&o.__esModule?o:{default:o};function a(e){if("string"!=typeof e)throw new Error("Argument passed must be a string");var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return e.replace(/[&<>"]/g,function(e){return t[e]})}function s(e,t){var n=this,o=arguments,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("function"!=typeof e)throw new Error("First argument must be a function");if("number"!=typeof t)throw new Error("Second argument must be a numeric value");var r=void 0;return function(){var a=n,s=o,l=i&&!r;clearTimeout(r),r=setTimeout(function(){r=null,i||e.apply(a,s)},t),l&&e.apply(a,s)}}function l(e){return Object.getOwnPropertyNames(e).length<=0}function d(e,t){var n=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/,o={d:[],w:[]};return(e||"").split(" ").forEach(function(e){var i=e+(t?"."+t:"");i.startsWith(".")?(o.d.push(i),o.w.push(i)):o[n.test(e)?"w":"d"].push(i)}),o.d=o.d.join(" "),o.w=o.w.join(" "),o}function u(e,t){if("string"!=typeof e)throw new Error("Event name must be a string");var n=e.match(/([a-z]+\.([a-z]+))/i),o={target:t};return null!==n&&(e=n[1],o.namespace=n[2]),new window.CustomEvent(e,{detail:o})}function c(e,t){return!!(e&&t&&2&e.compareDocumentPosition(t))}function f(e){return"string"==typeof e}r.default.Utils=r.default.Utils||{},r.default.Utils.escapeHTML=a,r.default.Utils.debounce=s,r.default.Utils.isObjectEmpty=l,r.default.Utils.splitEvents=d,r.default.Utils.createEvent=u,r.default.Utils.isNodeAfter=c,r.default.Utils.isString=f},{7:7}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.typeChecks=void 0,n.absolutizeUrl=l,n.formatType=d,n.getMimeFromType=u,n.getTypeFromFile=c,n.getExtension=f,n.normalizeExtension=p;var o,i=e(7),r=(o=i)&&o.__esModule?o:{default:o},a=e(27);var s=n.typeChecks=[];function l(e){if("string"!=typeof e)throw new Error("`url` argument must be a string");var t=document.createElement("div");return t.innerHTML='<a href="'+(0,a.escapeHTML)(e)+'">x</a>',t.firstChild.href}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e&&!t?c(e):t}function u(e){if("string"!=typeof e)throw new Error("`type` argument must be a string");return e&&e.indexOf(";")>-1?e.substr(0,e.indexOf(";")):e}function c(e){if("string"!=typeof e)throw new Error("`url` argument must be a string");for(var t=0,n=s.length;t<n;t++){var o=s[t](e);if(o)return o}var i=p(f(e)),r="video/mp4";return i&&(~["mp4","m4v","ogg","ogv","webm","flv","mpeg","mov"].indexOf(i)?r="video/"+i:~["mp3","oga","wav","mid","midi"].indexOf(i)&&(r="audio/"+i)),r}function f(e){if("string"!=typeof e)throw new Error("`url` argument must be a string");var t=e.split("?")[0].split("\\").pop().split("/").pop();return~t.indexOf(".")?t.substring(t.lastIndexOf(".")+1):""}function p(e){if("string"!=typeof e)throw new Error("`extension` argument must be a string");switch(e){case"mp4":case"m4v":return"mp4";case"webm":case"webma":case"webmv":return"webm";case"ogg":case"oga":case"ogv":return"ogg";default:return e}}r.default.Utils=r.default.Utils||{},r.default.Utils.typeChecks=s,r.default.Utils.absolutizeUrl=l,r.default.Utils.formatType=d,r.default.Utils.getMimeFromType=u,r.default.Utils.getTypeFromFile=c,r.default.Utils.getExtension=f,r.default.Utils.normalizeExtension=p},{27:27,7:7}],29:[function(e,t,n){"use strict";var o,i=a(e(2)),r=a(e(4));function a(e){return e&&e.__esModule?e:{default:e}}if([Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=i.default.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1,o=arguments.length;n<o;n++){var i=arguments[n];if(null!==i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length-1;--n>=0&&t.item(n)!==this;);return n>-1}),window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t=(this.document||this.ownerDocument).querySelectorAll(e),n=void 0,o=this;do{for(n=t.length;--n>=0&&t.item(n)!==o;);}while(n<0&&(o=o.parentElement));return o}),function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),o=Math.max(0,16-(n-e)),i=window.setTimeout(function(){t(n+o)},o);return e=n+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),/firefox/i.test(navigator.userAgent)){var s=window.getComputedStyle;window.getComputedStyle=function(e,t){var n=s(e,t);return null===n?{getPropertyValue:function(){}}:n}}window.Promise||(window.Promise=r.default),(o=window.Node||window.Element)&&o.prototype&&null===o.prototype.children&&Object.defineProperty(o.prototype,"children",{get:function(){for(var e=0,t=void 0,n=this.childNodes,o=[];t=n[e++];)1===t.nodeType&&o.push(t);return o}})},{2:2,4:4}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isDropFrame=a,n.secondsToTimeCode=s,n.timeCodeToSeconds=l,n.calculateTimeFormat=d,n.convertSMPTEtoSeconds=u;var o,i=e(7),r=(o=i)&&o.__esModule?o:{default:o};function a(){return!((arguments.length>0&&void 0!==arguments[0]?arguments[0]:25)%1==0)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:25,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"hh:mm:ss";e=!e||"number"!=typeof e||e<0?0:e;var s=Math.round(.066666*o),l=Math.round(o),d=24*Math.round(3600*o),u=Math.round(600*o),c=a(o)?";":":",f=void 0,p=void 0,m=void 0,h=void 0,v=Math.round(e*o);if(a(o)){v<0&&(v=d+v);var g=(v%=d)%u;v+=9*s*Math.floor(v/u),g>s&&(v+=s*Math.floor((g-s)/Math.round(60*l-s)));var y=Math.floor(v/l);f=Math.floor(Math.floor(y/60)/60),p=Math.floor(y/60)%60,m=n?y%60:Math.floor(v/l%60).toFixed(i)}else f=Math.floor(e/3600)%24,p=Math.floor(e/60)%60,m=n?Math.floor(e%60):Math.floor(e%60).toFixed(i);f=f<=0?0:f,m=60===(m=m<=0?0:m)?0:m,p=60===(p=p<=0?0:p)?0:p;for(var E=r.split(":"),b={},S=0,x=E.length;S<x;++S){for(var w="",P=0,T=E[S].length;P<T;P++)w.indexOf(E[S][P])<0&&(w+=E[S][P]);~["f","s","m","h"].indexOf(w)&&(b[w]=E[S].length)}var C=t||f>0?(f<10&&b.h>1?"0"+f:f)+":":"";return C+=(p<10&&b.m>1?"0"+p:p)+":",C+=""+(m<10&&b.s>1?"0"+m:m),n&&(C+=(h=(h=(v%l).toFixed(0))<=0?0:h)<10&&b.f?c+"0"+h:""+c+h),C}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;if("string"!=typeof e)throw new TypeError("Time must be a string");if(e.indexOf(";")>0&&(e=e.replace(";",":")),!/\d{2}(\:\d{2}){0,3}/i.test(e))throw new TypeError("Time code must have the format `00:00:00`");var n=e.split(":"),o=void 0,i=0,r=0,s=0,l=0,d=0,u=Math.round(.066666*t),c=Math.round(t),f=3600*c,p=60*c;switch(n.length){default:case 1:s=parseInt(n[0],10);break;case 2:r=parseInt(n[0],10),s=parseInt(n[1],10);break;case 3:i=parseInt(n[0],10),r=parseInt(n[1],10),s=parseInt(n[2],10);break;case 4:i=parseInt(n[0],10),r=parseInt(n[1],10),s=parseInt(n[2],10),l=parseInt(n[3],10)}return o=a(t)?f*i+p*r+c*s+l-u*((d=60*i+r)-Math.floor(d/10)):(f*i+p*r+t*s+l)/t,parseFloat(o.toFixed(3))}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25;e=!e||"number"!=typeof e||e<0?0:e;for(var o=Math.floor(e/3600)%24,i=Math.floor(e/60)%60,r=Math.floor(e%60),a=[[Math.floor((e%1*n).toFixed(3)),"f"],[r,"s"],[i,"m"],[o,"h"]],s=t.timeFormat,l=s[1]===s[0],d=l?2:1,u=s.length<d?s[d]:":",c=s[0],f=!1,p=0,m=a.length;p<m;p++)if(~s.indexOf(a[p][1]))f=!0;else if(f){for(var h=!1,v=p;v<m;v++)if(a[v][0]>0){h=!0;break}if(!h)break;l||(s=c+s),s=a[p][1]+u+s,l&&(s=a[p][1]+s),c=a[p][1]}t.timeFormat=s}function u(e){if("string"!=typeof e)throw new TypeError("Argument must be a string value");for(var t=~(e=e.replace(",",".")).indexOf(".")?e.split(".")[1].length:0,n=0,o=1,i=0,r=(e=e.split(":").reverse()).length;i<r;i++)o=1,i>0&&(o=Math.pow(60,i)),n+=Number(e[i])*o;return Number(n.toFixed(t))}r.default.Utils=r.default.Utils||{},r.default.Utils.secondsToTimeCode=s,r.default.Utils.timeCodeToSeconds=l,r.default.Utils.calculateTimeFormat=d,r.default.Utils.convertSMPTEtoSeconds=u},{7:7}]},{},[29,6,5,15,23,20,19,21,22,24,16,18,17,9,10,11,12,13,14]);
/*! JsBarcode v3.11.0 | (c) Johan Lindell | MIT license */
!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=20)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function t(e,n){r(this,t),this.data=e,this.text=n.text||e,this.options=n};e.default=o},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0});var o,i=e.SET_A=0,u=e.SET_B=1,a=e.SET_C=2,f=(e.SHIFT=98,e.START_A=103),c=e.START_B=104,s=e.START_C=105;e.MODULO=103,e.STOP=106,e.FNC1=207,e.SET_BY_CODE=(o={},r(o,f,i),r(o,c,u),r(o,s,a),o),e.SWAP={101:i,100:u,99:a},e.A_START_CHAR=String.fromCharCode(208),e.B_START_CHAR=String.fromCharCode(209),e.C_START_CHAR=String.fromCharCode(210),e.A_CHARS="[\0-_È-Ï]",e.B_CHARS="[ -È-Ï]",e.C_CHARS="(Ï*[0-9]{2}Ï*)",e.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SIDE_BIN="101",e.MIDDLE_BIN="01010",e.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},e.EAN2_STRUCTURE=["LL","LG","GL","GG"],e.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],e.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=function(t,e,n){var o=t.split("").map(function(t,n){return r.BINARIES[e[n]]}).map(function(e,n){return e?e[t[n]]:""});if(n){var i=t.length-1;o=o.map(function(t,e){return e<i?t+n:t})}return o.join("")};e.default=o},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){for(var n=0;n<e;n++)t="0"+t;return t}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=n(0),c=function(t){return t&&t.__esModule?t:{default:t}}(f),s=function(t){function e(t,n){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return i(e,t),a(e,[{key:"encode",value:function(){for(var t="110",e=0;e<this.data.length;e++){var n=parseInt(this.data[e]),r=n.toString(2);r=u(r,4-r.length);for(var o=0;o<r.length;o++)t+="0"==r[o]?"100":"110"}return t+="1001",{data:t,text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),e}(c.default);e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.default=function(t,e){return r({},t,e)}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),f=function(t){return t&&t.__esModule?t:{default:t}}(a),c=n(1),s=function(t){function e(t,n){r(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.substring(1),n));return i.bytes=t.split("").map(function(t){return t.charCodeAt(0)}),i}return i(e,t),u(e,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var t=this.bytes,n=t.shift()-105,r=c.SET_BY_CODE[n];if(void 0===r)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&t.unshift(c.FNC1);var o=e.next(t,1,r);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:e.getBar(n)+o.result+e.getBar((o.checksum+n)%c.MODULO)+e.getBar(c.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var t=this.options.ean128||!1;return"string"==typeof t&&(t="true"===t.toLowerCase()),t}}],[{key:"getBar",value:function(t){return c.BARS[t]?c.BARS[t].toString():""}},{key:"correctIndex",value:function(t,e){if(e===c.SET_A){var n=t.shift();return n<32?n+64:n-32}return e===c.SET_B?t.shift()-32:10*(t.shift()-48)+t.shift()-48}},{key:"next",value:function(t,n,r){if(!t.length)return{result:"",checksum:0};var o=void 0,i=void 0;if(t[0]>=200){i=t.shift()-105;var u=c.SWAP[i];void 0!==u?o=e.next(t,n+1,u):(r!==c.SET_A&&r!==c.SET_B||i!==c.SHIFT||(t[0]=r===c.SET_A?t[0]>95?t[0]-96:t[0]:t[0]<32?t[0]+96:t[0]),o=e.next(t,n+1,r))}else i=e.correctIndex(t,r),o=e.next(t,n+1,r);var a=e.getBar(i),f=i*n;return{result:a+o.result,checksum:f+o.checksum}}}]),e}(f.default);e.default=s},function(t,e,n){"use strict";function r(t){for(var e=0,n=0;n<t.length;n++){var r=parseInt(t[n]);(n+t.length)%2==0?e+=r:e+=2*r%10+Math.floor(2*r/10)}return(10-e%10)%10}function o(t){for(var e=0,n=[2,3,4,5,6,7],r=0;r<t.length;r++){e+=n[r%n.length]*parseInt(t[t.length-1-r])}return(11-e%11)%11}Object.defineProperty(e,"__esModule",{value:!0}),e.mod10=r,e.mod11=o},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(t){function e(t,n){r(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.name="InvalidInputException",i.symbology=t,i.input=n,i.message='"'+i.input+'" is not a valid input for '+i.symbology,i}return i(e,t),e}(Error),a=function(t){function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return i(e,t),e}(Error),f=function(t){function e(){r(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}return i(e,t),e}(Error);e.InvalidInputException=u,e.InvalidElementException=a,e.NoElementException=f},function(t,e,n){"use strict";function r(t){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var n in e)e.hasOwnProperty(n)&&(n=e[n],"string"==typeof t[n]&&(t[n]=parseInt(t[n],10)));return"string"==typeof t.displayValue&&(t.displayValue="false"!=t.displayValue),t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};e.default=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=n(2),c=n(3),s=r(c),l=n(0),p=r(l),d=function(t){function e(t,n){o(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.fontSize=!n.flat&&n.fontSize>10*n.width?10*n.width:n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return u(e,t),a(e,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(t,e){return this.text.substr(t,e)}},{key:"leftEncode",value:function(t,e){return(0,s.default)(t,e)}},{key:"rightText",value:function(t,e){return this.text.substr(t,e)}},{key:"rightEncode",value:function(t,e){return(0,s.default)(t,e)}},{key:"encodeGuarded",value:function(){var t={fontSize:this.fontSize},e={height:this.guardHeight};return[{data:f.SIDE_BIN,options:e},{data:this.leftEncode(),text:this.leftText(),options:t},{data:f.MIDDLE_BIN,options:e},{data:this.rightEncode(),text:this.rightText(),options:t},{data:f.SIDE_BIN,options:e}]}},{key:"encodeFlat",value:function(){return{data:[f.SIDE_BIN,this.leftEncode(),f.MIDDLE_BIN,this.rightEncode(),f.SIDE_BIN].join(""),text:this.text}}}]),e}(p.default);e.default=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t){var e,n=0;for(e=1;e<11;e+=2)n+=parseInt(t[e]);for(e=0;e<11;e+=2)n+=3*parseInt(t[e]);return(10-n%10)%10}Object.defineProperty(e,"__esModule",{value:!0});var f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.checksum=a;var c=n(3),s=r(c),l=n(0),p=r(l),d=function(t){function e(t,n){o(this,e),-1!==t.search(/^[0-9]{11}$/)&&(t+=a(t));var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.displayValue=n.displayValue,n.fontSize>10*n.width?r.fontSize=10*n.width:r.fontSize=n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return u(e,t),f(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==a(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var t="";return t+="101",t+=(0,s.default)(this.data.substr(0,6),"LLLLLL"),t+="01010",t+=(0,s.default)(this.data.substr(6,6),"RRRRRR"),t+="101",{data:t,text:this.text}}},{key:"guardedEncoding",value:function(){var t=[];return this.displayValue&&t.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),t.push({data:"101"+(0,s.default)(this.data[0],"L"),options:{height:this.guardHeight}}),t.push({data:(0,s.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),t.push({data:"01010",options:{height:this.guardHeight}}),t.push({data:(0,s.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),t.push({data:(0,s.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&t.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),t}}]),e}(p.default);e.default=d},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(36),f=n(0),c=function(t){return t&&t.__esModule?t:{default:t}}(f),s=function(t){function e(){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),u(e,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var t=this,e=this.data.match(/.{2}/g).map(function(e){return t.encodePair(e)}).join("");return{data:a.START_BIN+e+a.END_BIN,text:this.text}}},{key:"encodePair",value:function(t){var e=a.BINARIES[t[1]];return a.BINARIES[t[0]].split("").map(function(t,n){return("1"===t?"111":"1")+("1"===e[n]?"000":"0")}).join("")}}]),e}(c.default);e.default=s},function(t,e,n){"use strict";function r(t,e){return e.height+(e.displayValue&&t.text.length>0?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function o(t,e,n){if(n.displayValue&&e<t){if("center"==n.textAlign)return Math.floor((t-e)/2);if("left"==n.textAlign)return 0;if("right"==n.textAlign)return Math.floor(t-e)}return 0}function i(t,e,n){for(var i=0;i<t.length;i++){var u,a=t[i],c=(0,s.default)(e,a.options);u=c.displayValue?f(a.text,c,n):0;var l=a.data.length*c.width;a.width=Math.ceil(Math.max(u,l)),a.height=r(a,c),a.barcodePadding=o(u,l,c)}}function u(t){for(var e=0,n=0;n<t.length;n++)e+=t[n].width;return e}function a(t){for(var e=0,n=0;n<t.length;n++)t[n].height>e&&(e=t[n].height);return e}function f(t,e,n){var r;if(n)r=n;else{if("undefined"==typeof document)return 0;r=document.createElement("canvas").getContext("2d")}return r.font=e.fontOptions+" "+e.fontSize+"px "+e.font,r.measureText(t).width}Object.defineProperty(e,"__esModule",{value:!0}),e.getTotalWidthOfEncodings=e.calculateEncodingAttributes=e.getBarcodePadding=e.getEncodingHeight=e.getMaximumHeightOfEncodings=void 0;var c=n(5),s=function(t){return t&&t.__esModule?t:{default:t}}(c);e.getMaximumHeightOfEncodings=a,e.getEncodingHeight=r,e.getBarcodePadding=o,e.calculateEncodingAttributes=i,e.getTotalWidthOfEncodings=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(27),o=n(26),i=n(33),u=n(37),a=n(42),f=n(44),c=n(43),s=n(34);e.default={CODE39:r.CODE39,CODE128:o.CODE128,CODE128A:o.CODE128A,CODE128B:o.CODE128B,CODE128C:o.CODE128C,EAN13:i.EAN13,EAN8:i.EAN8,EAN5:i.EAN5,EAN2:i.EAN2,UPC:i.UPC,UPCE:i.UPCE,ITF14:u.ITF14,ITF:u.ITF,MSI:a.MSI,MSI10:a.MSI10,MSI11:a.MSI11,MSI1010:a.MSI1010,MSI1110:a.MSI1110,pharmacode:f.pharmacode,codabar:c.codabar,GenericBarcode:s.GenericBarcode}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e){r(this,t),this.api=e}return o(t,[{key:"handleCatch",value:function(t){if("InvalidInputException"!==t.name)throw t;if(this.api._options.valid===this.api._defaults.valid)throw t.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(t){try{var e=t.apply(void 0,arguments);return this.api._options.valid(!0),e}catch(t){return this.handleCatch(t),this.api}}}]),t}();e.default=i},function(t,e,n){"use strict";function r(t){return t.marginTop=t.marginTop||t.margin,t.marginBottom=t.marginBottom||t.margin,t.marginRight=t.marginRight||t.margin,t.marginLeft=t.marginLeft||t.margin,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){if("string"==typeof t)return i(t);if(Array.isArray(t)){for(var e=[],n=0;n<t.length;n++)e.push(o(t[n]));return e}if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLImageElement)return u(t);if(t&&"svg"===t.nodeName||"undefined"!=typeof SVGElement&&t instanceof SVGElement)return{element:t,options:(0,c.default)(t),renderer:l.default.SVGRenderer};if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement)return{element:t,options:(0,c.default)(t),renderer:l.default.CanvasRenderer};if(t&&t.getContext)return{element:t,renderer:l.default.CanvasRenderer};if(t&&"object"===(void 0===t?"undefined":a(t))&&!t.nodeName)return{element:t,renderer:l.default.ObjectRenderer};throw new p.InvalidElementException}function i(t){var e=document.querySelectorAll(t);if(0!==e.length){for(var n=[],r=0;r<e.length;r++)n.push(o(e[r]));return n}}function u(t){var e=document.createElement("canvas");return{element:e,options:(0,c.default)(t),renderer:l.default.CanvasRenderer,afterRender:function(){t.setAttribute("src",e.toDataURL())}}}Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f=n(45),c=r(f),s=n(47),l=r(s),p=n(8);e.default=o},function(t,e,n){"use strict";function r(t){function e(t){if(Array.isArray(t))for(var r=0;r<t.length;r++)e(t[r]);else t.text=t.text||"",t.data=t.data||"",n.push(t)}var n=[];return e(t),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){t=""+t;var r=new e(t,n);if(!r.valid())throw new E.InvalidInputException(r.constructor.name,t);var o=r.encode();o=(0,p.default)(o);for(var i=0;i<o.length;i++)o[i].options=(0,s.default)(n,o[i].options);return o}function i(){return f.default.CODE128?"CODE128":Object.keys(f.default)[0]}function u(t,e,n){e=(0,p.default)(e);for(var r=0;r<e.length;r++)e[r].options=(0,s.default)(n,e[r].options),(0,h.default)(e[r].options);(0,h.default)(n),new(0,t.renderer)(t.element,e,n).render(),t.afterRender&&t.afterRender()}var a=n(15),f=r(a),c=n(5),s=r(c),l=n(19),p=r(l),d=n(17),h=r(d),y=n(18),b=r(y),_=n(9),v=r(_),g=n(16),O=r(g),E=n(8),w=n(10),m=r(w),j=function(){},x=function(t,e,n){var r=new j;if(void 0===t)throw Error("No element to render on was provided.");return r._renderProperties=(0,b.default)(t),r._encodings=[],r._options=m.default,r._errorHandler=new O.default(r),void 0!==e&&(n=n||{},n.format||(n.format=i()),r.options(n)[n.format](e,n).render()),r};x.getModule=function(t){return f.default[t]};for(var P in f.default)f.default.hasOwnProperty(P)&&function(t,e){j.prototype[e]=j.prototype[e.toUpperCase()]=j.prototype[e.toLowerCase()]=function(n,r){var i=this;return i._errorHandler.wrapBarcodeCall(function(){r.text=void 0===r.text?void 0:""+r.text;var u=(0,s.default)(i._options,r);u=(0,v.default)(u);var a=t[e],f=o(n,a,u);return i._encodings.push(f),i})}}(f.default,P);j.prototype.options=function(t){return this._options=(0,s.default)(this._options,t),this},j.prototype.blank=function(t){var e=new Array(t+1).join("0");return this._encodings.push({data:e}),this},j.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var t;for(var e in this._renderProperties){t=this._renderProperties[e];var n=(0,s.default)(this._options,t.options);"auto"==n.format&&(n.format=i()),this._errorHandler.wrapBarcodeCall(function(){var e=n.value,r=f.default[n.format.toUpperCase()],i=o(e,r,n);u(t,i,n)})}}},j.prototype.render=function(){if(!this._renderProperties)throw new E.NoElementException;if(Array.isArray(this._renderProperties))for(var t=0;t<this._renderProperties.length;t++)u(this._renderProperties[t],this._encodings,this._options);else u(this._renderProperties,this._encodings,this._options);return this},j.prototype._defaults=m.default,"undefined"!=typeof window&&(window.JsBarcode=x),"undefined"!=typeof jQuery&&(jQuery.fn.JsBarcode=function(t,e){var n=[];return jQuery(this).each(function(){n.push(this)}),x(n,t,e)}),t.exports=x},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(6),f=function(t){return t&&t.__esModule?t:{default:t}}(a),c=n(1),s=function(t){function e(t,n){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c.A_START_CHAR+t,n))}return i(e,t),u(e,[{key:"valid",value:function(){return new RegExp("^"+c.A_CHARS+"+$").test(this.data)}}]),e}(f.default);e.default=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(6),f=function(t){return t&&t.__esModule?t:{default:t}}(a),c=n(1),s=function(t){function e(t,n){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c.B_START_CHAR+t,n))}return i(e,t),u(e,[{key:"valid",value:function(){return new RegExp("^"+c.B_CHARS+"+$").test(this.data)}}]),e}(f.default);e.default=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(6),f=function(t){return t&&t.__esModule?t:{default:t}}(a),c=n(1),s=function(t){function e(t,n){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,c.C_START_CHAR+t,n))}return i(e,t),u(e,[{key:"valid",value:function(){return new RegExp("^"+c.C_CHARS+"+$").test(this.data)}}]),e}(f.default);e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=n(6),f=r(a),c=n(25),s=r(c),l=function(t){function e(t,n){if(o(this,e),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,(0,s.default)(t),n));else var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i(r)}return u(e,t),e}(f.default);e.default=l},function(t,e,n){"use strict";function r(t,e){var n=e?i.A_CHARS:i.B_CHARS,u=t.match(new RegExp("^("+n+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(u)return u[1]+String.fromCharCode(204)+o(t.substring(u[1].length));var a=t.match(new RegExp("^"+n+"+"))[0];return a.length===t.length?t:a+String.fromCharCode(e?205:206)+r(t.substring(a.length),!e)}function o(t){var e=f(t),n=e.length;if(n===t.length)return t;t=t.substring(n);var o=u(t)>=a(t);return e+String.fromCharCode(o?206:205)+r(t,o)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),u=function(t){return t.match(new RegExp("^"+i.A_CHARS+"*"))[0].length},a=function(t){return t.match(new RegExp("^"+i.B_CHARS+"*"))[0].length},f=function(t){return t.match(new RegExp("^"+i.C_CHARS+"*"))[0]};e.default=function(t){var e=void 0;if(f(t).length>=2)e=i.C_START_CHAR+o(t);else{var n=u(t)>a(t);e=(n?i.A_START_CHAR:i.B_START_CHAR)+r(t,n)}return e.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(t,e){return String.fromCharCode(203)+e})}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.CODE128C=e.CODE128B=e.CODE128A=e.CODE128=void 0;var o=n(24),i=r(o),u=n(21),a=r(u),f=n(22),c=r(f),s=n(23),l=r(s);e.CODE128=i.default,e.CODE128A=a.default,e.CODE128B=c.default,e.CODE128C=l.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){return a(c(t))}function a(t){return b[t].toString(2)}function f(t){return y[t]}function c(t){return y.indexOf(t)}function s(t){for(var e=0,n=0;n<t.length;n++)e+=c(t[n]);return e%=43}Object.defineProperty(e,"__esModule",{value:!0}),e.CODE39=void 0;var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),p=n(0),d=function(t){return t&&t.__esModule?t:{default:t}}(p),h=function(t){function e(t,n){return r(this,e),t=t.toUpperCase(),n.mod43&&(t+=f(s(t))),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return i(e,t),l(e,[{key:"encode",value:function(){for(var t=u("*"),e=0;e<this.data.length;e++)t+=u(this.data[e])+"0";return t+=u("*"),{data:t,text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),e}(d.default),y=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],b=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];e.CODE39=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},f=n(2),c=n(11),s=function(t){return t&&t.__esModule?t:{default:t}}(c),l=function(t){return(10-t.substr(0,12).split("").map(function(t){return+t}).reduce(function(t,e,n){return n%2?t+3*e:t+e},0)%10)%10},p=function(t){function e(t,n){r(this,e),-1!==t.search(/^[0-9]{12}$/)&&(t+=l(t));var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.lastChar=n.lastChar,i}return i(e,t),u(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===l(this.data)}},{key:"leftText",value:function(){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var t=this.data.substr(1,6),n=f.EAN13_STRUCTURE[this.data[0]];return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,n)}},{key:"rightText",value:function(){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var t=this.data.substr(7,6);return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRRRR")}},{key:"encodeGuarded",value:function(){var t=a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(t.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(t.push({data:"00"}),t.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),t}}]),e}(s.default);e.default=p},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=n(2),c=n(3),s=r(c),l=n(0),p=r(l),d=function(t){function e(t,n){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return u(e,t),a(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var t=f.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,s.default)(this.data,t,"01"),text:this.text}}}]),e}(p.default);e.default=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=n(2),c=n(3),s=r(c),l=n(0),p=r(l),d=function(t){return t.split("").map(function(t){return+t}).reduce(function(t,e,n){return n%2?t+9*e:t+3*e},0)%10},h=function(t){function e(t,n){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return u(e,t),a(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var t=f.EAN5_STRUCTURE[d(this.data)];return{data:"1011"+(0,s.default)(this.data,t,"01"),text:this.text}}}]),e}(p.default);e.default=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},f=n(11),c=function(t){return t&&t.__esModule?t:{default:t}}(f),s=function(t){return(10-t.substr(0,7).split("").map(function(t){return+t}).reduce(function(t,e,n){return n%2?t+e:t+3*e},0)%10)%10},l=function(t){function e(t,n){return r(this,e),-1!==t.search(/^[0-9]{7}$/)&&(t+=s(t)),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return i(e,t),u(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===s(this.data)}},{key:"leftText",value:function(){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var t=this.data.substr(0,4);return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,"LLLL")}},{key:"rightText",value:function(){return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var t=this.data.substr(4,4);return a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRR")}}]),e}(c.default);e.default=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){for(var n=parseInt(t[t.length-1]),r=h[n],o="",i=0,u=0;u<r.length;u++){var a=r[u];o+="X"===a?t[i++]:a}return""+(o=""+e+o)+(0,d.checksum)(o)}Object.defineProperty(e,"__esModule",{value:!0});var f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(3),s=r(c),l=n(0),p=r(l),d=n(12),h=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],y=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],b=function(t){function e(t,n){o(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));if(r.isValid=!1,-1!==t.search(/^[0-9]{6}$/))r.middleDigits=t,r.upcA=a(t,"0"),r.text=n.text||""+r.upcA[0]+t+r.upcA[r.upcA.length-1],r.isValid=!0;else{if(-1===t.search(/^[01][0-9]{7}$/))return i(r);if(r.middleDigits=t.substring(1,t.length-1),r.upcA=a(r.middleDigits,t[0]),r.upcA[r.upcA.length-1]!==t[t.length-1])return i(r);r.isValid=!0}return r.displayValue=n.displayValue,n.fontSize>10*n.width?r.fontSize=10*n.width:r.fontSize=n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return u(e,t),f(e,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var t="";return t+="101",t+=this.encodeMiddleDigits(),t+="010101",{data:t,text:this.text}}},{key:"guardedEncoding",value:function(){var t=[];return this.displayValue&&t.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),t.push({data:"101",options:{height:this.guardHeight}}),t.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),t.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&t.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),t}},{key:"encodeMiddleDigits",value:function(){var t=this.upcA[0],e=this.upcA[this.upcA.length-1],n=y[parseInt(e)][parseInt(t)];return(0,s.default)(this.middleDigits,n)}}]),e}(p.default);e.default=b},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.UPCE=e.UPC=e.EAN2=e.EAN5=e.EAN8=e.EAN13=void 0;var o=n(28),i=r(o),u=n(31),a=r(u),f=n(30),c=r(f),s=n(29),l=r(s),p=n(12),d=r(p),h=n(32),y=r(h);e.EAN13=i.default,e.EAN8=a.default,e.EAN5=c.default,e.EAN2=l.default,e.UPC=d.default,e.UPCE=y.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.GenericBarcode=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),f=function(t){return t&&t.__esModule?t:{default:t}}(a),c=function(t){function e(t,n){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return i(e,t),u(e,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),e}(f.default);e.GenericBarcode=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(13),f=function(t){return t&&t.__esModule?t:{default:t}}(a),c=function(t){var e=t.substr(0,13).split("").map(function(t){return parseInt(t,10)}).reduce(function(t,e,n){return t+e*(3-n%2*2)},0);return 10*Math.ceil(e/10)-e},s=function(t){function e(t,n){return r(this,e),-1!==t.search(/^[0-9]{13}$/)&&(t+=c(t)),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return i(e,t),u(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===c(this.data)}}]),e}(f.default);e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.START_BIN="1010",e.END_BIN="11101",e.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ITF14=e.ITF=void 0;var o=n(13),i=r(o),u=n(35),a=r(u);e.ITF=i.default,e.ITF14=a.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(4),a=function(t){return t&&t.__esModule?t:{default:t}}(u),f=n(7),c=function(t){function e(t,n){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,f.mod10)(t),n))}return i(e,t),e}(a.default);e.default=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(4),a=function(t){return t&&t.__esModule?t:{default:t}}(u),f=n(7),c=function(t){function e(t,n){return r(this,e),t+=(0,f.mod10)(t),t+=(0,f.mod10)(t),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return i(e,t),e}(a.default);e.default=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(4),a=function(t){return t&&t.__esModule?t:{default:t}}(u),f=n(7),c=function(t){function e(t,n){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,f.mod11)(t),n))}return i(e,t),e}(a.default);e.default=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=n(4),a=function(t){return t&&t.__esModule?t:{default:t}}(u),f=n(7),c=function(t){function e(t,n){return r(this,e),t+=(0,f.mod11)(t),t+=(0,f.mod10)(t),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return i(e,t),e}(a.default);e.default=c},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.MSI1110=e.MSI1010=e.MSI11=e.MSI10=e.MSI=void 0;var o=n(4),i=r(o),u=n(38),a=r(u),f=n(40),c=r(f),s=n(39),l=r(s),p=n(41),d=r(p);e.MSI=i.default,e.MSI10=a.default,e.MSI11=c.default,e.MSI1010=l.default,e.MSI1110=d.default},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.codabar=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),f=function(t){return t&&t.__esModule?t:{default:t}}(a),c=function(t){function e(t,n){r(this,e),0===t.search(/^[0-9\-\$\:\.\+\/]+$/)&&(t="A"+t+"A");var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.toUpperCase(),n));return i.text=i.options.text||i.text.replace(/[A-D]/g,""),i}return i(e,t),u(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var t=[],e=this.getEncodings(),n=0;n<this.data.length;n++)t.push(e[this.data.charAt(n)]),n!==this.data.length-1&&t.push("0");return{text:this.text,data:t.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"101100110011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),e}(f.default);e.codabar=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.pharmacode=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),f=function(t){return t&&t.__esModule?t:{default:t}}(a),c=function(t){function e(t,n){r(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.number=parseInt(t,10),i}return i(e,t),u(e,[{key:"encode",value:function(){for(var t=this.number,e="";!isNaN(t)&&0!=t;)t%2==0?(e="11100"+e,t=(t-2)/2):(e="100"+e,t=(t-1)/2);return e=e.slice(0,-2),{data:e,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),e}(f.default);e.pharmacode=c},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){var e={};for(var n in f.default)f.default.hasOwnProperty(n)&&(t.hasAttribute("jsbarcode-"+n.toLowerCase())&&(e[n]=t.getAttribute("jsbarcode-"+n.toLowerCase())),t.hasAttribute("data-"+n.toLowerCase())&&(e[n]=t.getAttribute("data-"+n.toLowerCase())));return e.value=t.getAttribute("jsbarcode-value")||t.getAttribute("data-value"),e=(0,u.default)(e)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),u=r(i),a=n(10),f=r(a);e.default=o},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(5),u=function(t){return t&&t.__esModule?t:{default:t}}(i),a=n(14),f=function(){function t(e,n,o){r(this,t),this.canvas=e,this.encodings=n,this.options=o}return o(t,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var e=(0,u.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(e,this.encodings[t]),this.drawCanvasText(e,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,a.calculateEncodingAttributes)(this.encodings,this.options,t);var e=(0,a.getTotalWidthOfEncodings)(this.encodings),n=(0,a.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=e+this.options.marginLeft+this.options.marginRight,this.canvas.height=n,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,e){var n,r=this.canvas.getContext("2d"),o=e.data;n="top"==t.textPosition?t.marginTop+t.fontSize+t.textMargin:t.marginTop,r.fillStyle=t.lineColor;for(var i=0;i<o.length;i++){var u=i*t.width+e.barcodePadding;"1"===o[i]?r.fillRect(u,n,t.width,t.height):o[i]&&r.fillRect(u,n,t.width,t.height*o[i])}}},{key:"drawCanvasText",value:function(t,e){var n=this.canvas.getContext("2d"),r=t.fontOptions+" "+t.fontSize+"px "+t.font;if(t.displayValue){var o,i;i="top"==t.textPosition?t.marginTop+t.fontSize-t.textMargin:t.height+t.textMargin+t.marginTop+t.fontSize,n.font=r,"left"==t.textAlign||e.barcodePadding>0?(o=0,n.textAlign="left"):"right"==t.textAlign?(o=e.width-1,n.textAlign="right"):(o=e.width/2,n.textAlign="center"),n.fillText(e.text,o,i)}}},{key:"moveCanvasDrawing",value:function(t){this.canvas.getContext("2d").translate(t.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),t}();e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(46),i=r(o),u=n(49),a=r(u),f=n(48),c=r(f);e.default={CanvasRenderer:i.default,SVGRenderer:a.default,ObjectRenderer:c.default}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,n,o){r(this,t),this.object=e,this.encodings=n,this.options=o}return o(t,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),t}();e.default=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(5),u=function(t){return t&&t.__esModule?t:{default:t}}(i),a=n(14),f="http://www.w3.org/2000/svg",c=function(){function t(e,n,o){r(this,t),this.svg=e,this.encodings=n,this.options=o,this.document=o.xmlDocument||document}return o(t,[{key:"render",value:function(){var t=this.options.marginLeft;this.prepareSVG();for(var e=0;e<this.encodings.length;e++){var n=this.encodings[e],r=(0,u.default)(this.options,n.options),o=this.createGroup(t,r.marginTop,this.svg);this.setGroupOptions(o,r),this.drawSvgBarcode(o,r,n),this.drawSVGText(o,r,n),t+=n.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,a.calculateEncodingAttributes)(this.encodings,this.options);var t=(0,a.getTotalWidthOfEncodings)(this.encodings),e=(0,a.getMaximumHeightOfEncodings)(this.encodings),n=t+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(n,e),this.options.background&&this.drawRect(0,0,n,e,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(t,e,n){var r,o=n.data;r="top"==e.textPosition?e.fontSize+e.textMargin:0;for(var i=0,u=0,a=0;a<o.length;a++)u=a*e.width+n.barcodePadding,"1"===o[a]?i++:i>0&&(this.drawRect(u-e.width*i,r,e.width*i,e.height,t),i=0);i>0&&this.drawRect(u-e.width*(i-1),r,e.width*i,e.height,t)}},{key:"drawSVGText",value:function(t,e,n){var r=this.document.createElementNS(f,"text");if(e.displayValue){var o,i;r.setAttribute("style","font:"+e.fontOptions+" "+e.fontSize+"px "+e.font),i="top"==e.textPosition?e.fontSize-e.textMargin:e.height+e.textMargin+e.fontSize,"left"==e.textAlign||n.barcodePadding>0?(o=0,r.setAttribute("text-anchor","start")):"right"==e.textAlign?(o=n.width-1,r.setAttribute("text-anchor","end")):(o=n.width/2,r.setAttribute("text-anchor","middle")),r.setAttribute("x",o),r.setAttribute("y",i),r.appendChild(this.document.createTextNode(n.text)),t.appendChild(r)}}},{key:"setSvgAttributes",value:function(t,e){var n=this.svg;n.setAttribute("width",t+"px"),n.setAttribute("height",e+"px"),n.setAttribute("x","0px"),n.setAttribute("y","0px"),n.setAttribute("viewBox","0 0 "+t+" "+e),n.setAttribute("xmlns",f),n.setAttribute("version","1.1"),n.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(t,e,n){var r=this.document.createElementNS(f,"g");return r.setAttribute("transform","translate("+t+", "+e+")"),n.appendChild(r),r}},{key:"setGroupOptions",value:function(t,e){t.setAttribute("style","fill:"+e.lineColor+";")}},{key:"drawRect",value:function(t,e,n,r,o){var i=this.document.createElementNS(f,"rect");return i.setAttribute("x",t),i.setAttribute("y",e),i.setAttribute("width",n),i.setAttribute("height",r),o.appendChild(i),i}}]),t}();e.default=c}]);
XA.component.video = function (i, e) { var n = {}; function t(i) { var e = i.width(); i.removeClass("video-small hide-controls"), e < 481 && e >= 321 ? i.addClass("video-small") : e < 321 && i.addClass("hide-controls") } function o(e, n) { var t = e.find("video"); if (t.length) { i.extend(n, { plugins: ["youtube", "flash", "silverlight"], silverlightName: "silverlightmediaelement.xap", classPrefix: "mejs-", success: function (e) { e.movieName = "Movie", i(e).on("ended", function () { n.fromPlaylist && i(n.playlist).trigger("change-video") }), i(e).closest(".component-content").find(".video-init").hide() }, stretching: "auto", pluginPath: "../other/" }), t.each(function (e) { var o = i(t[e]), a = this; if (o.attr("poster")) { var s = o.parent().find(".video-init"); o.add(s).on("click", function () { var i; n.success = (i = n.success, function () { try { arguments[0].load(), arguments[0].play() } catch (i) { console.warn("Error while loading video") } return i.apply(this, arguments) }), s.hide(), new MediaElementPlayer(a, n) }) } else new MediaElementPlayer(t[e], n) }) } } return n.initVideoFromPlaylist = function (e, n) { var t = i(e).data("properties"); return i.extend(t, { fromPlaylist: !0, playlist: n }), o(e, t) }, n.initInstance = function (e, n) { var a = i(e); o(a, n), t(a), i(window).resize(function () { t(a) }) }, n.init = function () { XA.component.hasOwnProperty("playlist") && XA.component.playlist.init(), i(".video.component:not(.initialized)").each(function () { var e = i(this).data("properties"); n.initInstance(this, e), i(this).addClass("initialized") }), i(e).on("mozfullscreenchange", function () { setTimeout(function () { i(window).resize() }, 200) }) }, n }(jQuery, document), XA.register("video", XA.component.video);

$(function () {
    var videos = $(".iframe-container");
    if (videos.length === 0) {
        return;
    }

    var $video = $('.iframe-container iframe');
    $video.attr("id" , "video");

    // Remove controls when unchecked 
    if(!($( ".iframe-container" ).hasClass( "controls" ))){
        if (( $("#video")[0].src.indexOf("?") < 0) && ($("#video")[0].src.indexOf("controls=0") < 0)) { 
            $("#video")[0].src = $("#video")[0].src + "?controls=0&rel=0&modestbranding=1";
        }
        else if (( $("#video")[0].src.indexOf("?") > 0) && ($("#video")[0].src.indexOf("controls=0") < 0)) { 
            $("#video")[0].src = $("#video")[0].src + "&controls=0$rel=0&modestbranding=1";
        }
    }

   // Add attributes: controls, autoplay,poster, loop, mute and playsinline. Skip autoplay when using poster
   var classList = $('.iframe-container').attr("class").split(/\s+/);
   //if Poster skip autoplay
    if (jQuery.inArray("poster", classList) != -1) {
        var index = classList.indexOf("autoplay");
        if (index > -1) {
            classList.splice(index, 1);
        }  
    }
    for (var i = 0; i < classList.length; i++) {
        if (classList[i] !== "poster" && classList[i] !== "iframe-container" ) {
            if (($("#video")[0].src.indexOf("?") < 0) && ($("#video")[0].src.indexOf(classList[i]+"=1") < 0 )) { 
                $("#video")[0].src = $("#video")[0].src + "?"+classList[i]+"=1";
            }
            else if (( $("#video")[0].src.indexOf("?") > 0 ) && ( $("#video")[0].src.indexOf(classList[i]+"=1") < 0 )) { 
                $("#video")[0].src = $("#video")[0].src + "&"+classList[i]+"=1";
            } 
        }
    }
   
    
    videos.on("click", function () {
        var elm = $(this);
        var embedCode = $video;
        elm.addClass("player").html(embedCode); 
        // autoplay onclick
        if($( ".iframe-container" ).hasClass( "autoplay" )){
            if (($("#video")[0].src.indexOf("?") < 0) && ($("#video")[0].src.indexOf("autoplay=1") < 0 )) { 
            $("#video")[0].src = $("#video")[0].src + "?autoplay=1";
            }
            else if (( $("#video")[0].src.indexOf("?") > 0 ) && ( $("#video")[0].src.indexOf("autoplay=1") < 0 )) { 
                $("#video")[0].src = $("#video")[0].src + "&autoplay=1";
            } 
        }
        $('iframe').on('afterChange', function () {
        videos.children('iframe').remove();
        });
    });
});

(function(){var t,e,n,r,a,i,o,l,u,s,c,h,p,f,g,v,d,m,y,C,T,w,$,D,S=[].slice,k=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};t=window.jQuery||window.Zepto||window.$,t.payment={},t.payment.fn={},t.fn.payment=function(){var e,n;return n=arguments[0],e=2<=arguments.length?S.call(arguments,1):[],t.payment.fn[n].apply(this,e)},a=/(\d{1,4})/g,t.payment.cards=r=[{type:"maestro",patterns:[5018,502,503,506,56,58,639,6220,67],format:a,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",patterns:[600],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",patterns:[5019],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"visa",patterns:[4],format:a,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",patterns:[62,88],format:a,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",patterns:[35],format:a,length:[16],cvcLength:[3],luhn:!0}],e=function(t){var e,n,a,i,o,l,u,s;for(t=(t+"").replace(/\D/g,""),i=0,l=r.length;i<l;i++)for(e=r[i],s=e.patterns,o=0,u=s.length;o<u;o++)if(a=s[o],n=a+"",t.substr(0,n.length)===n)return e},n=function(t){var e,n,a;for(n=0,a=r.length;n<a;n++)if(e=r[n],e.type===t)return e},p=function(t){var e,n,r,a,i,o;for(r=!0,a=0,n=(t+"").split("").reverse(),i=0,o=n.length;i<o;i++)e=n[i],e=parseInt(e,10),(r=!r)&&(e*=2),e>9&&(e-=9),a+=e;return a%10===0},h=function(t){var e;return null!=t.prop("selectionStart")&&t.prop("selectionStart")!==t.prop("selectionEnd")||!(null==("undefined"!=typeof document&&null!==document&&null!=(e=document.selection)?e.createRange:void 0)||!document.selection.createRange().text)},$=function(t,e){var n,r,a,i,o,l;try{r=e.prop("selectionStart")}catch(t){i=t,r=null}if(o=e.val(),e.val(t),null!==r&&e.is(":focus"))return r===o.length&&(r=t.length),o!==t&&(l=o.slice(r-1,+r+1||9e9),n=t.slice(r-1,+r+1||9e9),a=t[r],/\d/.test(a)&&l===""+a+" "&&n===" "+a&&(r+=1)),e.prop("selectionStart",r),e.prop("selectionEnd",r)},m=function(t){var e,n,r,a,i,o,l,u;for(null==t&&(t=""),r="０１２３４５６７８９",a="0123456789",o="",e=t.split(""),l=0,u=e.length;l<u;l++)n=e[l],i=r.indexOf(n),i>-1&&(n=a[i]),o+=n;return o},d=function(e){var n;return n=t(e.currentTarget),setTimeout(function(){var t;return t=n.val(),t=m(t),t=t.replace(/\D/g,""),$(t,n)})},g=function(e){var n;return n=t(e.currentTarget),setTimeout(function(){var e;return e=n.val(),e=m(e),e=t.payment.formatCardNumber(e),$(e,n)})},l=function(n){var r,a,i,o,l,u,s;if(i=String.fromCharCode(n.which),/^\d+$/.test(i)&&(r=t(n.currentTarget),s=r.val(),a=e(s+i),o=(s.replace(/\D/g,"")+i).length,u=16,a&&(u=a.length[a.length.length-1]),!(o>=u||null!=r.prop("selectionStart")&&r.prop("selectionStart")!==s.length)))return l=a&&"amex"===a.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,l.test(s)?(n.preventDefault(),setTimeout(function(){return r.val(s+" "+i)})):l.test(s+i)?(n.preventDefault(),setTimeout(function(){return r.val(s+i+" ")})):void 0},i=function(e){var n,r;if(n=t(e.currentTarget),r=n.val(),8===e.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===r.length))return/\d\s$/.test(r)?(e.preventDefault(),setTimeout(function(){return n.val(r.replace(/\d\s$/,""))})):/\s\d?$/.test(r)?(e.preventDefault(),setTimeout(function(){return n.val(r.replace(/\d$/,""))})):void 0},v=function(e){var n;return n=t(e.currentTarget),setTimeout(function(){var e;return e=n.val(),e=m(e),e=t.payment.formatExpiry(e),$(e,n)})},u=function(e){var n,r,a;if(r=String.fromCharCode(e.which),/^\d+$/.test(r))return n=t(e.currentTarget),a=n.val()+r,/^\d$/.test(a)&&"0"!==a&&"1"!==a?(e.preventDefault(),setTimeout(function(){return n.val("0"+a+" / ")})):/^\d\d$/.test(a)?(e.preventDefault(),setTimeout(function(){var t,e;return t=parseInt(a[0],10),e=parseInt(a[1],10),e>2&&0!==t?n.val("0"+t+" / "+e):n.val(""+a+" / ")})):void 0},s=function(e){var n,r,a;if(r=String.fromCharCode(e.which),/^\d+$/.test(r))return n=t(e.currentTarget),a=n.val(),/^\d\d$/.test(a)?n.val(""+a+" / "):void 0},c=function(e){var n,r,a;if(a=String.fromCharCode(e.which),"/"===a||" "===a)return n=t(e.currentTarget),r=n.val(),/^\d$/.test(r)&&"0"!==r?n.val("0"+r+" / "):void 0},o=function(e){var n,r;if(n=t(e.currentTarget),r=n.val(),8===e.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===r.length))return/\d\s\/\s$/.test(r)?(e.preventDefault(),setTimeout(function(){return n.val(r.replace(/\d\s\/\s$/,""))})):void 0},f=function(e){var n;return n=t(e.currentTarget),setTimeout(function(){var t;return t=n.val(),t=m(t),t=t.replace(/\D/g,"").slice(0,4),$(t,n)})},w=function(t){var e;return!(!t.metaKey&&!t.ctrlKey)||32!==t.which&&(0===t.which||(t.which<33||(e=String.fromCharCode(t.which),!!/[\d\s]/.test(e))))},C=function(n){var r,a,i,o;if(r=t(n.currentTarget),i=String.fromCharCode(n.which),/^\d+$/.test(i)&&!h(r))return o=(r.val()+i).replace(/\D/g,""),a=e(o),a?o.length<=a.length[a.length.length-1]:o.length<=16},T=function(e){var n,r,a;if(n=t(e.currentTarget),r=String.fromCharCode(e.which),/^\d+$/.test(r)&&!h(n))return a=n.val()+r,a=a.replace(/\D/g,""),!(a.length>6)&&void 0},y=function(e){var n,r,a;if(n=t(e.currentTarget),r=String.fromCharCode(e.which),/^\d+$/.test(r)&&!h(n))return a=n.val()+r,a.length<=4},D=function(e){var n,a,i,o,l;if(n=t(e.currentTarget),l=n.val(),o=t.payment.cardType(l)||"unknown",!n.hasClass(o))return a=function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)i=r[t],n.push(i.type);return n}(),n.removeClass("unknown"),n.removeClass(a.join(" ")),n.addClass(o),n.toggleClass("identified","unknown"!==o),n.trigger("payment.cardType",o)},t.payment.fn.formatCardCVC=function(){return this.on("keypress",w),this.on("keypress",y),this.on("paste",f),this.on("change",f),this.on("input",f),this},t.payment.fn.formatCardExpiry=function(){return this.on("keypress",w),this.on("keypress",T),this.on("keypress",u),this.on("keypress",c),this.on("keypress",s),this.on("keydown",o),this.on("change",v),this.on("input",v),this},t.payment.fn.formatCardNumber=function(){return this.on("keypress",w),this.on("keypress",C),this.on("keypress",l),this.on("keydown",i),this.on("keyup",D),this.on("paste",g),this.on("change",g),this.on("input",g),this.on("input",D),this},t.payment.fn.restrictNumeric=function(){return this.on("keypress",w),this.on("paste",d),this.on("change",d),this.on("input",d),this},t.payment.fn.cardExpiryVal=function(){return t.payment.cardExpiryVal(t(this).val())},t.payment.cardExpiryVal=function(t){var e,n,r,a;return a=t.split(/[\s\/]+/,2),e=a[0],r=a[1],2===(null!=r?r.length:void 0)&&/^\d+$/.test(r)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),r=n+r),e=parseInt(e,10),r=parseInt(r,10),{month:e,year:r}},t.payment.validateCardNumber=function(t){var n,r;return t=(t+"").replace(/\s+|-/g,""),!!/^\d+$/.test(t)&&(n=e(t),!!n&&(r=t.length,k.call(n.length,r)>=0&&(n.luhn===!1||p(t))))},t.payment.validateCardExpiry=function(e,n){var r,a,i;return"object"==typeof e&&"month"in e&&(i=e,e=i.month,n=i.year),!(!e||!n)&&(e=t.trim(e),n=t.trim(n),!!/^\d+$/.test(e)&&(!!/^\d+$/.test(n)&&(1<=e&&e<=12&&(2===n.length&&(n=n<70?"20"+n:"19"+n),4===n.length&&(a=new Date(n,e),r=new Date,a.setMonth(a.getMonth()-1),a.setMonth(a.getMonth()+1,1),a>r)))))},t.payment.validateCardCVC=function(e,r){var a,i;return e=t.trim(e),!!/^\d+$/.test(e)&&(a=n(r),null!=a?(i=e.length,k.call(a.cvcLength,i)>=0):e.length>=3&&e.length<=4)},t.payment.cardType=function(t){var n;return t?(null!=(n=e(t))?n.type:void 0)||null:null},t.payment.formatCardNumber=function(n){var r,a,i,o;return n=n.replace(/\D/g,""),(r=e(n))?(i=r.length[r.length.length-1],n=n.slice(0,i),r.format.global?null!=(o=n.match(r.format))?o.join(" "):void 0:(a=r.format.exec(n),null!=a?(a.shift(),a=t.grep(a,function(t){return t}),a.join(" ")):void 0)):n},t.payment.formatExpiry=function(t){var e,n,r,a;return(n=t.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(e=n[1]||"",r=n[2]||"",a=n[3]||"",a.length>0?r=" / ":" /"===r?(e=e.substring(0,1),r=""):2===e.length||r.length>0?r=" / ":1===e.length&&"0"!==e&&"1"!==e&&(e="0"+e,r=" / "),e+r+a):""}}).call(this);
//! MODIFIED TO INCLUDE FAMOUS FOOTWEAR CC AS CARD_TYPE

// Generated by CoffeeScript 1.10.0
(function() {
    var $,
        Range,
        Trie,
        indexOf =
            [].indexOf ||
            function(item) {
                for (var i = 0, l = this.length; i < l; i++) {
                    if (i in this && this[i] === item) return i;
                }
                return -1;
            };

    Trie = (function() {
        function Trie() {
            this.trie = {};
        }

        Trie.prototype.push = function(value) {
            var char, i, j, len, obj, ref, results;
            value = value.toString();
            obj = this.trie;
            ref = value.split("");
            results = [];
            for (i = j = 0, len = ref.length; j < len; i = ++j) {
                char = ref[i];
                if (obj[char] == null) {
                    if (i === value.length - 1) {
                        obj[char] = null;
                    } else {
                        obj[char] = {};
                    }
                }
                results.push((obj = obj[char]));
            }
            return results;
        };

        Trie.prototype.find = function(value) {
            var char, i, j, len, obj, ref;
            value = value.toString();
            obj = this.trie;
            ref = value.split("");
            for (i = j = 0, len = ref.length; j < len; i = ++j) {
                char = ref[i];
                if (obj.hasOwnProperty(char)) {
                    if (obj[char] === null) {
                        return true;
                    }
                } else {
                    return false;
                }
                obj = obj[char];
            }
        };

        return Trie;
    })();

    Range = (function() {
        function Range(trie1) {
            this.trie = trie1;
            if (this.trie.constructor !== Trie) {
                throw Error("Range constructor requires a Trie parameter");
            }
        }

        Range.rangeWithString = function(ranges) {
            var j, k, len, n, r, range, ref, ref1, trie;
            if (typeof ranges !== "string") {
                throw Error("rangeWithString requires a string parameter");
            }
            ranges = ranges.replace(/ /g, "");
            ranges = ranges.split(",");
            trie = new Trie();
            for (j = 0, len = ranges.length; j < len; j++) {
                range = ranges[j];
                if ((r = range.match(/^(\d+)-(\d+)$/))) {
                    for (
                        n = k = ref = r[1], ref1 = r[2];
                        ref <= ref1 ? k <= ref1 : k >= ref1;
                        n = ref <= ref1 ? ++k : --k
                    ) {
                        trie.push(n);
                    }
                } else if (range.match(/^\d+$/)) {
                    trie.push(range);
                } else {
                    throw Error("Invalid range '" + r + "'");
                }
            }
            return new Range(trie);
        };

        Range.prototype.match = function(number) {
            return this.trie.find(number);
        };

        return Range;
    })();

    /*
    jQuery Credit Card Validator 1.1
    
    Copyright 2012-2015 Pawel Decowski
    
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software
    is furnished to do so, subject to the following conditions:
    
    The above copyright notice and this permission notice shall be included
    in all copies or substantial portions of the Software.
    
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
    THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.
     */

    $ = jQuery;

    $.fn.validateCreditCard = function(callback, options) {
        var bind,
            card,
            card_type,
            card_types,
            get_card_type,
            is_valid_length,
            is_valid_luhn,
            j,
            len,
            normalize,
            ref,
            validate,
            validate_number;
            card_types = [
            {
                name: "famousfootwear_creditcard",
                range: "544267",
                valid_length: [16]
            },
            {
                name: "amex",
                range: "34,37",
                valid_length: [15]
            },
            {
                name: "diners_club_carte_blanche",
                range: "300-305",
                valid_length: [14]
            },
            {
                name: "diners_club_international",
                range: "36",
                valid_length: [14]
            },
            {
                name: "jcb",
                range: "3528-3589",
                valid_length: [16]
            },
            {
                name: "laser",
                range: "6304, 6706, 6709, 6771",
                valid_length: [16, 17, 18, 19]
            },
            {
                name: "visa_electron",
                range: "4026, 417500, 4508, 4844, 4913, 4917",
                valid_length: [16]
            },
            {
                name: "visa",
                range: "4",
                valid_length: [13, 14, 15, 16, 17, 18, 19]
            },
            {
                name: "mastercard",
                range: "51-55,2221-2720",
                valid_length: [16]
            },
            {
                name: "discover",
                range: "6011, 622126-622925, 644-649, 65",
                valid_length: [16]
            },
            {
                name: "dankort",
                range: "5019",
                valid_length: [16]
            },
            {
                name: "maestro",
                range: "50, 56-69",
                valid_length: [12, 13, 14, 15, 16, 17, 18, 19]
            },
            {
                name: "uatp",
                range: "1",
                valid_length: [15]
            },
            {
                name: "union_pay",
                range: "62",
                valid_length: [16]
            },
        ];
        bind = false;
        if (callback) {
            if (typeof callback === "object") {
                options = callback;
                bind = false;
                callback = null;
            } else if (typeof callback === "function") {
                bind = true;
            }
        }
        if (options == null) {
            options = {};
        }
        if (options.accept == null) {
            options.accept = (function() {
                var j, len, results;
                results = [];
                for (j = 0, len = card_types.length; j < len; j++) {
                    card = card_types[j];
                    results.push(card.name);
                }
                return results;
            })();
        }
        ref = options.accept;
        for (j = 0, len = ref.length; j < len; j++) {
            card_type = ref[j];
            if (
                indexOf.call(
                    (function() {
                        var k, len1, results;
                        results = [];
                        for (k = 0, len1 = card_types.length; k < len1; k++) {
                            card = card_types[k];
                            results.push(card.name);
                        }
                        return results;
                    })(),
                    card_type
                ) < 0
            ) {
                throw Error(
                    "Credit card type '" + card_type + "' is not supported"
                );
            }
        }
        get_card_type = function(number) {
            var k, len1, r, ref1;
            ref1 = (function() {
                var l, len1, ref1, results;
                results = [];
                for (l = 0, len1 = card_types.length; l < len1; l++) {
                    card = card_types[l];
                    if (
                        ((ref1 = card.name),
                        indexOf.call(options.accept, ref1) >= 0)
                    ) {
                        results.push(card);
                    }
                }
                return results;
            })();
            for (k = 0, len1 = ref1.length; k < len1; k++) {
                card_type = ref1[k];
                r = Range.rangeWithString(card_type.range);
                if (r.match(number)) {
                    return card_type;
                }
            }
            return null;
        };
        is_valid_luhn = function(number) {
            var digit, k, len1, n, ref1, sum;
            sum = 0;
            ref1 = number.split("").reverse();
            for (n = k = 0, len1 = ref1.length; k < len1; n = ++k) {
                digit = ref1[n];
                digit = +digit;
                if (n % 2) {
                    digit *= 2;
                    if (digit < 10) {
                        sum += digit;
                    } else {
                        sum += digit - 9;
                    }
                } else {
                    sum += digit;
                }
            }
            return sum % 10 === 0;
        };
        is_valid_length = function(number, card_type) {
            var ref1;
            return (
                (ref1 = number.length),
                indexOf.call(card_type.valid_length, ref1) >= 0
            );
        };
        validate_number = function(number) {
            var length_valid, luhn_valid;
            card_type = get_card_type(number);
            luhn_valid = false;
            length_valid = false;
            if (card_type != null) {
                luhn_valid = is_valid_luhn(number);
                length_valid = is_valid_length(number, card_type);
            }
            return {
                card_type: card_type,
                valid: luhn_valid && length_valid,
                luhn_valid: luhn_valid,
                length_valid: length_valid
            };
        };
        validate = (function(_this) {
            return function() {
                var number;
                number = normalize($(_this).val());
                return validate_number(number);
            };
        })(this);
        normalize = function(number) {
            return number.replace(/[ -]/g, "");
        };
        if (!bind) {
            return validate();
        }
        this.on(
            "input.jccv",
            (function(_this) {
                return function() {
                    $(_this).off("keyup.jccv");
                    return callback.call(_this, validate());
                };
            })(this)
        );
        this.on(
            "keyup.jccv",
            (function(_this) {
                return function() {
                    return callback.call(_this, validate());
                };
            })(this)
        );
        callback.call(this, validate());
        return this;
    };
}.call(this));

// -----------------------------------------------------------------------
// Copyright 2016 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------
$(document).ready(function () {
  CXAApplication.Initialize();
});

/**
 * Format the amount to a currency.
 *
 * @param {number} amount - amount to be formatted
 * @param {object} currencyInfo - object containing currency information
 * @returns {string} the formatted currency
 */
function formatCurrency(amount, currencyInfo) {
  var options = {
    precision: currencyInfo.precision || 2,
    decimalSeparator: currencyInfo.decimalSeparator || ',',
    groupSeparator: currencyInfo.groupSeparator || ' ',
    symbolPosition: typeof currencyInfo.symbolPosition === 'undefined' ? 3 : currencyInfo.symbolPosition
  };

  var currencyValue = amount.__ko_proto__ === ko.dependentObservable || amount.__ko_proto__ === ko.observable ? amount() : amount;

  var formatted = parseFloat(currencyValue, 10).toFixed(options.precision);

  var regex = new RegExp('^(\\d+)[^\\d](\\d{' + options.precision + '})$');
  formatted = formatted.replace(regex, '$1' + options.decimalSeparator + '$2');
  formatted = formatted.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1' + options.groupSeparator);

  if (currencyInfo.symbol && currencyInfo.symbol.length > 0) {
    // Currency Symbol Position - [0: $n] [1: n$] [2: $ n] [3: n $]
    switch (options.symbolPosition) {
    case 0:
      formatted = currencyInfo.symbol + formatted;
      break;
    case 1:
      formatted = formatted + currencyInfo.symbol;
      break;
    case 2:
      formatted = currencyInfo.symbol + ' ' + formatted;
      break;
    case 3:
    default:
      formatted = formatted + ' ' + currencyInfo.symbol;
      break;
    }
  }

  return formatted;
}

/**
 * Format the amount to a currency using CultureInfo code.
 *
 * @param {number} amount - amount to be formatted
 * @param {string} symbol - currency symbol
 * @param {number} symbolPosition - position of currency symbol
 * @param {string} cultureInfo - the CultureInfo code
 * @returns {string} the formatted currency
 */
function formatCurrencyUsingCultureInfo(amount, symbol, symbolPosition, cultureInfo) {
  var currencyInfo = { decimalSeparator: getSeparator(cultureInfo, 'decimal'), groupSeparator: getSeparator(cultureInfo, 'group'), symbol: symbol, symbolPosition: symbolPosition };
  return formatCurrency(amount, currencyInfo);
}

 /**
 * To validate the product ids parameter is valid before sending the request.
 *
 * @param {string[]} - an array of product ids
 * @returns {boolean} true if product id and catalog name are not empty, false otherwise
 */
function isValidProductIds(productIds) {
  return productIds.length > 0 && !productIds.some(function(x){ return isEmptyOrSpaces(x); }) && CATALOG_NAME !== undefined && !isEmptyOrSpaces(CATALOG_NAME);
}

/**
 * Get the separator using CultureInfo code.
 *
 * @param {string} cultureInfo - the CultureInfo code
 * @param {string} separatorType - the type of separator (decimal or group)
 * @returns {string} the separator
 */
function getSeparator(cultureInfo, separatorType) {
  const numberWithGroupAndDecimalSeparator = 1000.1;
  return Intl.NumberFormat(cultureInfo)
    .formatToParts(numberWithGroupAndDecimalSeparator)
    .find(function(part){
      return part.type === separatorType
    })
    .value;
}

if (!String.prototype.format) {
  String.prototype.format = function () {
    var args = arguments;
    return this.replace(/{(\d+)}/g, function (match, number) {
      return typeof args[number] !== 'undefined'
        ? args[number]
        : match
      ;
    });
  };
}

function getCurrentPageExtension() {
  var pageExtensiponWithQueryString = window.location.href.split('.').pop();
  if (pageExtensiponWithQueryString && pageExtensiponWithQueryString.length >= 4) {
    var pageExtension = pageExtensiponWithQueryString.substr(0, 4);
    return pageExtension;
  }
  return '';
}

function getCurrentTenantAndSiteName() {
  var currentTenantAndSite = { Tenant: '', Site: '' };
  var siteRootPath = $("input[name='_SiteRootPath'").val();
  var siteNodes = siteRootPath.split("/");

  currentTenantAndSite.Site = siteNodes[siteNodes.length - 1];
  currentTenantAndSite.Tenant = siteNodes[siteNodes.length - 2];
  return currentTenantAndSite;
}
!function(i){"use strict";"function"==typeof define&&define.amd?define(["jquery"],i):"undefined"!=typeof exports?module.exports=i(require("jquery")):i(jQuery)}(function(i){"use strict";var e=window.Slick||{};(e=function(){var e=0;return function(t,o){var s,n=this;n.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:i(t),appendDots:i(t),arrows:!0,asNavFor:null,prevArrow:'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',nextArrow:'<button class="slick-next" aria-label="Next" type="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(e,t){return i('<button type="button" />').text(t+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},n.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},i.extend(n,n.initials),n.activeBreakpoint=null,n.animType=null,n.animProp=null,n.breakpoints=[],n.breakpointSettings=[],n.cssTransitions=!1,n.focussed=!1,n.interrupted=!1,n.hidden="hidden",n.paused=!0,n.positionProp=null,n.respondTo=null,n.rowCount=1,n.shouldClick=!0,n.$slider=i(t),n.$slidesCache=null,n.transformType=null,n.transitionType=null,n.visibilityChange="visibilitychange",n.windowWidth=0,n.windowTimer=null,s=i(t).data("slick")||{},n.options=i.extend({},n.defaults,o,s),n.currentSlide=n.options.initialSlide,n.originalSettings=n.options,void 0!==document.mozHidden?(n.hidden="mozHidden",n.visibilityChange="mozvisibilitychange"):void 0!==document.webkitHidden&&(n.hidden="webkitHidden",n.visibilityChange="webkitvisibilitychange"),n.autoPlay=i.proxy(n.autoPlay,n),n.autoPlayClear=i.proxy(n.autoPlayClear,n),n.autoPlayIterator=i.proxy(n.autoPlayIterator,n),n.changeSlide=i.proxy(n.changeSlide,n),n.clickHandler=i.proxy(n.clickHandler,n),n.selectHandler=i.proxy(n.selectHandler,n),n.setPosition=i.proxy(n.setPosition,n),n.swipeHandler=i.proxy(n.swipeHandler,n),n.dragHandler=i.proxy(n.dragHandler,n),n.keyHandler=i.proxy(n.keyHandler,n),n.instanceUid=e++,n.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,n.registerBreakpoints(),n.init(!0)}}()).prototype.activateADA=function(){this.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},e.prototype.addSlide=e.prototype.slickAdd=function(e,t,o){var s=this;if("boolean"==typeof t)o=t,t=null;else if(t<0||t>=s.slideCount)return!1;s.unload(),"number"==typeof t?0===t&&0===s.$slides.length?i(e).appendTo(s.$slideTrack):o?i(e).insertBefore(s.$slides.eq(t)):i(e).insertAfter(s.$slides.eq(t)):!0===o?i(e).prependTo(s.$slideTrack):i(e).appendTo(s.$slideTrack),s.$slides=s.$slideTrack.children(this.options.slide),s.$slideTrack.children(this.options.slide).detach(),s.$slideTrack.append(s.$slides),s.$slides.each(function(e,t){i(t).attr("data-slick-index",e)}),s.$slidesCache=s.$slides,s.reinit()},e.prototype.animateHeight=function(){var i=this;if(1===i.options.slidesToShow&&!0===i.options.adaptiveHeight&&!1===i.options.vertical){var e=i.$slides.eq(i.currentSlide).outerHeight(!0);i.$list.animate({height:e},i.options.speed)}},e.prototype.animateSlide=function(e,t){var o={},s=this;s.animateHeight(),!0===s.options.rtl&&!1===s.options.vertical&&(e=-e),!1===s.transformsEnabled?!1===s.options.vertical?s.$slideTrack.animate({left:e},s.options.speed,s.options.easing,t):s.$slideTrack.animate({top:e},s.options.speed,s.options.easing,t):!1===s.cssTransitions?(!0===s.options.rtl&&(s.currentLeft=-s.currentLeft),i({animStart:s.currentLeft}).animate({animStart:e},{duration:s.options.speed,easing:s.options.easing,step:function(i){i=Math.ceil(i),!1===s.options.vertical?(o[s.animType]="translate("+i+"px, 0px)",s.$slideTrack.css(o)):(o[s.animType]="translate(0px,"+i+"px)",s.$slideTrack.css(o))},complete:function(){t&&t.call()}})):(s.applyTransition(),e=Math.ceil(e),!1===s.options.vertical?o[s.animType]="translate3d("+e+"px, 0px, 0px)":o[s.animType]="translate3d(0px,"+e+"px, 0px)",s.$slideTrack.css(o),t&&setTimeout(function(){s.disableTransition(),t.call()},s.options.speed))},e.prototype.getNavTarget=function(){var e=this,t=e.options.asNavFor;return t&&null!==t&&(t=i(t).not(e.$slider)),t},e.prototype.asNavFor=function(e){var t=this.getNavTarget();null!==t&&"object"==typeof t&&t.each(function(){var t=i(this).slick("getSlick");t.unslicked||t.slideHandler(e,!0)})},e.prototype.applyTransition=function(i){var e=this,t={};!1===e.options.fade?t[e.transitionType]=e.transformType+" "+e.options.speed+"ms "+e.options.cssEase:t[e.transitionType]="opacity "+e.options.speed+"ms "+e.options.cssEase,!1===e.options.fade?e.$slideTrack.css(t):e.$slides.eq(i).css(t)},e.prototype.autoPlay=function(){var i=this;i.autoPlayClear(),i.slideCount>i.options.slidesToShow&&(i.autoPlayTimer=setInterval(i.autoPlayIterator,i.options.autoplaySpeed))},e.prototype.autoPlayClear=function(){var i=this;i.autoPlayTimer&&clearInterval(i.autoPlayTimer)},e.prototype.autoPlayIterator=function(){var i=this,e=i.currentSlide+i.options.slidesToScroll;i.paused||i.interrupted||i.focussed||(!1===i.options.infinite&&(1===i.direction&&i.currentSlide+1===i.slideCount-1?i.direction=0:0===i.direction&&(e=i.currentSlide-i.options.slidesToScroll,i.currentSlide-1==0&&(i.direction=1))),i.slideHandler(e))},e.prototype.buildArrows=function(){var e=this;!0===e.options.arrows&&(e.$prevArrow=i(e.options.prevArrow).addClass("slick-arrow"),e.$nextArrow=i(e.options.nextArrow).addClass("slick-arrow"),e.slideCount>e.options.slidesToShow?(e.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.prependTo(e.options.appendArrows),e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.appendTo(e.options.appendArrows),!0!==e.options.infinite&&e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):e.$prevArrow.add(e.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},e.prototype.buildDots=function(){var e,t,o=this;if(!0===o.options.dots){for(o.$slider.addClass("slick-dotted"),t=i("<ul />").addClass(o.options.dotsClass),e=0;e<=o.getDotCount();e+=1)t.append(i("<li />").append(o.options.customPaging.call(this,o,e)));o.$dots=t.appendTo(o.options.appendDots),o.$dots.find("li").first().addClass("slick-active")}},e.prototype.buildOut=function(){var e=this;e.$slides=e.$slider.children(e.options.slide+":not(.slick-cloned)").addClass("slick-slide"),e.slideCount=e.$slides.length,e.$slides.each(function(e,t){i(t).attr("data-slick-index",e).data("originalStyling",i(t).attr("style")||"")}),e.$slider.addClass("slick-slider"),e.$slideTrack=0===e.slideCount?i('<div class="slick-track"/>').appendTo(e.$slider):e.$slides.wrapAll('<div class="slick-track"/>').parent(),e.$list=e.$slideTrack.wrap('<div class="slick-list"/>').parent(),e.$slideTrack.css("opacity",0),!0!==e.options.centerMode&&!0!==e.options.swipeToSlide||(e.options.slidesToScroll=1),i("img[data-lazy]",e.$slider).not("[src]").addClass("slick-loading"),e.setupInfinite(),e.buildArrows(),e.buildDots(),e.updateDots(),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),!0===e.options.draggable&&e.$list.addClass("draggable")},e.prototype.buildRows=function(){var i,e,t,o,s,n,r,l=this;if(o=document.createDocumentFragment(),n=l.$slider.children(),l.options.rows>1){for(r=l.options.slidesPerRow*l.options.rows,s=Math.ceil(n.length/r),i=0;i<s;i++){var d=document.createElement("div");for(e=0;e<l.options.rows;e++){var a=document.createElement("div");for(t=0;t<l.options.slidesPerRow;t++){var c=i*r+(e*l.options.slidesPerRow+t);n.get(c)&&a.appendChild(n.get(c))}d.appendChild(a)}o.appendChild(d)}l.$slider.empty().append(o),l.$slider.children().children().children().css({width:100/l.options.slidesPerRow+"%",display:"inline-block"})}},e.prototype.checkResponsive=function(e,t){var o,s,n,r=this,l=!1,d=r.$slider.width(),a=window.innerWidth||i(window).width();if("window"===r.respondTo?n=a:"slider"===r.respondTo?n=d:"min"===r.respondTo&&(n=Math.min(a,d)),r.options.responsive&&r.options.responsive.length&&null!==r.options.responsive){s=null;for(o in r.breakpoints)r.breakpoints.hasOwnProperty(o)&&(!1===r.originalSettings.mobileFirst?n<r.breakpoints[o]&&(s=r.breakpoints[o]):n>r.breakpoints[o]&&(s=r.breakpoints[o]));null!==s?null!==r.activeBreakpoint?(s!==r.activeBreakpoint||t)&&(r.activeBreakpoint=s,"unslick"===r.breakpointSettings[s]?r.unslick(s):(r.options=i.extend({},r.originalSettings,r.breakpointSettings[s]),!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e)),l=s):(r.activeBreakpoint=s,"unslick"===r.breakpointSettings[s]?r.unslick(s):(r.options=i.extend({},r.originalSettings,r.breakpointSettings[s]),!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e)),l=s):null!==r.activeBreakpoint&&(r.activeBreakpoint=null,r.options=r.originalSettings,!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e),l=s),e||!1===l||r.$slider.trigger("breakpoint",[r,l])}},e.prototype.changeSlide=function(e,t){var o,s,n,r=this,l=i(e.currentTarget);switch(l.is("a")&&e.preventDefault(),l.is("li")||(l=l.closest("li")),n=r.slideCount%r.options.slidesToScroll!=0,o=n?0:(r.slideCount-r.currentSlide)%r.options.slidesToScroll,e.data.message){case"previous":s=0===o?r.options.slidesToScroll:r.options.slidesToShow-o,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide-s,!1,t);break;case"next":s=0===o?r.options.slidesToScroll:o,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide+s,!1,t);break;case"index":var d=0===e.data.index?0:e.data.index||l.index()*r.options.slidesToScroll;r.slideHandler(r.checkNavigable(d),!1,t),l.children().trigger("focus");break;default:return}},e.prototype.checkNavigable=function(i){var e,t;if(e=this.getNavigableIndexes(),t=0,i>e[e.length-1])i=e[e.length-1];else for(var o in e){if(i<e[o]){i=t;break}t=e[o]}return i},e.prototype.cleanUpEvents=function(){var e=this;e.options.dots&&null!==e.$dots&&(i("li",e.$dots).off("click.slick",e.changeSlide).off("mouseenter.slick",i.proxy(e.interrupt,e,!0)).off("mouseleave.slick",i.proxy(e.interrupt,e,!1)),!0===e.options.accessibility&&e.$dots.off("keydown.slick",e.keyHandler)),e.$slider.off("focus.slick blur.slick"),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow&&e.$prevArrow.off("click.slick",e.changeSlide),e.$nextArrow&&e.$nextArrow.off("click.slick",e.changeSlide),!0===e.options.accessibility&&(e.$prevArrow&&e.$prevArrow.off("keydown.slick",e.keyHandler),e.$nextArrow&&e.$nextArrow.off("keydown.slick",e.keyHandler))),e.$list.off("touchstart.slick mousedown.slick",e.swipeHandler),e.$list.off("touchmove.slick mousemove.slick",e.swipeHandler),e.$list.off("touchend.slick mouseup.slick",e.swipeHandler),e.$list.off("touchcancel.slick mouseleave.slick",e.swipeHandler),e.$list.off("click.slick",e.clickHandler),i(document).off(e.visibilityChange,e.visibility),e.cleanUpSlideEvents(),!0===e.options.accessibility&&e.$list.off("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().off("click.slick",e.selectHandler),i(window).off("orientationchange.slick.slick-"+e.instanceUid,e.orientationChange),i(window).off("resize.slick.slick-"+e.instanceUid,e.resize),i("[draggable!=true]",e.$slideTrack).off("dragstart",e.preventDefault),i(window).off("load.slick.slick-"+e.instanceUid,e.setPosition)},e.prototype.cleanUpSlideEvents=function(){var e=this;e.$list.off("mouseenter.slick",i.proxy(e.interrupt,e,!0)),e.$list.off("mouseleave.slick",i.proxy(e.interrupt,e,!1))},e.prototype.cleanUpRows=function(){var i,e=this;e.options.rows>1&&((i=e.$slides.children().children()).removeAttr("style"),e.$slider.empty().append(i))},e.prototype.clickHandler=function(i){!1===this.shouldClick&&(i.stopImmediatePropagation(),i.stopPropagation(),i.preventDefault())},e.prototype.destroy=function(e){var t=this;t.autoPlayClear(),t.touchObject={},t.cleanUpEvents(),i(".slick-cloned",t.$slider).detach(),t.$dots&&t.$dots.remove(),t.$prevArrow&&t.$prevArrow.length&&(t.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove()),t.$nextArrow&&t.$nextArrow.length&&(t.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove()),t.$slides&&(t.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){i(this).attr("style",i(this).data("originalStyling"))}),t.$slideTrack.children(this.options.slide).detach(),t.$slideTrack.detach(),t.$list.detach(),t.$slider.append(t.$slides)),t.cleanUpRows(),t.$slider.removeClass("slick-slider"),t.$slider.removeClass("slick-initialized"),t.$slider.removeClass("slick-dotted"),t.unslicked=!0,e||t.$slider.trigger("destroy",[t])},e.prototype.disableTransition=function(i){var e=this,t={};t[e.transitionType]="",!1===e.options.fade?e.$slideTrack.css(t):e.$slides.eq(i).css(t)},e.prototype.fadeSlide=function(i,e){var t=this;!1===t.cssTransitions?(t.$slides.eq(i).css({zIndex:t.options.zIndex}),t.$slides.eq(i).animate({opacity:1},t.options.speed,t.options.easing,e)):(t.applyTransition(i),t.$slides.eq(i).css({opacity:1,zIndex:t.options.zIndex}),e&&setTimeout(function(){t.disableTransition(i),e.call()},t.options.speed))},e.prototype.fadeSlideOut=function(i){var e=this;!1===e.cssTransitions?e.$slides.eq(i).animate({opacity:0,zIndex:e.options.zIndex-2},e.options.speed,e.options.easing):(e.applyTransition(i),e.$slides.eq(i).css({opacity:0,zIndex:e.options.zIndex-2}))},e.prototype.filterSlides=e.prototype.slickFilter=function(i){var e=this;null!==i&&(e.$slidesCache=e.$slides,e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.filter(i).appendTo(e.$slideTrack),e.reinit())},e.prototype.focusHandler=function(){var e=this;e.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(t){t.stopImmediatePropagation();var o=i(this);setTimeout(function(){e.options.pauseOnFocus&&(e.focussed=o.is(":focus"),e.autoPlay())},0)})},e.prototype.getCurrent=e.prototype.slickCurrentSlide=function(){return this.currentSlide},e.prototype.getDotCount=function(){var i=this,e=0,t=0,o=0;if(!0===i.options.infinite)if(i.slideCount<=i.options.slidesToShow)++o;else for(;e<i.slideCount;)++o,e=t+i.options.slidesToScroll,t+=i.options.slidesToScroll<=i.options.slidesToShow?i.options.slidesToScroll:i.options.slidesToShow;else if(!0===i.options.centerMode)o=i.slideCount;else if(i.options.asNavFor)for(;e<i.slideCount;)++o,e=t+i.options.slidesToScroll,t+=i.options.slidesToScroll<=i.options.slidesToShow?i.options.slidesToScroll:i.options.slidesToShow;else o=1+Math.ceil((i.slideCount-i.options.slidesToShow)/i.options.slidesToScroll);return o-1},e.prototype.getLeft=function(i){var e,t,o,s,n=this,r=0;return n.slideOffset=0,t=n.$slides.first().outerHeight(!0),!0===n.options.infinite?(n.slideCount>n.options.slidesToShow&&(n.slideOffset=n.slideWidth*n.options.slidesToShow*-1,s=-1,!0===n.options.vertical&&!0===n.options.centerMode&&(2===n.options.slidesToShow?s=-1.5:1===n.options.slidesToShow&&(s=-2)),r=t*n.options.slidesToShow*s),n.slideCount%n.options.slidesToScroll!=0&&i+n.options.slidesToScroll>n.slideCount&&n.slideCount>n.options.slidesToShow&&(i>n.slideCount?(n.slideOffset=(n.options.slidesToShow-(i-n.slideCount))*n.slideWidth*-1,r=(n.options.slidesToShow-(i-n.slideCount))*t*-1):(n.slideOffset=n.slideCount%n.options.slidesToScroll*n.slideWidth*-1,r=n.slideCount%n.options.slidesToScroll*t*-1))):i+n.options.slidesToShow>n.slideCount&&(n.slideOffset=(i+n.options.slidesToShow-n.slideCount)*n.slideWidth,r=(i+n.options.slidesToShow-n.slideCount)*t),n.slideCount<=n.options.slidesToShow&&(n.slideOffset=0,r=0),!0===n.options.centerMode&&n.slideCount<=n.options.slidesToShow?n.slideOffset=n.slideWidth*Math.floor(n.options.slidesToShow)/2-n.slideWidth*n.slideCount/2:!0===n.options.centerMode&&!0===n.options.infinite?n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)-n.slideWidth:!0===n.options.centerMode&&(n.slideOffset=0,n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)),e=!1===n.options.vertical?i*n.slideWidth*-1+n.slideOffset:i*t*-1+r,!0===n.options.variableWidth&&(o=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(i):n.$slideTrack.children(".slick-slide").eq(i+n.options.slidesToShow),e=!0===n.options.rtl?o[0]?-1*(n.$slideTrack.width()-o[0].offsetLeft-o.width()):0:o[0]?-1*o[0].offsetLeft:0,!0===n.options.centerMode&&(o=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(i):n.$slideTrack.children(".slick-slide").eq(i+n.options.slidesToShow+1),e=!0===n.options.rtl?o[0]?-1*(n.$slideTrack.width()-o[0].offsetLeft-o.width()):0:o[0]?-1*o[0].offsetLeft:0,e+=(n.$list.width()-o.outerWidth())/2)),e},e.prototype.getOption=e.prototype.slickGetOption=function(i){return this.options[i]},e.prototype.getNavigableIndexes=function(){var i,e=this,t=0,o=0,s=[];for(!1===e.options.infinite?i=e.slideCount:(t=-1*e.options.slidesToScroll,o=-1*e.options.slidesToScroll,i=2*e.slideCount);t<i;)s.push(t),t=o+e.options.slidesToScroll,o+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;return s},e.prototype.getSlick=function(){return this},e.prototype.getSlideCount=function(){var e,t,o=this;return t=!0===o.options.centerMode?o.slideWidth*Math.floor(o.options.slidesToShow/2):0,!0===o.options.swipeToSlide?(o.$slideTrack.find(".slick-slide").each(function(s,n){if(n.offsetLeft-t+i(n).outerWidth()/2>-1*o.swipeLeft)return e=n,!1}),Math.abs(i(e).attr("data-slick-index")-o.currentSlide)||1):o.options.slidesToScroll},e.prototype.goTo=e.prototype.slickGoTo=function(i,e){this.changeSlide({data:{message:"index",index:parseInt(i)}},e)},e.prototype.init=function(e){var t=this;i(t.$slider).hasClass("slick-initialized")||(i(t.$slider).addClass("slick-initialized"),t.buildRows(),t.buildOut(),t.setProps(),t.startLoad(),t.loadSlider(),t.initializeEvents(),t.updateArrows(),t.updateDots(),t.checkResponsive(!0),t.focusHandler()),e&&t.$slider.trigger("init",[t]),!0===t.options.accessibility&&t.initADA(),t.options.autoplay&&(t.paused=!1,t.autoPlay())},e.prototype.initADA=function(){var e=this,t=Math.ceil(e.slideCount/e.options.slidesToShow),o=e.getNavigableIndexes().filter(function(i){return i>=0&&i<e.slideCount});e.$slides.add(e.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),null!==e.$dots&&(e.$slides.not(e.$slideTrack.find(".slick-cloned")).each(function(t){var s=o.indexOf(t);i(this).attr({role:"tabpanel",id:"slick-slide"+e.instanceUid+t,tabindex:-1}),-1!==s&&i(this).attr({"aria-describedby":"slick-slide-control"+e.instanceUid+s})}),e.$dots.attr("role","tablist").find("li").each(function(s){var n=o[s];i(this).attr({role:"presentation"}),i(this).find("button").first().attr({role:"tab",id:"slick-slide-control"+e.instanceUid+s,"aria-controls":"slick-slide"+e.instanceUid+n,"aria-label":s+1+" of "+t,"aria-selected":null,tabindex:"-1"})}).eq(e.currentSlide).find("button").attr({"aria-selected":"true",tabindex:"0"}).end());for(var s=e.currentSlide,n=s+e.options.slidesToShow;s<n;s++)e.$slides.eq(s).attr("tabindex",0);e.activateADA()},e.prototype.initArrowEvents=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},i.changeSlide),i.$nextArrow.off("click.slick").on("click.slick",{message:"next"},i.changeSlide),!0===i.options.accessibility&&(i.$prevArrow.on("keydown.slick",i.keyHandler),i.$nextArrow.on("keydown.slick",i.keyHandler)))},e.prototype.initDotEvents=function(){var e=this;!0===e.options.dots&&(i("li",e.$dots).on("click.slick",{message:"index"},e.changeSlide),!0===e.options.accessibility&&e.$dots.on("keydown.slick",e.keyHandler)),!0===e.options.dots&&!0===e.options.pauseOnDotsHover&&i("li",e.$dots).on("mouseenter.slick",i.proxy(e.interrupt,e,!0)).on("mouseleave.slick",i.proxy(e.interrupt,e,!1))},e.prototype.initSlideEvents=function(){var e=this;e.options.pauseOnHover&&(e.$list.on("mouseenter.slick",i.proxy(e.interrupt,e,!0)),e.$list.on("mouseleave.slick",i.proxy(e.interrupt,e,!1)))},e.prototype.initializeEvents=function(){var e=this;e.initArrowEvents(),e.initDotEvents(),e.initSlideEvents(),e.$list.on("touchstart.slick mousedown.slick",{action:"start"},e.swipeHandler),e.$list.on("touchmove.slick mousemove.slick",{action:"move"},e.swipeHandler),e.$list.on("touchend.slick mouseup.slick",{action:"end"},e.swipeHandler),e.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},e.swipeHandler),e.$list.on("click.slick",e.clickHandler),i(document).on(e.visibilityChange,i.proxy(e.visibility,e)),!0===e.options.accessibility&&e.$list.on("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().on("click.slick",e.selectHandler),i(window).on("orientationchange.slick.slick-"+e.instanceUid,i.proxy(e.orientationChange,e)),i(window).on("resize.slick.slick-"+e.instanceUid,i.proxy(e.resize,e)),i("[draggable!=true]",e.$slideTrack).on("dragstart",e.preventDefault),i(window).on("load.slick.slick-"+e.instanceUid,e.setPosition),i(e.setPosition)},e.prototype.initUI=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.show(),i.$nextArrow.show()),!0===i.options.dots&&i.slideCount>i.options.slidesToShow&&i.$dots.show()},e.prototype.keyHandler=function(i){var e=this;i.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===i.keyCode&&!0===e.options.accessibility?e.changeSlide({data:{message:!0===e.options.rtl?"next":"previous"}}):39===i.keyCode&&!0===e.options.accessibility&&e.changeSlide({data:{message:!0===e.options.rtl?"previous":"next"}}))},e.prototype.lazyLoad=function(){function e(e){i("img[data-lazy]",e).each(function(){var e=i(this),t=i(this).attr("data-lazy"),o=i(this).attr("data-srcset"),s=i(this).attr("data-sizes")||n.$slider.attr("data-sizes"),r=document.createElement("img");r.onload=function(){e.animate({opacity:0},100,function(){o&&(e.attr("srcset",o),s&&e.attr("sizes",s)),e.attr("src",t).animate({opacity:1},200,function(){e.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")}),n.$slider.trigger("lazyLoaded",[n,e,t])})},r.onerror=function(){e.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),n.$slider.trigger("lazyLoadError",[n,e,t])},r.src=t})}var t,o,s,n=this;if(!0===n.options.centerMode?!0===n.options.infinite?s=(o=n.currentSlide+(n.options.slidesToShow/2+1))+n.options.slidesToShow+2:(o=Math.max(0,n.currentSlide-(n.options.slidesToShow/2+1)),s=n.options.slidesToShow/2+1+2+n.currentSlide):(o=n.options.infinite?n.options.slidesToShow+n.currentSlide:n.currentSlide,s=Math.ceil(o+n.options.slidesToShow),!0===n.options.fade&&(o>0&&o--,s<=n.slideCount&&s++)),t=n.$slider.find(".slick-slide").slice(o,s),"anticipated"===n.options.lazyLoad)for(var r=o-1,l=s,d=n.$slider.find(".slick-slide"),a=0;a<n.options.slidesToScroll;a++)r<0&&(r=n.slideCount-1),t=(t=t.add(d.eq(r))).add(d.eq(l)),r--,l++;e(t),n.slideCount<=n.options.slidesToShow?e(n.$slider.find(".slick-slide")):n.currentSlide>=n.slideCount-n.options.slidesToShow?e(n.$slider.find(".slick-cloned").slice(0,n.options.slidesToShow)):0===n.currentSlide&&e(n.$slider.find(".slick-cloned").slice(-1*n.options.slidesToShow))},e.prototype.loadSlider=function(){var i=this;i.setPosition(),i.$slideTrack.css({opacity:1}),i.$slider.removeClass("slick-loading"),i.initUI(),"progressive"===i.options.lazyLoad&&i.progressiveLazyLoad()},e.prototype.next=e.prototype.slickNext=function(){this.changeSlide({data:{message:"next"}})},e.prototype.orientationChange=function(){var i=this;i.checkResponsive(),i.setPosition()},e.prototype.pause=e.prototype.slickPause=function(){var i=this;i.autoPlayClear(),i.paused=!0},e.prototype.play=e.prototype.slickPlay=function(){var i=this;i.autoPlay(),i.options.autoplay=!0,i.paused=!1,i.focussed=!1,i.interrupted=!1},e.prototype.postSlide=function(e){var t=this;t.unslicked||(t.$slider.trigger("afterChange",[t,e]),t.animating=!1,t.slideCount>t.options.slidesToShow&&t.setPosition(),t.swipeLeft=null,t.options.autoplay&&t.autoPlay(),!0===t.options.accessibility&&(t.initADA(),t.options.focusOnChange&&i(t.$slides.get(t.currentSlide)).attr("tabindex",0).focus()))},e.prototype.prev=e.prototype.slickPrev=function(){this.changeSlide({data:{message:"previous"}})},e.prototype.preventDefault=function(i){i.preventDefault()},e.prototype.progressiveLazyLoad=function(e){e=e||1;var t,o,s,n,r,l=this,d=i("img[data-lazy]",l.$slider);d.length?(t=d.first(),o=t.attr("data-lazy"),s=t.attr("data-srcset"),n=t.attr("data-sizes")||l.$slider.attr("data-sizes"),(r=document.createElement("img")).onload=function(){s&&(t.attr("srcset",s),n&&t.attr("sizes",n)),t.attr("src",o).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading"),!0===l.options.adaptiveHeight&&l.setPosition(),l.$slider.trigger("lazyLoaded",[l,t,o]),l.progressiveLazyLoad()},r.onerror=function(){e<3?setTimeout(function(){l.progressiveLazyLoad(e+1)},500):(t.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),l.$slider.trigger("lazyLoadError",[l,t,o]),l.progressiveLazyLoad())},r.src=o):l.$slider.trigger("allImagesLoaded",[l])},e.prototype.refresh=function(e){var t,o,s=this;o=s.slideCount-s.options.slidesToShow,!s.options.infinite&&s.currentSlide>o&&(s.currentSlide=o),s.slideCount<=s.options.slidesToShow&&(s.currentSlide=0),t=s.currentSlide,s.destroy(!0),i.extend(s,s.initials,{currentSlide:t}),s.init(),e||s.changeSlide({data:{message:"index",index:t}},!1)},e.prototype.registerBreakpoints=function(){var e,t,o,s=this,n=s.options.responsive||null;if("array"===i.type(n)&&n.length){s.respondTo=s.options.respondTo||"window";for(e in n)if(o=s.breakpoints.length-1,n.hasOwnProperty(e)){for(t=n[e].breakpoint;o>=0;)s.breakpoints[o]&&s.breakpoints[o]===t&&s.breakpoints.splice(o,1),o--;s.breakpoints.push(t),s.breakpointSettings[t]=n[e].settings}s.breakpoints.sort(function(i,e){return s.options.mobileFirst?i-e:e-i})}},e.prototype.reinit=function(){var e=this;e.$slides=e.$slideTrack.children(e.options.slide).addClass("slick-slide"),e.slideCount=e.$slides.length,e.currentSlide>=e.slideCount&&0!==e.currentSlide&&(e.currentSlide=e.currentSlide-e.options.slidesToScroll),e.slideCount<=e.options.slidesToShow&&(e.currentSlide=0),e.registerBreakpoints(),e.setProps(),e.setupInfinite(),e.buildArrows(),e.updateArrows(),e.initArrowEvents(),e.buildDots(),e.updateDots(),e.initDotEvents(),e.cleanUpSlideEvents(),e.initSlideEvents(),e.checkResponsive(!1,!0),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().on("click.slick",e.selectHandler),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),e.setPosition(),e.focusHandler(),e.paused=!e.options.autoplay,e.autoPlay(),e.$slider.trigger("reInit",[e])},e.prototype.resize=function(){var e=this;i(window).width()!==e.windowWidth&&(clearTimeout(e.windowDelay),e.windowDelay=window.setTimeout(function(){e.windowWidth=i(window).width(),e.checkResponsive(),e.unslicked||e.setPosition()},50))},e.prototype.removeSlide=e.prototype.slickRemove=function(i,e,t){var o=this;if(i="boolean"==typeof i?!0===(e=i)?0:o.slideCount-1:!0===e?--i:i,o.slideCount<1||i<0||i>o.slideCount-1)return!1;o.unload(),!0===t?o.$slideTrack.children().remove():o.$slideTrack.children(this.options.slide).eq(i).remove(),o.$slides=o.$slideTrack.children(this.options.slide),o.$slideTrack.children(this.options.slide).detach(),o.$slideTrack.append(o.$slides),o.$slidesCache=o.$slides,o.reinit()},e.prototype.setCSS=function(i){var e,t,o=this,s={};!0===o.options.rtl&&(i=-i),e="left"==o.positionProp?Math.ceil(i)+"px":"0px",t="top"==o.positionProp?Math.ceil(i)+"px":"0px",s[o.positionProp]=i,!1===o.transformsEnabled?o.$slideTrack.css(s):(s={},!1===o.cssTransitions?(s[o.animType]="translate("+e+", "+t+")",o.$slideTrack.css(s)):(s[o.animType]="translate3d("+e+", "+t+", 0px)",o.$slideTrack.css(s)))},e.prototype.setDimensions=function(){var i=this;!1===i.options.vertical?!0===i.options.centerMode&&i.$list.css({padding:"0px "+i.options.centerPadding}):(i.$list.height(i.$slides.first().outerHeight(!0)*i.options.slidesToShow),!0===i.options.centerMode&&i.$list.css({padding:i.options.centerPadding+" 0px"})),i.listWidth=i.$list.width(),i.listHeight=i.$list.height(),!1===i.options.vertical&&!1===i.options.variableWidth?(i.slideWidth=Math.ceil(i.listWidth/i.options.slidesToShow),i.$slideTrack.width(Math.ceil(i.slideWidth*i.$slideTrack.children(".slick-slide").length))):!0===i.options.variableWidth?i.$slideTrack.width(5e3*i.slideCount):(i.slideWidth=Math.ceil(i.listWidth),i.$slideTrack.height(Math.ceil(i.$slides.first().outerHeight(!0)*i.$slideTrack.children(".slick-slide").length)));var e=i.$slides.first().outerWidth(!0)-i.$slides.first().width();!1===i.options.variableWidth&&i.$slideTrack.children(".slick-slide").width(i.slideWidth-e)},e.prototype.setFade=function(){var e,t=this;t.$slides.each(function(o,s){e=t.slideWidth*o*-1,!0===t.options.rtl?i(s).css({position:"relative",right:e,top:0,zIndex:t.options.zIndex-2,opacity:0}):i(s).css({position:"relative",left:e,top:0,zIndex:t.options.zIndex-2,opacity:0})}),t.$slides.eq(t.currentSlide).css({zIndex:t.options.zIndex-1,opacity:1})},e.prototype.setHeight=function(){var i=this;if(1===i.options.slidesToShow&&!0===i.options.adaptiveHeight&&!1===i.options.vertical){var e=i.$slides.eq(i.currentSlide).outerHeight(!0);i.$list.css("height",e)}},e.prototype.setOption=e.prototype.slickSetOption=function(){var e,t,o,s,n,r=this,l=!1;if("object"===i.type(arguments[0])?(o=arguments[0],l=arguments[1],n="multiple"):"string"===i.type(arguments[0])&&(o=arguments[0],s=arguments[1],l=arguments[2],"responsive"===arguments[0]&&"array"===i.type(arguments[1])?n="responsive":void 0!==arguments[1]&&(n="single")),"single"===n)r.options[o]=s;else if("multiple"===n)i.each(o,function(i,e){r.options[i]=e});else if("responsive"===n)for(t in s)if("array"!==i.type(r.options.responsive))r.options.responsive=[s[t]];else{for(e=r.options.responsive.length-1;e>=0;)r.options.responsive[e].breakpoint===s[t].breakpoint&&r.options.responsive.splice(e,1),e--;r.options.responsive.push(s[t])}l&&(r.unload(),r.reinit())},e.prototype.setPosition=function(){var i=this;i.setDimensions(),i.setHeight(),!1===i.options.fade?i.setCSS(i.getLeft(i.currentSlide)):i.setFade(),i.$slider.trigger("setPosition",[i])},e.prototype.setProps=function(){var i=this,e=document.body.style;i.positionProp=!0===i.options.vertical?"top":"left","top"===i.positionProp?i.$slider.addClass("slick-vertical"):i.$slider.removeClass("slick-vertical"),void 0===e.WebkitTransition&&void 0===e.MozTransition&&void 0===e.msTransition||!0===i.options.useCSS&&(i.cssTransitions=!0),i.options.fade&&("number"==typeof i.options.zIndex?i.options.zIndex<3&&(i.options.zIndex=3):i.options.zIndex=i.defaults.zIndex),void 0!==e.OTransform&&(i.animType="OTransform",i.transformType="-o-transform",i.transitionType="OTransition",void 0===e.perspectiveProperty&&void 0===e.webkitPerspective&&(i.animType=!1)),void 0!==e.MozTransform&&(i.animType="MozTransform",i.transformType="-moz-transform",i.transitionType="MozTransition",void 0===e.perspectiveProperty&&void 0===e.MozPerspective&&(i.animType=!1)),void 0!==e.webkitTransform&&(i.animType="webkitTransform",i.transformType="-webkit-transform",i.transitionType="webkitTransition",void 0===e.perspectiveProperty&&void 0===e.webkitPerspective&&(i.animType=!1)),void 0!==e.msTransform&&(i.animType="msTransform",i.transformType="-ms-transform",i.transitionType="msTransition",void 0===e.msTransform&&(i.animType=!1)),void 0!==e.transform&&!1!==i.animType&&(i.animType="transform",i.transformType="transform",i.transitionType="transition"),i.transformsEnabled=i.options.useTransform&&null!==i.animType&&!1!==i.animType},e.prototype.setSlideClasses=function(i){var e,t,o,s,n=this;if(t=n.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),n.$slides.eq(i).addClass("slick-current"),!0===n.options.centerMode){var r=n.options.slidesToShow%2==0?1:0;e=Math.floor(n.options.slidesToShow/2),!0===n.options.infinite&&(i>=e&&i<=n.slideCount-1-e?n.$slides.slice(i-e+r,i+e+1).addClass("slick-active").attr("aria-hidden","false"):(o=n.options.slidesToShow+i,t.slice(o-e+1+r,o+e+2).addClass("slick-active").attr("aria-hidden","false")),0===i?t.eq(t.length-1-n.options.slidesToShow).addClass("slick-center"):i===n.slideCount-1&&t.eq(n.options.slidesToShow).addClass("slick-center")),n.$slides.eq(i).addClass("slick-center")}else i>=0&&i<=n.slideCount-n.options.slidesToShow?n.$slides.slice(i,i+n.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):t.length<=n.options.slidesToShow?t.addClass("slick-active").attr("aria-hidden","false"):(s=n.slideCount%n.options.slidesToShow,o=!0===n.options.infinite?n.options.slidesToShow+i:i,n.options.slidesToShow==n.options.slidesToScroll&&n.slideCount-i<n.options.slidesToShow?t.slice(o-(n.options.slidesToShow-s),o+s).addClass("slick-active").attr("aria-hidden","false"):t.slice(o,o+n.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));"ondemand"!==n.options.lazyLoad&&"anticipated"!==n.options.lazyLoad||n.lazyLoad()},e.prototype.setupInfinite=function(){var e,t,o,s=this;if(!0===s.options.fade&&(s.options.centerMode=!1),!0===s.options.infinite&&!1===s.options.fade&&(t=null,s.slideCount>s.options.slidesToShow)){for(o=!0===s.options.centerMode?s.options.slidesToShow+1:s.options.slidesToShow,e=s.slideCount;e>s.slideCount-o;e-=1)t=e-1,i(s.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t-s.slideCount).prependTo(s.$slideTrack).addClass("slick-cloned");for(e=0;e<o+s.slideCount;e+=1)t=e,i(s.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t+s.slideCount).appendTo(s.$slideTrack).addClass("slick-cloned");s.$slideTrack.find(".slick-cloned").find("[id]").each(function(){i(this).attr("id","")})}},e.prototype.interrupt=function(i){var e=this;i||e.autoPlay(),e.interrupted=i},e.prototype.selectHandler=function(e){var t=this,o=i(e.target).is(".slick-slide")?i(e.target):i(e.target).parents(".slick-slide"),s=parseInt(o.attr("data-slick-index"));s||(s=0),t.slideCount<=t.options.slidesToShow?t.slideHandler(s,!1,!0):t.slideHandler(s)},e.prototype.slideHandler=function(i,e,t){var o,s,n,r,l,d=null,a=this;if(e=e||!1,!(!0===a.animating&&!0===a.options.waitForAnimate||!0===a.options.fade&&a.currentSlide===i))if(!1===e&&a.asNavFor(i),o=i,d=a.getLeft(o),r=a.getLeft(a.currentSlide),a.currentLeft=null===a.swipeLeft?r:a.swipeLeft,!1===a.options.infinite&&!1===a.options.centerMode&&(i<0||i>a.getDotCount()*a.options.slidesToScroll))!1===a.options.fade&&(o=a.currentSlide,!0!==t?a.animateSlide(r,function(){a.postSlide(o)}):a.postSlide(o));else if(!1===a.options.infinite&&!0===a.options.centerMode&&(i<0||i>a.slideCount-a.options.slidesToScroll))!1===a.options.fade&&(o=a.currentSlide,!0!==t?a.animateSlide(r,function(){a.postSlide(o)}):a.postSlide(o));else{if(a.options.autoplay&&clearInterval(a.autoPlayTimer),s=o<0?a.slideCount%a.options.slidesToScroll!=0?a.slideCount-a.slideCount%a.options.slidesToScroll:a.slideCount+o:o>=a.slideCount?a.slideCount%a.options.slidesToScroll!=0?0:o-a.slideCount:o,a.animating=!0,a.$slider.trigger("beforeChange",[a,a.currentSlide,s]),n=a.currentSlide,a.currentSlide=s,a.setSlideClasses(a.currentSlide),a.options.asNavFor&&(l=(l=a.getNavTarget()).slick("getSlick")).slideCount<=l.options.slidesToShow&&l.setSlideClasses(a.currentSlide),a.updateDots(),a.updateArrows(),!0===a.options.fade)return!0!==t?(a.fadeSlideOut(n),a.fadeSlide(s,function(){a.postSlide(s)})):a.postSlide(s),void a.animateHeight();!0!==t?a.animateSlide(d,function(){a.postSlide(s)}):a.postSlide(s)}},e.prototype.startLoad=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.hide(),i.$nextArrow.hide()),!0===i.options.dots&&i.slideCount>i.options.slidesToShow&&i.$dots.hide(),i.$slider.addClass("slick-loading")},e.prototype.swipeDirection=function(){var i,e,t,o,s=this;return i=s.touchObject.startX-s.touchObject.curX,e=s.touchObject.startY-s.touchObject.curY,t=Math.atan2(e,i),(o=Math.round(180*t/Math.PI))<0&&(o=360-Math.abs(o)),o<=45&&o>=0?!1===s.options.rtl?"left":"right":o<=360&&o>=315?!1===s.options.rtl?"left":"right":o>=135&&o<=225?!1===s.options.rtl?"right":"left":!0===s.options.verticalSwiping?o>=35&&o<=135?"down":"up":"vertical"},e.prototype.swipeEnd=function(i){var e,t,o=this;if(o.dragging=!1,o.swiping=!1,o.scrolling)return o.scrolling=!1,!1;if(o.interrupted=!1,o.shouldClick=!(o.touchObject.swipeLength>10),void 0===o.touchObject.curX)return!1;if(!0===o.touchObject.edgeHit&&o.$slider.trigger("edge",[o,o.swipeDirection()]),o.touchObject.swipeLength>=o.touchObject.minSwipe){switch(t=o.swipeDirection()){case"left":case"down":e=o.options.swipeToSlide?o.checkNavigable(o.currentSlide+o.getSlideCount()):o.currentSlide+o.getSlideCount(),o.currentDirection=0;break;case"right":case"up":e=o.options.swipeToSlide?o.checkNavigable(o.currentSlide-o.getSlideCount()):o.currentSlide-o.getSlideCount(),o.currentDirection=1}"vertical"!=t&&(o.slideHandler(e),o.touchObject={},o.$slider.trigger("swipe",[o,t]))}else o.touchObject.startX!==o.touchObject.curX&&(o.slideHandler(o.currentSlide),o.touchObject={})},e.prototype.swipeHandler=function(i){var e=this;if(!(!1===e.options.swipe||"ontouchend"in document&&!1===e.options.swipe||!1===e.options.draggable&&-1!==i.type.indexOf("mouse")))switch(e.touchObject.fingerCount=i.originalEvent&&void 0!==i.originalEvent.touches?i.originalEvent.touches.length:1,e.touchObject.minSwipe=e.listWidth/e.options.touchThreshold,!0===e.options.verticalSwiping&&(e.touchObject.minSwipe=e.listHeight/e.options.touchThreshold),i.data.action){case"start":e.swipeStart(i);break;case"move":e.swipeMove(i);break;case"end":e.swipeEnd(i)}},e.prototype.swipeMove=function(i){var e,t,o,s,n,r,l=this;return n=void 0!==i.originalEvent?i.originalEvent.touches:null,!(!l.dragging||l.scrolling||n&&1!==n.length)&&(e=l.getLeft(l.currentSlide),l.touchObject.curX=void 0!==n?n[0].pageX:i.clientX,l.touchObject.curY=void 0!==n?n[0].pageY:i.clientY,l.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(l.touchObject.curX-l.touchObject.startX,2))),r=Math.round(Math.sqrt(Math.pow(l.touchObject.curY-l.touchObject.startY,2))),!l.options.verticalSwiping&&!l.swiping&&r>4?(l.scrolling=!0,!1):(!0===l.options.verticalSwiping&&(l.touchObject.swipeLength=r),t=l.swipeDirection(),void 0!==i.originalEvent&&l.touchObject.swipeLength>4&&(l.swiping=!0,i.preventDefault()),s=(!1===l.options.rtl?1:-1)*(l.touchObject.curX>l.touchObject.startX?1:-1),!0===l.options.verticalSwiping&&(s=l.touchObject.curY>l.touchObject.startY?1:-1),o=l.touchObject.swipeLength,l.touchObject.edgeHit=!1,!1===l.options.infinite&&(0===l.currentSlide&&"right"===t||l.currentSlide>=l.getDotCount()&&"left"===t)&&(o=l.touchObject.swipeLength*l.options.edgeFriction,l.touchObject.edgeHit=!0),!1===l.options.vertical?l.swipeLeft=e+o*s:l.swipeLeft=e+o*(l.$list.height()/l.listWidth)*s,!0===l.options.verticalSwiping&&(l.swipeLeft=e+o*s),!0!==l.options.fade&&!1!==l.options.touchMove&&(!0===l.animating?(l.swipeLeft=null,!1):void l.setCSS(l.swipeLeft))))},e.prototype.swipeStart=function(i){var e,t=this;if(t.interrupted=!0,1!==t.touchObject.fingerCount||t.slideCount<=t.options.slidesToShow)return t.touchObject={},!1;void 0!==i.originalEvent&&void 0!==i.originalEvent.touches&&(e=i.originalEvent.touches[0]),t.touchObject.startX=t.touchObject.curX=void 0!==e?e.pageX:i.clientX,t.touchObject.startY=t.touchObject.curY=void 0!==e?e.pageY:i.clientY,t.dragging=!0},e.prototype.unfilterSlides=e.prototype.slickUnfilter=function(){var i=this;null!==i.$slidesCache&&(i.unload(),i.$slideTrack.children(this.options.slide).detach(),i.$slidesCache.appendTo(i.$slideTrack),i.reinit())},e.prototype.unload=function(){var e=this;i(".slick-cloned",e.$slider).remove(),e.$dots&&e.$dots.remove(),e.$prevArrow&&e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.remove(),e.$nextArrow&&e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.remove(),e.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},e.prototype.unslick=function(i){var e=this;e.$slider.trigger("unslick",[e,i]),e.destroy()},e.prototype.updateArrows=function(){var i=this;Math.floor(i.options.slidesToShow/2),!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&!i.options.infinite&&(i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),i.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===i.currentSlide?(i.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):i.currentSlide>=i.slideCount-i.options.slidesToShow&&!1===i.options.centerMode?(i.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):i.currentSlide>=i.slideCount-1&&!0===i.options.centerMode&&(i.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},e.prototype.updateDots=function(){var i=this;null!==i.$dots&&(i.$dots.find("li").removeClass("slick-active").end(),i.$dots.find("li").eq(Math.floor(i.currentSlide/i.options.slidesToScroll)).addClass("slick-active"))},e.prototype.visibility=function(){var i=this;i.options.autoplay&&(document[i.hidden]?i.interrupted=!0:i.interrupted=!1)},i.fn.slick=function(){var i,t,o=this,s=arguments[0],n=Array.prototype.slice.call(arguments,1),r=o.length;for(i=0;i<r;i++)if("object"==typeof s||void 0===s?o[i].slick=new e(o[i],s):t=o[i].slick[s].apply(o[i].slick,n),void 0!==t)return t;return o}});

// -----------------------------------------------------------------------
// Copyright 2016 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    // use AMD define funtion to support AMD modules if in use
    define(['CXA/Application', 'exports'], factory);
  } else if (typeof exports === 'object') {
    // to support CommonJS
    factory(exports);
  }

  // browser global variable
  root.RunningModes = {
    Normal: "Normal",
    ExperienceEditor: "Experience Editor"
  };

  root.ComponentType = {
    Form: "form",
    Component: "component"
  };

  var CXAApplication = {
    CXAComponentIdEnumerator: -1,
    CXAComponentIdPrefix: "cxa_component_",
    GenerateComponentId: function () {
      return this.CXAComponentIdPrefix + ++this.CXAComponentIdEnumerator;
    }
  };

  root.CXAApplication = CXAApplication;
  factory(CXAApplication);
}(this, function (CXAApplication) {
  'use strict';
  CXAApplication.RunningMode = RunningModes.Normal;
  CXAApplication.LoadedComponents = [];

  var _CreateAndInitialize = function ($object, callInitMethod) {
    // Had to set both data and attr as filteration is done on the basis of the attribute for performance.
    $object.data("cxa-component-initialized", "true");
    $object.attr("data-cxa-component-initialized", "true");

    var $componentClassName = $object.data("cxa-component-class");
    var $componentModelName = $object.data("cxa-component-model");

    var $componentType = $object.data("cxa-component-type");

    switch ($componentType) {
    case ComponentType.Component:
      var model;


      if ($componentModelName) {
        model = eval("new " + $componentModelName + "({})");
      }

      if (typeof window[$componentClassName] === "undefined") {
          console.log("Rendering: ", $componentClassName, "function (class name) not present!");
          return;
      }


      var componentInstance = eval($componentClassName)($object.get(0), model);

      if (callInitMethod) {
        // Initialize the Experience Editor specific display
        if (CXAApplication.IsExperienceEditorMode() && componentInstance.InExperienceEditorMode) {
          componentInstance.InExperienceEditorMode();
        }

        // Initialize the component
        if (componentInstance.Init) {
          componentInstance.Init();
        }
      }

      break;
    case ComponentType.Form:
      var $form = eval($componentClassName);

      if ($form.Init) {
        $form.Init($object.get(0));
      }
      // else {
      //     console.error("TODO: ComponentType.Form - " + $componentClassName + ".Init() not defined.");
      // }

      break;

    default:
      break;
    }
  };

  CXAApplication.CreateComponentInstance = function (cssSelector, callInitMethod, loadAll) {
    var $selectedObjects;

    $selectedObjects = $(cssSelector);

    if (!loadAll) {
      $selectedObjects = $selectedObjects.not("[data-cxa-component-initialized='true']");
    }

    if ($selectedObjects.length === 0) {
      return;
    }

    $selectedObjects.each(function () {
      _CreateAndInitialize($(this), callInitMethod);
    });
  };

  CXAApplication.IsExperienceEditorMode = function () {
    return CXAApplication.RunningMode === RunningModes.ExperienceEditor || typeof Sitecore !== "undefined" && typeof Sitecore.WebEditSettings !== "undefined" && Sitecore.WebEditSettings.editing;
  };

  CXAApplication.InitializeComponents = function () {
    CXAApplication.CreateComponentInstance("[data-cxa-component-class]", false, true);

    $(CXAApplication.LoadedComponents).each(function () {
      try {
        this.Init();
      } catch (err) {
        MessageContext.PublishError(CXAApplication, "component initialization failed : " + err);
        throw err;
      }
    });
  };

  CXAApplication.Initialize = function () {
    var pageExtension = getCurrentPageExtension();

    if (typeof Sitecore !== "undefined" && typeof Sitecore.WebEditSettings !== "undefined" && Sitecore.WebEditSettings.editing ||
            pageExtension === "html") {
      CXAApplication.RunningMode = RunningModes.ExperienceEditor;
    }

    CXAApplication.InitializeComponents();

    if (CXAApplication.IsExperienceEditorMode()) {
      $(CXAApplication.LoadedComponents).each(function () {
        this.InExperienceEditorMode();
      });
    }

    // If in Experience Editor mode, we need to observe DOM so that newly added components can be initialized...
    if (CXAApplication.IsExperienceEditorMode()) {
      if (typeof DomObserver === "undefined") {
        MessageContext.PublishError(CXAApplication, "DomObserver Service not Initialized...");
      } else {
        DomObserver.ObserveDomChanges(function () {
          CXAApplication.CreateComponentInstance("[data-cxa-component-class]", true);
        }, $("#wrapper").get(0));
      }
    }
  };

  CXAApplication.LoadComponent = function (component, element, model) {
    try {
      // setting components name and id
      component.Id = CXAApplication.GenerateComponentId();
      component.RootElement = element;
      // if there's a model bind it to the root element of component
      if (model) {
        model.Id = ko.observable(component.Id);
        component.Model = model;
        // bind the root element to the knockout model
        ko.applyBindings(model, element);
      }

      CXAApplication.LoadedComponents.push(component);
    } catch (err) {
      MessageContext.PublishError(CXAApplication, "component loading failed : " + err);
    }
  };

  CXAApplication.Goto = function (url) {
    var virtualFolder = document.getElementsByName("_SiteVirtualFolder");
    if (virtualFolder.length > 0) {
      var virtualFolderString = virtualFolder[0].value;
      if (virtualFolderString.length > 1) {
        virtualFolderString = virtualFolderString.replace("/", "").replace("/", "");
        url = url.replace("/", "");
        url = "/" + virtualFolderString + "/" + url;
      }
    }
    window.location.href = url;
  };

  CXAApplication.IsComponentLoaded = function(componentName) {
      var componentMatch = CXAApplication.LoadedComponents.filter(function(component) {
        return component.Name === componentName;
      });

      return componentMatch.length > 0;
  };
}));
/* eslint-disable no-unused-vars */
function isMobile() {
  if (/Mobi/i.test(navigator.userAgent)) {
    return true;
  }

  return false;
}
/* eslint-enable no-unused-vars */

// Copyright 2017-2018 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    // use AMD define funtion to support AMD modules if in use
    define('CXA/Common/Component', ['exports'], factory);
  } else if (typeof exports === 'object') {
    // to support CommonJS
    factory(exports);
  }
  // browser global variable
  root.Component = factory;
}(this, function (element, model) {
  'use strict';
  var component = {};

  component.InExperienceEditorMode = function () {
    // To be overridden by actual component
  };

  component.Init = function () {
    // To be overridden by actual component
  };

  // public methods available to all components
  component.PublishError = function (message, data) {
    MessageContext.PublishError(component, message, data);
  };
  component.PublishInfo = function (message, data) {
    MessageContext.PublishInfo(component, message, data);
  };
  component.PublishWarning = function (message, data) {
    MessageContext.PublishWarning(component, message, data);
  };

  component.Visual = {
    EnableInDesignEditing: function () {
      var $inDesignButtons = $(component.RootElement).find(".disabled-in-design");

      $inDesignButtons.removeAttr("disabled");

      $inDesignButtons.on("click", function (e) {
        e.preventDefault();
        return false;
      });
    },
    Appear: function () {
      $(component.RootElement).fadeIn(100);
    },
    DisAppear: function () {
      $(component.RootElement).hide();
    },
    DisableLinks: function () {
      $(component.RootElement).find('a')
        .attr('href', 'javascript:void(0)');
    },
    Disable: function () {
      $(component.RootElement).find('input')
        .attr('disabled', 'disabled');
      $(component.RootElement).find('select')
        .attr('disabled', 'disabled');
      $(component.RootElement).find('textarea')
        .attr('disabled', 'disabled');
      $(component.RootElement).find('button')
        .attr('disabled', 'disabled');
      $(component.RootElement).find('a')
        .attr('disabled', 'disabled');
      component.Visual.DisableLinks();

      if (CXAApplication.IsExperienceEditorMode()) {
        this.EnableInDesignEditing();
      }
    },
    Enable: function () {
      $(component.RootElement).find('input')
        .removeAttr('disabled');
      $(component.RootElement).find('button')
        .removeAttr('disabled');
    }
  };

  component.LoadData = function (url, data, callback) {
    AjaxService.Post(url, data, function (data, success, sender) { if (success) callback(data); }, component);
  };

  // Load the component in the CXA Application instance
  CXAApplication.LoadComponent(component, element, model);

  return component;
}));
// -----------------------------------------------------------------------
// Copyright 2016 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    // use AMD define funtion to support AMD modules if in use
    define(['exports'], factory);
  } else if (typeof exports === 'object') {
    // to support CommonJS
    factory(exports);
  }

  root.CXAForm = factory;
}(this, function (element) {
  var form = {
    RootElement: element
  };
  form.FormRoot = $(form.RootElement).find('form');
  form.SubmitButton = $(form.FormRoot).find(':submit');

  form.Disable = function () {
    $(form.RootElement).find('input')
      .attr('disabled', 'disabled');
    $(form.RootElement).find('button')
      .attr('disabled', 'disabled');
    $(form.RootElement).find('a')
      .attr('disabled', 'disabled');
  };

  form.Enable = function () {
    $(form.RootElement).find('input')
      .removeAttr('disabled');
    $(form.RootElement).find('button')
      .removeAttr('disabled');
    $(form.RootElement).find('a')
      .removeAttr('disabled');
  };

  form.EnableInDesignEditing = function () {
    var $inDesignButtons = $(form.RootElement).find(".disabled-in-design");

    $inDesignButtons.removeAttr("disabled");

    $inDesignButtons.on("click", function (e) {
      e.preventDefault();
      return false;
    });
  };

  form.OnBegin = function () {
    MessageContext.ClearAllMessages();
    $(form.SubmitButton).button('loading');
    form.Disable();
  };
  form.OnSuccess = function (data) {
    // To be overridden by actual component
  };

  form.OnComplete = function () {
    $(form.SubmitButton).button('reset');
    form.Enable();
  };

  form.Init = function (instance) {
    if (CXAApplication.RunningMode === RunningModes.ExperienceEditor) {
      form.Disable();
    }

    if (!instance.RootElement) { instance.RootElement = form.RootElement; }
    if (!instance.OnBegin) { instance.OnBegin = form.OnBegin; }
    if (!instance.OnComplete) { instance.OnComplete = form.OnComplete; }
    if (!instance.OnSuccess) { instance.OnSuccess = form.OnSuccess; }
  };

  return form;
}));
(function (root, $, factory) {
  factory($);
}(window, window.jQuery, function ($) {
  $(document).ready(function () {
    var components = $('.component-content');
    var forms = components.find('form');

    function hasKnockoutBinding(element) {
      var knockoutBinding = $(element).data('bind');
      var bindings = ['disable', 'enable', 'loading', 'text']

      if(!knockoutBinding) {
        return false;
      }

      for (var i = 0; i < bindings.length; i++) {
        if (knockoutBinding.indexOf(bindings[i] + ':') > -1) {
          return true;
        }
      }

      return false;
    }

    $(forms).each(function () {
      var form = this;

      //skip if button has certain knockout bindings
      if($(form).data('bind')) {
        var formSubmitButton = button = $(form).find(':submit');
        if(hasKnockoutBinding(formSubmitButton)) {
          return; 
        }
      }

      $(this).on('submit', function () {

          window.MessageContext.ClearAllMessages();

          var submitButton = $(this).find(':submit');
          if (!$(submitButton).hasClass('search-button')) {
            $(submitButton).button('loading');
          }



      });
      if (!CXAApplication.IsExperienceEditorMode()) {
        $(document).on('ajaxComplete', function () {
          var submitButton = $(forms).find(':submit').filter(function(i, button){
            return $(button).data('autoenable') !== false;
          });
          $(submitButton).button('reset');
        });
        $(document).on('ajaxError', function () {
          var submitButton = $(forms).find(':submit');
          $(submitButton).button('reset');
        });
      }
    });
  });
}));
// Copyright 2017-2018 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    // use AMD define funtion to support AMD modules if in use
    define(['exports'], factory);
  } else if (typeof exports === 'object') {
    // to support CommonJS
    factory(exports);
  }
  root.StartUpManager = factory;
}(this, function (element, actions) {
  var component = new Component(element);

  component.StartupActions = actions;

  component.Run = function () {
    $(component.StartupActions).each(function () {
      try {
        this();
      } catch (err) {
        component.PublishError(err);
      }
    });
  };

  component.Init = function () {
    component.Run();
  };
}));
/**
 * @description Initializes the Add to Cart Broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/AddToCartBroker', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresAddToCartBroker
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresAddToCartBroker instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresAddToCartBroker = getContext();
    root.CaleresAddToCartBroker = CaleresAddToCartBroker;
    factory(CaleresAddToCartBroker);

}(this, function (CaleresAddToCartBroker) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresAddToCartBroker.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param channel - string: channel to distinguish groups of messages
     * @param data - broker event data
     */
    function notifyHandler(handler, source, channel, data) {
        handler(source, channel, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param channel - string: channel to distinguish groups of messages
     * @param data - broker event data
     */
    function dispatch(source, channel, data) {
        var handlers = CaleresAddToCartBroker.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, channel, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function ItemAddedToCart - notifies listeners when a user has added an item to the cart (EX: To pop open the Minicart)
     */
    CaleresAddToCartBroker.ItemAddedToCart = function (source, channel, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, channel, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresAddToCartBroker.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresAddToCartBroker.LastHandlerId);
        CaleresAddToCartBroker.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresAddToCartBroker.UnSubscribeHandler = function (handlerId) {
        if (CaleresAddToCartBroker.Handlers[handlerId]) {
            delete CaleresAddToCartBroker.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
// -----------------------------------------------------------------------
// Copyright 2016 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

/**
 * Http Queue Class
 * It queue the Http calls and execute them as a batch
 * It remove the duplicated calls and execute it once and share the results for all the callers
 */
var HttpCallsQueue = (function () {
  /**
   * Keep the list of queue items
   */
  let list = {};

  /**
   * Keep the current executed batch
   */
  let currentExecutedBatch;

  /**
   * Execution timeout between each batch
   */
  const EXECUTION_TIMEOUT = 10;

  return (function () {
    function filterCharacters(dataString) {
      return dataString.replace(/[^\w\s]/gi, '');
    }

    /**
     * Create a key from the url and it's data
     * It needs to make sure the key is uniqueue
     * @param url is the http call url
     * @param data is the http post data
     */
    function createObjectKey(url, data) {
      const dataJson = JSON.stringify(data);

      return url ? filterCharacters(url) + filterCharacters(JSON.stringify(dataJson)) : url;
    }

    /**
     * Update the list item
     */
    function updateList(callInfo) {
      const urlKey = createObjectKey(callInfo.url, callInfo.data);
      let listItem = list[urlKey];
      listItem = !Array.isArray(listItem) ? [] : listItem;
      listItem.push({
        callType: callInfo.callType,
        url: callInfo.url,
        data: callInfo.data,
        callback: callInfo.callback,
        sender: callInfo.sender
      });
      list[urlKey] = listItem;
    }

    /**
     * Dequeue the item
     * @param urlKey is the uniqueue key to find the queue item
     */
    function dequeueCall(urlKey) {
      delete list[urlKey];
    }

    /**
     * Run through the queue and do a http call for each queue item
     * Each queue item has a collection of same/duplicated calls
     * We only run the call once and pass the array of callbacks to the specified action
     * When we run the action, the call will dequeue
     * @param action is the action that is run when a call need to happen. e.g http post call
     */
    function executeQueue(action) {
      if (list) {
        currentExecutedBatch = setTimeout(function () {
          Object.keys(list).forEach(function (key) {
            const calls = list[key];
            let callbacks = [];
            let firstCall = calls[0];

            calls.forEach(function (singleCall) {
              callbacks.push(singleCall.callback);
            });
            action({ callType: firstCall.callType, url: firstCall.url, data: firstCall.data, callbacks: callbacks, sender: firstCall.sender });
            dequeueCall(key);
          });
        }, EXECUTION_TIMEOUT);
      }
    }

    /**
     * Enqueue the http call
     * It creates the queue item key from the url and it's data to make sure the call is unique
     * For each new unique call, it creates a object propery and add the call details to an array
     * Any subsequent calls that has a same data & URL, will add to the same array otherwise
     * the new object property will create
     * @param httpAction is the callback will happen when the execute the queue
     * @param callType is the call type
     * @param url is the http url
     * @param data is the post data
     * @param callback is the callback
     * @param sender is the sender
     * @example
     * {
     *      ..,
     *      UNIQUE_KEY: [{callType, url, data, callback, sender}, {callType, url, data, callback, sender},..]
     * }
     */
    function enqueueCall(httpAction, callInfo) {
      clearTimeout(currentExecutedBatch);
      updateList(callInfo);
      executeQueue(httpAction);
    }

    /**
     * Export the functions for external usage
     */
    return {
      enqueueCall: enqueueCall
    };
  })();
})(
  (function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
      // use AMD define funtion to support AMD modules if in use
      define(['exports'], factory);
    } else if (typeof exports === 'object') {
      // to support CommonJS
      factory(exports);
    }

    // browser global variable
    var AjaxService = {};
    root.AjaxService = AjaxService;
    factory(AjaxService);
  })(this, function (AjaxService) {
    'use strict';

    const CXA_API_URL = '/api/cxa';
    const CXA_API_CART_CONTROLLER = CXA_API_URL + '/Cart';

    // API constants
    AjaxService.CXA_API_GET_CART = CXA_API_CART_CONTROLLER + '/GetCart';

    function injectVirtualFolder(url) {
      var virtualFolder = document.getElementsByName('_SiteVirtualFolder');

      if (virtualFolder.length <= 0) {
        return url;
      }

      var virtualFolderString = virtualFolder[0].value;
      if (virtualFolderString.length <= 1) {
        return url;
      }

      var $url = $("<a href='" + url + "'>");
      var host = $url.prop('host');

      // do not modify if link is external
      if (host !== location.host) {
        return url;
      }

      virtualFolderString = virtualFolderString.replace('/', '').replace('/', '');
      var pathname = $url.prop('pathname');
      pathname = pathname.replace(virtualFolderString, '');
      pathname = '/' + virtualFolderString + '/' + pathname;
      pathname = pathname.replace('//', '/').replace('//', '/');
      $url.prop('pathname', pathname);

      return $url.prop('href');
    }

    function retrieveSiteName() {
      return $('input[name=_SiteName]').val();
    }

    function injectSiteName(url) {
      var siteName = retrieveSiteName();

      if (siteName) {
        url += url.indexOf('?') === -1 ? '?' : '&';
        url += 'sc_site=' + siteName;
      }

      return url;
    }

    function handleSuccess(data) {
      // check if there are any errors/warnings/infos at the data and publish them if any
      if (data) {
        if (data.HasErrors) {
          $(data.Errors).each(function () {
            MessageContext.PublishError(null, 'Error: ' + this, data);
          });
        }

        if (data.HasInfo) {
          $(data.Info).each(function () {
            MessageContext.PublishInfo(null, 'Info: ' + this, data);
          });
        }

        if (data.HasWarnings) {
          $(data.Warnings).each(function () {
            MessageContext.PublishWarning(null, 'Warning: ' + this, data);
          });
        }
      }
    }

    function handleFailure(event, xhr, options, error) {
      // if ajax request fails, publish an error message
      MessageContext.PublishError(event, error, xhr);
    }

    function InitializeService() {
      // bind error handler to all ajax events on the page
      $(document).ajaxSuccess(function (event, xhr, options, data) {
        handleSuccess(data);
      });
      $(document).ajaxError(function (event, xhr, options, error) {
        handleFailure(event, xhr, options, error);
      });
    }

    function retrieveAntiForgeryToken() {
      return $('#_CRSFform input[name=__RequestVerificationToken]').val();
    }

    function addAntiForgeryToken(data) {
      if (typeof data !== 'string') {
        data.__RequestVerificationToken = retrieveAntiForgeryToken();
      }
      return data;
    }

    function httpAction(call) {
      call.data = !call.data ? {} : call.data;
      call.url = injectSiteName(call.url);

      $.ajax({
        global: true,
        type: call.callType,
        url: call.url,
        headers: { __RequestVerificationToken: retrieveAntiForgeryToken() },
        cache: false,
        data: addAntiForgeryToken(call.data),
        datatype: 'json',
        success: function (data) {
          if (data) {
            call.callbacks.forEach(function (callback) {
              callback(data, true, call.sender);
            });
          }
        },
        error: function (xhr, status, message) {
          call.callbacks.forEach(function (callback) {
            callback(null, false, call.sender);
          });
        }
      });
    }

    function ajaxCall(callInfo) {
      if (callInfo) {
        HttpCallsQueue.enqueueCall(httpAction, callInfo);
      }
    }

    function getCurrentPageExtension() {
      var pageExtensionWithQueryString = window.location.href.split('.').pop();
      if (pageExtensionWithQueryString && pageExtensionWithQueryString.length >= 4) {
        var pageExtension = pageExtensionWithQueryString.substr(0, 4);
        return pageExtension;
      }
      return '';
    }

    InitializeService();

    var isCreativeExchangeVersion = getCurrentPageExtension() === 'html';

    AjaxService.Get = function (url, data, callback, sender) {
      if (!isCreativeExchangeVersion) {
        url = injectVirtualFolder(url);
        ajaxCall({ callType: 'GET', url: url, data: data, callback: callback, sender: sender });
      }
    };

    AjaxService.Post = function (url, data, callback, sender) {
      if (!isCreativeExchangeVersion) {
        url = injectVirtualFolder(url);
        ajaxCall({ callType: 'POST', url: url, data: data, callback: callback, sender: sender });
      }
    };
  })
);

// -----------------------------------------------------------------------
// <copyright file="cxa.common.productprice.js" company="Sitecore Corporation">
// Copyright (c) Sitecore Corporation 1999-2018
// </copyright>
// <summary>Provides a common tool</summary>
// -----------------------------------------------------------------------
// Copyright 2017-2018 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
  'use strict';
  var instance;

  if (typeof define === 'function' && define.amd) {
    // use AMD define funtion to support AMD modules if in use
    define('CXA/Common/CartContext', ['exports'], factory);
  } else if (typeof exports === 'object') {
    // to support CommonJS
    factory(exports);
  }

  function createContext() {
    var context = {
      Handlers: {}, // repsoitory to store handlers
      LastHandlerId: -1 // last used handler Id, initialized to -1
    };
    return context;
  }

  function getContext() {
    if (!instance) {
      instance = createContext();
    }
    return instance;
  }
  // browser global variable
  var CartContext = getContext();
  root.CartContext = CartContext;

  factory(CartContext);
}(this, function (CartContext) {
  'use strict';
  function hasHandlers(eventType) {
    var handlers = CartContext.Handlers[eventType];
    var handlerId;
    for (handlerId in handlers) {
      if (handlers.hasOwnProperty(handlerId)) {
        return true;
      }
    }
    return false;
  }

  function notifyHandler(handler, data) {
    handler(data);
  }

  function dispatch(eventType, data) {
    var handlers = CartContext.Handlers[eventType];

    var handlerId;
    for (handlerId in handlers) {
      if (handlers.hasOwnProperty(handlerId)) {
        notifyHandler(handlers[handlerId], data);
      }
    }
  }

  CartContext.Cache = {};
  CartContext.createCache = function (cartRequestFunction) {
    return function (callback) {
      if (!CartContext.Cache['key']) {
        CartContext.Cache['key'] = $.Deferred(function (defer) {
          cartRequestFunction(defer, 'key');
        }).promise();
      }
      return CartContext.Cache['key'].done(callback);
    };
  };
  // -------------------- Service Public Functions ---------------------------------------------------------------------

  CartContext.CartData = null;
  CartContext.CartEvents = {
    CartUpdate: "cartUpdate",
    MinicartUpdate: "minicartUpdate"
  };

  CartContext.TriggerCartUpdateEvent = function (data) {
    CartContext.Cache = {};
    if (!hasHandlers(CartContext.CartEvents.CartUpdate)) {
      return false;
    }

    dispatch(CartContext.CartEvents.CartUpdate, data);
    return true;
  };

  CartContext.SubscribeHandler = function (eventType, handler) {
    if (typeof handler !== 'function') {
      return false;
    }
    if (!CartContext.Handlers.hasOwnProperty(eventType)) {
      CartContext.Handlers[eventType] = {};
    }

    var newHandlerId = 'h_' + String(++CartContext.LastHandlerId);
    CartContext.Handlers[eventType][newHandlerId] = handler;

    return newHandlerId;
  };

  CartContext.UnSubscribeHandler = function (handlerId) {
    if (CartContext.Handlers[handlerId]) {
      delete CartContext.Handlers[handlerId];
      return handlerId;
    }

    return null;
  };

  CartContext.IsCartCountCached = function () {
    const elems = document.getElementById('cacheCartCount');

    return typeof Storage !== 'undefined' && elems && elems.value === 'true';
  };

  CartContext.IsCachedCartCountAvailable = function () {
    return typeof Storage !== 'undefined' && localStorage.getItem('cxaCartCount');
  };

  CartContext.GetCachedCartCount = function () {
    return typeof Storage !== 'undefined' ? localStorage.getItem('cxaCartCount') : 0;
  };

  CartContext.UpdateCachedCartCount = function (count) {
    if (typeof Storage !== 'undefined') {
      localStorage.setItem('cxaCartCount', count);
    }
  };

  CartContext.DeleteCachedCartCount = function () {
    if (typeof Storage !== 'undefined') {
      localStorage.removeItem('cxaCartCount');
    }
  };

  CartContext.TriggerMinicartUpdate = function (minicartData) {
    if (!hasHandlers(CartContext.CartEvents.MinicartUpdate)) {
      return false;
    }

    dispatch(CartContext.CartEvents.MinicartUpdate, minicartData);
    return true;
  };

  CartContext.IsDeliveryPage = function() {
    return CXAApplication.IsComponentLoaded("Caleres/Feature/CheckoutDelivery");
  };

  CartContext.IsBillingPage = function() {
    return CXAApplication.IsComponentLoaded("Caleres/Feature/CheckoutBilling");
  };

  CartContext.IsReviewPage = function() {
    return CXAApplication.IsComponentLoaded("Caleres/Feature/CheckoutConfirm");
  };

  CartContext.IsCheckoutPage = function() {
    return CartContext.IsDeliveryPage() || CartContext.IsBillingPage() || CartContext.IsReviewPage();
  };
}));
/**
 * @description Initializes the CustomerAccount broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/CustomerAccount', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresCustomerAccountContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
            CustomerAccountState: {
                
            },
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresCustomerAccountContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresCustomerAccountContext = getContext();
    root.CaleresCustomerAccountContext = CaleresCustomerAccountContext;
    factory(CaleresCustomerAccountContext);

}(this, function (CaleresCustomerAccountContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresCustomerAccountContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param customerAccountState - the current view that the customerAccount process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, customerAccountState, data) {
        handler(source, customerAccountState, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param customerAccountState - the current view that the customerAccount process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, customerAccountState, data) {
        var handlers = CaleresCustomerAccountContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, customerAccountState, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function SetCustomerAccountState - called by components to notify handlers that customerAccount state has changed
     * @param source - the event caller
     * @param customerAccountState - the current view that the customerAccount process is showing
     * @param data -Account data
     */
    CaleresCustomerAccountContext.SetCustomerAccountState = function (source, customerAccountState, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, customerAccountState, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresCustomerAccountContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresCustomerAccountContext.LastHandlerId);
        CaleresCustomerAccountContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresCustomerAccountContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresCustomerAccountContext.Handlers[handlerId]) {
            delete CaleresCustomerAccountContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
/**
 * @description Initializes the CustomerOrders broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/CustomerOrders', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresCustomerOrdersContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
            CustomerOrdersState: ""
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresCustomerOrdersContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresCustomerOrdersContext = getContext();
    root.CaleresCustomerOrdersContext = CaleresCustomerOrdersContext;
    factory(CaleresCustomerOrdersContext);

}(this, function (CaleresCustomerOrdersContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresCustomerOrdersContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param customerOrdersState - the current view that the customerOrders process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, customerOrdersState, data) {
        handler(source, customerOrdersState, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param customerOrdersState - the current view that the customerOrders process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, customerOrdersState, data) {
        var handlers = CaleresCustomerOrdersContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, customerOrdersState, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function SetCustomerOrdersState - called by components to notify handlers that customerOrders state has changed
     * @param source - the event caller
     * @param customerOrdersState - the current view that the customerOrders process is showing
     * @param data -orders data
     */
    CaleresCustomerOrdersContext.SetCustomerOrdersState = function (source, customerOrdersState, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, customerOrdersState, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresCustomerOrdersContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresCustomerOrdersContext.LastHandlerId);
        CaleresCustomerOrdersContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresCustomerOrdersContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresCustomerOrdersContext.Handlers[handlerId]) {
            delete CaleresCustomerOrdersContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
// https://stackoverflow.com/questions/8572826/generic-deep-diff-between-two-objects/31010495

window.deepDiffMapper = function () {
    return {
      VALUE_CREATED: 'created',
      VALUE_UPDATED: 'updated',
      VALUE_DELETED: 'deleted',
      VALUE_UNCHANGED: 'unchanged',
      map: function(obj1, obj2) {
        if (this.isFunction(obj1) || this.isFunction(obj2)) {
          throw 'Invalid argument. Function given, object expected.';
        }
        if (this.isValue(obj1) || this.isValue(obj2)) {
          return {
            type: this.compareValues(obj1, obj2),
            data: obj1 === undefined ? obj2 : obj1
          };
        }
  
        var diff = {};
        for (var key in obj1) {
          if (this.isFunction(obj1[key])) {
            continue;
          }
  
          var value2 = undefined;
          if (obj2[key] !== undefined) {
            value2 = obj2[key];
          }
  
          diff[key] = this.map(obj1[key], value2);
        }
        for (var key in obj2) {
          if (this.isFunction(obj2[key]) || diff[key] !== undefined) {
            continue;
          }
  
          diff[key] = this.map(undefined, obj2[key]);
        }
  
        return diff;
  
      },
      compareValues: function (value1, value2) {
        if (value1 === value2) {
          return this.VALUE_UNCHANGED;
        }
        if (this.isDate(value1) && this.isDate(value2) && value1.getTime() === value2.getTime()) {
          return this.VALUE_UNCHANGED;
        }
        if (value1 === undefined) {
          return this.VALUE_CREATED;
        }
        if (value2 === undefined) {
          return this.VALUE_DELETED;
        }
        return this.VALUE_UPDATED;
      },
      isFunction: function (x) {
        return Object.prototype.toString.call(x) === '[object Function]';
      },
      isArray: function (x) {
        return Object.prototype.toString.call(x) === '[object Array]';
      },
      isDate: function (x) {
        return Object.prototype.toString.call(x) === '[object Date]';
      },
      isObject: function (x) {
        return Object.prototype.toString.call(x) === '[object Object]';
      },
      isValue: function (x) {
        return !this.isObject(x) && !this.isArray(x);
      }
    }
  }();

// -----------------------------------------------------------------------
// <copyright file="cxa.services.dom.observer.js" company="Sitecore Corporation">
// Copyright (c) Sitecore Corporation 1999-2018
// </copyright>
// <summary>Provides a common tool</summary>
// -----------------------------------------------------------------------
// Copyright 2017-2018 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
  'use strict';
  var instance;

  if (typeof define === 'function' && define.amd) {
    // use AMD define funtion to support AMD modules if in use
    define('CXA/Common/DomObserver', ['exports'], factory);
  } else if (typeof exports === 'object') {
    // to support CommonJS
    factory(exports);
  }

  function createDomObserver() {
    var domObserver = {};

    return domObserver;
  }

  function getDomObserver() {
    if (!instance) {
      instance = createDomObserver();
    }
    return instance;
  }
  // browser global variable
  var DomObserver = getDomObserver();
  root.DomObserver = DomObserver;
  factory(DomObserver);
}(this, function (DomObserver) {
  'use strict';

  // https://dom.spec.whatwg.org/#mutation-observers
  // http://stackoverflow.com/questions/2844565/is-there-a-javascript-jquery-dom-change-listener
  // http://stackoverflow.com/questions/3219758/detect-changes-in-the-dom

  // -------------------- Service Public Functions ---------------------------------------------------------------------
  DomObserver.ObserveDomChanges = function (callback, targetNode, options) {
    if (!targetNode) {
      targetNode = document;
    }

    if (!options) {
      options = {
        subtree: true,
        attributes: false,
        childList: true
      };
    }

    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;

    var observer = new MutationObserver(function (mutations, observer) {
      if (callback) {
        callback();
      }
    });

    // define what element should be observed by the observer
    // and what types of mutations trigger the callback
    observer.observe(targetNode, options);

    return true;
  };
}));
/**
 * @description Models used by the login page Knockout views
 */

/**
 * @function CaleresLogin - initializes an instance of CaleresLogin
 * @param loginState - tells the broker which view to show
 */
var CaleresLogin = function(loginState) {
    var self = this;

    self.loginState = loginState;
}

/**
 * @function CaleresLoginSignInForm - initializes an instance of CaleresLoginSignInForm
 * @param userEmail
 * @param password
 */
var CaleresLoginSignInForm = function(userEmail, password) {
    var self = this;

    self.userEmail = userEmail;
    self.password = password;
}

/**
 * @function CaleresLoginForgotPassword - initializes an instance of CaleresLoginForgotPassword
 * @param userEmail
 */
var CaleresLoginForgotPassword = function(userEmail) {
    var self = this;

    self.userEmail = userEmail;
}

/**
 * @function CaleresLoginAccountLocked - initializes an instance of CaleresLoginAccountLocked
 * @param userEmail
 */
var CaleresLoginAccountLocked = function(userEmail) {
    var self = this;

    self.userEmail = userEmail;
}

/**
 * @function CaleresLoginEmailConfirmation - initializes an instance of CaleresLoginEmailConfirmation
 * @param userEmail
 */
var CaleresLoginEmailConfirmation = function(userEmail) {
    var self = this;

    self.userEmail = userEmail;
}
/**
 * @description Initializes the Product Login broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/Login', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresLoginContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
            LoginState: "",
            UserEmail: "",
            EmailState: ""
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresLoginContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresLoginContext = getContext();
    root.CaleresLoginContext = CaleresLoginContext;
    factory(CaleresLoginContext);

}(this, function (CaleresLoginContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresLoginContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param loginState - the current view that the login process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, loginState, data) {
        handler(source, loginState, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param loginState - the current view that the login process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, loginState, data) {
        var handlers = CaleresLoginContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, loginState, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function SetLoginState - called by components to notify handlers that login state has changed
     * @param source - the event caller
     * @param loginState - the current view that the login process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresLoginContext.SetLoginState = function (source, loginState, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, loginState, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresLoginContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresLoginContext.LastHandlerId);
        CaleresLoginContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresLoginContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresLoginContext.Handlers[handlerId]) {
            delete CaleresLoginContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };

    /**
     * @function GetErrorMessage - gets a login error message from the server
     * @param errorCode - error code of the error message
     * @param fallbackMessage - fallback error if there is an issue retrieving the error message
     * @param callback - function to call after receiving the error
     */
    CaleresLoginContext.GetErrorMessage = function(errorCode, fallbackMessage, callback) {
        $.ajax({
            method: "GET",
            url: "/api/calxa/account/getsystemmessage",
            data: {errorCode: errorCode}
        })
        .done(function(data) {
            if(data && data.Success) {
                MessageContext.PublishError("accountlogin", data.Message);
            }
            else {
                MessageContext.PublishError("accountlogin", fallbackMessage);
            }

            if(callback) {
                callback();
            }
        });
    };
}));
// -----------------------------------------------------------------------
// <copyright file="cxa.common.messaging.js" company="Sitecore Corporation">
// Copyright (c) Sitecore Corporation 1999-2018
// </copyright>
// <summary>Provides a common tool</summary>
// -----------------------------------------------------------------------
// Copyright 2017-2018 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
    'use strict';
    var instance;
  
    if (typeof define === 'function' && define.amd) {
      // use AMD define funtion to support AMD modules if in use
      define('CXA/Common/MessageContext', ['exports'], factory);
    } else if (typeof exports === 'object') {
      // to support CommonJS
      factory(exports);
    }
  
    function createContext() {
      var context = {
        Handlers: {}, // repsoitory to store message handlers
        LastHandlerId: -1, // last used handler Id, initialized to -1
        StandardChannels: { 
            Error: "standard.error", 
            Warning: "standard.warning", 
            Info: "standard.info", 
            Command: "standard.command",
            Default: "extended.default",
            Success: "extended.success"
        },
        StandardCommands: { ClearAll: "command.clearAll", ClearErrors: "command.clearErrors", ClearWarnings: "command.clearWarnings", ClearInfo: "command.clearInfo" }
      };
      return context;
    }
  
    function getContext() {
      if (!instance) {
        instance = createContext();
      }
      return instance;
    }
    // browser global variable
    var MessageContext = getContext();
    root.MessageContext = MessageContext;
    factory(MessageContext);
  }(this, function (MessageContext) {
    'use strict';
  
    function channelExists(channel) {
      return MessageContext.Handlers.hasOwnProperty(channel);
    }
  
    function registerChannel(channel) {
      if (!MessageContext.Handlers.hasOwnProperty(channel)) {
        MessageContext.Handlers[channel] = {};
      }
    }
  
    function hasHandlers(channel) {
      if (!channelExists) { return false; }
      var handlers = MessageContext.Handlers[channel];
      var handlerId;
      for (handlerId in handlers) {
        if (handlers.hasOwnProperty(handlerId)) {
          return true;
        }
      }
      return false;
    }
  
    function notifyHandler(source, handler, message, data) {
        handler(source,message, data);
    }

    function dispatch(source, channel, message, data) {
        var handlers = MessageContext.Handlers[channel];
        if (channelExists(channel)) {
            var handlerId;
            for (handlerId in handlers) {
                if (handlers.hasOwnProperty(handlerId)) {
                    notifyHandler(source, handlers[handlerId], message, data);
                }
            }
        }
    }
  
    // -------------------- Service Public Functions ---------------------------------------------------------------------
  
    MessageContext.PublishMessage = function (source, channel, message) {
      if (!hasHandlers(channel)) { return false; }
      var dispatchFunction = dispatch(source, channel, message);
      // run asyncronously
      setTimeout(dispatchFunction, 0);
      return true;
    };
  
    MessageContext.PublishCommand = function (source, command) {
      if (!hasHandlers(MessageContext.StandardChannels.Command)) { return false; }
      var dispatchFunction = dispatch(source, MessageContext.StandardChannels.Command, command);
      // run asyncronously
      setTimeout(dispatchFunction, 0);
      return true;
    };
  
    MessageContext.PublishError = function (source, message, data) {
      if (!hasHandlers(MessageContext.StandardChannels.Error)) { return false; }
      var dispatchFunction = dispatch(source, MessageContext.StandardChannels.Error, message);
      // run asyncronously
      setTimeout(dispatchFunction, 0);
      return true;
    };
  
    MessageContext.PublishWarning = function (source, message, data) {
      if (!hasHandlers(MessageContext.StandardChannels.Warning)) { return false; }
      var dispatchFunction = dispatch(source, MessageContext.StandardChannels.Warning, message, data);
      // run asyncronously
      setTimeout(dispatchFunction, 0);
      return true;
    };
  
    MessageContext.PublishInfo = function (source, message, data) {
      if (!hasHandlers(MessageContext.StandardChannels.Info)) { return false; }
      var dispatchFunction = dispatch(source, MessageContext.StandardChannels.Info, message, data);
      // run asyncronously
      setTimeout(dispatchFunction, 0);
      return true;
    };

    MessageContext.PublishSuccess = function (source, message, data) {
        if (!hasHandlers(MessageContext.StandardChannels.Success)) { return false; }
        var dispatchFunction = dispatch(source, MessageContext.StandardChannels.Success, message, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    MessageContext.PublishDefault = function (source, message, data) {
        if (!hasHandlers(MessageContext.StandardChannels.Default)) { return false; }
        var dispatchFunction = dispatch(source, MessageContext.StandardChannels.Default, message, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };
  
    MessageContext.SubscribeMessageHandler = function (channel, handler) {
      if (typeof handler !== 'function') {
        return false;
      }
  
      registerChannel(channel);
      var newHandlerId = 'h_' + String(++MessageContext.LastHandlerId);
      MessageContext.Handlers[channel][newHandlerId] = handler;
  
      return newHandlerId;
    };
  
    MessageContext.SubscribeErrorHandler = function (handler) {
      if (typeof handler !== 'function') {
        return false;
      }
      var channel = MessageContext.StandardChannels.Error;
      registerChannel(channel);
      var newHandlerId = 'h_' + String(++MessageContext.LastHandlerId);
      MessageContext.Handlers[channel][newHandlerId] = handler;
  
      return newHandlerId;
    };
  
    MessageContext.SubscribeInfoHandler = function (handler) {
      if (typeof handler !== 'function') {
        return false;
      }
      var channel = MessageContext.StandardChannels.Info;
      registerChannel(channel);
      var newHandlerId = 'h_' + String(++MessageContext.LastHandlerId);
      MessageContext.Handlers[channel][newHandlerId] = handler;
  
      return newHandlerId;
    };
  
    MessageContext.SubscribeWarningHandler = function (handler) {
      if (typeof handler !== 'function') {
        return false;
      }
      var channel = MessageContext.StandardChannels.Warning;
      registerChannel(channel);
      var newHandlerId = 'h_' + String(++MessageContext.LastHandlerId);
      MessageContext.Handlers[channel][newHandlerId] = handler;
  
      return newHandlerId;
    };
  
    MessageContext.SubscribeCommandHandler = function (handler) {
      if (typeof handler !== 'function') {
        return false;
      }
      var channel = MessageContext.StandardChannels.Command;
      registerChannel(channel);
      var newHandlerId = 'h_' + String(++MessageContext.LastHandlerId);
      MessageContext.Handlers[channel][newHandlerId] = handler;
  
      return newHandlerId;
    };
  
    MessageContext.UnSubscribeHandler = function (handlerId) {
      for (var channel in MessageContext.Handlers) {
        if (MessageContext.Handlers.hasOwnProperty(channel)) {
          var channelHandlers = MessageContext.Handlers[channel];
          if (channelHandlers[handlerId]) {
            delete channelHandlers[handlerId];
            return handlerId;
          }
        }
      }
  
      return null;
    };
  
    // sends a clearAll command to all components that have subscribed to MessageContext.StandardChannels.Command channel
    MessageContext.ClearAllMessages = function () {
      MessageContext.PublishCommand(this, MessageContext.StandardCommands.ClearAll);
    };

    MessageContext.retrieveStoredMessages = function(storageName) {
        var storageItem = sessionStorage.getItem(storageName);
        if(storageItem) {
            return JSON.parse(storageItem);
        }

        return new Array();
    };

    MessageContext.storeMessages = function(storageName, messageArray) {
        sessionStorage.setItem(storageName, JSON.stringify(messageArray));
    };

    MessageContext.clearStoredMessages = function(storageName) {
        sessionStorage.removeItem(storageName);
    }

    MessageContext.PublishMessageDeferred = function (source, channel, message, data) {
        var storageName = "MessagesDeferred_" + channel;
        var messages = MessageContext.retrieveStoredMessages(storageName);
        
        var message = {
            source: source,
            message: message,
            data: data
        };

        messages.push(message);
        MessageContext.storeMessages(storageName, messages);
    };

    MessageContext.PublishSuccessDeferred = function (source, message, data) {
        MessageContext.PublishMessageDeferred(source, MessageContext.StandardChannels.Success, message, data);
        return true;
    };

    MessageContext.PublishDefaultDeferred = function (source, message, data) {
        MessageContext.PublishMessageDeferred(source, MessageContext.StandardChannels.Default, message, data);
        return true;
    };

    MessageContext.PublishErrorDeferred = function (source, message, data) {
        MessageContext.PublishMessageDeferred(source, MessageContext.StandardChannels.Error, message, data);
        return true;
    };

    MessageContext.PublishWarningDeferred = function (source, message, data) {
        MessageContext.PublishMessageDeferred(source, MessageContext.StandardChannels.Warning, message, data);
        return true;
    };

    MessageContext.PublishInfoDeferred = function (source, message, data) {
        MessageContext.PublishMessageDeferred(source, MessageContext.StandardChannels.Info, message, data);
        return true;
    };

    MessageContext.PublishDeferredMessages = function (channel) {
        var storageName = "MessagesDeferred_" + channel;
        var messages = MessageContext.retrieveStoredMessages(storageName);
        for(var i = 0; i < messages.length; i++) {
            var message = messages[i];
            window.setTimeout(function() {
                MessageContext.PublishMessage(message.source, channel, message.message, message.data);
            }, 0);
            
        }
        MessageContext.clearStoredMessages(storageName);
    }
  }));

  window.addEventListener("load", function(event) {
    MessageContext.PublishDeferredMessages(MessageContext.StandardChannels.Success);
    MessageContext.PublishDeferredMessages(MessageContext.StandardChannels.Default);
    MessageContext.PublishDeferredMessages(MessageContext.StandardChannels.Error);
    MessageContext.PublishDeferredMessages(MessageContext.StandardChannels.Warning);
    MessageContext.PublishDeferredMessages(MessageContext.StandardChannels.Info);
});
/**
 * @description Initializes the Mobile App Broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/MobileAppBroker', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresMobileAppContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresMobileAppContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresMobileAppContext = getContext();
    root.CaleresMobileAppContext = CaleresMobileAppContext;
    factory(CaleresMobileAppContext);

}(this, function (CaleresMobileAppContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresMobileAppContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param channel - string: channel to distinguish groups of messages
     * @param data - broker event data
     */
    function notifyHandler(handler, source, channel, data) {
        handler(source, channel, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param channel - string: channel to distinguish groups of messages
     * @param data - broker event data
     */
    function dispatch(source, channel, data) {
        var handlers = CaleresMobileAppContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, channel, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function SendMobileAppData - called by components to send mobile app related data
     * @param source - the event caller
     * @param channel - string: channel to distinguish groups of messages
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresMobileAppContext.SendMobileAppData = function (source, channel, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, channel, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresMobileAppContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresMobileAppContext.LastHandlerId);
        CaleresMobileAppContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresMobileAppContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresMobileAppContext.Handlers[handlerId]) {
            delete CaleresMobileAppContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
const MOCK_ORDER = {
    "Errors": [],
    "Info": [],
    "Warnings": [],
    "HasErrors": false,
    "HasInfo": false,
    "HasWarnings": false,
    "Success": true,
    "Url": null,
    "ContentEncoding": null,
    "ContentType": null,
    "Data": {
      "HistoryItems": [
        {
          "Order": {
            "OrderStatus": "Processed",
            "OrderType": "STORE",
            "OrderNumber": "3377-20181227-2-4503",
            "OnlineOrderNumber": "123456788912",
            "OrderShippingTotal": 0,
            "OrderTotal": 24.99,
            "OrderSubtotal": 0,
            "OrderTaxableAmount": 0,
            "OrderTax": 0,
            "TransactionDate": "2018-12-27 00:00:00.0",
            "TransactionId": "432565886",
            "LineItems": [
              {
                "CompanyId": "350",
                "ProductId": "91829",
                "ImageUrl": "https://calapp.ff.ffbs.net/mobile/images/kermit.gif",
                "ProductName": "Women's Benassi JDI Slide Sandal",
                "Brand": "Nike",
                "Color": "Black",
                "Size": "08.0M",
                "Price": -24.99,
                "DisplaySize": "8.0",
                "DisplayWidth": "M",
                "NumericSize": "08.0",
                "NumericWidth": "5",
                "Type": "SALE",
                "ShippingTrackingNumber": "0",
                "LineNumber": 1,
                "ItemFoundOnHost": true,
                "PriceWithCurrency": "$24.99"
              },
              {
                "CompanyId": "350",
                "ProductId": "91829",
                "ImageUrl": "https://calapp.ff.ffbs.net/mobile/images/kermit.gif",
                "ProductName": "Women's Benassi JDI Slide Sandal",
                "Brand": "Nike",
                "Color": "Black",
                "Size": "08.0M",
                "Price": -24.99,
                "DisplaySize": "8.0",
                "DisplayWidth": "M",
                "NumericSize": "08.0",
                "NumericWidth": "5",
                "Type": "SALE",
                "ShippingTrackingNumber": "0",
                "LineNumber": 1,
                "ItemFoundOnHost": true,
                "PriceWithCurrency": "$24.99"
              }
            ],
            "Shipping": {
              "Address": {
                "FirstName": null,
                "LastName": null,
                "AddressLine1": null,
                "AddressLine2": null,
                "PhoneNumber": null,
                "City": null,
                "State": null,
                "ZipCode": null,
                "Country": null
              },
              "ShippingMethod": "",
              "GiftNote": ""
            },
            "Billing": {
              "Address": {
                "FirstName": "Devlin",
                "LastName": "Downson",
                "AddressLine1": "404 Cannot Connect W.",
                "AddressLine2": "Apt 2B",
                "PhoneNumber": "501-404-0000",
                "City": "Sain Louis",
                "State": "MO",
                "ZipCode": "63404",
                "Country": "Amurca"
              },
              "PaymentMethods": [
                {
                  "Type": "CreditCard",
                  "AmountRaw": "",
                  "CreditCardType": "VISA",
                  "CreditCardLastFourDigits": "1234",
                  "Amount": 420.00,
                  "AmountWithCurrency": "$420.00"
                }
              ]
            },
            "Rewards": {
              "Points": 25,
              "Type": "",
              "TransactionDate": "2018-12-27 00:00:00.0",
              "DatePointsPosted": "2018-12-27 20:04:00.0",
              "Amount": 0
            },
            "Store": {
              "StoreNumber": "3377",
              "StorePhone": "7183792107",
              "Address": {
                "FirstName": null,
                "LastName": null,
                "AddressLine1": "THE MALL AT BAY PLAZA",
                "AddressLine2": "200 BAYCHESTER AVENUE",
                "PhoneNumber": null,
                "City": "BRONX",
                "State": "NY",
                "ZipCode": "10475",
                "Country": null
              }
            },
            "Discounts": [
              {
                "Type": "Coupon",
                "OnlinePromoCode": "P0518361",
                "CouponNumber": "910050664964",
                "Amount": 5,
                "CouponFoundOnHost": true,
                "CouponDescription": "$5 off POS offer",
                "CouponType": 1,
                "PromoDescription": "$5 off POS Offer",
                "AmountWithCurrency": "$5.00"
              }
            ],
            "OrderShippingTotalWithCurrency": "$0.00",
            "OrderTotalWithCurrency": "$24.99",
            "OrderSubtotalWithCurrency": "$0.00",
            "OrderTaxableAmountWithCurrency": "$0.00",
            "OrderTaxWithCurrency": "$0.00",
            "OrderDetailsLink": "/tests/pages/DrewTay/ShippingAddress?orderNumber=",
            "ReturnOrderLink": "/tests/pages/DrewTay/ShippingAddress?orderNumber="
          },
          "Rewards": null,
          "Type": "order"
        }
      ]
    },
  };

const MOCK_ORDER_DETAILS = {
  "Errors": [],
  "HasErrors": false,
  "HasInfo": false,
  "HasWarnings": false,
  "Info": [],
  "Success": true,
  "Url": null,
  "Warnings": [],
  "ContentEncoding": null,
  "ContentType": null,
  "Data": {
    "HistoryItems": [
      {
        "Order": {
          "OrderStatus": "Processing",
          "OrderType": "WEB",
          "OrderNumber": "20023-20190925-96-400",
          "OnlineOrderNumber": "003100000382",
          "OrderShippingTotal": 21,
          "OrderTotal": 271.57,
          "OrderSubtotal": 237,
          "OrderTaxableAmount": 237,
          "OrderTax": 13.57,
          "TransactionDateRaw": "2019-09-25 00:00:00.0",
          "TransactionDate": "09/25/2019",
          "TransactionId": "1",
          "LineItems": [
            {
              "CompanyId": "403",
              "ProductId": "22350",
              "ImageUrl": "/blob/product-images/20023/22/35/0/22350_right_small.jpg",
              "ProductName": "Women's Boomerang Tall Shaft Boot",
              "Brand": "Bzees",
              "Color": "Black Microfiber",
              "Size": "8.0W",
              "Price": 99,
              "DisplaySize": "8.0",
              "DisplayWidth": "W",
              "NumericSize": "8.0",
              "NumericWidth": "7",
              "Type": "SALE",
              "ShippingTrackingNumber": "",
              "LineNumber": 1,
              "ItemFoundOnHost": true,
              "PriceWithCurrency": "$99.00",
              "IsReturn": false
            },
            {
              "CompanyId": "403",
              "ProductId": "22384",
              "ImageUrl": "/blob/product-images/20023/22/38/4/22384_right_small.jpg",
              "ProductName": "Women's Willow Pump",
              "Brand": "Bzees",
              "Color": "Black Ribbed Knit",
              "Size": "8.0W",
              "Price": 69,
              "DisplaySize": "8.0",
              "DisplayWidth": "W",
              "NumericSize": "8.0",
              "NumericWidth": "7",
              "Type": "SALE",
              "ShippingTrackingNumber": "",
              "LineNumber": 2,
              "ItemFoundOnHost": true,
              "PriceWithCurrency": "$69.00",
              "IsReturn": false
            },
            {
              "CompanyId": "403",
              "ProductId": "22384",
              "ImageUrl": "/blob/product-images/20023/22/38/4/22384_right_small.jpg",
              "ProductName": "Women's Willow Pump",
              "Brand": "Bzees",
              "Color": "Black Ribbed Knit",
              "Size": "8.0W",
              "Price": 69,
              "DisplaySize": "8.0",
              "DisplayWidth": "W",
              "NumericSize": "8.0",
              "NumericWidth": "7",
              "Type": "SALE",
              "ShippingTrackingNumber": "",
              "LineNumber": 3,
              "ItemFoundOnHost": true,
              "PriceWithCurrency": "$69.00",
              "IsReturn": false
            }
          ],
          "Shipping": {
            "Address": {
              "FirstName": "Amy",
              "LastName": "Becker",
              "AddressLine1": "8300 Maryland Ave",
              "AddressLine2": "",
              "PhoneNumber": "",
              "City": "Clayton",
              "State": "MO",
              "ZipCode": "63105",
              "Country": "US"
            },
            "ShippingMethod": "2ND DAY AIR",
            "GiftNote": ""
          },
          "Billing": {
            "Address": {
              "FirstName": "Amy",
              "LastName": "Becker",
              "AddressLine1": "8300 Maryland Ave",
              "AddressLine2": "",
              "PhoneNumber": null,
              "City": "Clayton",
              "State": "MO",
              "ZipCode": "63105",
              "Country": "US"
            },
            "PaymentMethods": [
              {
                "Type": "CreditCard",
                "AmountRaw": "271.57",
                "CreditCardType": "Visa",
                "ExpirationDateRaw": null,
                "ExpirationDate": "",
                "CreditCardLastFourDigits": "1111",
                "Amount": 271.57,
                "AmountWithCurrency": "$271.57"
              }
            ]
          },
          "Rewards": null,
          "Store": null,
          "Discounts": [
            {
              "Type": "",
              "OnlinePromoCode": "",
              "CouponNumber": "",
              "Amount": null,
              "CouponFoundOnHost": false,
              "CouponDescription": "",
              "CouponType": "",
              "PromoDescription": "",
              "AmountWithCurrency": "$0.00"
            }
          ],
          "OrderShippingTotalWithCurrency": "$21.00",
          "OrderTotalWithCurrency": "$271.57",
          "OrderSubtotalWithCurrency": "$237.00",
          "OrderTaxableAmountWithCurrency": "$237.00",
          "OrderTaxWithCurrency": "$13.57",
          "OrderDiscountTotalWithCurrency": "$0.00",
          "OrderGiftCardTotalWithCurrency": "$0.00"
        },
        "Rewards": {
          "Points": 0,
          "Type": null,
          "TransactionDateRaw": null,
          "TransactionDate": "",
          "DatePointsPostedRaw": null,
          "DatePointsPosted": "",
          "Amount": 0
        },
        "Type": "order",
        "TransactionDate": "/Date(1569387600000)/",
        "OnlineOrderNumber": "003100000382"
      }
    ],
    "AlternateKey": "",
    "EmailAddress": "abecker@caleres.com",
    "CustomerNo": "9985167890",
    "CustomerId": "56428747",
    "MinPostedDateRaw": "2017-10-07 00:00:00.0",
    "MinPostedDate": "10/07/2017",
    "PostalCode": "63105"
  },
  "JsonRequestBehavior": 1,
  "MaxJsonLength": null,
  "RecursionLimit": null
};

const MOCK_LOYALTY_OFFERS = {
    "CustomerId": "160778203",
    "AvailablePoints": "4673",
    "UsableCertificates": [
      {
        "Amount": 10,
        "CertificateTitle": "10 Birthday Certificate",
        "CouponNumber": "910100781252",
        "ExpirationDate": "6/16/2030",
        "ImageUrl": "",
        "LoyaltyCertificateType": "Birthday",
        "PromoCode": "W1020107"
      },
      {
        "Amount": 5,
        "CertificateTitle": "5 Loyalty Certificate",
        "CouponNumber": "910050777695",
        "ExpirationDate": "6/16/2030",
        "ImageUrl": "",
        "LoyaltyCertificateType": "Regular",
        "PromoCode": "W0520117"
      }
    ],
    "UsableOffers": [
      {
          "Amount": "50.00",
          "PromoCode": "FRHP2020",
          "CampaignCode": [],
          "CouponNumber": "920500809746",
          "ExpirationDate": "2020-12-31 23:59:59.0",
          "IssuedDate": [],
          "ActivationDate": []
      },
      {
          "Amount": "3.00",
          "PromoCode": "PPD32020",
          "CampaignCode": [],
          "CouponNumber": "960030809731",
          "ExpirationDate": "2020-12-31 23:59:59.0",
          "IssuedDate": [],
          "ActivationDate": []
      },
      {
          "Amount": "2.00",
          "PromoCode": "PPD22020",
          "CampaignCode": [],
          "CouponNumber": "960020809727",
          "ExpirationDate": "2020-12-31 23:59:59.0",
          "IssuedDate": [],
          "ActivationDate": []
      }
    ],
    "IssuableRewardsCertificates": [
      {
          "Amount": "5.00",
          "Points": "100",
          "Eligibility": "Eligible"
      },
      {
          "Amount": "10.00",
          "Points": "200",
          "Eligibility": "Eligible"
      },
      {
          "Amount": "15.00",
          "Points": "300",
          "Eligibility": "Eligible"
      },
      {
          "Amount": "20.00",
          "Points": "400",
          "Eligibility": "Eligible"
      },
      {
          "Amount": "25.00",
          "Points": "500",
          "Eligibility": "Eligible"
      },
      {
          "Amount": "50.00",
          "Points": "1000",
          "Eligibility": "Eligible"
      },
      {
          "Amount": "75.00",
          "Points": "1500",
          "Eligibility": "Eligible"
      }
    ]
};
const MOCK_GET_LOYALTY_CERTS = {
  "CreateCertificateImageUrl": "/-/media/project/tenant/famous-footwear/famous-footwear/rewards-images/create-cash.svg",
  "CertificateEmptyStateImageUrl": "/-/media/project/tenant/famous-footwear/famous-footwear/rewards-images/empty.svg",
  "MemberNumber": "6300983242",
  "UsableCertificates": [
    {
      "CertificateTitle": "5 Welcome Cash",
      "LoyaltyCertificateType": "Welcome",
      "Amount": 5,
      "PromoCode": "WA20127",
      "CouponNumber": "910050814765",
      "ExpirationDate": "12/31/2020",
      "ImageUrl": "/-/media/project/tenant/famous-footwear/famous-footwear/rewards-images/5-bonus-reward-cash.svg"
    }
  ],
  "UsableOffers": [
    {
      "OfferTitle": "Earn 3X Bonus Points",
      "LoyaltyOfferType": 2,
      "OfferType": "PointsMultiplier",
      "PromoCode": "PPD32020",
      "CouponNumber": "960030134178",
      "ExpirationDate": "11/9/2020",
      "Amount": 3,
      "OfferDescription": "",
      "ActivationDate": ""
    },
    {
      "OfferTitle": "Extra BOGO 50% Off",
      "LoyaltyOfferType": 1,
      "OfferType": "PickYourOwnBogo",
      "PromoCode": "FRHP2020",
      "CouponNumber": "920500134152",
      "ExpirationDate": "12/31/2020",
      "Amount": 50,
      "OfferDescription": "Text",
      "ActivationDate": ""
    },
    {
      "OfferTitle": "Earn 2X Bonus Points",
      "LoyaltyOfferType": 2,
      "OfferType": "PointsMultiplier",
      "PromoCode": "PPD22020",
      "CouponNumber": "960020134164",
      "ExpirationDate": "12/31/2020",
      "Amount": 2,
      "OfferDescription": "",
      "ActivationDate": ""
    }
  ],
  "IssuableCertificates": [
    {
      "Amount": "5.00",
      "PointsRequired": 100
    },
    {
      "Amount": "10.00",
      "PointsRequired": 200
    },
    {
      "Amount": "15.00",
      "PointsRequired": 300
    },
    {
      "Amount": "20.00",
      "PointsRequired": 400
    },
    {
      "Amount": "25.00",
      "PointsRequired": 500
    },
    {
      "Amount": "50.00",
      "PointsRequired": 1000
    }
  ],
  "Errors": [],
  "HasErrors": false,
  "HasInfo": false,
  "HasWarnings": false,
  "Info": [],
  "Success": true,
  "Url": null,
  "Warnings": [],
  "ContentEncoding": null,
  "ContentType": null,
  "Data": null,
  "JsonRequestBehavior": 1,
  "MaxJsonLength": null,
  "RecursionLimit": null
};
/**
 * @description Models used by the product detail page Knockout views
 */

 /**
 * @function CaleresProduct - initializes an instance of CaleresProduct
 */
var CaleresProduct = function() {
    var self = this;
    self.isLoaded = false;
    self.productId = "";
    self.productGroupId = "";
    self.fullProductGroupId = "";
    self.isSelected = ko.observable(false);
    self.productName = "";
    self.productDescription = "";
    self.listPrice = "";
    self.adjustedPrice = "";
    self.savingsPercent = "";
    self.savingsAmount = "";
    self.listPriceNumeric = "";
    self.adjustedPriceNumeric = 0;
    self.savingsAmountNumeric = 0;
    self.isOnSale = "";
    self.productUri = "";
    self.itemNumber = "";
    self.brand = "";
    self.productColor = "";
    self.primaryColor = ko.observable("");
    self.isWhite = false;
    self.heelHeight = "";
    self.customerRating = 0;
    self.hasCustomerRating = false;
    self.webGender = "";
    self.webDepartment = "";
    self.typeOfGood = "";
    self.secondaryCategory = "";
    self.tertiaryCategory = "";
    self.isPromoExcluded = false;
    self.seePriceInCart = false;
    self.productGroupImage;
    self.productSwatchImage;
    self.productImages = [];
    self.productVariants = [];
    self.variantDefinitions = [];
    self.variantDefinitionLabels = [];
    self.variantDefinitionSelectLabels = [];
    self.isInStock = false;
    self.isOutOfStock = false;
    self.isPreorderable = false;
    self.isBackorderable = false;
    self.isBopisEligible = false;
    self.isFinalSale = false;
    self.productBadges = [];
    self.productBrand = [];
    self.hasError = ko.observable(false);
};

 /**
 * @function CaleresProductVariant - initializes an instance of CaleresProductVariant
 */
var CaleresProductVariant = function() {
    var self = this;

    self.productId = "";
    self.variantId = "";
    self.variantName = "";
    self.listPrice = "";
    self.adjustedPrice = "";
    self.savingsPercent = "";
    self.savingsAmount = "";
    self.isOnSale = "";
    self.upc = "";
    self.stockCount = 0;
    self.adjustedPriceNumeric = 0;
    self.listPriceNumeric = 0;
    self.variantValues = [];
    self.sizeString = "";
    self.variantSizeString = "";
    self.stockStatus = "";
    self.availabilityDate = "";
    self.hasLowInventory = false;
    self.isPreorderable = false;
    self.isBackorderable = false;
    self.isSelected = ko.observable(false);
    self.hasSizeType = "";
    self.sizeTypeValues = "";
    self.sizeTypeMappingString = "";

    self.webGenderValues = "";
    self.webGenderMappingString = "";
    self.sizeSubText = "";
};

/**
 * @function CaleresVariantValue - initializes an instance of CaleresVariantValue
 * @param propertyName
 * @param propertyValue
 * @param orderBy
 */
var CaleresVariantValue = function (propertyName, propertyValue, orderBy) {
    var self = this;
    self.propertyName = propertyName;
    self.propertyValue = propertyValue;
    self.orderBy = orderBy;
};

 /**
 * @function CaleresProductImage - initializes an instance of CaleresProductImage
 * @param imageUrl
 * @param imageAngle
 * @param imageType
 * @param productName
 * @param isVideo
 */
var CaleresProductImage = function(imageUrl, imageAngle, imageType, productName, isVideo) {
    var self = this;

    self.imageUrl = imageUrl;
    self.imageAngle = imageAngle;
    self.imageType = imageType;
    self.productName = productName;
    self.altTag = productName + ' - ' + imageAngle;
    self.isVideo = ko.observable(isVideo);
    self.resizedProductImages = new Array();
    self.isSelected = ko.observable(false);
    self.isYouTubeVideo = ko.observable(false);
    self.isVimeoVideo = ko.observable(false);
    self.isMp4Video = ko.observable(false);
    self.isEmbeddedVideo = ko.observable(false);
    self.embeddedVideoId = "";
    self.videoThumbnail = ko.observable('');
    self.getVideoUrl = function() {
        if(!self.isEmbeddedVideo() || !self.embeddedVideoId) {
            return self.imageUrl;
        }
        if(self.isYouTubeVideo()) {
            return '//www.youtube.com/embed/' + self.embeddedVideoId + '?enablejsapi=1';
        }
        else {
            return '//player.vimeo.com/video/' + self.embeddedVideoId;
        }
    };

    self.hasThumbnail = ko.computed(function() {
        return this.videoThumbnail() !== null && this.videoThumbnail() !== '';
    }, self);

    self.initVideo = function(videoThumbnail) {
        if(videoThumbnail) {
            var thumbnailUrl = videoThumbnail.imageUrl;
            videoThumbnail.resizedProductImages.forEach(function(resizedImage) {
                if(resizedImage.imagePreset === PRODUCT_IMAGES.IMAGE_PRESETS.Large) {
                    thumbnailUrl = resizedImage.imageUrl;
                }
            });

            self.videoThumbnail(thumbnailUrl);
            return;
        }

        if(!self.isEmbeddedVideo() || !self.embeddedVideoId) {
            return;
        }

        if(self.isYouTubeVideo()) {
            self.videoThumbnail('//img.youtube.com/vi/' + self.embeddedVideoId + '/0.jpg');
        }
        else {
            $.getJSON('https://www.vimeo.com/api/v2/video/' + self.embeddedVideoId + '.json?callback=?', { format: "json" }, function (data) {
                var featuredImg = data[0].thumbnail_large;
                self.videoThumbnail(featuredImg);
                document.dispatchEvent(new Event("vimeo-thumbnail-loaded"));
            });
        }
    };
};

/**
 * @function CaleresResizedProductImage - initializes an instance of CaleresProductImage
 * @param imageUrl
 * @param imageAngle
 * @param imagePreset
 * @param imageType
 * @param productName
 */
var CaleresResizedProductImage = function(imageUrl, imageAngle, imagePreset, imageType, productName) {
    var self = this;

    self.imageUrl = imageUrl;
    self.imagePreset = imagePreset;
    self.imageAngle = imageAngle;
    self.imageType = imageType;
    self.productName = productName;
    self.altTag = productName + ' - ' + imageAngle;
    self.isSelected = ko.observable(false);
};

 /**
 * @function CaleresProductBadge - initializes an instance of CaleresProductBadge
 * @param badgeName
 * @param badgeImageUrl
 * @param badgeImageAlt
 */
var CaleresProductBadge = function(badgeName, badgeImageUrl, badgeImageAlt) {
    var self = this;

    self.badgeName = badgeName;
    self.badgeImageUrl = badgeImageUrl;
    self.badgeImageAlt = badgeImageAlt;
}

 /**
 * @function CaleresProductBrand - initializes an instance of CaleresProductBrand
 * @param brandDisplayName
 * @param brandImageUrl
 * @param brandPageUrl
 */
var CaleresProductBrand = function(brandDisplayName, brandImageUrl, brandPageUrl) {
    var self = this;

    self.brandDisplayName = brandDisplayName;
    self.brandImageUrl = brandImageUrl;
    self.brandPageUrl = brandPageUrl;
}

const PRODUCT_IMAGES = {
    IMAGE_PRESETS: {
        Feed1000: 'Feed1000',
        Feed351: 'Feed351',
        Feed660w: 'Feed660w',
        Feed800: 'Feed800',
        Large: 'Large',
        Medium: 'Medium',
        Small: 'Small',
        XLarge: 'XLarge',
        XSmall: 'XSmall',
    }
};
/**
 * @description Initializes the Product Badge broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define function to support AMD modules if in use
        define('Caleres/Common/ProductBadge', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresProductBadgeContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
        };
        return context;
    }

    /**
     * @function getContext - gets the CaleresProductBadgeContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresProductBadgeContext = getContext();
    root.CaleresProductBadgeContext = CaleresProductBadgeContext;
    factory(CaleresProductBadgeContext);

}(this, function (CaleresProductBadgeContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresProductBadgeContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productBadges - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, productBadges, data) {
        handler(source, productBadges, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productBadges - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, productBadges, data) {
        var handlers = CaleresProductBadgeContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, productBadges, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------

    /**
     * @function SetBadges - called by components to notify handlers that product badges have changed
     * @param source - the event caller
     * @param productBadges - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductBadgeContext.SetBadges = function (source, productBadges, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, productBadges, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresProductBadgeContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresProductBadgeContext.LastHandlerId);
        CaleresProductBadgeContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresProductBadgeContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresProductBadgeContext.Handlers[handlerId]) {
            delete CaleresProductBadgeContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
/**
 * @description Initializes the Product Brand broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define function to support AMD modules if in use
        define('Caleres/Common/ProductBrand', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresProductBrandContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
        };
        return context;
    }

    /**
     * @function getContext - gets the CaleresProductBrandContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresProductBrandContext = getContext();
    root.CaleresProductBrandContext = CaleresProductBrandContext;
    factory(CaleresProductBrandContext);

}(this, function (CaleresProductBrandContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresProductBrandContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productBrand - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, productBrand, data) {
        handler(source, productBrand, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productBrand - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, productBrand, data) {
        var handlers = CaleresProductBrandContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, productBrand, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------

    /**
     * @function SetBrand - called by components to notify handlers that product brands have changed
     * @param source - the event caller
     * @param productBrand - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductBrandContext.SetBrand = function (source, productBrand, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, productBrand, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresProductBrandContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresProductBrandContext.LastHandlerId);
        CaleresProductBrandContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresProductBrandContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresProductBrandContext.Handlers[handlerId]) {
            delete CaleresProductBrandContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
/**
 * @description Initializes the Product Images broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define function to support AMD modules if in use
        define('Caleres/Common/ProductImages', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresProductImagesContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresProductImagesContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresProductImagesContext = getContext();
    root.CaleresProductImagesContext = CaleresProductImagesContext;
    factory(CaleresProductImagesContext);

}(this, function (CaleresProductImagesContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresProductImagesContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productImages - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, productImages, data) {
        handler(source, productImages, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productImages - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, productImages, data) {
        var handlers = CaleresProductImagesContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, productImages, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------

    /**
     * @function SetImages - called by components to notify handlers that product images have changed
     * @param source - the event caller
     * @param productImages - an array of new product images to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductImagesContext.SetImages = function (source, productImages, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, productImages, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresProductImagesContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresProductImagesContext.LastHandlerId);
        CaleresProductImagesContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresProductImagesContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresProductImagesContext.Handlers[handlerId]) {
            delete CaleresProductImagesContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
/**
 * @description Initializes the Product Info broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define function to support AMD modules if in use
        define('Caleres/Common/ProductInfo', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresProductInformationContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresProductInformationContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }
    // browser global variable
    var CaleresProductInformationContext = getContext();
    root.CaleresProductInformationContext = CaleresProductInformationContext;
    factory(CaleresProductInformationContext);

}(this, function (CaleresProductInformationContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresProductInformationContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productName
     * @param productDescription
     * @param itemNumber
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, productName, productDescription, itemNumber, data) {
        handler(source, productName, productDescription, itemNumber, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productName
     * @param productDescription
     * @param itemNumber
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, productName, productDescription, itemNumber, data) {
        var handlers = CaleresProductInformationContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, productName, productDescription, itemNumber, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function SetInformation - called by components to notify handlers that product images have changed
     * @param source - the event caller
     * @param productName
     * @param productDescription
     * @param itemNumber
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductInformationContext.SetInformation = function (source, productName, productDescription, itemNumber, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, productName, productDescription, itemNumber, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresProductInformationContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresProductInformationContext.LastHandlerId);
        CaleresProductInformationContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresProductInformationContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresProductInformationContext.Handlers[handlerId]) {
            delete CaleresProductInformationContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
/**
 * @description Initializes the Product Price broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/ProductPrice', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresProductPriceContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
            Price: ""
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresProductPriceContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresProductPriceContext = getContext();
    root.CaleresProductPriceContext = CaleresProductPriceContext;
    factory(CaleresProductPriceContext);

}(this, function (CaleresProductPriceContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresProductPriceContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param priceBefore - product list price
     * @param priceNow - product sale price
     * @param isOnSale - displays if product is on sale
     * @param savingsPercent - percentage saved off of list price
     * @param savingsAmount - amount saved off of list price
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, priceBefore, price, isOnSale, savingsPercent, savingsAmount, data) {
        handler(source, priceBefore, price, isOnSale , savingsPercent, savingsAmount, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param priceBefore - product list price
     * @param priceNow - product sale price
     * @param isOnSale - displays if product is on sale
     * @param savingsPercent - percentage saved off of list price
     * @param savingsAmount - amount saved off of list price
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, priceBefore, price, isOnSale, savingsPercent, savingsAmount, data) {
        var handlers = CaleresProductPriceContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, priceBefore, price, isOnSale, savingsPercent, savingsAmount, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function SetPrice - called by components to notify handlers that product price has changed
     * @param source - the event caller
     * @param priceBefore - product list price
     * @param priceNow - product sale price
     * @param isOnSale - displays if product is on sale
     * @param savingsPercent - percentage saved off of list price
     * @param savingsAmount - amount saved off of list price
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductPriceContext.SetPrice = function (source, priceBefore, price, isOnSale, savingsPercent, savingsAmount, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, priceBefore, price, isOnSale, savingsPercent, savingsAmount, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresProductPriceContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresProductPriceContext.LastHandlerId);
        CaleresProductPriceContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresProductPriceContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresProductPriceContext.Handlers[handlerId]) {
            delete CaleresProductPriceContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
// -----------------------------------------------------------------------
// <copyright file="cxa.common.productselection.models.js" company="Sitecore Corporation">
// Copyright (c) Sitecore Corporation 1999-2017
// </copyright>
// <summary>Provides a common tool</summary>
// -----------------------------------------------------------------------
// Copyright 2017 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------
function BundleItemSelection() {
  var self = this;

  self.catalogName = "";
  self.productId = "";
  self.variantId = "";
}

function BundleSelection() {
  var self = this;

  self.catalogName = "";
  self.productId = "";
  self.bundledItemList = [];
  self.quantity = "";

  self.addBundleItemSelection = function (bundledItem) {
    this.bundledItemList.push(bundledItem);
  };

  self.toJSONString = function () {
    return JSON.stringify(this);
  };
}
/**
 * @description Initializes the Product Selection broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/ProductSelection', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresProductSelectionContext
     */
    function createContext() {
        var context = {
          Handlers: {}, // repository to store handlers
          LastHandlerId: -1, // last used handler Id, initialized to -1
          CurrentCatalogName: "",
          CurrentProductId: "",
          CurrentVariantId: ""
        };
        return context;
      }

    /**
     * @function createContext - gets the CaleresProductSelectionContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresProductSelectionContext = getContext();
    root.CaleresProductSelectionContext = CaleresProductSelectionContext;
    factory(CaleresProductSelectionContext);

}(this, function (CaleresProductSelectionContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresProductSelectionContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
        return false;
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param catalogName - the name of the catalog containing the selected product
     * @param productId - product Id of the selected product
     * @param variantId - variant Id of the selected product
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, catalogName, productId, variantId, data) {
        handler(source, catalogName, productId, variantId, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param catalogName - the name of the catalog containing the selected product
     * @param productId - product Id of the selected product
     * @param variantId - variant Id of the selected product
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(eventtype, source, catalogName, productId, variantId, data) {
        var handlers = CaleresProductSelectionContext.Handlers[eventtype];

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, catalogName, productId, variantId, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    CaleresProductSelectionContext.Events = {
        SelectedProduct: "selectedProduct",
        SelectedProductValid: "selectedProductValid",
        SelectedProductInvalid: "selectedProductInvalid"
    };

    /**
     * @function SelectedProduct - called by components to notify handlers that product have changed
     * @param source - the event caller
     * @param catalogName - the name of the catalog containing the selected product
     * @param productId - product Id of the selected product
     * @param variantId - variant Id of the selected product
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductSelectionContext.SelectedProduct = function (source, catalogName, productId, variantId, data) {
        if (!hasHandlers(CaleresProductSelectionContext.Events.SelectedProduct)) { return false; }
        var dispatchFunction = dispatch(CaleresProductSelectionContext.Events.SelectedProduct, source, catalogName, productId, variantId, data)
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SelectedProductValid - called by components to notify handlers that a selected product is valid
     * @param source - the event caller
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductSelectionContext.SelectedProductValid = function (source, data) {
        if (!hasHandlers(CaleresProductSelectionContext.Events.SelectedProductValid)) { return false; }
        var dispatchFunction = dispatch(CaleresProductSelectionContext.Events.SelectedProductValid, source, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SelectedProductInvalid - called by components to notify handlers that a selected product is invalid
     * @param source - the event caller
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductSelectionContext.SelectedProductInvalid = function (source, data) {
        if (!hasHandlers(CaleresProductSelectionContext.Events.SelectedProductInvalid)) { return false; }
        var dispatchFunction = dispatch(CaleresProductSelectionContext.Events.SelectedProductInvalid, source, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresProductSelectionContext.SubscribeHandler = function (eventType, handler) {
        if (typeof handler !== 'function') {
          return false;
        }
    
        if (!CaleresProductSelectionContext.Handlers.hasOwnProperty(eventType)) {
            CaleresProductSelectionContext.Handlers[eventType] = {};
        }
    
        var newHandlerId = 'h_' + String(++CaleresProductSelectionContext.LastHandlerId);
        CaleresProductSelectionContext.Handlers[eventType][newHandlerId] = handler;
    
        return newHandlerId;
      };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresProductSelectionContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresProductSelectionContext.Handlers[handlerId]) {
          delete CaleresProductSelectionContext.Handlers[handlerId];
          return handlerId;
        }
    
        return null;
      };
}));
/**
 * @description Initializes the Product Variants broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/ProductVariants', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresProductVariantsContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresProductVariantsContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresProductVariantsContext = getContext();
    root.CaleresProductVariantsContext = CaleresProductVariantsContext;
    factory(CaleresProductVariantsContext);

}(this, function (CaleresProductVariantsContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresProductVariantsContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productVariants - an array of new product variants to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, productVariants, variantDefinitions, variantDefinitionLabels, variantDefinitionSelectLabels, data) {
        handler(source, productVariants, variantDefinitions, variantDefinitionLabels, variantDefinitionSelectLabels, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param productVariants - an array of new product variants to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, productVariants, variantDefinitions, variantDefinitionLabels, variantDefinitionSelectLabels, data) {
        var handlers = CaleresProductVariantsContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, productVariants, variantDefinitions, variantDefinitionLabels, variantDefinitionSelectLabels, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function SetVariants - called by components to notify handlers that product images have changed
     * @param source - the event caller
     * @param productVariants - an array of new product variants to display
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresProductVariantsContext.SetVariants = function (source, productVariants, variantDefinitions, variantDefinitionLabels, variantDefinitionSelectLabels, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, productVariants, variantDefinitions, variantDefinitionLabels, variantDefinitionSelectLabels, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresProductVariantsContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresProductVariantsContext.LastHandlerId);
        CaleresProductVariantsContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresProductVariantsContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresProductVariantsContext.Handlers[handlerId]) {
            delete CaleresProductVariantsContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
/**
 * @description Initializes the Product Registration broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Common/Registration', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresRegistrationContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
            RegistrationState: "",
            UserEmail: "",
            EmailState: ""
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresRegistrationContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresRegistrationContext = getContext();
    root.CaleresRegistrationContext = CaleresRegistrationContext;
    factory(CaleresRegistrationContext);

}(this, function (CaleresRegistrationContext) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = CaleresRegistrationContext.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param registrationState - the current view that the registration process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function notifyHandler(handler, source, registrationState, data) {
        handler(source, registrationState, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param registrationState - the current view that the registration process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    function dispatch(source, registrationState, data) {
        var handlers = CaleresRegistrationContext.Handlers;

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, registrationState, data);
            }
        }
    }

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    /**
     * @function SetRegistrationState - called by components to notify handlers that registration state has changed
     * @param source - the event caller
     * @param registrationState - the current view that the registration process is showing
     * @param data - broker event data that contains the productGroupId to apply the action to
     */
    CaleresRegistrationContext.SetRegistrationState = function (source, registrationState, data) {
        if (!hasHandlers()) { return false; }
        var dispatchFunction = dispatch(source, registrationState, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    CaleresRegistrationContext.SubscribeHandler = function (handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        var newHandlerId = 'h_' + String(++CaleresRegistrationContext.LastHandlerId);
        CaleresRegistrationContext.Handlers[newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    CaleresRegistrationContext.UnSubscribeHandler = function (handlerId) {
        if (CaleresRegistrationContext.Handlers[handlerId]) {
            delete CaleresRegistrationContext.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };
}));
/**
 * @description Initializes the Rules-based Snippets broker
 */
(function (root, factory) {
    'use strict';
    var instance;

    if (typeof define === 'function' && define.amd) {
        // use AMD define function to support AMD modules if in use
        define('Caleres/Common/RulesBasedSnippets', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    /**
     * @function createContext - creates an instance of the CaleresRulesBasedSnippetsContext
     */
    function createContext() {
        var context = {
            Handlers: {}, //repository to store handlers
            LastHandlerId: -1, //last used handler Id, initialized to -1
            cachedSnippets: {},
            currentPath: window.location.pathname,
            isDynamicContentEnabled: false
        };
        return context;
    }

    /**
     * @function createContext - gets the CaleresRulesBasedSnippetsContext instance
     */
    function getContext() {
        if (!instance) {
            instance = createContext();
        }
        return instance;
    }

    // browser global variable
    var CaleresRulesBasedSnippetsContext = getContext();
    root.CaleresRulesBasedSnippetsContext = CaleresRulesBasedSnippetsContext;
    factory(CaleresRulesBasedSnippetsContext);

}(this, function (context) {
    'use strict';

    /**
     * @function hasHandlers - checks if the broker has registered event handlers
     */
    function hasHandlers() {
        var handlers = context.Handlers;
        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                return true;
            }
        }
        return false;
    }

    /**
     * @function notifyHandler - notifies handler that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param data - broker event that contains the event data
     */
    function notifyHandler(handler, source, data) {
        handler(source, data);
    }

    /**
     * @function dispatch - notifies all handlers that an event has been raised
     * @param handler
     * @param source - the event caller
     * @param data - broker event that contains the event data
     */
    function dispatch(eventType, source, data) {
        var handlers = context.Handlers[eventType];

        var handlerId;
        for (handlerId in handlers) {
            if (handlers.hasOwnProperty(handlerId)) {
                notifyHandler(handlers[handlerId], source, data);
            }
        }
    }

    /**
     * @function init - initializes the context and caches the current page's snippet html
     */
    function init() {
        var snippets = $('.rules-based-snippet');
        var dynamicSnippets = $('.rules-based-snippet__dynamic');
        context.isDynamicContentEnabled = dynamicSnippets.length > 0;
        if(context.isDynamicContentEnabled) {
            cacheSnippets(window.location.pathname, snippets.get());
        }
    }

    /**
     * @function cacheSnippets - caches snippet html for a specified url
     * @param path - url path of the current page
     * @param snippets - snippet DOM elements to be cached
     */
    function cacheSnippets(path, snippets) {
        var snippetsData = {
            snippets: [],
            pathname: path
        };

        snippets.forEach(function(snippet) {
            var snippetData = {
                uniqueId: $(snippet).data('setting-uniqueid'),
                outerHTML: snippet.outerHTML
            };

            snippetsData.snippets.push(snippetData);
        });

        context.cachedSnippets[path] = snippetsData;
    }

    /**
     * @summary - Listens for changes to the url and retrieves snippet html content for the page
     */
    document.addEventListener('urlchanged', function(event) {
        if(!context.isDynamicContentEnabled) {
            return;
        }
        if(context.currentPath === window.location.pathname) {
            return;
        }

        var path = window.location.pathname,
            snippetData = context.cachedSnippets[path];
        context.currentPath = path;

        if(!snippetData) {
            context.BeginRefresh(this, {});
            $.get(path, function(html) {
                
            });
            $.ajax({
                url: path,
                success: function(html) {
                    //$.parseHTML loads html into a new document to prevent scripts from running
                    var parsedHtml = $.parseHTML(html);
                    var snippets = $(parsedHtml).find('.rules-based-snippet').get();

                    cacheSnippets(path, snippets);
                    context.UpdateSnippets(this, context.cachedSnippets[path]);
                    context.EndRefresh(this, context.cachedSnippets[path]);        
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) { 
                    context.EndRefresh(this, context.cachedSnippets[path]);      
                }
              });
        }
        else {
            context.UpdateSnippets(this, snippetData);
        }
    });

    //-------------------- Service Public Functions ---------------------------------------------------------------------
    context.Events = {
        SnippetsUpdated: "snippetsUpdated",
        SnippetsRefreshBegin: "snippetsRefreshBegin",
        SnippetsRefreshEnd: "snippetsRefreshEnd"
    };

    /**
     * @function UpdateSnippets - called by components to notify handlers that snippets need to be updated
     * @param source - the event caller
     * @param data - broker event data that contains the new snippet dom objects
     */
    context.UpdateSnippets = function (source, data) {
        if (!hasHandlers(context.Events.SnippetsUpdated)) { return false; }
        var dispatchFunction = dispatch(context.Events.SnippetsUpdated, source, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function BeginRefresh - called by components to notify handlers that new snippet html is being loaded
     * @param source - the event caller
     * @param data - broker event data that contains the new snippet dom objects
     */
    context.BeginRefresh = function (source, data) {
        if (!hasHandlers(context.Events.SnippetsUpdated)) { return false; }
        var dispatchFunction = dispatch(context.Events.SnippetsRefreshBegin, source, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function EndRefresh - called by components to notify handlers that new snippet html has finished loading
     * @param source - the event caller
     * @param data - broker event data that contains the new snippet dom objects
     */
    context.EndRefresh = function (source, data) {
        if (!hasHandlers(context.Events.SnippetsUpdated)) { return false; }
        var dispatchFunction = dispatch(context.Events.SnippetsRefreshEnd, source, data);
        //run asyncronously
        setTimeout(dispatchFunction, 0);
        return true;
    };

    /**
     * @function SubscribeHandler - adds a handler
     * @param handler
     */
    context.SubscribeHandler = function (eventType, handler) {
        if (typeof handler !== 'function') {
            return false;
        }

        if (!context.Handlers.hasOwnProperty(eventType)) {
            context.Handlers[eventType] = {};
        }

        var newHandlerId = 'h_' + String(++context.LastHandlerId);
        context.Handlers[eventType][newHandlerId] = handler;

        return newHandlerId;
    };

    /**
     * @function UnSubscribeHandler - removes a handler
     * @param handlerId - id of the handler to remove
     */
    context.UnSubscribeHandler = function (handlerId) {
        if (context.Handlers[handlerId]) {
            delete context.Handlers[handlerId];
            return handlerId;
        }

        return null;
    };

    init();
}));
function getUrlParameter(name) {
    name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
    var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
    var results = regex.exec(location.search);
    return results === null ? '' : decodeURIComponent(results[1]);
};

function isObjectEmpty(obj) {
    let hasOwnProperty = Object.prototype.hasOwnProperty;

    if (obj == null) return true;
    if (typeof obj !== "object") return true;

    for (var key in obj) {
        if (hasOwnProperty.call(obj, key)) return false;
    }

    return true;
}
XA.component.accessibility = (function($) {
    var api = {};

    var getAllIndexedElement = function() {
        return $("body").find("[tabindex]");
    };

    var activateFirstElement = function() {
        api.indexedElements.eq(0).attr("tabindex", "0");
    };

    var getComponentName = function() {
        var $activeElement = $(document.activeElement),
            currComponent = $activeElement.closest(".initialized"),
            componentName = currComponent.length
                ? currComponent.attr("class").split(" ")[1]
                : "";
        return componentName;
    };

    var getWrapper = function(selector) {
        var $activeElement = $(document.activeElement);
        return $activeElement.closest(selector);
    };

    // Tab component helper start
    var activateTab = function(direction, currTab) {
        var activatedTab = currTab;
        if (direction == "left" && currTab.prev()) {
            currTab.attr("tabindex", "-1");
            activatedTab = currTab.prev();
        } else if (direction == "right" && currTab.next()) {
            currTab.attr("tabindex", "-1");
            activatedTab = currTab.next();
        }
        activatedTab
            .attr("tabindex", "0")
            .trigger("click")
            .focus();
    };
    // Tab component helper end

    // Accordion component helper start
    var activateItem = function(direction, currItem) {
        var itemWrapper = currItem.closest("li.item"),
            activatedTab = currItem,
            nextItem = itemWrapper.next(),
            prevItem = itemWrapper.prev();
        if (direction == "down" && nextItem) {
            currItem.attr("tabindex", "-1");
            activatedTab = nextItem;
        } else if (direction == "up" && prevItem) {
            currItem.attr("tabindex", "-1");
            activatedTab = prevItem;
        }
        activatedTab
            .find(".toggle-header")
            .attr("tabindex", "0")
            .focus();
    };
    // Tab component helper end

    //Flip component helper start
    var toggleFlip = function(currItem) {
        var nextItem = currItem.next().length ? currItem.next() : currItem.prev();
        currItem.attr("tabindex", "-1");
        nextItem
            .trigger("click")
            .attr("tabindex", "0")
            .focus();
    };
    //Flip component helper end

    // Binded logic
    var componentLogic = {
        tabs: function(keyCode) {
            var currTab = getWrapper("li.active");
            if (currTab) {
                if (keyCode == api.keys.right) {
                    activateTab("right", currTab);
                } else if (keyCode == api.keys.left) {
                    activateTab("left", currTab);
                }
            }
        },
        accordion: function(keyCode) {
            var currItem = getWrapper("div.toggle-header");
            if (currItem) {
                if (keyCode == api.keys.down) {
                    activateItem("down", currItem);
                } else if (keyCode == api.keys.up) {
                    activateItem("up", currItem);
                }
            }
        },
        flip: function(keyCode) {
            var currItem = getWrapper("[class*='Side']");
            if (currItem) {
                if (keyCode == api.keys.right || keyCode == api.keys.left) {
                    toggleFlip(currItem);
                }
            }
        }
    };

    var bindEvents = function(keyCode) {
        var component = getComponentName();
        if (componentLogic[component]) {
            componentLogic[component](keyCode);
        }
    };

    // For easy reference
    api.keys = {
        end: 35,
        home: 36,
        left: 37,
        up: 38,
        right: 39,
        down: 40,
        delete: 46,
        enter: 13,
        space: 32
    };

    api.indexedElements = getAllIndexedElement();

    api.watchEvents = function() {
        $(document).on("keyup", function(event) {
            var keyCode = event.keyCode;
            bindEvents(keyCode);
        });
    };

    api.initInstance = function() {
        api.watchEvents();
        activateFirstElement();
    };

    api.init = function() {
        api.initInstance();
    };

    return api;
})(jQuery, document);

XA.register("accessibility", XA.component.accessibility);

$(document).ready(function () {
  function showFirstSlide() {
    setTimeout(function () {
      $('.slides')
        .find('li')
        .first()
        .show();
    }, 1000);
  }

  (function loadFirstSlide() {
    var url = window.location.href.toString();
    var isIndexZero = url.indexOf('carousel=0') > -1;
    isIndexZero ? showFirstSlide() : false;
  })();
});
// -----------------------------------------------------------------------
// Copyright 2017-2018 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------
(function (root, factory) {
  if (typeof define === 'function' && define.amd) {
    define('CXA/Feature/Navigation', ['exports'], factory);
  } else if (typeof exports === 'object') {
    factory(exports);
  }

  // browser global variable
  root.Navigation = factory;
}(this, function (element) {
  var component = new Component(element);

  component.Init = function () {
    $message = $(component.RootElement).data("message-summary-error");

    if ($message) {
      $(function () {
        setTimeout(function () {
          MessageContext.PublishWarning("", $message, "");
        }, 2000);
      });
    }
  };

  component.Visual.DisableLinks = function () {
    return false;
  };

  component.InExperienceEditorMode = function () {
    component.Visual.Disable();
  };

  return component;
}));
$(function () {
  setupCXAMobileNavigation();
  setupSXAMobileNavigation();

  var $currentCategoryIdMetaTag = $('meta[name="CurrentCategoryId"]');

  if ($currentCategoryIdMetaTag) {
    var currentCategoryId = $currentCategoryIdMetaTag.attr('content');

    if ($('.cxa-navigationbar-component').length) {
      highlightCXANavigation(currentCategoryId);
    }

    if ($('.cxa-navigation-component').length) {
      clearSXANavigationHighlights();
      highlightSXANavigation(currentCategoryId);
    }
  }

  /**
   * Setup the CXA mobile navigation accordion.
   */
  function setupCXAMobileNavigation() {
    $('.toggle-nav').click(function (e) {
      e.preventDefault();

      var $toggle = $(this);

      $toggle.toggleClass('active')
        .closest('.product-categories-menu')
        .find('.category-navigation-list')
        .toggleClass('active');
    });
  }

  function setupSXAMobileNavigation() {
    $('.navbar-toggler').click(function (e) {
      e.preventDefault();

      $(this).closest('nav')
        .find('.navigation-list')
        .toggleClass('active');
    });
  }

  /**
   * Highlight CXA navigation based on the category identifier given.
   *
   * @param {string} selectedCategoryId - selected category identifier
   */
  function highlightCXANavigation(selectedCategoryId) {
    var $selectedCategoryLink = $('.category-navigation-list .category-item .category-link[itemid="' + selectedCategoryId + '"]');
    if ($selectedCategoryLink) {
      $selectedCategoryLink.closest('.category-item').addClass('active');
    }
  }

  /**
   * Remove highlights for all SXA navigation links
   */
  function clearSXANavigationHighlights() {
    $('.cxa-navigation-component li').removeClass('active');
  }

  /**
   * Highlight SXA navigation based on the category identifier given.
   *
   * @param {string} selectedCategoryId - selected category identifier
   */
  function highlightSXANavigation(selectedCategoryId) {
    var $selectedCategoryLink = $('.navigation-link-id:contains("' + selectedCategoryId + '")');
    if ($selectedCategoryLink) {
      $selectedCategoryLink.closest('li').addClass('active');
    }
  }
});

/* global _:true */
/**
 * Component Accordion
 * @module Accordion
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of accordion methods
 */
XA.component.accordions = (function($) {
    /**
     * In this object stored all public api methods
     * @type {Object.<Methods>}
     * @memberOf module:Accordion
     * */
    var api = {};
    /**
     * toogleEvents list of toggle events
     * @memberOf module:Accordion
     * @private
     */
    var toogleEvents = {
        focus: function() {
            $(this).addClass("show");
        },
        blur: function() {
            $(this).removeClass("show");
        }
    };



    /**
     * headerBackground method set up background image for toggle-header
     * @memberOf module:Accordion
     * @param {DomElement} header toggle-header DOM element of accordion component
     * @alias module:Accordion.headerBackground
     * @private
     */
    function headerBackground(header) {
        var backgroundIcon = $(header),
            background = $(header).find("img"),
            backgroundSrc = background.attr("src");

        if (backgroundSrc) {
            backgroundIcon.parents(".accordion").addClass("accordion-image");

            backgroundIcon.css({
                background: "url(" + backgroundSrc + ")",
                "background-repeat": "no-repeat",
                "background-size": "cover",
                "background-position": "50% 100%"
            });

            background.hide();
        }
    }
    /**
     * calcSlideSize method calculate and set up width of accordion items
     * @memberOf module:Accordion
     * @param {DomElement} acc Root Dom element of accordion component
     * @alias module:Accordion.calcSlideSize
     * @private
     */
    function calcSlideSize(acc) {
        var accordionWidth = $(acc).width(),
            accordionItems = $(acc).find(".item"),
            maxHeight = 0;

        accordionItems.forEach(function(item) {
            var itemContent = $(item).find(".toggle-content").eq(0),
                itemHeader = $(item).find(".toggle-header"),
                slideWidth =
                    accordionWidth -
                    accordionItems.length * itemHeader.outerWidth();

            if ($(item).hasClass("active")) {
                $(item).css({
                    width: slideWidth
                });
            }

            //width
            itemContent.css({
                width: $(acc).hasClass("accordion-image")
                    ? slideWidth + itemHeader.outerWidth()
                    : slideWidth -
                    itemHeader.outerWidth() -
                    parseInt(itemHeader.css("padding"))
            });

            //height
            if (
                $(item)
                    .find(".toggle-content")
                    .height() > maxHeight
            ) {
                maxHeight = $(item)
                    .find(".toggle-content")
                    .height();
            }
        });
    }

    /**
     * animateHorizontal method set up animation for horizontal oriented
     * accordion component
     * @memberOf module:Accordion
     * @param {Object} properties list of properties for accordion component
     * @alias module:Accordion.animateHorizontal
     */
    api.animateHorizontal = function(properties) {
        var accordion = $(this).parents(".accordion"),
            panel = $(this).closest(".item"),
            header = panel.find(".toggle-header"),
            content = panel.find(".toggle-content"),
            items = accordion.find(".item"),
            siblings = panel.siblings(),
            siblingsContent = siblings.find(".toggle-content");

        panel.toggleClass("active");
        siblings.removeClass("active");
        siblings.stop(true).animate(
            {
                width: 0
            },
            properties.speed,
            properties.easing,
            function() {
                siblingsContent.css({
                    display: "none"
                });
            }
        );

        if (panel.hasClass("active")) {
            var slideWidth = accordion.hasClass("accordion-image")
                ? content.outerWidth()
                : accordion.width() -
                ((items.length - 1) * panel.outerWidth() + 2),
                contentWidth = accordion.hasClass("accordion-image")
                    ? slideWidth
                    : slideWidth - header.outerWidth();

            panel.stop(true).animate(
                {
                    width: slideWidth
                },
                properties.speed,
                properties.easing,
                function() {}
            );

            content.css({
                width: contentWidth,
                display: "block"
            });
        } else {
            panel.stop(true).animate(
                {
                    width: 0
                },
                properties.speed,
                properties.easing,
                function() {
                    content.css({
                        display: "none"
                    });
                }
            );
        }
    };
    /**
     * getQueryParamKey get an Id of accordion component
     * @memberOf module:Accordion
     * @param {jQuery} accordions  Root Dom element of accordion component
     * @private
     * @return {null|string} return id of accordion component
     */
    function getQueryParamKey(accordions) {
        var firstAccordionId = accordions[0].id;
        if (accordions.length > 0 && firstAccordionId != "") {
            return firstAccordionId.toLocaleLowerCase();
        }
        return null;
    }
    /**
     * accordion method setting up watchers that animate accordion slide
     * @memberOf module:Accordion
     * @method
     * @private
     * @param {jQuery} acc Root DOM element of archive component wrapped by jQuery
     * @param {Object} prop list of properties for accordion component
     * @alias module:Accordion.accordion
     */
    function accordion(acc, properties) {

        var ev = "click",
            toggleHeader = acc.find(".toggle-header").not('.bound');

        if (properties.expandOnHover) {
            ev = "mouseenter";
        }

        toggleHeader.addClass('bound')

        toggleHeader.on("mouseover", toogleEvents.focus);
        toggleHeader.on("mouseleave", toogleEvents.blur);
        toggleHeader.on("focus", toogleEvents.focus);
        toggleHeader.on("blur", toogleEvents.blur);
        toggleHeader.on("keyup", function(e) {
            if (e.keyCode == 13 || e.keyCode == 32) {
                $(this).click();
            }
        });

        if (acc.hasClass("accordion-horizontal")) {
            //calc slide width
            $(document).ready(function() {
                calcSlideSize(acc);
            });
            toggleHeader.forEach(function(header) {
                headerBackground(header);
            });
        }

        toggleHeader.on(ev, function() {
            var $this = $(this),
                panel = $this.closest(".item"),
                accordion = $this.parents(".accordion"),
                content = panel.find(".toggle-content").eq(0),
                siblings = panel.siblings(),
                siblingsContent = siblings.find(".toggle-content");

            // Horizontal animation
            if (accordion.hasClass("accordion-horizontal")) {
                api.animateHorizontal.call(this, properties);
                // Vertical animation
            } else {
                // Close all other items if open
                // multiple option disabled
                if (!properties.canOpenMultiple) {
                    siblings.removeClass("active");
                    siblingsContent.stop().slideUp({
                        duration: properties.speed,
                        easing: properties.easing
                    });
                }

                panel.toggleClass("active");
                // Toggle state of selected item
                // If toggle state is enabled
                if (properties.canToggle) {
                    content.slideToggle({
                        duration: properties.speed,
                        easing: properties.easing
                    });
                } else {
                    content.slideDown({
                        duration: properties.speed,
                        easing: properties.easing
                    });
                }
            }
            // Scrolls to accordion tab that is opened  
            setTimeout(function(){accordion.animate({ scrollTop: panel.position().top})}, 211)
           
        });
    }
    /**
     * initInstance method prepare Dom elements according accordion setup
     * and call ["accordion"]{@link module:Accordion.accordion} method
     * @memberOf module:Acordion
     * @method
     * @param {jQuery} component Root DOM element of archive component wrapped by jQuery
     * @param {Object} prop list of properties for accordion component
     * @alias module:Accordion.initInstance
     */
    api.initInstance = function(component, prop) {
        // Set tabindex=0 for first header
        component
            .find(".toggle-header")
            .eq(0)
            .attr("tabindex", "0");
        //
        if (component.hasClass("toggle")) {
            $.extend(prop, {
                canToggle: true
            });
        }
        component.find(".toggle-content").eq(0).hide();
        var current = XA.queryString.getQueryParam(getQueryParamKey(component));
        if (current != null) {
            var arr = current.split(",");
            var items = component.find("li");
            for (var index = 0; index < items.length; index++) {
                var element = items[index];
                if (arr.indexOf(index + "") > -1) {
                    $(element).addClass("active");
                    $(element)
                        .find(".toggle-content").eq(0)
                        .show();
                }
            }
        } else if (prop.expandedByDefault) {
            component.find("li:first-child").addClass("active");
            component
                .find("li:first-child")
                .find(".toggle-content").eq(0)
                .show();
        }
        accordion(component, prop);
    };
    /**
     * init method calls in a loop for each
     * accordions component on a page and run Accordions's
     * [".initInstance"]{@link module:Accordion.initInstance} method.
     * @memberOf module:Accordion
     * @alias module:Accordion.init
     */
    api.init = function() {
        var accordions = $(".accordion:not(.initialized)");
        accordions.each(function() {
            var properties = $(this).data("properties"),
                acc = $(this);
            api.initInstance(acc, properties);
            acc.addClass("initialized");
        });
    };

    return api;
})(jQuery);

XA.register("accordions", XA.component.accordions);
/**
 * Component Archive
 * @module Archive
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of archive methods
 */
XA.component.archive = (function($) {
    /**
     * In this object stored all public api methods
     * @type {Object.<Methods>}
     * @memberOf module:Archive
     * */
    var api = {};
    /**
     * toggleClick method toggle childs visibility
     * for archive items
     * @memberOf module:Archive
     * @param {eventObject} args
     * @private
     */
    var toggleClick = function(args) {
        var groupHeader = $(args.target);
        groupHeader.siblings("ul").toggle();
        groupHeader.toggleClass("opened");
    };
    /**
     * initInstance method bind toggling for
     * an arhive element
     * @memberOf module:Archive
     * @method
     * @param {jQuery} component Root DOM element of archive component wrapped by jQuery
     * @alias module:Archive.initInstance
     */
    api.initInstance = function(component) {
        var toggles = component.find(".group-header");
        toggles.on("click", toggleClick);
    };

    /**
     * init method calls in a loop for each
     * archive component on a page and run Archive's
     * ["initInstance"]{@link module:Archive.api.initInstance}  method.
     * @memberOf module:Archive
     * @alias module:Archive.init
     */
    api.init = function() {
        var archives = $(".sxa-archive:not(.initialized)"),
            archive;

        for (var i = 0, l = archives.length; i < l; i++) {
            archive = $(archives[i]);
            api.initInstance(archive);
            archive.addClass("initialized");
        }
    };

    return api;
})(jQuery);

XA.register("archive", XA.component.archive);

/**
 * Component Breadcrumb
 * @module Breadcrumb
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of archive methods
 */
XA.component.breadcrumb = (function($) {
    /**
     * In this object stored all public api methods
     * @type {Object.<Methods>}
     * @memberOf module:Breadcrumb
     * */
    var api = {};
    /**
     * This class used by [Breadcrumb]{@link module:Breadcrumb} module
     * @class BreadcrumbManager
     * @memberOf module:Breadcrumb
     * @param {jQuery} elem DOM Root element of
     */
    function BreadcrumbManager(elem) {
        this.breadcrumb = elem;
        this.hideHistory = [];
        this.hideHistory.elems = [];
        this.hideHistory.widths = [];
    }

    /**
     * @method
     * @alias getElements
     * @memberOf module:Breadcrumb.BreadcrumbManager
     * @param {$OrderedList} list Ordered List of 
     * breadcrumb elements wrapped by jquery
     */
    BreadcrumbManager.prototype.getElements = function($list) {
        var elements = [];

        $list.find("li").each(function() {
            elements.push(this);
        });

        return elements;
    };
    /**
     * Calculate width of component elements
     * @name calculateListElementsWidth
     * @function
     * @memberOf module:Breadcrumb.BreadcrumbManager
     * @return {number} widthSum
     */
    BreadcrumbManager.prototype.calculateListElementsWidth = function($list) {
        var widthSum = 0;

        $list.find(">li").each(function() {
            widthSum += $(this).width();
        });

        return widthSum;
    };
    /**
     * In case if breadcrumb elements do no fit the component width
     * several breadcrum items will be replaced by "..."
     * @name calculateWidth
     * @function
     * @memberOf module:Breadcrumb.BreadcrumbManager
     */
    BreadcrumbManager.prototype.calculateWidth = function() {
        var inst = this,
            $list = $(inst.breadcrumb).find("nav>ol"),
            listWidth = $list.width(),
            widthSum = this.calculateListElementsWidth($list),
            elements = this.getElements($list),
            $elementToHide,
            removeIndx = 0;

        var width = inst.hideHistory.widths[inst.hideHistory.widths.length - 1];
        if (listWidth > widthSum + width) {
            var elem = inst.hideHistory.elems.pop();
            inst.hideHistory.widths.pop();
            $(elem).removeClass("item-hide");
        }

        while (listWidth < widthSum && elements.length > 2) {
            removeIndx = Math.round(elements.length / 2) - 1;
            $elementToHide = $(elements[removeIndx]);

            inst.hideHistory.elems.push(elements[removeIndx]);
            inst.hideHistory.widths.push($elementToHide.width());
            $elementToHide.addClass("item-hide");

            widthSum = inst.calculateListElementsWidth($list);
            elements.splice(removeIndx, 1);
        }
    };
    /**
     * Calls in a case when added "breadcrumb-hide" class.
     * It`s do initial
     * [calculation]{@link module:Breadcrumb.BreadcrumbManager.calculateWidth}
     * of component width and also add 
     * [recalculation]{@link module:Breadcrumb.BreadcrumbManager.calculateWidth}
     * to window resize event.
     * @method
     * @alias module:Breadcrumb.BreadcrumbManager.init
     * @memberOf module:Breadcrumb.BreadcrumbManager
     */
    BreadcrumbManager.prototype.init = function() {
        var inst = this;

        inst.calculateWidth();
        $(window).resize(function() {
            inst.calculateWidth();
        });
    };
    /**
     * Default behaviour of breadcrumb.
     * In case if children exist it`s only add
     * "breadcrumb-navigation" class
     * @method
     * @alias makeNavigation
     * @memberOf module:Breadcrumb.BreadcrumbManager
     */
    BreadcrumbManager.prototype.makeNavigation = function() {
        var breadcrumb = $(this.breadcrumb),
            children = breadcrumb.find("li > ol");

        if (children.length > 0) {
            breadcrumb.addClass("breadcrumb-navigation");
        }
    };
    /**
     * initIstance methos create new instance of
     * [BreadcrumbManager]{@link module:Breadcrumb.BreadcrumbManager}
     * @memberOf module:Breadcrumb
     * @method
     * @param {jQuery} component Root DOM element of
     * breadcrumb component wrapped by jQuery
     * @alias module:Breadcrumb.initInstance
     */
    api.initInstance = function(component) {
        var breadcrumb = new BreadcrumbManager(component),
            $component = $(component);
        /** breadcrumb-hide - can be added manually in component setups */
        if ($component.hasClass("breadcrumb-hide")) {
            breadcrumb.init();
        } else {
            breadcrumb.makeNavigation();
        }
    };
    /**
     * init method calls in a loop for each
     * breadcrumb component on a page and run Breadcrumb's
     * [".initInstance"]{@link module:Breadcrumb.api.initInstance}  method.
     * @memberOf module:Breadcrumb
     * @alias module:Breadcrumb.init
     */
    api.init = function() {
        var breadcrumb = $(".breadcrumb:not(.initialized)");
        breadcrumb.each(function() {
            api.initInstance($(this));
            $(this).addClass("initialized");
        });
    };

    return api;
})(jQuery, document);

XA.register("breadcrumb", XA.component.breadcrumb);

/**
 * XAContext
 *
 * XA.component.carousels module.
 *
 * Exposes register(selector, options) method, which initializes Carousel
 * for each elements that match the provided selector, with given options.
 * Element used as a carousel must contain a <ul class="slides"> tag.
 * That tag have to be filled with <li> elements. Each <li> element will be considered as a slide.
 * For more details read the documentation of a register(selector, options) method.
 *
 * @requires jQuery JavaScript Library v1.4.4 or higher
 */
/* global Hammer:true */
XA.component.carousels = (function($) {
    var pub = {},
        NavigationBuilder = null,
        SliderInitializer = null;

    /**
     * Timer class saves time stamp and counts time difference between
     * current time (update() method) and saved time stamp.
     * @constructor
     */
    function Timer() {
        /**
         * Time difference between last update() call and last set() call
         *
         * @member Timer
         */
        this.elapsed = 0;
        /**
         * Time stamp
         *
         * @member Timer
         */
        this.stamp = null;
    }

    /**
     *  Counts time difference between current time and saved time stamp
     *
     * @member Timer
     */
    Timer.prototype.update = function() {
        if (this.stamp !== null) {
            this.elapsed += this.newStamp() - this.stamp;
        }
    };

    /**
     *  Saves new time stamp
     *
     * @member Timer
     */
    Timer.prototype.set = function() {
        this.stamp = this.newStamp();
    };

    /**
     *  Counts time difference between current time and saved time stamp
     *
     * @member Timer
     * @return stamp of a current time
     * @type Number
     */
    Timer.prototype.newStamp = function() {
        return new Date().valueOf();
    };

    /**
     *  Resets elapsed time.
     *
     * @member Timer
     */
    Timer.prototype.reset = function() {
        this.elapsed = 0;
    };
    /**
     * End of Timer class
     */

    /**
     * TimeIndicator class extends Timer class
     * @constructor
     * @param {Object} $     a jQuery object
     * @param {XA.component.carousels.IndicatorViews.View} view  a time indicator view.
     * @param {Number} timeout   a view timeout
     * @base Timer
     */
    function TimeIndicator($, view, timeout) {
        /**
         * A time indicator view.
         *
         * @member TimerIndicator
         */
        this.view = view;

        this.view.init(timeout);
    }
    TimeIndicator.prototype = new Timer();
    TimeIndicator.constructor = Timer;

    /**
     * Plays the attached view.
     *
     * @member TimerIndicator
     */
    TimeIndicator.prototype.play = function() {
        this.view.play();
    };

    /**
     * Pauses the attached view.
     *
     * @member TimerIndicator
     */
    TimeIndicator.prototype.pause = function() {
        this.view.pause();
    };

    /**
     * Resets elapsed time and resets the attached view.
     *
     * @member TimerIndicator
     */
    TimeIndicator.prototype.reset = function() {
        Timer.prototype.reset.call(this);
        this.view.reset();
    };

    /**
     * Counts time difference between current time and saved time stamp.
     * and updates the attached view
     *
     * @member TimerIndicator
     */
    TimeIndicator.prototype.update = function() {
        Timer.prototype.update.call(this);
        this.view.update(this.elapsed);
    };
    /**
     * end of TimeIndicator class
     */

    /**
     * NavigationBuilder object creates navigation items
     */
    NavigationBuilder = (function($) {
        function createItem(settings) {
            var text = settings.text,
                $navItem = null;

            settings.text = '';
            settings.href = '#';

            $navItem = $('<a>', settings);
            $('<span>', {
                'text': text
            }).appendTo($navItem);

            return $navItem;
        }

        return {
            /**
             * Returns the element(s) that match(es) the provided selector or null
             *
             * @param {String} selector a selector used for searching
             * @return a jQuery object containing element(s) that match(es) the provided selector or null if no element match
             * @type Object
             */
            getElement: function(selector) {
                var $element = $(selector);

                if ($element.length === 0) {
                    $element = null;
                }

                return $element;
            },
            /**
             * Creates navigation items and appends them to $container.
             *
             * @param {Object} $container   navigation items container (jQuery object)
             * @param {String} label   navigation items label template
             * @param {Number} count    number of navigation items to create
             */
            createItems: function($container, label, count) {
                var i,
                    pattern = /#\{index\}/g,
                    settings;

                for (i = 0; i < count; i++) {
                    settings = {
                        'text': label.replace(pattern, i + 1)
                    };
                    createItem(settings).appendTo($container);
                }
            },
            /**
             * Creates or selects 'previous'/'next' navigation item.
             * Mode of action depends on settings object:
             * var settings = {
             *     isContainer: Boolean value,
             *     label: String value,
             *     selector: String value,
             *     method: String value
             * };
             *
             * If settings.selector === null or if settings.selector !== null and settings.isContainer == true
             * navigation item is created and attached to $element.first() (using settings.method).
             * If settings.selector !== null and settings.isContainer == false
             * $element.first() is selected as navigation item
             *
             * @param {Object} settings settings of navigation item
             * @param {Object} itemSettings   html attributes of navigation item
             * @param {Object} $element    navigation items container (jQuery object)
             * @return The 'prev'/'next' navigation item
             * @type Object
             */
            createPrevNextItem: function(settings, itemSettings, $element) {
                var $item = null,
                    isSelectorExists = settings.selector !== null;


                if (isSelectorExists) {
                    $element = this.getElement(settings.selector);
                }

                if ($element !== null) {
                    if (settings.isContainer || !isSelectorExists) {
                        $item = createItem($.extend({}, {
                            'text': settings.label
                        }, itemSettings));
                        ($element.first())[settings.method]($item);
                    } else {
                        $item = $element.first();
                    }
                }

                return $item;
            }
        };
    }($));
    /**
     * end of NavigationBuilder object
     */

    /**
     * Navigation class holds navigation items.
     * @constructor
     */
    function Navigation($, $wrapper, options) {
        var defaults = {
                'isEnabled': true,
                'hasPrevNextItems': true,
                'item': {
                    'label': '#{index}',
                    'selector': null
                },
                'prevItem': {
                    'label': '<',
                    'selector': null,
                    'isContainer': false
                },
                'nextItem': {
                    'label': '>',
                    'selector': null,
                    'isContainer': false
                },
                'slidesCount': 0
            },
            settings = $.extend(true, {}, defaults, options);

        /**
         * jQuery object
         *
         * @member Navigation
         */
        this.$ = $;
        /**
         * Navigation items (one for each slide if navigation is enabled).
         *
         * @member Navigation
         */
        this.$items = $();
        /**
         * Navigation 'next' item (if prev/next items are enabled).
         *
         * @member Navigation
         */
        this.$nextItem = $();
        /**
         * Navigation 'previous' item (if prev/next items are enabled).
         *
         * @member Navigation
         */
        this.$prevItem = $();
        /**
         * Selected item (one from this.$items or null).
         *
         * @member Navigation
         */
        this.$selectedItem = null;

        //initialization
        if (settings.isEnabled) {
            var self = this;
            setTimeout(function() {
                self.prepareItems(settings.item, settings.slidesCount, $wrapper);
                //select first item on init
                self.selectItem(0)
            }, 1000);

            $wrapper.find('.nav').trigger('navigation-created', this);


        }
    }

    /**
     * CSS classm which will be used for mark selected item
     *
     * @member Navigation
     */
    Navigation.prototype.selectedItemClass = 'active';

    /**
     * Mark navigation item with given index as selected.
     *
     * @member Navigation
     * @param {Number} index     index of navigation item
     */
    Navigation.prototype.selectItem = function (index) {
        if (this.$selectedItem !== null) {
            this.$selectedItem.removeClass(this.selectedItemClass);
        }
        this.$selectedItem = this.$items.eq(index).addClass(this.selectedItemClass);
    };

    /**
     * Creates or selects navigation items container and fills it with navigation items.
     * If navigation items container is not empty, child elements are adopted as navigation items.
     * Mode of action depends on settings object:
     * var settings = {
     *     'label': '#{index}',
     *     'selector': null
     * };
     * If settings.selector === null navigation item container is created.
     * If settings.selector !== null element that match settings.selector is adapted as navigagation items container.
     *
     * @member Navigation
     * @param {Object} settings settings of navigation items
     * @param {Number} count   number of navigation items
     * @param {Object} $wrapper    wrapper of navigation items container (jQuery object)
     * @return The container filled with navigation items.
     * @type Object
     */
    Navigation.prototype.prepareItems = function(settings, count, $wrapper) {
        var $container = null;

        if (settings.selector !== null) {
            $container = NavigationBuilder.getElement(settings.selector);
        } else {
            $container = $('<div/>', {
                'class': 'nav'
            });
            $container.appendTo($wrapper);
        }

        if ($container !== null) {
            if ($container.children().length === 0) {
                NavigationBuilder.createItems($container, settings.label, count);
            }
            this.$items = $container.children().slice(0, count);
        }

        return $container;
    };

    /**
     * Creates or selects navigation 'previous' and 'next' navigation items (@see NavigationBuilder.createPrevNextItem()).
     * If navigation items container is not empty, child elements are adopted as navigation items.
     *
     * @member Navigation
     * @param {Object} settings settings of navigation
     * @param {Object} $container    navigation items container (jQuery object)
     */
    Navigation.prototype.preparePrevNextItems = function(settings, $container) {
        var $item;

        settings.prevItem.method = 'prepend';
        $item = NavigationBuilder.createPrevNextItem(settings.prevItem, {
            'class': 'prev'
        }, $container);
        this.$prevItem = ($item === null) ? this.$prevItem : $item;

        settings.nextItem.method = 'append';
        $item = NavigationBuilder.createPrevNextItem(settings.nextItem, {
            'class': 'next'
        }, $container);
        this.$nextItem = ($item === null) ? this.$nextItem : $item;
    };
    /**
     * end of Navigation class
     */

    /**
     * SliderContext class is binded to a Slider class instance
     * and holds its properties.
     * @constructor
     */
    function SliderContext() {
        /**
         * Flag, which determines if slide can or can not be changed (for user request)
         *
         * @member SliderContext
         */
        this.canChangeSlide = true;
        /**
         * Default Slider setting object (@see Slider)
         *
         * @member SliderContext
         */
        this.defaults = null;
        /**
         * Navigation object (@see Navigation)
         *
         * @member SliderContext
         */
        this.navigation = null;
        /**
         * Slider object, which this context is attacehd to.
         *
         * @member SliderContext
         */
        this.owner = null;
        /**
         * Flag, which determines if change of a slide can or can not be scheduled
         *
         * @member SliderContext
         */
        this.preventScheduling = false;
        /**
         * Slider setting object
         *
         * @member SliderContext
         */
        this.settings = null;
        /**
         * Instance of Timer class (@see Timer), which is used to store how much
         * time is left to change the slide
         *
         * @member SliderContext
         */
        this.slideTimer = new Timer();
        /**
         * Instance of TimeIndicator class (@see TimeIndicator)
         *
         * @member SliderContext
         */
        this.timeIndicator = null;
        /**
         * Timers array.
         *
         * @member SliderContext
         */
        this.timers = [];
        /**
         * Last timeout identifier.
         *
         * @member SliderContext
         */
        this.timeoutId = null;
        /**
         * Transition (@see XA.component.carousels.Transitions.Transition) used while changing slides
         *
         * @member SliderContext
         */
        this.transition = null;
        /**
         * Transition settings object (@see XA.component.carousels.Transitions.TransitionSettings)
         *
         * @member SliderContext
         */
        this.transitionSettings = new XA.component.carousels.Transitions.TransitionSettings();
        /**
         * jQuery object which contains all slides
         *
         * @member SliderContext
         */
        this.$slides = null;
        /**
         * jQuery object containing element that wrapps slides
         *
         * @member SliderContext
         */
        this.$wrapper = null;
        /**
         * Reference to method, which should change current slide
         *
         * @member SliderContext
         */
        this.changeCurrentSlide = null;
        /**
         * Reference to method, which should return jQuery object with current slide
         *
         * @member SliderContext
         */
        this.getCurrentSlide = null;

        this.timers.push(this.slideTimer);
    }
    /**
     * end of SliderContext class
     */

    /**
     * Slider class manages changing of slides.
     *
     * Options object:
     * {
     *     'navigation': Object value, //navigation settings object
     *     'timeout': Number value, //time between slides changing
     *     'transition': String value, //name of transition class (@see XA.component.carousels.Transitions.Transition)
     *     'isPauseEnabled': Boolean value, //flag, which determines if pause feature is enabled
     *     'timeIndicator': {
     *         'isEnabled': Boolean value, //flag, which determines if time indicator is enabled
     *         'selector': String value, //selector of time indicator html element
     *         'view': String value, //name of view class (@see XA.component.carousels.IndicatorViews.View
     *         'options': Object value //object with options, which will be passed to a time indicator view
     *     }
     * }
     * @constructor
     * @param {Object} $     the jQuery object
     * @param {SliderContext} context    instance of SliderContext class; must be separate for each instance (@see SliderContext)
     * @param {Object} options    Slider options object
     */
    function Slider($, context, options) {
        var defaults = {
            'navigation': {},
            'timeout': 10000,
            'transition': 'BasicTransition',
            'isPauseEnabled': true,
            'timeIndicator': {
                'isEnabled': false,
                'selector': null,
                'view': 'View',
                'options': {}
            }
        };

        /**
         * Instance of SliderContext class (@see SliderContext)
         *
         * @member Navigation
         */
        this.context = context;

        context.owner = this;
        context.defaults = defaults;
        context.settings = $.extend(true, {}, defaults, options);
        context.transitionSettings.$slides = context.$slides;
    }

    /**
     * Executes method with given methodName on each Timer in context.timers (@see Timer)
     *
     * @member Slider
     * @param {String} methodName   name of a method, which will be executed on timers
     * @param {SliderContext} context    current context
     */
    Slider.prototype.executeOnTimers = function(methodName, context) {
        var i = null,
            timer = null,
            timers = context.timers;

        for (i = 0; i < timers.length; i++) {
            timer = timers[i];
            if (typeof(timer[methodName]) === 'function') {
                timer[methodName]();
            }
        }
    };

    /**
     * Deschedules change of a slide, by clearing timeout previously set by setTiemout() function.
     *
     * @member Slider
     * @param {SliderContext} context    current context
     */
    Slider.prototype.descheduleSlide = function(context) {
        if (context.timeoutId !== null) {
            clearTimeout(context.timeoutId);
            context.timeoutId = null;
        }
    };

    /**
     * Schedules change of a slide, by setting timeout (using setTiemout() function) if can.
     * If can't, tries again after short period of time.
     *
     * @member Slider
     * @param {SliderContext} context    current context
     */
    Slider.prototype.scheduleSlide = function(context) {
        var owner = context.owner;

        owner.descheduleSlide(context);

        if (!context.preventScheduling && context.$slides.length > 1) {
            owner.executeOnTimers('set', context);

            if (context.canChangeSlide) {
                if (context.timeIndicator !== null) {
                    context.timeIndicator.play();
                }
                context.timeoutId = setTimeout(function() {
                    owner.changeCurrentSlideBy(1, context);
                }, context.settings.timeout - context.slideTimer.elapsed);
            } else {
                setTimeout(function() {
                    owner.scheduleSlide(context);
                }, 100);
            }
        }
    };

    /**
     * Changes current slide, by offset performing context.transition
     * Any offset value is save (if it is an integer).
     *
     * @member Slider
     * @param {Number} offset    the offset to an index of a new slide
     * @param {SliderContext} context    current context
     */
    Slider.prototype.changeCurrentSlideBy = function(offset, context) {
        var settings = context.transitionSettings,
            $currentSlide = context.getCurrentSlide(),
            $slides = context.$slides;

        if ((offset % $slides.length) !== 0) {
            context.canChangeSlide = false;

            settings.offset = offset;
            settings.$currentSlide = $currentSlide;
            settings.$nextSlide = $slides.eq(($currentSlide.index() + offset) % $slides.length);

            context.changeCurrentSlide(settings.$nextSlide);
            context.transition.perform(context.transitionSettings, offset);
            context.owner.executeOnTimers('reset', context);
        }


        var $carousel = $(context.$wrapper).parents(".carousel");
        $carousel.trigger("slide-changed");
    };

    /**
     * Starts automatic slides changing
     *
     * @member Slider
     */
    Slider.prototype.run = function() {
        this.executeOnTimers('reset', this.context);
        this.scheduleSlide(this.context);
    };

    /**
     * Cancel the default action of event and changes slide manually.
     *
     * @member Slider
     * @param {Object} event     the event
     * @param {Number} offset    the offset to an index of a new slide
     * @param {SliderContext} context    current context
     */
    Slider.prototype.onChangeCurrentSlide = function(event, offset, context) {
        var owner = context.owner;

        event.preventDefault();
        if (context.canChangeSlide) {
            owner.descheduleSlide(context);
            owner.changeCurrentSlideBy(offset, context);
        }
    };

    /**
     * Selects navigation item with given index.
     *
     * @member Slider
     * @param {Number} index     the index of navigation item
     */
    Slider.prototype.selectNavigationItem = function(index) {
        this.context.navigation.selectItem(index);
    };
    /**
     * end of Slider class
     */

    /**
     * SliderInitializer object set up instances of Slider class
     */
    SliderInitializer = (function($) {
        var DIRECTION = {
            PREV: -1,
            NEXT: 1
        };

        /**
         * Attaches events to navigation items.
         *
         * @param {SliderContext} context   a context of a Slider class instance
         */
        function attachNavigationEvents(context) {
            var owner = context.owner,
                $navLinks = context.$wrapper.find(".nav-items"),
                $prevItemTxt = context.$wrapper.find('.prev-text'),
                $nextItemTxt = context.$wrapper.find('.next-text'),
                $carousel = context.$wrapper.parents(".carousel");

            context.navigation.$items.each(function (index) {
                var $slide = context.$slides.eq(index);

                $(this).click(function (event) {
                    owner.onChangeCurrentSlide(event, $slide.index() - context.getCurrentSlide().index(), context);
                });
            });

            $prevItemTxt.click(function (event) {
                switchSlide(event, context, DIRECTION.PREV);
            });

            $nextItemTxt.click(function (event) {
                switchSlide(event, context, DIRECTION.NEXT);
            });

            context.navigation.$prevItem.click(function (event) {
                switchSlide(event, context, DIRECTION.PREV);
            });

            context.navigation.$nextItem.click(function (event) {
                switchSlide(event, context, DIRECTION.NEXT);
            });

            $navLinks.on("keydown", function (event) {
                switch (event.keyCode) {
                    case 37: //Letf arrow
                        switchSlide(event, context, DIRECTION.PREV);
                        $(this).parent().find(".active").focus();
                        break;
                    case 39: //Right arrow
                        switchSlide(event, context, DIRECTION.NEXT);
                        $(this).parent().find(".active").focus();
                        break;
                    case 13: //Enter
                        focusFirstFocusableElement(owner.context.getCurrentSlide());
                }
            });

            $carousel.on("slide-changed", function(event){
                var $activeLink = $navLinks.find(".active");
                $activeLink.attr('tabindex', '0');
                
                if($navLinks.find(document.activeElement).length){
                    $activeLink.focus();
                }

                $navLinks.find(">div").not('.active').attr('tabindex', '-1');
            });
        }

        /**
         * Switch slides back and foreward
         *
         * @param {Event} event              an event which caused switch slide action
         * @param {SliderContext} context    a context of a Slider class instance
         * @param {number} direction         switch slide direction. -1 - switch to prev slide. 1 - switch to the next slide
         */
        function switchSlide(event, context, direction) {
            var owner = context.owner,
                navLinks$ = context.$wrapper.find(".nav-items");

            navLinks$.find(".active").attr('tabindex', '-1');
            owner.onChangeCurrentSlide(event, direction, context);
            navLinks$.find(".active").attr('tabindex', '0');
        }

        /**
         * Focus the first focusable element inside container
         *
         * @param {Container} container  a container element where the first focusable element will be focused
         */
        function focusFirstFocusableElement(container) {
            var focusableElementsString = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]';

            // Find all focusable children
            var focusableElements = container.find(focusableElementsString);

            // If there are focusable elements - select the first one
            if (focusableElements.length !== 0) {
                var firstTabStop = focusableElements[0];

                // Focus first
                firstTabStop.focus();
            }
        }

        /**
         * Attaches pause event to navigation wrapper.
         *
         * @param {SliderContext} context   a context of a Slider class instance
         */
        function attachPauseEvent(context) {
            var owner = context.owner,
                $element = context.$wrapper,
                $navLinks = $element.find(".nav a");

            var callbackMouseenter = function() {
                context.preventScheduling = true;
                owner.descheduleSlide(context);

                owner.executeOnTimers('update', context);
                if (context.timeIndicator !== null) {
                    context.timeIndicator.pause();
                }
            }

            $element.mouseenter(callbackMouseenter);
            $navLinks.on("focus", callbackMouseenter);

            var callbackMouseLeave = function() {
                context.preventScheduling = false;
                owner.scheduleSlide(context);
            }

            $element.mouseleave(callbackMouseLeave);
            $navLinks.on("blur", callbackMouseLeave);
        }

        /**
         * Creates time indicator view
         *
         * @param {SliderContext} context   a context of a Slider class instance
         */
        function createIndicator(context) {
            var settings = context.settings,
                timeIndicator = null,
                ViewConstructor = XA.component.carousels.IndicatorViews[settings.timeIndicator.view],
                view = null;

            if (ViewConstructor !== null) {
                view = new ViewConstructor(settings.timeIndicator.selector, settings.timeIndicator.options);
                timeIndicator = new TimeIndicator($, view, settings.timeout);
                context.timeIndicator = timeIndicator;
                context.timers.push(timeIndicator);
            }
        }

        /**
         * Attaches events to navigation.
         *
         * @param {SliderContext} context   a context of a Slider class instance
         */
        function initializeNavigation(context) {
            context.settings.navigation.slidesCount = context.$slides.length;
            context.navigation = new Navigation($, context.$wrapper, context.settings.navigation);

            setTimeout(function() {
                attachNavigationEvents(context);
            }, 1000);


            if (context.settings.isPauseEnabled) {
                attachPauseEvent(context);
            }
        }

        /**
         * Initializes transition for a given context.
         *
         * @param {SliderContext} context   a context of a Slider class instance
         */
        function initializeTransition(context) {
            var TransitionConstructor = null,
                owner = context.owner;

            context.transitionSettings.callback = function() {
                context.canChangeSlide = true;

                if (context.preventScheduling) {
                    owner.executeOnTimers('reset', context);
                } else {
                    owner.scheduleSlide(context);
                }
            };

            TransitionConstructor = XA.component.carousels.Transitions[context.settings.transition];
            if ((TransitionConstructor === null) || (TransitionConstructor === undefined)) {
                TransitionConstructor = XA.component.carousels.Transitions[context.defaults.transition];
            }
            context.transition = new TransitionConstructor();
            context.transition.init(context.transitionSettings);
        }

        return {
            /**
             * Initializes Slider object with a given context.
             *
             * @param {SliderContext} context   a context of a Slider class instance
             */
            initialize: function(context) {
                initializeNavigation(context);
                initializeTransition(context);

                if (context.settings.timeIndicator.isEnabled) {
                    createIndicator(context);
                }
            }
        };
    }($));
    /**
     * end of SliderInitializer
     */

    /**
     * Carousel class displays one slide (some content) at the time.
     * Its behaviour depends on settings (passed to init() method).
     * For more details @see Slider, @see SliderInitializer, @see Navigation,
     * @see NavigationBuilder, @see XA.component.carousels.Transitions.Transition,
     * @see XA.component.carousels.IndicatorViews.View
     *
     * @constructor
     */
    function Carousel() {
        var context = this;

        /**
         * Instance of a Slider class (@see Slider).
         *
         * @member Carousel
         */
        this.slider = null;
        /**
         * Displayed slide (jQuery object).
         *
         * @member Carousel
         */
        this.$currentSlide = null;
        /**
         * All slides (jQuery object).
         *
         * @member Carousel
         */
        this.$slides = null;

        /**
         * Changes current slide to a $newSlide.
         *
         * @member Carousel
         * @param {Object} $newSlide  the new slide (jQuery) object.
         */
        this.changeCurrentSlide = function($newSlide) {
            context.$currentSlide = $newSlide;
            context.slider.selectNavigationItem($newSlide.index());
        };

        /**
         * Returns current slide.
         *
         * @member Carousel
         * @return current slide (jQuery) object.
         * @type Object
         */
        this.getCurrentSlide = function() {
            return context.$currentSlide;
        };

        this.data = {};
    }

    /**
     * Resets the carousel.
     *
     * @member Carousel
     */
    Carousel.prototype.reset = function() {
        this.$slides.each(function() {
            $(this).hide();
        });

        this.changeCurrentSlide(this.$slides.first());
        this.$currentSlide.show();
    };

    /**
     * Initializes the carousel.
     * Wrapps carousel content with <div class="wrapper" /> element,
     * selects slides (<li /> elements) from <ul class="slides" /> element,
     * initializes Slider class inctance, resets the carousel and start automatic slides changing.
     *
     * @member Carousel
     * @param {Object} $container     jQuery object with a main html element of the carousel
     * @param {Object} options     carousel options object
     */
    Carousel.prototype.init = function($container, options) {
        var $wrapper = $('<div/>', {
                'class': 'wrapper'
            }),
            sliderContext = null;

        $wrapper.append($container.children().detach());
        $container.append($wrapper);
        this.$slides = $container.find('.slides li.slide');

        sliderContext = new SliderContext();
        sliderContext.changeCurrentSlide = this.changeCurrentSlide;
        sliderContext.getCurrentSlide = this.getCurrentSlide;
        sliderContext.$slides = this.$slides;
        sliderContext.$wrapper = $wrapper;

        this.slider = new Slider($, sliderContext, options);
        SliderInitializer.initialize(sliderContext);

        this.reset();
        this.slider.run();
    };
    /**
     * end of Carousel class
     */
   

    /* Carousel touch support */
    // TODO: if this needs to be added back in, we will need to load hammer.min.js using $.getScript or a similar method. 
    // Carousel.prototype.swipeSlide = function() {
    //     var self = this,
    //         $wrapper = this.slider.context.$wrapper,
    //         hammer = new Hammer($wrapper[0]);
    //     hammer.get('pan').set({ direction: Hammer.DIRECTION_HORIZONTAL });

    //     hammer.on("swipeleft", function(e) {
    //         self.slider.context.owner.onChangeCurrentSlide(e, 1, self.slider.context);
    //     });

    //     hammer.on("swiperight", function(e) {
    //         self.slider.context.owner.onChangeCurrentSlide(e, -1, self.slider.context);
    //     });
    // };
    
    Carousel.prototype.maxSlideInfoHeight = function(){
        var maxHeight = 0,
            slideInfo = this.$slides[0].querySelector('.slide-info')
        if (slideInfo){
            maxHeight = slideInfo.offsetHeight;
        };
        for (var i = 1; i < this.$slides.length; i++){
            var currSlideInfoHeight = this.$slides[i].querySelector('.slide-info').offsetHeight
            if (maxHeight <currSlideInfoHeight ){
                maxHeight = currSlideInfoHeight;
            }
        }
        return maxHeight;
    }

    Carousel.prototype.resizeWrapper = function() {
            var slideInfoHeight = this.maxSlideInfoHeight(),
                wrapper = this.slider.context.$wrapper;
            wrapper.find('.slide-info').css({
                'min-height': slideInfoHeight
            });
        
    };

    pub.initInstance = function(component){
              var properties = component.data("properties"),
                component = component.find(".carousel-inner"),
                id = component.attr("data-id"),
                self = component.eq(0),
                querySlideIndex = parseInt(XA.queryString.getQueryParam(component.closest('.component.carousel').attr("id") || "carousel")),
                validQueryParam = typeof querySlideIndex !== "undefined" && !isNaN(querySlideIndex) && querySlideIndex < component.find(".sxa-numbers").length,
                context, settings, $currentSlide, $slides;

            if (properties) {
                if (!properties.navigation) {
                    properties.navigation = {
                        item: {},
                        prevItem: {},
                        nextItem: {},
                        isEnabled: validQueryParam ? false: true
                    };
                }
                properties.navigation.item.selector = "[data-id='" + id + "'] .nav-items"; //properties.navigation.item.selector;
                properties.navigation.prevItem.selector = "#" + id + " .nav";
                properties.navigation.nextItem.selector = "#" + id + " .nav";

                var carousel = new Carousel($);
                carousel.init(component, properties);

                $(document).ready(function() {
                    carousel.resizeWrapper();
                });

                if (validQueryParam) {
                    context = carousel.slider.context,
                    settings = context.transitionSettings,
                    $currentSlide = context.getCurrentSlide(),
                    $slides = context.$slides;

                    context.canChangeSlide = false;
                    settings.$currentSlide = $currentSlide;
                    settings.$nextSlide = $($slides[querySlideIndex]);

                    context.changeCurrentSlide(settings.$nextSlide);
                    context.transition.perform(context.transitionSettings);
                    context.owner.executeOnTimers('reset', context);

                    context.navigation.prepareItems(properties.navigation.item, $slides.length, $(context.$wrapper));
                    context.navigation.selectItem(querySlideIndex);
                } else {
                    //carousel.swipeSlide();   
                }
            }
    }


    pub.init = function () {
        $(".carousel:not(.initialized)").each(function () {
            pub.initInstance($(this))

            $(this).addClass("initialized");
        });
    };

    return pub;
}(jQuery));
/**
 * end of XA.component.carousels module.
 */


XA.register("carousels", XA.component.carousels);



XA.component.carousels.Transitions = (function() {
    var pub = {};

    /**
     * TransitionSettings class holds data needed for changing slides
     * @constructor
     */
    function TransitionSettings() {}
    /**
     * Current slide (currently displayed) jQuery object
     *
     * @member TransitionSettings
     */
    TransitionSettings.prototype.$currentSlide = null;
    /**
     * Next slide jQuery object
     *
     * @member TransitionSettings
     */
    TransitionSettings.prototype.$nextSlide = null;
    /**
     * All slides (jQuery object)
     *
     * @member TransitionSettings
     */
    TransitionSettings.prototype.$slides = null;
    /**
     * Offset between $currentSlide and $nextSlide
     *
     * @member TransitionSettings
     */
    TransitionSettings.prototype.offset = 0;
    /**
     * Callback function which must be called after animation.
     *
     * @member TransitionSettings
     */
    TransitionSettings.prototype.callback = null;
    /**
     * end of TransitionSettings class
     */
    pub.TransitionSettings = TransitionSettings;

    /**
     * Transition class is a base class of all transitions.
     *
     * Important: settings.callback() (@see TransitionSettings) have to be called at the end of execution the perform() method.
     *
     * @constructor
     */
    function Transition() {}
    Transition.prototype = new Transition();
    /**
     * Initializes a transition with given settings (@see TransitionSettings).
     * 
     * @member Transition
     * @param {TransitionSettings} settings  transition settings
     */
    /* eslint-disable */
    Transition.prototype.init = function(settings) {
        //implementation using settings
    };
    /* eslint-enable */
    /**
     * Returns a factor associated with settings.offset (@see TransitionSettings), which
     * can be usefull for some animations.
     *
     * @member Transition
     * @param {TransitionSettings} settings  transition settings
     * @return The factor; 1 if offset is higher than 0, -1 otherwise
     * @type Number
     */
    Transition.prototype.factor = function(settings) {
        return (settings.offset > 0) ? 1 : -1;
    };
    /**
     * This method is called used by carousels to change slides.
     *
     * Important: settings.callback() (@see TransitionSettings) have to be called at the end of this method execution.
     *
     * @member Transition
     * @param {TransitionSettings} settings  transition settings
     */
    Transition.prototype.perform = function(settings) {
        settings.callback();
    };
    /**
     * End of Transition class
     */
    pub.Transition = Transition;

    /**
     * BasicTransition class changes slides without any animation.
     * Do not remove this class, becaouse carousels will use it by default,
     * if requested transition cannot be found.
     * @constructor
     */
    function BasicTransition() {}
    BasicTransition.prototype = new Transition();
    BasicTransition.constructor = BasicTransition;
    /**
     * @member BasicTransition
     */
    BasicTransition.prototype.perform = function(settings) {
        settings.$currentSlide.hide();
        settings.$nextSlide.show();

        settings.callback();
    };
    /**
     * End of BasicTransition class
     */
    pub.BasicTransition = BasicTransition;

    /**
     * FadeInTransition class changes slides by fading in new slide.
     * This class can be removed if effect is not used.
     * @constructor
     */
    function FadeInTransition() {}
    FadeInTransition.prototype = new Transition();
    FadeInTransition.constructor = FadeInTransition;
    /**
     * @member FadeInTransition
     */
    FadeInTransition.prototype.init = function() {
        /*settings.$slides.css({
         'position': 'absolute',
         'top': '0px',
         'left': '0px'
         });*/
    };
    /**
     * @member FadeInTransition
     */
    FadeInTransition.prototype.perform = function(settings) {
        var zIndexAttrib = 'z-index',
            $parent = settings.$slides.parent(),
            $nextSlide = settings.$nextSlide;

        $parent.css(zIndexAttrib, 0);
        $nextSlide.css(zIndexAttrib, 1);
        settings.$slides.css({
            'position': 'relative'
        });

        settings.$nextSlide.css({
            'position': 'absolute',
            'top': '0',
            'bottom': '0',
            'left': '0',
            'right': '0'
        });


        $nextSlide.fadeIn(function() {
            settings.$currentSlide.hide();

            settings.$nextSlide.css({
                'position': 'relative',
                'left': '0',
                'transform': 'none'
            });

            $nextSlide.css(zIndexAttrib, '');
            $parent.css(zIndexAttrib, '');

            settings.callback();
        });
    };
    /**
     * End of FadeInTransition class
     */
    pub.FadeInTransition = FadeInTransition;

    /**
     * SlideHorizontallyTransition class changes slides by sliding them horizontally.
     * This class can be removed if effect is not used.
     * If offset (difference between index of currently displayed slide and index of slide that will be shown)
     * is greater than 0, slides are sliding to the left. Otherwise (offset is lower than 0), slides are sliding
     * to the left.
     * When slide change is raised automatically, slides are always sliding to right (offset == 1).
     * If user raises slides change, slides are sliding:
     * - to left, if offset is greater than 0 (slide with higher index will be shown or user clicks on 'next' navigation item),
     * - to right, if offset is lower than 0 (slide with lower index will be shown or user clicks on 'prev' navigation item).
     * @constructor
     */
    function SlideHorizontallyTransition() {}
    SlideHorizontallyTransition.prototype = new Transition();
    SlideHorizontallyTransition.constructor = SlideHorizontallyTransition;
    /**
     * @member SlideHorizontallyTransition
     */
    SlideHorizontallyTransition.prototype.onAnimationComplete = function(settings, $parent) {
        settings.$currentSlide.hide();
        settings.$nextSlide.css({
            'top': '',
            'bottom': '',
            'left': '',
            'position': '',
            'width': ''
        });

        $parent.css({
            'left': ''
        });

        $parent.css('margin-left', '');

        settings.callback();
    };
    /**
     * @member SlideHorizontallyTransition
     */
    SlideHorizontallyTransition.prototype.perform = function (settings, offset) {
        var factor = this.factor(settings),
            onAnimationComplete = this.onAnimationComplete,
            width = settings.$currentSlide.width(),
            $parent = settings.$slides.parent();

        settings.$nextSlide.css({
            'top': '0',
            'bottom': '0',
            'left': '100%',
            'position': 'absolute',
            'width': '100%'
        });
        if (offset > 0) {
            settings.$nextSlide.css({
                'left': '100%',
            })
        } else {
            settings.$nextSlide.css({
                'left': '-100%',
            })
        }
        settings.$nextSlide.show();
        $parent.animate({
            'left': -factor * width + 'px',
        }, function() {
            onAnimationComplete(settings, $parent);
        });
    };
    /**
     * End of SlideHorizontallyTransition class
     */
    pub.SlideHorizontallyTransition = SlideHorizontallyTransition;

    /**
     * SlideVerticallyTransition class changes slides by sliding them vertically.
     * This class can be removed if this effect is not used.
     * If offset (difference between index of currently displayed slide and index of slide that will be shown)
     * is greater than 0, slides are sliding from up to down. Otherwise (offset is lower than 0), slides are sliding
     * from down to up.
     * When slide change is raised automatically, slides are always sliding from up to down (offset == 1).
     * If user raises slides change, slides are sliding:
     * - from up to down, if offset is greater than 0 (slide with higher index will be shown or user clicks on 'next' navigation item),
     * - from down to up, if offset is lower than 0 (slide with lower index will be shown or user clicks on 'prev' navigation item).
     * @constructor
     */
    function SlideVerticallyTransition() {}
    SlideVerticallyTransition.prototype = new Transition();
    SlideVerticallyTransition.constructor = SlideVerticallyTransition;
    /**
     * @member SlideVerticallyTransition
     */
    SlideVerticallyTransition.prototype.onAnimationComplete = function(settings, $parent) {
        settings.$currentSlide.hide();
        settings.$nextSlide.css({
            'top': '',
            'bottom': '',
            'left': '',
            'right': '',
            'position': '',
            'width': ''
        });

		$parent.css('top', '');
        $parent.css('margin-top', '');

        settings.callback();
    };
    /**
     * @member SlideVerticallyTransition
     */
    SlideVerticallyTransition.prototype.perform = function (settings, offset) {
        var factor = this.factor(settings),
            onAnimationComplete = this.onAnimationComplete,
            height = settings.$currentSlide.height(),
            $parent = settings.$slides.parent();

        settings.$nextSlide.css({
            'left': '0',
            'right': '0',
            'position': 'absolute',
            'width': '100%'
        });
        if (offset > 0) {
            settings.$nextSlide.css({
                'top': '-100%',
                'bottom': '100%',
            })
        } else {
            settings.$nextSlide.css({
                'top': '100%',
                'bottom': '-100%',
            })
        }
        settings.$nextSlide.show();

        $parent.animate({
            'top': factor * height
        }, function() {
            onAnimationComplete(settings, $parent);
        });

    };
    /**
     * SlideVerticallyTransition class
     */
    pub.SlideVerticallyTransition = SlideVerticallyTransition;

    return pub;
}(jQuery));
/**
 * end of XA.component.carousels.Transitions module.
 */

/**
 * XAContext
 *
 * XA.component.carousels.IndicatorViews module.
 *
 * Exposes View class, which is a base class of all 'time indicator' views used by carousels (@see XA.component.carousels, @see View).
 * Also exposes implementation of these 'time indicator' views:
 * - ProgressBarView - shows the progress of time, that looks like a progress bar,
 * - RotatorView - shows the progress of time with the filling up ring.
 * Carousel takes the class constructor by name from this module (it is given in options object of carousel; @see XA.component.carousels).
 * If there is a need to implement the new 'time indicator' view, create a new class,
 * by inheriting from View class and add it to this module. During implementation of a new 'time indicator'
 * view the XA.component.carousels.IndicatorsView.Tools namespace may be usefull. It contains:
 * - isCssSupported(props) function, which checks if any of CSS properties is supported (props - array of properties),
 * - isTransformSupported() function, which checks if CSS 3 'transform' is supported.
 *
 * Example view implementation (opacity increases with a progress of the time):
 * (function() {
 *     var View = XA.component.carousels.IndicatorViews.View;
 *
 *     function SampleView (selector, options) {
 *         //base constructor have to be called
 *         View.call(this, selector);
 *     }
 *
 *     SampleView.prototype = new View();
 *     SampleView.constructor = SampleView;
 *
 *     SampleView.prototype.init = function (timeout) {
 *         //base method have to be called
 *         View.prototype.init.call(this, timeout);
 *
 *         //initialization code - not needed in this example
 *     };
 *
 *     SampleView.prototype.reset = function () {
 *         //base method have to be called
 *         View.prototype.reset.call(this);
 *
 *         //reseting 'time indicator' view
 *         this.$indicator.stop(true);
 *         this.$indicator.css('opacity', 0);
 *     };
 *
 *     SampleView.prototype.pause = function () {
 *         //stoping 'time indicator' view animation
 *         this.$indicator.stop(true);
 *     };
 *
 *     SampleView.prototype.play = function () {
 *         //starting/resuming 'time indicator' view animation
 *         this.$indicator.animate({
 *             'opacity': 1
 *         }, this.timeout - this.timeElapsed, 'linear');
 *     };
 *
 *     XA.component.carousels.IndicatorViews.SampleView = SampleView;
 * }());
 *
 */
XA.component.carousels.IndicatorViews = (function($) {
    var pub = {},
        supportElementStyle = null;

    /**
     * Checks if any of CSS properties is supported.
     *
     * @param {Array} props     array of properties to be checked
     * @return true if any of CSS properties is supported, false otherwise
     * @type Boolean
     */
    function isCssSupported(props) {
        var i,
            isSupported = false;

        if (supportElementStyle === null) {
            supportElementStyle = document.createElement('supportElement').style;
        }

        for (i = 0; i < props.length; i++) {
            if (supportElementStyle[props[i]] !== undefined) {
                isSupported = true;
                break;
            }
        }

        return isSupported;
    }

    /**
     * Checks if CSS 3 'transform' is supported.
     *
     * @return true if CSS 3 'transform' is supported, false otherwise
     * @type Boolean
     */
    function isTransformSupported() {
        return isCssSupported(['transformProperty', 'WebkitTransform', 'MozTransform', 'OTransform', 'msTransform']);
    }

    /**
     * XA.component.carousels.IndicatorViews.Tools namespace
     *
     This namespace can be removed if RotatorView class is not used (@see RotatorView)
     */
    pub.Tools = {};
    pub.Tools.isCssSupported = isCssSupported;
    pub.Tools.isTransformSupported = isTransformSupported;
    /**
     * End of namespace
     */

    /**
     * View class is a base class of all 'time indicator' views
     * @constructor
     * @param {String} selector a selector used for searching
     * @param {Object} options   View options object
     */
    /* eslint-disable */
    function View(selector, options) {
        /**
         * A jQuery object containing element, which will be animated to show pogress of the time.
         *
         * @member View
         */

        this.$indicator = $(selector);
    }
    /* eslint-enable */
    /**
     * Initializes the view.
     *
     * @member Viewion
     * @param {Number} timeout   a timeout to the end of whole indicator animation
     */
    View.prototype.init = function(timeout) {
        this.timeElapsed = 0;
        this.timeout = timeout;
    };
    /**
     * Resets the view
     *
     * @member View
     */
    View.prototype.reset = function() {
        this.timeElapsed = 0;
    };
    /**
     * Starts/Renews the view animation.
     *
     * @member View
     */
    View.prototype.play = function() {};
    /**
     * Pauses the view animation.
     *
     * @member View
     */
    View.prototype.pause = function() {};
    /**
     * Updates the time that elapsed since animation begin.
     *
     * @member View
     */
    View.prototype.update = function(timeElapsed) {
        this.timeElapsed = timeElapsed;
    };
    /**
     * end of View class
     */
    pub.View = View;

    /**
     * ProgressBarView class provides a logic for animate a 'time indicator',
     * that looks like progress bar.
     *
     * Options object:
     * {
     *     'opacity': Number value //between 0 and 1; default is 0.8
     * }
     *
     * This class can be removed if this kind of view is not used.
     *
     * @constructor
     * @param {String} selector a selector used for searching
     * @param {Object} options   View options object
     */
    function ProgressBarView(selector, options) {
        View.call(this, selector);

        var defaults = {
            'opacity': 0.8
        };

        this.settings = $.extend(true, {}, defaults, options);

        this.$container = this.$indicator;
        this.$indicator = this.$indicator.find('div');
    }
    ProgressBarView.prototype = new View();
    ProgressBarView.constructor = ProgressBarView;
    /**
     * @member ProgressBarView
     */
    ProgressBarView.prototype.init = function(timeout) {
        View.prototype.init.call(this, timeout);

        var opacity = this.settings.opacity;
        this.$container.css('opacity', opacity);
        this.$indicator.css('opacity', opacity);
    };
    /**
     * @member ProgressBarView
     */
    ProgressBarView.prototype.reset = function() {
        View.prototype.reset.call(this);

        this.$indicator.stop(true);
        this.$indicator.css('width', '0px');
    };
    /**
     * @member ProgressBarView
     */
    ProgressBarView.prototype.pause = function() {
        this.$indicator.stop(true);
    };
    /**
     * @member ProgressBarView
     */
    ProgressBarView.prototype.play = function() {
        this.$indicator.animate({
            'width': '100%'
        }, this.timeout - this.timeElapsed, 'linear');
    };
    /**
     * end of ProgressBarView class
     */
    pub.ProgressBarView = ProgressBarView;

    /**
     * RotatorView class provides a logic for animate a 'time indicator',
     * that shows the progress of time with the filling up ring
     *
     * Options object:
     * {
     *     'opacity': Number value //between 0 and 1; default is 0.5
     * }
     *
     * This class can be removed if this kind of view is not used.
     *
     * @constructor
     * @param {String} selector a selector used for searching
     * @param {Object} options   View options object
     */
    function RotatorView(selector, options) {
        View.call(this, selector);

        var defaults = {
            'opacity': 0.5
        };

        this.settings = $.extend(true, {}, defaults, options);
        this.$mask = this.$indicator.find('span.mask').first();
        this.$rotator = this.$indicator.find('span.rotator').first();

        function rotateCss(deg) {
            var value = 'rotate(' + deg + 'deg)';

            return {
                '-webkit-transform': value,
                '-moz-transform': value,
                '-o-transform': value,
                '-ms-transform': value,
                'transform': value
            };
        }

        function animateRotator($rotator, options) {
            var defaults = {
                    'fontSize': '180px',
                    'animateOptions': {
                        'step': function(now) {
                            $rotator.css(rotateCss(now));
                        },
                        'easing': 'linear'
                    }
                },
                settings = $.extend(true, {}, defaults, options);

            $rotator.animate({
                    'font-size': settings.fontSize
                },
                settings.animateOptions);
        }

        function phaseTwoAnimation($mask, $rotator, duration) {
            $rotator.addClass('half');
            $mask.addClass('half');

            animateRotator($rotator, {
                'fontSize': '360px',
                'animateOptions': {
                    'duration': duration
                }
            });
        }

        function phaseOneAnimation($mask, $rotator, duration, phaseTwoDuration) {
            animateRotator($rotator, {
                'animateOptions': {
                    'duration': duration,
                    'complete': function() {
                        phaseTwoAnimation($mask, $rotator, phaseTwoDuration);
                    }
                }
            });
        }

        this.resetCss = function() {
            this.$rotator.removeClass('half');
            this.$rotator.css(rotateCss(0));
            this.$rotator.css('font-size', '0px');

            this.$mask.removeClass('half');
        };

        this.playPhaseOne = function() {
            var duration = this.timeout / 2 - this.timeElapsed;
            phaseOneAnimation(this.$mask, this.$rotator, duration, this.timeout / 2);
        };

        this.playPhaseTwo = function() {
            var duration = this.timeout - this.timeElapsed;
            phaseTwoAnimation(this.$mask, this.$rotator, duration);
        };
    }
    RotatorView.prototype = new View();
    RotatorView.constructor = RotatorView;
    /**
     * @member RotatorView
     */
    RotatorView.prototype.init = function(timeout) {
        View.prototype.init.call(this, timeout);

        if (isTransformSupported()) {
            this.$indicator.show();
            this.$mask.css('opacity', this.settings.opacity);
        }
    };
    /**
     * @member RotatorView
     */
    RotatorView.prototype.reset = function() {
        View.prototype.reset.call(this);

        this.$rotator.stop(true);
        this.resetCss();
    };
    /**
     * @member RotatorView
     */
    RotatorView.prototype.pause = function() {
        this.$rotator.stop(true);
    };
    /**
     * @member RotatorView
     */
    RotatorView.prototype.play = function() {
        var phase = this.playPhaseOne;
        if (this.timeElapsed >= this.timeout / 2) {
            phase = this.playPhaseTwo;
        }

        phase.call(this);
    };
    /**
     * end of RotatorView class
     */
    pub.RotatorView = RotatorView;

    return pub;
}(jQuery));
/**
 * end of XA.component.carousels.IndicatorViews module.
 */
XA.component.parallax = (function($) {
    var api = {};

    //Lodash implementation of Throttle
    function throttle(func, wait, options) {
        var context, args, result;
        var timeout = null;
        var previous = 0;
        if (!options) options = {};
        var later = function() {
            previous = options.leading === false ? 0 : Date.now();
            timeout = null;
            result = func.apply(context, args);
            if (!timeout) context = args = null;
        };
        return function() {
            var now = Date.now();
            if (!previous && options.leading === false) previous = now;
            var remaining = wait - (now - previous);
            context = this;
            args = arguments;
            if (remaining <= 0 || remaining > wait) {
                if (timeout) {
                    clearTimeout(timeout);
                    timeout = null;
                }
                previous = now;
                result = func.apply(context, args);
                if (!timeout) context = args = null;
            } else if (!timeout && options.trailing !== false) {
                timeout = setTimeout(later, remaining);
            }
            return result;
        };
    }

    function checkMobile() {
        return $(window).width() < 768;
    }

    function makeParallax($el) {
        var $bg = $el.children(".component-content"),
            vHeight = $(window).height(),
            elOffset = $bg[0].offsetTop,
            elHeight = $bg[0].offsetHeight,
            isMobile = checkMobile();

        function parallax() {
            if (isMobile) {
                return false;
            }
            var offset = $(window).scrollTop();

            if ((elOffset <= offset + vHeight) && (elOffset + elHeight >= offset)) {
                $bg.css("background-position", "50% " + Math.round((elOffset - offset) * 3 / 8) + "px");
            }
        }

        parallax();

        $(document).on("scroll", throttle(parallax, 10));
        $(window).on("resize", throttle(function() {
            isMobile = checkMobile();
            isMobile ? $bg.css("background-position", "50% 0") : parallax();
        }, 150));
    }

    api.initInstance=function(component) {
        makeParallax(component);
    }

    api.init = function() {
        $('.parallax-background:not(.initialized)').each(function() {
            api.initInstance($(this));
            $(this).addClass('initialized');
        });
    };

    return api;

})(jQuery);

XA.register('parallax-background', XA.component.parallax);
/**
 * Component Flash
 * @module Flash
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of flash methods
 */
// XA.component.flash = (function($) {
//     /**
//      * In this object stored all public api methods
//      * @type {Object.<Methods>}
//      * @memberOf module:Flash
//      * */
//     var api = {};
//     /**
//      * Set size of embeded element
//      * @memberOf module:Flash
//      * @method
//      * @param {jQuery.<Element>} object Embed element
//      * @private
//      */
//     function setSize(object) {
//         var oldHeight = object.attr("height");
//         var oldWidth = object.attr("width");
//         var newWidth = object.width();
//         var newHeight = (oldHeight * newWidth) / oldWidth;
//         object.height(newHeight);
//     }
//     /**
//      * Initialize flash component
//      * @memberOf module:Flash
//      * @method
//      * @param {jQuery} component Root DOM element of flash component wrapped by jQuery
//      * @param {Object} properties Properties setted in data attribute
//      * @private
//      */
//     function initFlash(component, properties) {
//         var content = component.find(".component-content > div");
//         content.flash(properties);
//     }
//     /**
//      * Call ["setSize"]{@link module:Flash.setSize} method
//      * and bind it to resize event
//      * @memberOf module:Flash
//      * @method
//      * @param {jQuery} component Root DOM element of flash component wrapped by jQuery
//      * @param {Object} prop Properties setted in data attribute
//      * @private
//      */
//     function attachEvents(component) {
//         $(document).ready(function() {
//             var object = component.find("embed");
//             object.css("width", "100%");
//             setSize(object);
//
//             $(window).resize(function() {
//                 setSize(object);
//             });
//         });
//     }
//
//     /**
//      * Call
//      * ["initFlash"]{@link  module:Flash.initFlash} and
//      * ["attachEvents"]{@link  module:Flash.attachEvents}
//      * methods
//      * @memberOf module:Flash
//      * @method
//      * @param {jQuery} component Root DOM element of flash component wrapped by jQuery
//      * @param {Object} prop Properties setted in data attribute
//      *  of flash component
//      * @alias module:Flash.initInstance
//      */
//     api.initInstance = function(component, prop) {
//         initFlash(component, prop);
//         attachEvents(component);
//     };
//     /**
//      * Find all not initialized yet
//      * Flash component and in a loop for each of them
//      * run Flash's
//      * ["initInstance"]{@link module:Flash.initInstance}
//      * method.
//      * @memberOf module:Flash
//      * @alias module:Flash.init
//      */
//     api.init = function() {
//         var flash = $(".flash:not(.initialized)");
//         if (flash.length > 0) {
//             flash.each(function() {
//                 var properties = $(this).data("properties");
//                 api.initInstance($(this), properties);
//                 $(this).addClass("initialized");
//             });
//         }
//     };
//
//     return api;
// })(jQuery, document);

XA.component.flash = (function($, document) {
    console.warn("Unsupported component: `XA.component.flash`");
});

XA.register("flash", XA.component.flash);

/**
 * Component Flip
 * @module Flip
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of flip methods
 */
XA.component.flip = (function($) {
    /**
     * In this object stored all public api methods
     * @type {Object.<Methods>}
     * @memberOf module:Flip
     * @
     * */
    var api = {
            /**
             * equalSideHeight set css "min-height" property with value that
             * equal to size of bigger flip side 
             * @param {jQuery<DOMElement>} $el  Root DOM element of Flip component wrapped by jQuery 
             * @memberof module:Flip
             * @method equalSideHeight
             */
            equalSideHeight: function($el) {
                var side0 = $el.find(".Side0"),
                    side1 = $el.find(".Side1"),
                    slide0Height = this.calcSlideSizeInToggle(side0),
                    slide1Height = this.calcSlideSizeInToggle(side1),
                    maxHeight = Math.max(slide0Height, slide1Height);
                $el.find(".flipsides").css({ "min-height": maxHeight + "px" });
                side0.add(side1).css({ bottom: 0 });
            },
            /**
             * calcSlideSizeInToggle calculate size of slide content
             * @param {jQuery<DOMElement>} $slide Slide DOM Element of flip component
             * @memberof module:Flip
             * @method calcSlideSizeInToggle
             * @return {number} size
             */
            calcSlideSizeInToggle: function($slide) {
                var child = $slide.find(">div"),
                    size = 0;
                child.each(function(pos, el) {
                    size += $(el).outerHeight(true);
                });
                size += parseInt($slide.css("padding-top"));
                size += parseInt($slide.css("padding-bottom"));
                return size;
            },
            /**
             * equalSideHeightInToggle method that called from component toggle 
             * to make all slides inside same height
             * @param {jQuery<DOMElement>} $el  Root DOM element of Flip component wrapped by jQuery 
             * @memberof module:Flip
             * @method equalSideHeightInToggle
             */
            equalSideHeightInToggle: function($el) {
                var side0 = $el.find(".Side0"),
                    side1 = $el.find(".Side1"),
                    slide0Height = this.calcSlideSizeInToggle(side0),
                    slide1Height = this.calcSlideSizeInToggle(side1),
                    maxHeight = Math.max(slide0Height, slide1Height);
                $el.find(".flipsides").css({ "min-height": maxHeight + "px" });
                side0.add(side1).css({ bottom: 0 });
            }
        };

    function detectMobile() {
        return "ontouchstart" in window;
    }
    /**
     * calcHeightOnResize method call
     * ["equalSideHeight"]{@link module:Flip.equalSideHeight} method
     * for all initialized Flip components
     * @memberOf module:Flip
     * @method
     * @alias module:Flip.initInstance
     * @private
     */
    function calcHeightOnResize() {
        var flip = $(".flip.initialized");
        flip.each(function() {
            api.equalSideHeight($(this));
        });
    }
    /**
     * initInstance method bind toggling "active" class for component
     * an Flip element
     * @memberOf module:Flip
     * @method
     * @param {jQuery} component Root DOM element of flip component wrapped by jQuery
     * @alias module:Flip.initInstance
     */
    api.initInstance = function(component) {
        // Set tabindex=0 for first header
        component.find('[class*="Side0"]').attr("tabindex", "0");
        //
        if (component.hasClass("flip-hover") && !detectMobile()) {
            component.hover(
                function() {
                    component.addClass("active");
                },
                function() {
                    component.removeClass("active");
                }
            );
        } else {
            component.on("click", function() {
                component.toggleClass("active");
            });
        }
    };
    /**
     * init method calls in a loop for each
     * flip component on a page and run Flip's
     * ["initInstance"]{@link module:Flip.api.initInstance},
     * ["equalSideHeight"]{@link module:Flip.equalSideHeight} methods.
     * Added watcher to "resize" event on window that call
     * ["calcHeightOnResize"]{@link module:Flip.calcHeightOnResize}
     *
     * @memberOf module:Flip
     * @alias module:Flip.init
     */
    api.init = function() {
        var flip = $(".flip:not(.initialized)");
        $(window).on("resize", function() {
            calcHeightOnResize();
        });
        flip.each(function() {
            var $flipModule = $(this).find(".flipsides");
            $flipModule.find(".Side0").attr("tabindex", "0");
            api.initInstance($(this));
            $(this).addClass("initialized");
            api.equalSideHeight($(this));
        });
    };
    return api;
})(jQuery, document);

XA.register("flip", XA.component.flip);

/**
 * Component Language Selector
 * @module LanguageSelector
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of language selector methods methods
 */
// XA.component.languageSelector = (function($) {
//     /**
//      * In this object stored all public api methods
//      * @type {Object.<Methods>}
//      * @memberOf module:LanguageSelector
//      * */
//     var api = {};
//     /**
//      * readDataAttributes function that return
//      * name of a language flag in format
//      * 'flags-'+language name
//      * @memberOf module:LanguageSelector
//      * @param {jQuery} item
//      * @private
//      */
//     function readDataAttributes(item) {
//         var country = item.data("country-code");
//
//         return "flags-" + country;
//     }
//     /**
//      * initLanguageSelector setted up flag classes for laguage selector items
//      * and bind 'click' event to drop down item that will toggle it visibility
//      * @memberOf module:LanguageSelector
//      * @param {jQuery} instance Root DOM element of language selector
//      * component
//      */
//     function initLanguageSelector(instance) {
//         var el = $(instance),
//             header = el.find(".language-selector-select-item"),
//             dropDownList = el.find(".language-selector-item-container"),
//             dropDownItem = dropDownList.find(".language-selector-item");
//
//         var className = readDataAttributes(header);
//         header.find(">a").addClass(className);
//
//         dropDownList.find(".language-selector-item").each(function() {
//             className = readDataAttributes($(this));
//             $(this)
//                 .find(">a")
//                 .addClass(className);
//         });
//
//         header.on("click", function() {
//             dropDownList.slideToggle();
//         });
//
//         dropDownItem.on("click", function() {
//             var url = $(this)
//                 .find("a")
//                 .attr("href");
//
//             window.location.href = url;
//         });
//     }
//     /**
//      * initInstance method calls
//      * [".initLanguageSelector"]{@link module:LanguageSelector.initLanguageSelector}  method.
//      * @memberOf module:LanguageSelector
//      * @method
//      * @param {jQuery} component Root DOM element of language selector component
//      * @alias module:LanguageSelector.initInstance
//      */
//     api.initInstance = function(component) {
//         initLanguageSelector(component);
//     };
//
//     /**
//      * init method calls in a loop for each
//      * language selector component on a page and run LanguageSelector's
//      * [".initInstance"]{@link module:LanguageSelector.api.initInstance}  method.
//      * @memberOf module:LanguageSelector
//      * @alias module:LanguageSelector.init
//      */
//     api.init = function() {
//         var languageSelector = $(".language-selector:not(.initialized)");
//
//         languageSelector.each(function() {
//             api.initInstance(this);
//             $(this).addClass("initialized");
//         });
//     };
//
//     return api;
// })(jQuery, document);


XA.component.languageSelector = (function($, document) {
    console.warn("Unsupported component: `XA.component.languageSelector`");
});

XA.register("language-selector", XA.component.languageSelector);

/**
 * Component Navigation
 * @module Navigation
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of navigation methods
 */
XA.component.navigation = (function($) {
    var timeout = 200,
        timer = 0,
        submenu,
        dropDownEvents = {
            show: function(sm) {
                this.debounce();
                submenu = sm;
                submenu.closest("li").addClass("show");
            },
            debounce: function() {
                if (timer) {
                    clearTimeout(timer);
                    timer = null;
                }
            },
            hide: function() {
                if (submenu) {
                    submenu.closest("li").removeClass("show");
                }
            },
            queueHide: function() {
                timer = setTimeout(function() {
                    dropDownEvents.hide();
                }, timeout);
            },
            focus: function() {
                $(this)
                    .closest("li")
                    .siblings()
                    .removeClass("show");
                $(this)
                    .closest("li")
                    .addClass("show");
            },
            blur: function() {
                if (
                    $(this)
                        .closest("li")
                        .is(".last")
                ) {
                    $(this)
                        .parents(".rel-level1")
                        .removeClass("show");
                }
            }
        };

    /**
     * Prepare DOM structure of Navigation component and<br/>
     * add Event listeners of showing and hiding
     * different levels of navigation.
     * @method
     * @alias module:Navigation.dropDownNavigation
     * @memberOf module:Navigation
     * breadcrum elements wrapped by jquery
     * @param {jQuery} navi Root DOM element of
     * navigation component wrapped by jQuery
     * @private
     */
    function dropDownNavigation(navi) {
        navi.on(
            "mouseover",
            ".rel-level1 > a, .rel-level1 >.navigation-title>a, .rel-level2 >.navigation-title>a",
            function() {
                $(this)
                    .closest("li")
                    .siblings()
                    .removeClass("show");
                $(this)
                    .closest("li.rel-level1")
                    .siblings()
                    .removeClass("show");
                $(this)
                    .closest("li.rel-level1")
                    .siblings()
                    .find(".show")
                    .removeClass("show");
                var elem = $(this)
                    .closest("li")
                    .find(">ul");
                dropDownEvents.show(elem);
            }
        );
        navi.on(
            "mouseleave",
            ".rel-level1 > a, .rel-level1 >.navigation-title",
            dropDownEvents.queueHide
        );
        navi.on("mouseover", ".rel-level1 > ul", dropDownEvents.debounce);
        navi.on("mouseleave", ".rel-level1 > ul", dropDownEvents.queueHide);
        navi.on(
            "focus",
            ".rel-level1 > a, .rel-level1 >.navigation-title, .rel-level1 >.navigation-title",
            dropDownEvents.focus
        );
        navi.on("blur", ".rel-level2 > a", dropDownEvents.blur);
        navi.on("mouseleave", function() {
            $(this)
                .find(".show")
                .removeClass("show");
        });
        navi.find(".rel-level1").each(function() {
            if ($(this).find("ul").length) {
                $(this).addClass("submenu");
            }
        });

        navi.find(".rel-level2").each(function() {
            //if level2 menu have children
            if ($(this).parents("#header") > 0) {
                if ($(this).find("ul").length) {
                    $(this).addClass("submenu");
                    $(this)
                        .parents(".rel-level1")
                        .addClass("wide-nav");
                }
            }

            //if level2 menu should be navigation-image variant
            if ($(this).find("> img").length) {
                $(this).addClass("submenu navigation-image");
            }
        });

        navi.on("click", ".sxaToogleNavBtn", function() {
            var $this = jQuery(this);
            $this.find(".sxaWrappedList").toggleClass("hidden");
        });
    }
    /**
     * Prepare DOM structure of Mobile Navigation component and<br/>
     * add Event listeners of showing and hiding
     * different levels of navigation.
     * @method
     * @alias module:Navigation.mobileNavigation
     * @memberOf module:Navigation
     * breadcrum elements wrapped by jquery
     * @param {jQuery} navi Root DOM element of
     * navigation component wrapped by jQuery
     * @private
     */
    function mobileNavigation(navi) {
        function checkChildren(nav) {
            nav.find(".rel-level1").each(function() {
                if (!$(this).find("ul").length) {
                    $(this).addClass("no-child");
                }
            });
        }

        function bindEvents(nav) {
            nav.find(".navigation-title").on("click", function(e) {
                var navlvl = $(this).closest("li"),
                    menuParent = navlvl.parents(".navigation");

                if (menuParent.hasClass("navigation-mobile")) {
                    if (!$(e.target).is("a")) {
                        if (navlvl.hasClass("active")) {
                            navlvl.find(">ul").slideToggle(function() {
                                navlvl.removeClass("active");
                            });
                        } else {
                            navlvl.find(">ul").slideToggle(function() {
                                navlvl.addClass("active");
                            });
                        }
                    }
                }
            });

            nav.find(".rel-level1").on("focus", function() {
                $(this)
                    .siblings("ul")
                    .slideDown();
                $(this)
                    .closest("li")
                    .siblings()
                    .find("ul")
                    .slideUp();
            });
        }
        checkChildren(navi);
        bindEvents(navi);
    }

    /**
     * @method
     * @alias module:Navigation.toggleIcon
     * @memberOf module:Navigation
     * @param {$} toggle
     * navigation elements wrapped by jquery
     * @private
     */
    function toggleIcon(toggle) {
        $(toggle).on("click", function() {
            $(this)
                .parents(".navigation")
                .toggleClass("active");
            $(this).toggleClass("active");
        });
    }

    /**
     * In this object stored all public api methods
     * @type {Object.<Methods>}
     * @memberOf module:Navigation
     * */
    var api = {};

    /**
     * initIstance method. <br/>
     * If added <b>navigation-main</b> class
     * called [dropDownNavigation]{@link module:Navigation.dropDownNavigation},
     * [mobileNavigation]{@link module:Navigation.mobileNavigation} methods. <br/>
     * If added <b>navigation-mobile</b> class
     * called only [mobileNavigation]{@link module:Navigation.mobileNavigation},
     * @memberOf module:Navigation
     * @method
     * @param {jQuery} component Root DOM element of
     * navigation component wrapped by jQuery
     * @alias module:Navigation.initInstance
     */
    api.initInstance = function(component) {
        if (component.hasClass("navigation-main")) {
            dropDownNavigation(component);
            mobileNavigation(component);
        } else if (component.hasClass("navigation-mobile")) {
            mobileNavigation(component);
        }
    };
    /**
     * init method calls [initInstance]{@link module:Navigation.initInstance} method
     * in a loop for each navigation component on a page. <br/>
     *
     * For navigation with setted <b>mobile-nav</b> class
     * calls [toggleIcon]{@link module:Navigation.toggleIcon} method
     *
     * @memberOf module:Navigation
     * @alias module:Navigation.init
     */
    api.init = function() {
        var navigation = $(".navigation:not(.initialized)");
        navigation.each(function() {
            api.initInstance($(this));
            $(this).addClass("initialized");
        });

        var toggle = $(".mobile-nav:not(.initialized)");
        toggle.each(function() {
            toggleIcon(this);
            $(this).addClass("initialized");
        });
    };

    return api;
})(jQuery, document);

XA.register("navigation", XA.component.navigation);

/* global mejs:false */
XA.component.overlay = function ($) {

    var api = {},
        href = window.location.href,
        host = location.host,
        label,
        overlayPlaceholder = false,
        marginTop = 100,
        focusableElementsString = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]',
        firstTabStop,
        lastTabStop,
        overlayClickSource;

    function isPreviewMode() {
        if (href.indexOf("sc_mode=preview") > -1) {
            return true;
        }
        var $hdPageMode = $('#hdPageMode');

        return $hdPageMode.length > 0 && $hdPageMode.attr('value') == 'preview';
    }



    function isOverlayPage() {
        return $('#wrapper').hasClass('overlay-page');
    }

    function hasOverlayContent() {
        return $(".overlay-source").length;
    }

    api.resizeOverlay = function (inner, content, options) {
        var unit = "px";
        var css = {
            "width": "",
            "height": ""
        };
        var wh = $(window).height();

        if (options.percent) {
            unit = "%";
            inner.addClass("overlay-percent");
        } else {
            inner.removeClass("overlay-percent");
        }

        if (options.width) {
            css["width"] = options.width + unit;
        }
        if (options.height) {
            css["height"] = options.height + unit;
        }

        css["max-height"] = (wh - marginTop - 0.1 * wh) + "px";

        content.css(css);
    }

    function getUrlVariables(url) {
        var q = url.split('?')[1],
            vars = [],
            hash;

        if (q != undefined) {
            q = q.split('&');
            for (var i = 0; i < q.length; i++) {
                hash = q[i].split('=');
                vars.push(hash[1]);
                vars[hash[0]] = hash[1];
            }
        }

        return vars;
    }

    function getSize(vars) {
        var obj = {};

        if (vars["width"] !== null) {
            obj["width"] = vars["width"];
        }

        if (vars["height"] !== null) {
            obj["height"] = vars["height"];
        }

        return obj;
    }

    function checkInternal(url) {
        if (url.indexOf(host) > -1) {
            return true;
        }
        return false;
    }

    function checkImage(url) {
        var ext = url.split("?")[0].split('.').pop();
        if ($.inArray(ext, ['gif', 'png', 'jpg', 'jpeg']) > -1) {
            return true;
        }

        return false;
    }


    function loadOverlay(url, overlay) {
        var content = overlay.find(".overlay-inner"),
            overlayContent = overlay.find(".component-content"),
            vars = getUrlVariables(url),
            internalLink = checkInternal(url),
            overlaySize = getSize(vars),
            suffix;
        overlayContent.addClass('overlayFullWidth');
        content.removeAttr('style');
        if (internalLink) {
            if (checkImage(url)) {
                content.empty().append($("<img>", { src: url }));
                content.css(overlaySize);
                overlayContent.removeClass('overlayFullWidth');
                showOverlay(overlay);
            } else if (url.indexOf("overlaytype=iframe") > -1) {
                content.empty().append($("<iframe>", { src: url, style: "width: 100%; height: 100%" }));
                content.css(overlaySize);
                showOverlay(overlay);
            } else {
                if (isPreviewMode()) {
                    suffix = "cf_overlay=1";
                    url = url.replace("sitecore/shell/");
                    url += (url.indexOf("?") == -1 ? "?" : "&") + suffix;
                }

                $.get(url, function (data) {
                    var overlayData = $(data).before().first();

                    api.resizeOverlay(content, overlayContent, {
                        width: overlayData.attr("data-width"),
                        height: overlayData.data("height"),
                        percent: overlayData.data("percent")
                    });

                    content.empty().append(data);
                    XA.init();
                    showOverlay(overlay);
                });
            }
        } else {
            if (checkImage(url)) {
                content.empty().append($("<img>", { src: url }));
            } else {
                content.empty().append($("<iframe >", { src: url, style: "width: 100%; height: 100%" }));
            }
            content.css(overlaySize);
            showOverlay(overlay);
        }

    }

    function preShowOverlay(overlay) {
        overlay.css({
            "opacity": 1
        }).show();
    }

    function showOverlay(overlay) {
        var close, content;
        overlay.show().animate({
            opacity: 1
        });

        //Rerun knockout binding for any incoming knockout powered renderings:
        CXAApplication.CreateComponentInstance("[data-cxa-component-class]", true);

        // hide wrapper data from screen readers
        $("#wrapper").addClass("aria-hidden");

        overlayClickSource = document.activeElement;

        close = overlay.find(".overlay-close");
        setTimeout(function () { close.focus(); }, 0);

        content = overlay.find(".overlay-inner");
        content.blur(function (args) {
            args.preventDefault();
            args.stopPropagation();
            setTimeout(function () { close.focus() }, 0);
        });

        // Find all focusable children
        var focusableElements = content.find(focusableElementsString);

        // Convert NodeList to Array
        focusableElements = Array.prototype.slice.call(focusableElements);
        firstTabStop = focusableElements[0];
        lastTabStop = focusableElements[focusableElements.length - 1];

        // Focus first
        firstTabStop.focus();
        return overlay;
    }

    function hideOverlay(overlay) {
        $("#wrapper").removeClass("aria-hidden");
        var content = overlay.find(".overlay-inner");

        overlay.animate({ opacity: 0 },
            function () {
                overlay.hide();
                content.empty();

                if (typeof(mejs) !== "undefined") {
                    for (var p in mejs.players) {
                        if ($("#" + mejs.players[p].id).parents(".overlay").length === 1) {
                            $("#" + mejs.players[p].id + ' video').attr('src', '');
                            mejs.players[p].remove();
                            mejs.players.splice(p, 1);
                        }
                    }
                }
            }
        );
       
        return overlay;
    }

    function createOverlay() {
        var overlay = "<div class='overlay-wrapper'>" +
            "<div class='overlay component'>" +
            "<div class='component-content' role='dialog'>" +
            "<div class='overlay-inner'></div>" +
            "<div class='overlay-close' role='button' aria-label='Close dialog'></div>" +
            "</div>" +
            "</div>" +
            "</div>";

        $("body").append(overlay);
    }

    api.initInstance = function (component, overlay, overlayContent) {
        component.on("click",
            function (event) {
                event.preventDefault();
                event.stopPropagation();
                preShowOverlay(overlay, overlayContent);

                var uri = this.href;
                loadOverlay(uri, overlay);

                var href = this.href.split('/');
                for (var i = 0; i <= href.length; i++) {
                    label = href.pop();
                    if (label.length == 0) {
                        continue;
                    }
                    break;
                }
            });
    }

    api.init = function () {
        var overlayContent,
            overlaySource,
            overlayInner,
            overlayCloseLink,
            closeAction,
            page,
            overlay,
            content;

        if (!overlayPlaceholder && hasOverlayContent()) {
            createOverlay();
        }

        if (isOverlayPage()) {

            page = $(".overlay-page");
            overlayContent = page.children(".component-content");
            overlay = $("#spnOverlay");
            content = overlayContent.children(".overlay-inner");

            api.resizeOverlay(content, overlayContent, {
                width: overlayContent.data("width"),
                height: overlayContent.data("height"),
                percent: overlayContent.data("percent")
            });
            overlayContent.on("click", function (event) {
                event.stopPropagation();
            });
            page.on("click", function () {
                if (isPreviewMode()) {
                    location.href = location.href.replace("sc_mode=preview", "sc_mode=edit");
                }
            });
        }
        overlay = $(".overlay-wrapper > .overlay");
        overlayContent = overlay.find(".component-content");
        overlaySource = $(".overlay-source a:not(.initialized), a.overlay-source:not(.initialized)");
        overlayInner = $(".overlay-inner");
        overlayCloseLink = overlay.find(".overlay-close");

        closeAction = function () {
            hideOverlay(overlay);
            overlayInner.off("blur");
            setTimeout(function () {
                if (overlayClickSource != null) {
                    overlayClickSource.focus();
                }
            }, 0);
        };

        if (!overlayPlaceholder) {
            overlayContent.on("click", function (event) {
                event.stopPropagation();
            });

            overlay.on("click", function () {
                closeAction();
            });

            overlayCloseLink.on("click", function (args) {
                args.preventDefault();
                closeAction();
            });

            $("body").keydown(function (e) {
                // Check for TAB key press
                if (e.keyCode === 9) {
                    // SHIFT + TAB
                    if (e.shiftKey) {
                        if (document.activeElement === firstTabStop) {
                            e.preventDefault();
                            lastTabStop.focus();
                        }

                        // TAB
                    } else if (document.activeElement === lastTabStop) {
                        e.preventDefault();
                        // firstTabStop.attr('tabindex', 0);
                        firstTabStop.focus();
                    }
                }

                // ESCAPE
                if (e.keyCode === 27) {
                    e.stopPropagation();
                    closeAction();
                }
            });

            $(window).on("resize", function () {
                var height = $(window).height();
                height = height - marginTop - 0.1 * height;
                overlayContent.css("max-height", height + "px");
            });

            overlayPlaceholder = true;
        }


        overlaySource.each(function () {

            api.initInstance($(this), overlay, overlayContent);
            $(this).addClass("initialized");
        });


    };

    return api;

}(jQuery);

XA.register("overlay", XA.component.overlay);

[].forEach.call(document.querySelectorAll('.search-results.overlay-source'), function (e) {
    XA.dom.observeDOM(e, function () { XA.component.overlay.init(); });
});
/**
 * Component Snippet
 * @module Snippet
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of Snippet methods
 */
XA.component.snippet = (function($) {
     /**
     * In this object stored all public api methods
     * @type {Object.<Methods>}
     * @memberOf module:Snippet
     * @
     * */
    var api = {},
        instance;
     /**
     * initInstance method of a Snippet element
     * @memberOf module:Snippet
     * @method
     * @param {jQuery} component Root DOM element of Snippet component wrapped by jQuery
     * @param {jQuery} snippetModule Snippet inner DOM element of Snippet component wrapped by jQuery
     * @alias module:Snippet.initInstance
     */
    api.initInstance = function(component, snippetModule) {};
    /**
     * init method calls in a loop for each
     * snippet component on a page and run Snippet's
     * ["initInstance"]{@link module:Snippet.api.initInstance} methods.
     * @memberOf module:Snippet
     * @alias module:Snippet.init
     */
    api.init = function() {
        var $snippets = $(".snippet:not(.initialized)");
        $snippets.each(function() {
            var $snippetModule = $(this).find(".snippet-inner");
            instance = $(this);
            api.initInstance(instance, $snippetModule);
            $(this).addClass("initialized");
        });
    };

    return api;
})(jQuery);

XA.register("snippet", XA.component.snippet);

/**
 * Component Social
 * @module Social
 * @param  {jQuery} $ Instance of jQuery
 * @param  {document} document document object
 * @return {Object} List of Social component methods
 */
// XA.component.social = (function($, document) {
//     /**
//      * In this object stored all public api methods
//      * @type {Object.<Methods>}
//      * @memberOf module:Social
//      * @
//      * */
//     var api = {};
//     api.shareProperties;
//     /**
//      * Create connector for facebook
//      * initInstance method of a Social component
//      * @memberOf module:Social
//      * @method
//      * @alias module:Social.initFacebook
//      */
//     api.initFacebook = function() {
//         (function(d, s, id) {
//             var js,
//                 fjs = d.getElementsByTagName(s)[0];
//             if (d.getElementById(id)) {
//                 return;
//             }
//             js = d.createElement(s);
//             js.id = id;
//             js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
//             fjs.parentNode.insertBefore(js, fjs);
//         })(document, "script", "facebook-jssdk");
//     };
//     /**
//      * Create connector for facebook
//      * initInstance method of a Social component
//      * @memberOf module:Social
//      * @param {Array} properties properties for external scripts
//      * @method
//      * @alias module:Social.initFacebook
//      */
//     var attachExternalScript = function(properties) {
//         var component = $(".sharethis"),
//             shareThisExternal;
//         if (window.stLight === undefined) {
//             shareThisExternal = document.createElement("script");
//             shareThisExternal.type = "text/javascript";
//             shareThisExternal.src = "//w.sharethis.com/button/buttons.js";
//             $(window).on("load", function() {
//                 $(properties).each(function() {
//                     try {
//                         window.stLight.options(this);
//                     } catch (e) {}
//                 });
//             });
//             $(component[0]).append(shareThisExternal);
//         }
//     };
//     /**
//      * initInstance method of a Social component
//      * @memberOf module:Social
//      * @method
//      * @param {jQuery} component Root DOM element of Social component wrapped by jQuery
//      * @param {Object} prop Social component properties
//      * @alias module:Social.initInstance
//      */
//     api.initInstance = function(component, prop) {
//         api.shareProperties.push(prop);
//     };
//     /**
//      * init method calls in a loop for each
//      * social component on a page and run
//      * ["initInstance"]{@link module:Snippet.api.initInstance} methods.
//      * @memberOf module:Social
//      * @alias module:Social.init
//      */
//     api.init = function() {
//         var shareThis = $(".sharethis:not(.initialized)");
//         api.shareProperties = [];
//         shareThis.each(function() {
//             var properties = $(this).data("properties");
//             api.initInstance($(this), properties);
//             $(this).addClass("initialized");
//         });
//         attachExternalScript(api.shareProperties);
//     };
//     return api;
// })(jQuery, document);


XA.component.social = (function($, document) {
    console.warn("Unsupported component: `XA.component.social`");
});
XA.register("social", XA.component.social);


/**
 * Component Tabs
 * @module Tabs
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of tabs methods
 */
XA.component.tabs = (function($) {
    /**
     * In this object stored all public api methods
     * @type {Object.<Methods>}
     * @memberOf module:Tabs
     * @
     * */
    var api = {},
        instance;
    /**
     * isFlipInside chech if inside Tab component present Flip component
     * @memberOf module:Tab
     * @method
     * @param {jQuery} $instance Tabs Root DOM element of tab component wrapped by jQuery
     * @alias module:Tab.isFlipInside
     * @return {boolean}
     * @private
     */
    var isFlipInside = function(instance) {
        return !!instance.find(".component.flip").length;
    };
    /**
     * tabsScrollable modify tabs to support scroll for tabs header
     * @memberOf module:Tab
     * @method
     * @param {jQuery} $tabsScroll Tabs Root DOM element of tab component wrapped by jQuery
     * @alias module:Tab.tabsScrollable
     * @private
     */
    function tabsScrollable($tabsScroll) {
        var speed = 150; //tabs scroll speed

        function initNavScroll($tabsNav) {
            var sum = 0,
                maxHeight = 0;

            if ($tabsNav.length) {
                $tabsNav
                    .parent()
                    .find(".prev")
                    .remove();
                $tabsNav
                    .parent()
                    .find(".next")
                    .remove();
                $tabsNav.unwrap();

                $tabsNav.css("width", "auto");
                $tabsNav.css("height", "auto");
                $tabsNav.css("left", 0);
            }

            $tabsNav.find("li").each(function() {
                sum += $(this).outerWidth(true);
            });

            $tabsNav.find("li").each(function() {
                maxHeight = Math.max(maxHeight, $(this).height());
            });

            $tabsNav.wrap("<div class='wrapper'>");
            $("<div class='next tab-slider'>></div>").insertAfter($tabsNav);
            $("<div class='prev tab-slider'><</div>").insertBefore($tabsNav);

            $tabsNav.parent().css("height", parseInt(maxHeight, 10));
            $tabsNav
                .parent()
                .find(".tab-slider")
                .css("height", parseInt(maxHeight, 10) - 2);
            //fix for 8111
            sum += 10;
            if (sum > $tabsNav.parent().width()) {
                $tabsNav
                    .parent()
                    .find(".prev")
                    .hide();
                $tabsNav.width(sum);
            } else {
                $tabsNav
                    .parent()
                    .find(".prev")
                    .hide();
                $tabsNav
                    .parent()
                    .find(".next")
                    .hide();
            }
        }

        function bindPrevNextEvents(current, $tabsNav) {
            current.find(".prev").click(function() {
                var left = parseInt($tabsNav.css("left"), 10);
                left += speed;

                if (left > 0) {
                    left = 0;
                    $tabsNav.stop().animate({
                        left: left
                    });

                    $tabsNav
                        .parent()
                        .find(".prev")
                        .hide();
                    $tabsNav
                        .parent()
                        .find(".next")
                        .show();
                } else {
                    $tabsNav.stop().animate({
                        left: left
                    });

                    $tabsNav
                        .parent()
                        .find(".prev")
                        .show();
                    $tabsNav
                        .parent()
                        .find(".next")
                        .show();
                }
            });

            current.find(".next").click(function() {
                var left = parseInt($tabsNav.css("left"), 10),
                    navWidth = $tabsNav.width(),
                    navParentWidth = $tabsNav.parent().width();

                left -= speed;

                if (navWidth + left < navParentWidth) {
                    left = navWidth - navParentWidth + 20;
                    $tabsNav.stop().animate({
                        left: -left
                    });

                    $tabsNav
                        .parent()
                        .find(".prev")
                        .show();
                    $tabsNav
                        .parent()
                        .find(".next")
                        .hide();
                } else {
                    $tabsNav.stop().animate({
                        left: left
                    });

                    $tabsNav
                        .parent()
                        .find(".prev")
                        .show();
                    $tabsNav
                        .parent()
                        .find(".next")
                        .show();
                }
            });
        }

        function bindChangeTabs($tabsNav, $tabsContainer) {
            $tabsNav.find("li").click(function(event) {
                var index = $(this).index(),
                    instance = $(this).closest(".component.tabs");

                $(this).addClass("active");
                $(this)
                    .siblings()
                    .removeClass("active");

                $tabsContainer.find(".tab").removeClass("active");
                $tabsContainer
                    .find(".tab:eq(" + index + ")")
                    .addClass("active");

                if (isFlipInside(instance)) {
                    try {
                        XA.component.flip.equalSideHeight(instance);
                    } catch (e) {
                        /* eslint-disable no-console */
                        console.warn(
                            "Error during calculation height of Flip list in toggle"
                        ); // jshint ignore:line
                        /* eslint-enable no-console */
                    }
                }
                event.preventDefault();
            });
        }

        function initTabsScrollable($tabs) {
            $tabs.each(function() {
                var $tabsNav = $(this).find(".tabs-heading"),
                    $tabsContainer = $(this).find(".tabs-container");

                $tabsNav.find("li:first-child").addClass("active");
                $tabsContainer.find(".tab:eq(0)").addClass("active");

                bindChangeTabs($tabsNav, $tabsContainer);
                initNavScroll($tabsNav);
                bindPrevNextEvents($(this), $tabsNav);
            });
        }

        initTabsScrollable($tabsScroll);
        $(window).on("resize", function() {
            initTabsScrollable($tabsScroll);
        })
    }
    /**
     * selectActiveTab activate selected tab
     * @memberOf module:Tab
     * @method
     * @param {jQuery} $tabNav Tabs header DOM element of tab component wrapped by jQuery
     * @param {jQuery} $tabs Tabs content DOM element of tab component wrapped by jQuery
     * @alias module:Tab.selectActiveTab
     * @private
     */
    function selectActiveTab($tabNav, $tabs) {
        var tabRootId = $tabNav.closest(".component.tabs").attr("id");
        var tabToSelect = XA.queryString.getQueryParam(tabRootId || "tab");

        if (
            tabToSelect != null &&
            !isNaN(parseInt(tabToSelect)) &&
            isFinite(tabToSelect)
        ) {
            tabToSelect = parseInt(tabToSelect);
            if ($tabNav.length > tabToSelect) {
                $($tabNav[tabToSelect]).addClass("active");
                $($tabs[tabToSelect]).addClass("active");

                return;
            }
        }
        $tabNav.first().addClass("active");
        $tabNav.first().attr("tabindex", "0");
        $tabs.first().addClass("active");
    }

    /**
     * @function activateTabFromAnchor - if URL contains a hash and it matches an existing tab id (with "-id" appended), activate the tab
     * Note: In order to prevent anchor scrolling behavior, the tab ID needs to match hash string and have "-id" appended at the end.
     * Example: URL Hash #tab-mywallet will activate id="tab-mywallet-id"
     */
    function activateTabFromAnchor() {
        // check if anchor hash includes "-id"
        var idString = "-id";
        var exists = new RegExp(idString).test(window.location.hash);
        // if "-id" is present, set tabId to the hash, otherwise set to hash with "-id" appended.
        var tabId = exists ? window.location.hash : window.location.hash + "-id";
        if (window.location.hash !== '' && $(tabId).length > 0) {
            // trigger click .tab-heading li that matches current hash
            $(tabId).parents(".tabs-heading > li").trigger("click");
        }
    }

    /**
     * @function updateURlFromTab - if selected tab contains an id, update the URL with id hash (dropping "-id" from the end).
     * @param {string} tabChildId - id of the selected tab 
     */
    function updateUrlFromTab(tabChildId) {
        // check if tabChildId includes "-id"
        var idString = "-id";
        var exists = new RegExp(idString).test(tabChildId);
        // if "-id" is present, remove "-id" from tabChildId, otherwise set to tabChildId
        var tabId = exists ? tabChildId.replace(idString, "") : tabChildId;
        // update URL hash with tabId
        window.location.hash = tabId;
    }

    /**
     * initInstance initialize component according to his option
     * @memberOf module:Tabs
     * @method
     * @param {jQuery} component Root DOM element of archive component wrapped by jQuery
     * @alias module:Tabs.initInstance
     */
    api.initInstance = function(component) {
        var $tabModule = component.find(".tabs-inner");
        if (component.hasClass("tabs-scrollable")) {
            tabsScrollable(component);
        } else {
            $tabModule.each(function() {
                var $tabNav = $(this).find(".tabs-heading > li"),
                    $tabs = $(this).find("> .tabs-container > .tab");

                selectActiveTab($tabNav, $tabs);

                $tabNav.on("click", function(event){
                    var current = $(this),
                    index = current.index(),
                    tabInner = current.parent().parent(),
                    tabChildId = current.children().children().children().attr("id");

                    current.siblings().removeClass("active");
                    tabInner
                        .find("> .tabs-container > .tab")
                        .removeClass("active");
                    current.addClass("active");                        
                    $(
                        tabInner
                            .children(".tabs-container")
                            .children(".tab")
                            .eq(index)
                    ).addClass("active");
                    if (isFlipInside(component)) {
                        try {
                            XA.component.flip.equalSideHeight(component);
                        } catch (e) {
                            /* eslint-disable no-console */
                            console.warn(
                                "Error during calculation height of Flip list in toggle"
                            ); // jshint ignore:line
                            /* eslint-disable no-console */
                        }
                    }
                    current.trigger("focus");
                    event.preventDefault();

                    // Update URL hash if present
                    if (typeof tabChildId !== "undefined") {
                        updateUrlFromTab(tabChildId);
                    }
                })
                .on("keyup", function(event) {
                    var currentHeading = $(this);
                    switch (event.keyCode) {
                        case 38: {
                            currentHeading.prev("li").trigger("click");
                            break;
                        }
                        case 40: {
                            currentHeading.next("li").trigger("click");
                            break;
                        }
                    }
                });
            });
        }

        if (isFlipInside(component)) {
            try {
                XA.component.flip.equalSideHeight(component);
            } catch (e) {
                /* eslint-disable no-console */
                console.warn(
                    "Error during calculation height of Flip list in toggle"
                ); // jshint ignore:line
                /* eslint-enable no-console */
            }
        }
    };
    /**
     * init method calls in a loop for each
     * tabs component on a page and run Tab's
     * ["initInstance"]{@link module:Tabs.api.initInstance} method
     * @memberOf module:Tabs
     * @alias module:Tabs.init
     */
    api.init = function() {
        var $tabs = $(".tabs:not(.initialized)");
        $tabs.each(function() {
            var instance = $(this);
            api.initInstance(instance);
            $(this).addClass("initialized");
        });

        // Activate tab if an anchor is present on load
        activateTabFromAnchor();

        // Listen for hash changes to activate tab if an anchor is present
        window.addEventListener('hashchange', function(e) {
            activateTabFromAnchor();
        })


    };

    return api;
})(jQuery);

XA.register("tabs", XA.component.tabs);

XA.component.toggle = (function($) {
    var api = {

    };

    var properties, instance;

    var getFlipList = function(instance) {
        return $(instance).find('.component.flip');
    }

    var openToggle = function(instance) {
        var flipList = getFlipList(instance),
            eventCalendar = $(instance).find('.event-calendar');
        $(instance).find('details').attr('open', 'open');
        if (eventCalendar.length){
            eventCalendar.trigger('resize')
        }
        if (flipList.lengt) {
            try {
                XA.component.flip.equalSideHeightInToggle(instance)
            } catch (e) {
                /* eslint-disable no-console */
                console.warn('Error during calculation height of Flip list in toggle'); // jshint ignore:line
                /* eslint-enable no-console */

            }
        }

    }
    var closeToggle = function(instance) {
        $(instance).find('details').removeAttr('open');
    }

    var setAnimation = function(instance) {
        $(instance).find('details summary~.component>.component-content').css({
            'animation-name': properties.easing,
            'animation-duration': (properties.speed || 500) + 'ms'
        })
    }
    var isExpandOnHover = function() {
        return properties.expandOnHover;
    }
    var isExpanded = function() {
        return properties.expandedByDefault;
    }
    var bindEvents = function(instance) {
        var summary = $(instance).find('summary');
        if (isExpandOnHover()) {
            summary.on('mouseenter', function() {
                openToggle(instance);
            })
        }
        if (isExpanded()) {
            openToggle(instance)
        }

        summary.on('click', function(event) {
            event.preventDefault();
            var details = $(this).closest('details')
            if (details.attr('open')) {
                closeToggle(instance);
            } else {
                openToggle(instance);
            }

        })

    }

    var initToggle = function(component) {
        bindEvents(component)
        setAnimation(component);
    };

    api.initInstance=function(component) {
        initToggle(component);
    }

    api.init = function() {
        $('.toggle:not(.initialized)').each(function() {
            instance = $(this);
            properties = instance.data('properties');
            api.initInstance(this,properties);
            instance.addClass('initialized');
        });
    };

    return api;
})(jQuery);

XA.register('component-toggle', XA.component.toggle);
/* global mejs:false */
/**
 * Component Playlist
 * @module Playlist
 * @param  {jQuery} $ Instance of jQuery
 * @return {Object} List of Playlist component methods
 */
XA.component.playlist = (function($) {
    /**
     * In this object stored all public api methods
     * @type {Object.<Methods>}
     * @memberOf module:Playlist
     * */
    var api = {};
    /**
     * This class used by [Playlist]{@link module:Playlist} module
     * @class Playlist
     * @memberOf module:Playlist
     * @param {jQuery} playlist Root DOM element of playlist component wrapped by jQuery
     * @param {Object} properties Properties setted in data attribute
     */
    function Playlist(playlist, properties) {
        this.properties = properties;
        this.playlist = playlist;
        this.activeVideo = 0;
        this.playlistItems = 0;
    }
    /**
     * Create new source element, seted up it with type & src. Created element
     * append to Video container(take it from videoContainer parameter)
     * @method
     * @alias createNewSources
     * @memberOf module:Playlist.Playlist
     * @param {$OrderedList} source takes from properties.sources[itemIndex].src - 
     * source of playlist element
     * @param {$OrderedList} videoContainer container where source should be added
     */
    Playlist.prototype.createNewSources = function(source, videoContainer) {
        var newSource;

        var sourceBuilder = function(path) {
            var newSource = $("<source>"),
                type;

            if (path.match(/\.(mp4)$/)) {
                type = "video/mp4";
            } else if (path.match(/\.(webm)$/)) {
                type = "video/webm";
            } else if (path.match(/\.(ogv)$/)) {
                type = "video/ogg";
            } else {
                type = "video/youtube";
            }

            newSource.attr({
                type: type,
                src: path
            });

            return newSource;
        };

        if (source instanceof Array) {
            for (var i = 0; i < source.length; i++) {
                newSource = sourceBuilder(source[i]);
                videoContainer.find("video").append(newSource);
            }
        } else {
            newSource = sourceBuilder(source);
            videoContainer.find("video").append(newSource);
        }
    };
    /**
     * Replace source of each video element under play list component.
     * After replacing it reinitialized video component by calling 
     * [XA.component.video.initVideoFromPlaylist]{@link module:Video.initVideoFromPlaylist}
     * @name replaceSource
     * @function
     * @param {number} itemIndex position of active video in video list
     * @param {boolean} loadFromEvent
     * @memberOf module:Playlist.Playlist
     */

    Playlist.prototype.replaceSource = function(itemIndex, loadFromEvent) {
        var inst = this,
            videoContainer,
            videoClone,
            newSrc = inst.properties.sources[itemIndex].src,
            sources,
            videoId,
            videoContainerHeight = 0;

        $(inst.properties.playlistId).each(function() {
            videoContainer = $(this);
            videoId = inst.properties.playlistId;

            if (videoContainer.is(videoId) && newSrc.length) {
                videoContainer.addClass("show");

                sources = videoContainer.find("source");
                sources.remove();
                inst.createNewSources(newSrc, videoContainer);
                videoContainer
                    .find("video")
                    .attr({
                        src: ""
                    })
                    .show();

                var autoplayVideo = false;
                if (loadFromEvent) {
                    if (inst.properties.autoPlaySelected) {
                        autoplayVideo = true;
                    }
                } else {
                    if (inst.properties.autoPlay) {
                        autoplayVideo = true;
                    }
                }

                if (autoplayVideo) {
                    videoContainer.find("video").attr({
                        autoplay: ""
                    });
                }

                videoClone = videoContainer.find("video").clone();
                videoContainerHeight = videoContainer.height();
                videoContainer.css({
                    height: videoContainerHeight
                });

                var id = videoContainer.find(".mejs-container").attr("id");
                if (id) {
                    $("#" + id).remove();
                    delete mejs.players[id];
                    videoContainer
                        .find(".component-content")
                        .append(videoClone);
                }

                XA.component.video.initVideoFromPlaylist(
                    videoContainer,
                    inst.playlist
                );
                videoContainer.css({
                    height: "auto"
                });
            }
        });
    };

    /**
     * Inititalise videos under component. On call and on
     * [change-video]{@link module:Playlist.Playlist#change-video} event
     * calls [replaceSource]{@link module:Playlist.Playlist.replaceSource}
     * @name loadPlaylistVideo
     * @function
     * @listeners module:Playlist.Playlist#change-video
     * @memberOf module:Playlist.Playlist
     */

    Playlist.prototype.loadPlaylistVideo = function() {
        var inst = this,
            playlistItems = $(inst.playlist).find(".playlist-item"),
            activeListItem;

        inst.playlistItems = playlistItems.length;
        var loadVideoFromPlaylist = function(loadFromEvent) {
            inst.replaceSource(inst.activeVideo, loadFromEvent);
            activeListItem = playlistItems.eq(inst.activeVideo);
            activeListItem.addClass("active");
            activeListItem.siblings().removeClass("active");
        };

        loadVideoFromPlaylist();
        $(inst.playlist).on("change-video", function(event, properties) {
            var loadNewVideo = false;

            if (properties) {
                if (properties.hasOwnProperty("back")) {
                    inst.activeVideo--;
                    if (inst.activeVideo < 0) {
                        inst.activeVideo = 0;
                    } else {
                        loadNewVideo = true;
                    }
                } else {
                    inst.activeVideo++;
                    if (inst.activeVideo === inst.playlistItems) {
                        if (inst.properties.repeatAfterAll) {
                            inst.activeVideo = 0;
                            loadNewVideo = true;
                        } else {
                            inst.activeVideo = inst.playlistItems - 1;
                        }
                    } else {
                        loadNewVideo = true;
                    }
                }
            } else {
                if (inst.properties.playNext) {
                    if (inst.activeVideo + 1 <= inst.playlistItems) {
                        inst.activeVideo++;

                        if (inst.activeVideo === inst.playlistItems) {
                            inst.activeVideo = 0;

                            if (inst.properties.repeatAfterAll) {
                                loadNewVideo = true;
                            }
                        } else {
                            inst.actiVideo--;
                            loadNewVideo = true;
                        }
                    }
                }
            }

            if (loadNewVideo) {
                loadVideoFromPlaylist(true);
            }
        });
    };
    /**
     * Attach events to playlist-section and nav items
     * @name attachEvents
     * @function
     * @fires module:Playlist.Playlist#change-video
     * @memberOf module:Playlist.Playlist
     */
    Playlist.prototype.attachEvents = function() {
        var inst = this,
            link = $(inst.playlist).find(".playlist-section"),
            navItems = $(inst.playlist).find(".playlist-nav a"),
            playlistItem;
        link.on("click", function(event) {
            event.preventDefault();

            playlistItem = $(this).parents(".playlist-item");
            var itemIndex = playlistItem.index();

            if (itemIndex !== inst.activeVideo) {
                playlistItem.addClass("active");
                playlistItem.siblings().removeClass("active");
                inst.replaceSource(itemIndex, true);
                inst.activeVideo = itemIndex;
            }
        });

        navItems.on("click", function(event) {
            event.preventDefault();
            var properties = {};

            if (
                $(this)
                    .parent()
                    .hasClass("playlist-prev")
            ) {
                properties.back = true;
            }
            /**
             * Change video event fires when user click
             * on a ".playlist-nav a" element.
             *
             * @event module:Playlist.Playlist#change-video
             * @type {object}
             * @property {Object} properties - Indicates whether playlist has back button
             */
            $(inst.playlist).trigger("change-video", properties);
        });
    };
    /**
     * For each playlist component create new instance of
     * ["Playlist"]{@link  module:Playlist.Playlist} and call
     * ["loadPlaylistVideo"]{@link  module:Playlist.Playlist.loadPlaylistVideo},
     * ["attachEvents"]{@link  module:Playlist.Playlist.attachEvents}
     * methods
     * @memberOf module:Playlist
     * @method
     * @param {jQuery} component Root DOM element of playlist component wrapped by jQuery
     * @param {Object} prop Properties setted in data attribute
     *  of playlist component
     * @alias module:Playlist.initInstance
     */
    api.initInstance = function(component, prop) {
        var playlist;
        $(prop.playlistId).addClass("initialized"); //prevent video init in component-video.js
        if (prop.sources.length) {
            playlist = new Playlist(component, prop);
            playlist.loadPlaylistVideo();
            playlist.attachEvents();
        }
    };
    /**
     * Find all not initialized yet
     * Playlist components and in a loop for each of them
     * run ["initInstance"]{@link module:Playlist.initInstance}
     * method.
     * @memberOf module:Playlist
     * @alias module:Playlist.init
     */
    api.init = function() {
        var playlists = $(".playlist.component:not(.initialized)"),
            properties;

        playlists.each(function() {
            properties = $(this).data("properties");
            api.initInstance(this, properties);
            $(this).addClass("initialized");
        });
    };

    return api;
})(jQuery, document);

XA.register("playlist", XA.component.playlist);

/*
Details Element Polyfill 2.0.0
Copyright © 2017 Javan Makhmali
 */
(function () { }).call(this),
    function () {
    if (document.querySelector('body').getAttribute('class') && document.querySelector('body').getAttribute('class').indexOf('on-page-editor') > -1) {
            return;
        }
        var t, e, n, r, u, o, i, a, s, l, c, d;
        l = {
            element: function () {
                var t, e, n, r, u;
                return e = document.createElement("details"), "open" in e ? (e.innerHTML = "<summary>a</summary>b", e.setAttribute("style", "position: absolute; left: -9999px"), r = null != (u = document.body) ? u : document.documentElement, r.appendChild(e), t = e.offsetHeight, e.open = !0, n = e.offsetHeight, r.removeChild(e), t !== n) : !1
            }(),
            toggleEvent: function () {
                var t;
                return t = document.createElement("details"), "ontoggle" in t
            }()
        }, l.element && l.toggleEvent || (i = function () {
            return document.head.insertAdjacentHTML("afterbegin", '<style>@charset"UTF-8";details:not([open])>*:not(summary){display:none;}details>summary{display:block;}details>summary::before{content:"\u25ba";padding-right:0.3rem;font-size:0.6rem;cursor:default;}details[open]>summary::before{content:"\u25bc";}</style>')
        }, o = function () {
            var t, e, n, r, u;
            return t = document.createElement("details").constructor.prototype, r = t.setAttribute, n = t.removeAttribute, u = null != (e = Object.getOwnPropertyDescriptor(t, "open")) ? e.set : void 0, Object.defineProperties(t, {
                open: {
                    set: function (t) {
                        return "DETAILS" === this.tagName ? (t ? this.setAttribute("open", "") : this.removeAttribute("open"), t) : null != u ? u.call(this, t) : void 0
                    }
                },
                setAttribute: {
                    value: function (t, e) {
                        return d(this, function (n) {
                            return function () {
                                return r.call(n, t, e)
                            }
                        }(this))
                    }
                },
                removeAttribute: {
                    value: function (t) {
                        return d(this, function (e) {
                            return function () {
                                return n.call(e, t)
                            }
                        }(this))
                    }
                }
            })
        }, a = function () {
            return r(function (t) {
                var e;
                return e = t.querySelector("summary"), t.hasAttribute("open") ? (t.removeAttribute("open"), e.setAttribute("aria-expanded", !1)) : (t.setAttribute("open", ""), e.setAttribute("aria-expanded", !0))
            })
        }, u = function () {
            var e, n, r, u, o;
            for (u = document.querySelectorAll("summary"), e = 0, n = u.length; n > e; e++) o = u[e], t(o);
            return "undefined" != typeof MutationObserver && null !== MutationObserver ? (r = new MutationObserver(function (e) {
                var n, r, u, i, a;
                for (i = [], r = 0, u = e.length; u > r; r++) n = e[r].addedNodes, i.push(function () {
                    var e, r, u;
                    for (u = [], e = 0, r = n.length; r > e; e++) a = n[e], "DETAILS" === a.tagName && (o = a.querySelector("summary")) ? u.push(t(o, a)) : u.push(void 0);
                    return u
                }());
                return i
            }), r.observe(document.documentElement, {
                subtree: !0,
                childList: !0
            })) : document.addEventListener("DOMNodeInserted", function (e) {
                return "SUMMARY" === e.target.tagName ? t(e.target) : void 0
            })
        }, t = function (t, e) {
            return null == e && (e = n(t, "DETAILS")), t.setAttribute("aria-expanded", e.hasAttribute("open")), t.hasAttribute("tabindex") || t.setAttribute("tabindex", "0"), t.hasAttribute("role") ? void 0 : t.setAttribute("role", "button")
        }, s = function () {
            var t;
            return "undefined" != typeof MutationObserver && null !== MutationObserver ? (t = new MutationObserver(function (t) {
                var e, n, r, u, o, i;
                for (o = [], n = 0, r = t.length; r > n; n++) u = t[n], i = u.target, e = u.attributeName, "DETAILS" === i.tagName && "open" === e ? o.push(c(i)) : o.push(void 0);
                return o
            }), t.observe(document.documentElement, {
                attributes: !0,
                subtree: !0
            })) : r(function (t) {
                var e;
                return e = t.getAttribute("open"), setTimeout(function () {
                    return t.getAttribute("open") !== e ? c(t) : void 0
                }, 1)
            })
        }, e = function (t) {
            return !(t.defaultPrevented || t.altKey || t.ctrlKey || t.metaKey || t.shiftKey || t.target.isContentEditable)
        }, r = function (t) {
            return addEventListener("click", function (r) {
                var u, o;
                return e(r) && r.which <= 1 && (u = n(r.target, "SUMMARY")) && "DETAILS" === (null != (o = u.parentElement) ? o.tagName : void 0) ? t(u.parentElement) : void 0
            }, !1), addEventListener("keydown", function (r) {
                var u, o, i;
                return e(r) && (13 === (o = r.keyCode) || 32 === o) && (u = n(r.target, "SUMMARY")) && "DETAILS" === (null != (i = u.parentElement) ? i.tagName : void 0) ? (t(u.parentElement), r.preventDefault()) : void 0
            }, !1)
        }, n = function () {
            return "function" == typeof Element.prototype.closest ? function (t, e) {
                return t.closest(e)
            } : function (t, e) {
                for (; t;) {
                    if (t.tagName === e) return t;
                    t = t.parentElement
                }
            }
        }(), c = function (t) {
            var e;
            return e = document.createEvent("Events"), e.initEvent("toggle", !0, !1), t.dispatchEvent(e)
        }, d = function (t, e) {
            var n, r;
            return n = t.getAttribute("open"), r = e(), t.getAttribute("open") !== n && c(t), r
        }, l.element || (i(), o(), a(), u()), l.element && !l.toggleEvent && s())
    }.call(this),
    function () { }.call(this);
XA.component.equalHeight = (function ($) {
    var settings = {
        parentSelector: '.equalized-content',
        selector: '.equal:not(.flip.component),.flip .Side0,.flip .Side1'
    };

    var api = {};

    api.fixHeight = function () {

        $(settings.parentSelector).each(function () {
            var $elements = $(this).find(settings.selector),
                maxHeight = 0;



            $elements.each(function () {
                var $element = $(this);
                $element.css('min-height', 'inherit');
                $element.find('>.component-content').css('min-height', 'inherit');

                if ($element.outerHeight(true) > maxHeight) {
                    maxHeight = $element.outerHeight(true);
                }
            });

            if (maxHeight > 0) {
                $elements.each(function () {
                    var $element = $(this);
                    if ($element.hasClass("Side0") || $element.hasClass("Side1")) {
                        $element.parent().attr('class', 'flip').css({ 'min-height': maxHeight });
                    }
                    $element.css({
                        'min-height': maxHeight
                    });
                    $element.find('>.component-content').css({
                        'min-height': maxHeight
                    });
                });
            }
        });
    }

    api.init = function () {
        $(window).bind('load', function () {
            setTimeout(api.fixHeight, 0);
        });

        $(window).bind('resize', function () {
            api.fixHeight();
        });
    };

    return api;

}(jQuery, document));

XA.register("equalHeight", XA.component.equalHeight);
/*
XA.connector.mapsConnector = (function ($, document) {

    "use strict";

    var api = {},
        maps = [],
        markers = [],
        map,
        getMapType,
        createMarker,
        infoWindows = [],
        addMarker,
        callbacks = [],
        animationTimeout,
        loading = false;

    getMapType = function (options) {
        switch (options.mode) {
            case 'Roadmap': {
                return google.maps.MapTypeId.ROADMAP;
            }
            case 'Satellite': {
                return google.maps.MapTypeId.SATELLITE;
            }
            case 'Hybrid':{
                return google.maps.MapTypeId.HYBRID;
            }
            default: {
                return google.maps.MapTypeId.ROADMAP;
            }
        }
    };

    createMarker = function(mapId, data) {
        var marker;
        if (data.icon === null) {
            marker = new google.maps.Marker({
                position: new google.maps.LatLng(data.latitude, data.longitude),
                map: maps[mapId],
                title: data.title
            });
        } else {
            marker = new google.maps.Marker({
                position: new google.maps.LatLng(data.latitude, data.longitude),
                map: maps[mapId],
                title: data.title,
                icon: data.icon
            });
        }
        if (data.latitude === '' && data.longitude === '') {
            //if marker doesn't have coordinated then create it but doesn't show it on the map
            marker.setVisible(false);
        }
        return marker;
    };

    addMarker = function(mapId, marker, data) {
        //save POI id - this will be used while removing dynamic POIs from the map
        marker.id = data.id;

        if (markers[mapId]) {
            markers[mapId].push({ marker: marker, type: data.type});
        } else {
            markers[mapId] = [];
            markers[mapId].push({ marker: marker, type: data.type});
        }
    };

    api.loadScript = function(key, callback) {
        //save each callback and call them all when script will be loaded - protection for loading maps twice
        callbacks.push(callback);

        if (!loading) {
            loading = true;
            var script = document.createElement("script"),
                src = "https://maps.googleapis.com/maps/api/js?v=3.exp";
            script.type = "text/javascript";
            if (typeof key !== "undefined" && key !== "") {
                src += "&key=" + key + "&v=3.exp&signed_in=false";
            } else {
                src += "&signed_in=false";
            }
            src += "&libraries=places&callback=XA.connector.mapsConnector.scriptsLoaded";
            script.src = src;
            script.onload = function () {
                console.log("Google loader has been loaded, waiting for maps api");
            };
            document.body.appendChild(script);
        }
    };

    api.scriptsLoaded = function () {
        var i, length = callbacks.length;
        for (i = 0; i < length; i++) {
            callbacks[i].call();
        }
        loading = false;
    };

    api.showMap = function(mapId, options, viewBounds) {
        var mapOptions,
            listener,
            scrollwheel = options.disableMapZoomOnScroll !== "1",
            mapDragging = options.disableMapScrolling !== "1";

        if (viewBounds instanceof Array) {
                mapOptions = {
                    zoom: options.zoom,
                    scrollwheel: scrollwheel,
                    draggable: mapDragging,
                    center: new google.maps.LatLng(viewBounds[0], viewBounds[1]),
                    mapTypeId: getMapType(options)
                };
                map = new google.maps.Map(document.getElementById(options.canvasId), mapOptions);
        } else {
                mapOptions = {
                    scrollwheel: scrollwheel,
                    draggable: mapDragging,
                    mapTypeId: getMapType(options)
                };
                map = new google.maps.Map(document.getElementById(options.canvasId), mapOptions);
                map.fitBounds(viewBounds);
                if (options.poiCount < 2) {
                    listener = google.maps.event.addListener(map, "idle", function() { 
                        if (markers.length > 0 && markers[mapId].length < 2) {
                            map.setZoom(options.zoom); 
                            google.maps.event.removeListener(listener); 
                        }
                    });
                }
        }

        listener = google.maps.event.addListener(map, "zoom_changed", function(a, b, c, d) { 
            var zoom = map.getZoom();
            if (zoom < 1) {
                map.setZoom(1);
            }
        });

        maps[mapId] = map;
    };

    api.renderPoi = function(mapId, data) {
        var marker = createMarker(mapId, data),
            key = mapId + "#" + data.id;

        addMarker(mapId, marker, data);

        if (data.html !== "" && data.html !== null) {
            infoWindows[key] = new google.maps.InfoWindow({
                content: data.html
            });
        }

        if (typeof infoWindows[key] !== "undefined") {
            (function(currentKey, marker) {
                google.maps.event.addListener(marker, "click", function() {
                    for (var key in infoWindows) {
                        if (infoWindows.hasOwnProperty(key)) {
                            infoWindows[key].close();
                        }
                    }
                    infoWindows[currentKey].open(maps[mapId], marker);
                });
            })(key, marker);
        }
    };

    api.renderDynamicPoi = function(mapId, data, getPoiContent) {
        var marker = createMarker(mapId, data);            

        addMarker(mapId, marker, data);

        google.maps.event.addListener(marker, "click", function () {
            if (typeof (getPoiContent) === "function") {
                var poiId = data.id,
                    poiTypeId = data.poiTypeId,
                    poiVariantId = data.poiVariantId;

                if (poiVariantId == null) {
                    return;
                }

                getPoiContent(poiId, poiTypeId, poiVariantId, function (result) {
                    if (infoWindows[mapId]) {
                        infoWindows[mapId].close();
                    }
                    infoWindows[mapId] = new google.maps.InfoWindow({
                        content: result.Html
                    });
                    infoWindows[mapId].open(maps[mapId], marker);
                });
            }
        });
    };

    api.clearMarkers = function(mapId) {
        var mapMarkers;
        if (markers.hasOwnProperty(mapId)) {
            mapMarkers = markers[mapId];
            for (var i = 0; i < mapMarkers.length; i++) {
                if (mapMarkers[i].type === "Dynamic") {
                    mapMarkers[i].marker.setMap(null);
                }
            }
            markers[mapId] = mapMarkers.filter(function (markerData) {
                if (markerData.type === "Static" || markerData.type === "MyLocation") {
                    return true;
                } else {
                    return false;
                }
            });
        }
    };

    api.updateMapPosition = function (mapId) {
        var map = maps[mapId],
            marker,
            mapMarkers = [],
            bounds = new google.maps.LatLngBounds(),
            i;

        if (markers.hasOwnProperty(mapId)) {
            mapMarkers = markers[mapId];
        }

        for (i =0; i < mapMarkers.length; i++) {
            marker = mapMarkers[i].marker;
            bounds.extend(new google.maps.LatLng(marker.position.lat(), marker.position.lng()));
        }

        map.fitBounds(bounds);
    };

    api.centerMap = function(mapId, data, centerMap, animate) {
        var map = maps[mapId],
            mapMarkers = [],
            animatedMarker;

        if (centerMap) {
            map.setCenter(new google.maps.LatLng(data.coordinates[0], data.coordinates[1]));
        }

        if (animate) {
            if (markers.hasOwnProperty(mapId)) {
                mapMarkers = markers[mapId];
            }
            for (var i = 0; i < mapMarkers.length; i++) {
                mapMarkers[i].marker.setAnimation(null);
                if (mapMarkers[i].marker.id === data.id) {
                    animatedMarker = mapMarkers[i].marker;
                    mapMarkers[i].marker.setMap(null);
                }
            }
            if (typeof animatedMarker !== "undefined") {
                animatedMarker.setMap(map);
                animatedMarker.setAnimation(google.maps.Animation.BOUNCE);
                animationTimeout = setTimeout(function () {
                    animatedMarker.setMap(map);
                }, 2000);
            }
        }
    };

    api.getCentralPoint = function(poisCoords) {
        var i,
            poiCoords,
            count = poisCoords.length,
            bounds = new google.maps.LatLngBounds();

        for (i = 0; i < count; i++) {
            poiCoords = poisCoords[i];
            if (poiCoords.latitude !== "" && poiCoords.longitude !== "") {
                bounds.extend(new google.maps.LatLng(poiCoords.latitude, poiCoords.longitude));
            }
        }
        return bounds;
    };

    api.locationAutocomplete = function(queryParams, successCallback, failCallback){
        var autocomplete = new google.maps.places.AutocompleteService(),
            maxResults = queryParams.maxResults <= 0 ? 1 : queryParams.maxResults;
            autocomplete.getQueryPredictions({input : queryParams.text}, function(results){
                    var predictions = [], length;
                    if(results != null && results.length) {
                        length = results.length >= maxResults ? maxResults : results.length;

                        for (var i = 0; i < length; i++) {
                            predictions.push(_.extend(results[i], {text : results[i].description}));
                        }

                        successCallback(predictions);
                    }
                    else {
                        failCallback();
                    }
            });
    };

    api.addressLookup = function (queryParams, successCallback, failCallback) {
        var search,
            query;

        if(queryParams.hasOwnProperty("place_id")){ //places lookup
            search = new google.maps.places.PlacesService(typeof map !== "undefined" ? map : new google.maps.Map(document.createElement("div")));
            search.getDetails({
                placeId : queryParams["place_id"]
            }, function(results,status){
                if (status == google.maps.places.PlacesServiceStatus.OK) {
                    if(typeof(results) !== "undefined" && typeof(results.geometry.location) !== "undefined"){
                        successCallback([results.geometry.location.lat(),results.geometry.location.lng()]);
                        return;
                    }
                }
                failCallback();
            });
        }
        else { //standard lookup
            query = {
                address : queryParams.text
            };
            search = new google.maps.Geocoder();
            search.geocode(query, function(results,status){
                if (status == google.maps.GeocoderStatus.OK) {
                    if(typeof(results[0]) !== "undefined" && typeof(results[0].geometry.location) !== "undefined"){
                        successCallback([results[0].geometry.location.lat(),results[0].geometry.location.lng()]);
                        return;
                    }
                }
                failCallback();
            });
        }
    };

    api.updateMyPoiLocation = function(mapId, coordinates, zoom) {
        var map = maps[mapId],
            mapMarkers = [],
            myLocationMarker;

        if (markers.hasOwnProperty(mapId)) {
            mapMarkers = markers[mapId];
            myLocationMarker = mapMarkers.filter(function (marker) {
                if (marker.type === "MyLocation") {
                    return true;
                }
                return false;
            });
            if (myLocationMarker.length > 0) {                
                myLocationMarker[0].marker.setPosition(new google.maps.LatLng(coordinates[0], coordinates[1]));
                myLocationMarker[0].marker.setVisible(true);                
                this.updateMapPosition(mapId);
                if (typeof zoom !== "undefined") {
                    map.setZoom(zoom); 
                }
            }
        }
    };

    return api;

})(jQuery, document);
*/
function HeaderNavigationMenuModel(rootElement) {
    var self = this;
    self.rootElement = rootElement;

    self.init = function () {

        var timeout = null;
        var startingPositionY = window.pageYOffset;
        const header = document.getElementsByClassName("fixed-position");
        var bodyElement = document.getElementsByTagName("body")[0];
        const menuLinks = document.getElementsByClassName("menu-bar-link");
        const menuArray = Array.from(menuLinks);

        const hamburgerBtn = document.getElementById("hamburger-btn");
        hamburgerBtn.addEventListener("click", event => {
            bodyElement.classList.toggle("is-mobile-open");
        });

        menuArray.map(link => {
            link.addEventListener("click", event => {
                const elm = event.target.closest('[aria-haspopup="true"]');
                elm.classList.toggle("open");
                event.preventDefault();
                return false;
            });
        });

        // Hide on scroll down, show on scroll up
        window.onscroll = function () {
            document.activeElement.blur();
            const currentScrollPos = window.pageYOffset;
            if (startingPositionY > currentScrollPos) {
                header.classList.remove("hidden-position");
                header.classList.add("top-position");
            } else {
                header.classList.remove("top-position");
                header.classList.add("hidden-position");
            }
            startingPositionY = currentScrollPos;
        };

        // resize event
        window.onresize = onResize;
    }

    function onResize() {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
            const elms = document.querySelector('li[aria-haspopup="true"]');
            const liArray = Array.from(elms);
            liArray.map(li => {
                li.classList.remove("open");
            });
        }, 500);
    }

}
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);
    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }
     root.HeaderNavigationMenu = factory;
     root.HeaderNavigationMenu_ComponentClass = "caleres-headernavigationmenu-component";
}(this, function (element) {
    'use strict';
    var component = new Component(element);
    component.Name = "Caleres/Feature/HeaderNavigationMenu";
    component.model = new HeaderNavigationMenuModel(component.RootElement);
    component.Init = function () {
        component.model.init();
        ko.applyBindingsWithValidation(component.model, component.RootElement);
    }
    return component;
}));
// -----------------------------------------------------------------------
// Copyright 2016 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

var Message = function (message, data) {
  return {
    message: message,
    data: data
  };
};

var MessageSummaryViewModel = function () {
  var self = this;

  self.errorMessages = ko.observableArray();
  self.infoMessages = ko.observableArray();
  self.warningMessages = ko.observableArray();

  self.showError = ko.computed(function () { return self.errorMessages().length > 0; });
  self.showWarning = ko.computed(function () { return self.warningMessages().length > 0; });
  self.showInfo = ko.computed(function () { return self.infoMessages().length > 0; });

  self.showComponent = ko.computed(function () {
    bShow = self.showError() || self.showWarning() || self.showInfo();
    return bShow;
  });

  self.clear = function () {
    self.errorMessages.removeAll();
    self.infoMessages.removeAll();
    self.warningMessages.removeAll();
  };
};
// -----------------------------------------------------------------------
// Copyright 2016 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    // use AMD define funtion to support AMD modules if in use
    define('CXA/Feature/MessageSummary', ['exports'], factory);
  } else if (typeof exports === 'object') {
    // to support CommonJS
    factory(exports);
  }
  // browser global variable
  root.MessageSummary = factory;
}(this, function (element, model) {
  'use strict';

  var component = new Component(element, model);
  component.Name = "CXA/Feature/MessageSummary";
  component.InExperienceEditorMode = function () {
    model.errorMessages.push(new Message("error: Lorem ipsum dolor sit amet, consectetur adipiscing.", null));
    model.infoMessages.push(new Message("info: Lorem ipsum dolor sit amet, consectetur adipiscing.", null));
    model.warningMessages.push(new Message("warning: Lorem ipsum dolor sit amet, consectetur adipiscing.", null));
  };
  // Message Handlers
  component.ErrorMessageHandler = function (source, message, data) {
    var item = new Message(message, data);
    if (item.message) {
      model.errorMessages.push(item);
    }
  };

  component.WarningMessageHandler = function (source, message, data) {
    var item = new Message(message, data);
    if (item.message) {
      model.warningMessages.push(item);
    }
  };

  component.InfoMessageHandler = function (source, message, data) {
    var item = new Message(message, data);
    if (item.message) {
      model.infoMessages.push(item);
    }
  };

  component.CommandMessageHandler = function (source, command, data) {
    if (command === MessageContext.StandardCommands.ClearAll) {
      component.Model.clear();
    }
  };

  component.StartListening = function () {
    component.ErrorHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Error, component.ErrorMessageHandler);
    component.WarningHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Warning, component.WarningMessageHandler);
    component.InfoHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Info, component.InfoMessageHandler);
    component.CommandHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Command, component.CommandMessageHandler);
  };
  component.StopListening = function () {
    if (component.ErrorHandlerId) MessageContext.UnSubscribeHandler(component.ErrorHandlerId);
    if (component.WarningHandlerId) MessageContext.UnSubscribeHandler(component.WarningHandlerId);
    if (component.InfoHandlerId) MessageContext.UnSubscribeHandler(component.InfoHandlerId);
  };

  component.Init = function () {
    component.StartListening();
  };

  return component;
}));
XA.component.observer = (function($){
	var pub = {},
		initialized = false,
		body = $("body");

	function initObserver() {
		if((typeof(Sitecore)!== "undefined") && !initialized && body.hasClass("on-page-editor")){
			Sitecore.PageModes.ChromeManager.chromesReseted.observe(function(){	
				XA.init();
			});
			initialized = true;
		}
	}

	pub.init = function(){
		initObserver();
	}

	return pub;

}(jQuery));

XA.register("observer", XA.component.observer);
XA.component.partialDesignHighlight = (function($,document){
    var pub = {}, isRegistered = false;
	
	pub.init = function() {
	    var Frame, mouseoverHandler, mouseoutHandler;

        if(!Object.prototype.hasOwnProperty.call(window, "Sitecore")) {
			return false;
		}

        if ($('.on-page-editor').length > 0 && !isRegistered) {

            isRegistered = true;

            Frame = Sitecore.PageModes.HoverFrame.extend({
                horizontalSideClassName: function() {
                    return this.base() + " scHilghlightedChrome boldHighlight sxaFrame";
                },

                verticalSideClassName: function() {
                    return this.base() + " scHilghlightedChrome boldHighlight sxaFrame";
                },

                dispose: function() {
                    if (this.sides) {
                        $sc.each(this.sides, function() {
                            this.remove();
                        });
                    }
                    this.sides = null;                    
                },
                show: function(chrome) {
                    this.base(chrome);

                    this.top.css('left', this.top.position().left - 2 + "px").css('width', this.top.width() + 4 + "px");
                    this.bottom.css('left', this.bottom.position().left - 2 + "px").css('width', this.bottom.width() + 4 + "px");
                    this.topRightCorner.css('left', this.topRightCorner.position().left + 2 + "px");
                    this.bottomRightCorner.css('top', this.bottomRightCorner.position().top + 3 + "px");
                    this.bottomLeftCorner.css('top', this.bottomLeftCorner.position().top + 3 + "px");
                    this.left.css('height', this.left.height() + 7 + "px").css('top', this.left.position().top - 2 + "px");
                    this.right.css('height', this.right.height() + 7 + "px").css('left', this.right.position().left - 1 + "px").css('top', this.right.position().top - 2 + "px");
                    if (this.bottom.position().top - this.top.position().top < 7) {
                        this.bottom.css('top', this.top.position().top + 7 + "px");
                    }
                }
            });

            mouseoverHandler = function (partialDesignId) {
                
                if (partialDesignId) {
                    var chromes = Sitecore.PageModes.ChromeManager.chromes();
                  
                    for (var i = 0; i < chromes.length; i++) {
                        var chrome = chromes[i];
                        if (chrome.data !== undefined &&
                            chrome.data.custom !== undefined &&
                            partialDesignId === chrome.data.custom.sxaSource) {

                            if (chrome._highlight !== undefined) {
                                chrome._highlight.hide();
                            }
                                
                            chrome._highlight = new Frame();
                            chrome._highlight.show(chrome);
                        }
                    }
                }
            }

            mouseoutHandler = function() {
                var chromes = Sitecore.PageModes.ChromeManager.chromes();
                for (var i = 0; i < chromes.length; i++) {
                    chromes[i].hideHighlight();
                }
                $(".sxaFrame").remove();
            }

            $('.on-page-editor').on('mouseover', 'table[data-zgtype=snippets] tr', function () {
                mouseoverHandler($(this).attr('id'));
			});

			$('.on-page-editor').on('mouseout', 'table[data-zgtype=snippets] tr', mouseoutHandler);

			
			$('.on-page-editor').on('mouseenter', '.sc_DropDownItemLink', function () {
			    
			    //check if we are over snippet button

                var partialDesignId = $(this).data("sc-sxa-item-id");
			    
                if (partialDesignId.length) {
                    partialDesignId = partialDesignId.substring(partialDesignId.indexOf('{') + 1, partialDesignId.indexOf('}'));
                    if (partialDesignId) {
                        mouseoverHandler("L" + partialDesignId.replace(/-/g,''));
                    }
                }
            });

			$('.on-page-editor').on('mouseleave', '.sc_DropDownItemLink', function () {
                //check if we are over snippet button
			    if ($(this).data("sc-sxa-item-id").length > 0) {
                    mouseoutHandler();
                }
            });
		}		
	};
	
    return pub;
})(jQuery,document);

XA.register("partialDesignHighlight", XA.component.partialDesignHighlight);
$(document).ready(function () {
  var event = isMobile() ? 'touchend' : 'click';
  var $searchForm = $('#SearchForm');
  var $toggleSearch = $('.toggle-search-bar');

  let targetExitedBoundary = function (target) {
    const isSearchBar = $toggleSearch.is($(target));
    const isSearchBarDescendant = $searchForm.has(target).length;
    return !(isSearchBar || isSearchBarDescendant);
  };

  $(window)
    .off(event + '.searchBar')
    .on(event + '.searchBar', function (e) {
      if (targetExitedBoundary(e.target)) {
        $searchForm.removeClass('active');
      }
    });

  $toggleSearch.off(event).on(event, function () {
    $searchForm.toggleClass('active');
  });

  $searchForm.find(':submit').click(function (e) {
    e.preventDefault();
    $(this).attr('disabled', 'disabled');
    $searchForm.submit();
  });
});

XA.component.searchEqualHeight = (function($) {
    var settings = {
        parentSelector: '.search-results.components',
        selector: 'li'
    };

    var api = {};

    function fixHeight() {

        $(settings.parentSelector).each(function() {
            var $elements = $(this).find(settings.selector),
                maxHeight = 0,
                maxPadding = 0;

            $elements.each(function() {
                $(this).css('min-height', 'inherit');

                if ($(this).height() > maxHeight) {
                    maxHeight = $(this).outerHeight(true);
                }

            });

            if (maxHeight > 0) {
                $elements.css({
                    'padding-bottom': maxPadding,
                    'min-height': maxHeight
                });
            }
        });
    }

    api.init = function() {
		//Latest Theme version ise flexboxes.
		//In case you don`t want use flex you should 
		//uncoment code below
		
       /* $(document).ready(function() {
            setTimeout(fixHeight, 0);
        });

        $(window).bind('resize', function() {
            fixHeight();
        });
		*/
    };
    return api;
}(jQuery, document));

XA.register("searchEqualHeight", XA.component.searchEqualHeight);
/*
$(function () {
  var categoryNav = $('.component.cxa-subcategorynavigation-component');
  var categoryNavList = categoryNav.find("ul");

  categoryNav.find(".subcategories-title").click(
    function () {
      var clicks = $(this).data('clicks');
      if (!clicks) {
        categoryNavList.fadeTo("fast", 0);
        categoryNavList.hide();
        $(this).data('clicks', 1);
      } else {
        categoryNavList.show();
        categoryNavList.fadeTo("fast", 1);
        $(this).removeData();
      }
    }
  );
});
*/
$(document).ready(function () {
  let $topbar = $('.cxa-topbarlinks-component');
  let $topbarItems = $topbar.find('ul');
  let $topbarContent = $topbar.find('.component-content');
  let $logoutLink = $('a[href*="/api/cxa/account/logoff"]');
  let hoverTimeout;

  function showContent() {
    clearTimeout(hoverTimeout);
    $topbarItems
      .stop()
      .fadeTo('fast', 1)
      .show();
  }

  function hideContent() {
    hoverTimeout = setTimeout(function () {
      $topbarItems.fadeTo('slow', 0).hide();
    }, 200);
  }

  $logoutLink.on('click', function (event) {
    CartContext.DeleteCachedCartCount();
  });

  if (isMobile()) {
    let targetExitedBoundary = function (target) {
      const isTopBar = $topbarContent.is($(target));
      var isTopBarDescendant = false;
      if ($topbar.length > 0 && $topbar.get(0)) {
        isTopBarDescendant = $.contains($topbar.get(0), target);
      } 
      return !(isTopBar || isTopBarDescendant);
    };

    $(window)
      .off('touchend.topbar')
      .on('touchend.topbar', function (e) {
        if (targetExitedBoundary(e.target)) {
          $topbarItems.hide();
        }
      });

    $topbarContent
      .off('touchend')
      .on('touchend', 'a', function (e) {
        e.stopPropagation();
      })
      .on('touchend', function () {
        if ($topbarItems.css('display') === 'none') {
          showContent();
        } else {
          hideContent();
        }
      });
  } else {
    $topbarContent.hover(showContent, hideContent);
  }

  $topbarItems.hide();
});

function EmailSignupViewModel(rootElement) {
    var self = this;
    self.rootElement = $(rootElement);

    var emailSignup = document.querySelector('.caleres-email-signup-component');


    var successText = emailSignup.dataset.successText,
        invalidText = emailSignup.dataset.invalidEmailText,
        notRegisteredText = emailSignup.dataset.emailNotRegisteredText,
        correctedText = emailSignup.dataset.emailCorrectionText, 
        caslText = emailSignup.dataset.caslRequiredText;

    var emailAddressRules = { 
        email: {
            params: VALIDATION_PATTERNS.EMAIL,
            message: invalidText
        }
    };
    var zipPostalCodeRules = {
        required: false,
        zipcode: {
            message: ko.validation.rules["zipcode"].message
        }
    };

    //Rendering Variant fields
    self.submitText = ko.observable(emailSignup.dataset.submitText);
    self.emailBoxText = ko.observable(emailSignup.dataset.emailBoxText);
    self.emailSignupLoadingText = ko.observable(emailSignup.dataset.emailSignUpLoadingText);
    self.firstNameText = ko.observable(emailSignup.dataset.firstNameText);
    self.lastNameText = ko.observable(emailSignup.dataset.lastNameText);
    self.zipCodeText = ko.observable(emailSignup.dataset.zipCodeText);
    self.zipCodeSubText = ko.observable(emailSignup.dataset.zipCodeSubText);
    self.birthDayText = ko.observable(emailSignup.dataset.birthdayText);
    self.birthDaySubText = ko.observable(emailSignup.dataset.birthdaySubText);
    self.birthDayHintLabel = ko.observable(emailSignup.dataset.birthdayHintLabel);
    self.birthMonthText = ko.observable(emailSignup.dataset.birthMonthText);
    self.birthMonthSubText = ko.observable(emailSignup.dataset.birthMonthSubText);
    self.birthMonthHintLabel = ko.observable(emailSignup.dataset.birthMonthHintLabel);
    self.privacyText = ko.observable(emailSignup.dataset.privacyText);
    self.privacyLinkText = ko.observable(emailSignup.dataset.privacyLinkText);
    self.isCaslEnabled = emailSignup.dataset.isCaslEnabled === "True" ? ko.observable(true) : ko.observable(false);
    self.showCaslRequiredLabel = emailSignup.dataset.showCaslRequiredLabel === "True" ? ko.observable(true) : ko.observable(false);
    self.caslRequiredLabel = ko.observable(emailSignup.dataset.caslRequiredLabel);
    self.caslEmailOptInLabel = ko.observable(self.rootElement.find(".email-signup-form__casl-email-optin-label").html());
    self.caslSourceName = ko.observable("");

    //Rendering state
    self.emailAddress = ko.validatedObservable().extend(emailAddressRules);
    self.firstName = ko.observable("");
    self.lastName = ko.observable("");
    self.postalCode = ko.validatedObservable("").extend(zipPostalCodeRules);
    self.birthMonth = ko.observable("");
    self.birthMonthValues = [
        {text: "Month", value: ""},
        {text: "1", value: "1"},
        {text: "2", value: "2"},
        {text: "3", value: "3"},
        {text: "4", value: "4"},
        {text: "5", value: "5"},
        {text: "6", value: "6"},
        {text: "7", value: "7"},
        {text: "8", value: "8"},
        {text: "9", value: "9"},
        {text: "10", value: "10"},
        {text: "11", value: "11"},
        {text: "12", value: "12"},
    ];


    self.birthDay = ko.observable("");
    self.birthDayValues = [
        {text: "Day", value: ""},
    ];
    for (var i = 1; i<=31; i++) {
        self.birthDayValues.push({ text: String(i), value: String(i) })
    }

    self.reference = ko.observable('SRUS'); // TODO: This will need to be re-worked at some point to pull in correct business unit
    self.isInputFocused = ko.observable(false);
    self.isEmailValid = ko.observable(false);
    self.showError = ko.observable(false);
    self.showSuccess = ko.observable(false);
    self.feedbackText = ko.observable('');
    self.isProcessingEmailSignUp = ko.observable(false);
    self.isEmailOptIn = ko.observable(false);

    self.hasFeedback = ko.pureComputed(function() {
        if (self.showError() === true || self.showSuccess() === true || self.feedbackText() != '') {
            return true;
        } else {
            return false;
        }
    });


    self.checkAndHandleClientErrors = function() {
        //Email must be valid always
        if(!self.emailAddress.isValid()) {
            self.isEmailValid(false);
            self.handleErrors(invalidText);
            return true;
        }

        //Zipcode is only validated if a value is present
        if (self.postalCode().length > 0 && !self.postalCode.isValid()) {
            self.handleErrors(ko.validation.rules["zipcode"].message);
            return true;
        }

        // Checkbox is only validated if CASL is enabled 
        if (self.isCaslEnabled() && !self.isEmailOptIn()) {
            self.handleErrors(caslText);
            return true;
        }

        return false;
    };

    self.validateEmail = function() {
        // Analytics
        try {
            if (window.data) {
                var dataLayer = window.data;
                dataLayer.event('processevent', {
                    processAction: 'start',
                    processName: 'email subscription sign up'
                });                
            }
        } catch(err) {
            console.log("Analytics error:", err);
        }

        // Client side validation before sending to server
        var hasErrors = self.checkAndHandleClientErrors();
        if (hasErrors) {
            self.isProcessingEmailSignUp(false);
        // Reset happens too early and doesn't clear loading state without the timeout
            setTimeout(function() {$('.email-signup-form__submit').button('reset');}, 10)
            return;
        }

        self.isProcessingEmailSignUp(true);

        var dataPayload = {
            EmailAddress : self.emailAddress(),
            Reference: self.reference()
        };

        // validate email address against Fresh Address
        AjaxService.Post("/api/calxa/addressvalidation/validateemailaddress", dataPayload, function (response) {
            if (response !== null && response.Success) {
                successCallback(response);
            } else {
                failureCallback(response);
            }
        });

        // handles success path
        var successCallback = function(response) {
            self.isEmailValid(response.IsValid);
            self.emailAddress(response.CleansedEmailAddress);

            if (self.isEmailValid() === true) {
                // proceed with submitting the email
                self.submitEmail();
            } else {
                // go down the failure path
                failureCallback(response);
            }
        }

        // handles failure path
        var failureCallback = function(response) {
            self.isEmailValid(response.IsValid);
            self.isProcessingEmailSignUp(false);

            if (response.CleansedEmailAddress) {
                // if a cleansed email is returned, show the corrected suggestion message
                self.handleErrors(correctedText + " " + response.CleansedEmailAddress);
            } else if(response.OriginalEmailAddress) {
                // show the default invalid email message with email
                self.handleErrors(response.OriginalEmailAddress + " " + invalidText)
            }
            else {
                // otherwise show the default invalid email message
                self.handleErrors(invalidText)
            }
        }

    }

    self.submitEmail = function() {
        var dataPayload = {
            EmailAddress: self.emailAddress(),
            SalesforceKey:  emailSignup.dataset.salesforceKey,
            FormSource: emailSignup.dataset.formSource,
            IsV2Authentication: emailSignup.dataset.isV2Authentication,
            IsEmailOptIn: self.isCaslEnabled() ? self.isEmailOptIn() : true,
            CaslSources: [{
                SourceLocationName: self.caslSourceName().length > 0 ? self.caslSourceName() : "",
                IsChecked: self.isEmailOptIn()
             }]            
        };

        //Add additional optional Extended Signup fields
        [
            [self.firstName, "FirstName"],
            [self.lastName, "LastName"],
            [self.postalCode, "PostalCode"],
            [self.birthMonth, "BirthMonth"],
            [self.birthDay, "BirthDay"]
        ].forEach(function(field) {
           var value = field[0]();
           var key = field[1];
           if (value && value.length) {
               dataPayload[key] = value;
           }
        });

        // submits email and keys to core retail and salesforce
        AjaxService.Post("/api/calxa/account/emailaddresssubscribe", dataPayload, function (response) {
            if (response !== null && response.Success) {
                if(response.Data) {
                    var userData = JSON.parse(response.Data);
                    if(userData && userData.AccountSubscribe) {
                        CaleresGlobalTracking.setCustomerNumber(userData.AccountSubscribe.CustomerNo);
                    }
                }

                // show the success feedback
                self.handleSuccess(successText);
            } else {
                // show error feedback
                self.handleErrors(notRegisteredText);
            }
        });
    }

    // display error message and styling
    self.handleErrors = function(errorText) {
        self.feedbackText(errorText);
        self.showSuccess(false);
        self.showError(true);
    }

    // display success message and styling
    self.handleSuccess = function(successText) {
        self.feedbackText(successText);
        self.showError(false);
        self.showSuccess(true);
        self.isProcessingEmailSignUp(false);
        // unfocuses input on success
        self.isInputFocused(false);

        $('.email-signup-form__submit').button('reset');

        // Analytics
        try {
            if (window.data) {
                var dataLayer = window.data;
                dataLayer.event('processevent', {
                    processAction: 'complete',
                    processName: 'email subscription sign up'
                });                
            }
        } catch(err) {
            console.log("Analytics error:", err);
        }
        
    }

    self.clearFeedback = function() {
        // check if any feedback is visible that needs to be cleared
        if (self.hasFeedback() === true) {
            self.showError(false);
            self.showSuccess(false);
            self.feedbackText('');
        }
        // allows default action to continue: https://knockoutjs.com/documentation/event-binding.html#note-3-allowing-the-default-action
        return true;
    }

    self.clearForm = function() {
        // only clear out the form if successfully submitted
        if (self.showSuccess() === true) {
            self.emailAddress('');
            // clear any feedback
            self.clearFeedback();
        }
        self.isProcessingEmailSignUp(false);
    }

    self.updateCaslSourceWithVariantCode = function(currentVariantCode) {
        var newCaslSourceName = "";

        if (currentVariantCode === "DFLT") {
            newCaslSourceName = emailSignup.dataset.caslSourceNameDefault || "";
        } else if (currentVariantCode === "EXTD") {
            newCaslSourceName = emailSignup.dataset.caslSourceNameExtended || "";
        } 

        self.caslSourceName(newCaslSourceName);
    };

}
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    root.CaleresEmailSignup = factory;
    root.CaleresEmailSignup_ComponentClass = "caleres-email-signup-component";

}(this, function (element) {
    'use strict';
    var component = new Component(element);
    component.Name = "Caleres/Feature/EmailSignupRendering";
    component.model = new EmailSignupViewModel(component.RootElement);

    component.InExperienceEditorMode = function () {
        // console.log('print shipping label editor experience mode');
    }

    component.Init = function () {
        if ($(component.RootElement).length) {
            ko.applyBindings(component.model, component.RootElement);
        }
    }
    return component;
}));
function SignInViewModel(rootText) {
    var self = this;

    self.isViewActive = ko.observable(true);

    self.rootText = rootText;

    self.visitorName = ko.observable("");
    self.isUserAuthenticated = ko.observable(false);
    self.greetingLabel = ko.observable("");
    self.anonymousLabel = ko.observable("");
    self.pseudoLabel = ko.observable("");
    self.authenticatedLabel = ko.observable("");
    self.signInLinkText = ko.observable("");
    self.greetingText = ko.observable("");

    self.initialize = function () {
        var visitorName = "";        
        var signInData = $(self.rootText).find('.caleres-signin-component__container');
        
        self.isUserAuthenticated(signInData.attr("data-userIsAuthenticated") === "true" ? true : false);
        self.greetingLabel(signInData.attr("data-greetingLabel"));
        self.anonymousLabel(signInData.attr("data-anonymousLabel"));
        self.pseudoLabel(signInData.attr("data-pseudoLabel"));
        self.authenticatedLabel(signInData.attr("data-authenticatedLabel"));
        
        self.signInLinkText("");
        self.greetingText("");

        try {
            visitorName = localStorage.getItem("visitorName") ? localStorage.getItem("visitorName") : "";
        } catch (err) {
            console.log('Error occurred: ', err);
        }

        if(self.isUserAuthenticated()) {
            self.greetingText(self.greetingLabel() + ' ' + visitorName + ', ');
            self.signInLinkText(self.authenticatedLabel());
        }
        else if(visitorName.length > 0)
        {
            self.greetingText(self.greetingLabel() + ' ' + visitorName + ', ');
            self.signInLinkText(self.pseudoLabel());
        }
        else
        {
            self.greetingText("");
            self.signInLinkText(self.anonymousLabel());
        }
    };

    self.showView = function () {
        self.isViewActive(true);
    }

    self.hideView = function () {
        self.isViewActive(false);
    }
}
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    root.CaleresSignIn = factory;
    root.CaleresSignIn_ComponentClass = "caleres-signin-component";

}(this, function (element) {
    'use strict';
    var component = new Component(element);
    component.Name = "Caleres/Feature/SignIn";
    component.signInViewModel = new SignInViewModel(component.RootElement);

    component.InExperienceEditorMode = function () {
        component.signInViewModel.showView();
        component.Visual.Disable();
    }

  
    component.Init = function () {
        if ($(component.RootElement).length) {
            component.signInViewModel.initialize();
            ko.applyBindings(component.signInViewModel, component.RootElement);
            component.signInViewModel.showView();
            CaleresGlobalTracking.setFormLoaded();
        }
    }

    return component;
}));
var CARTHEADING = CARTHEADING || {
    URL: {
        GET: '/api/cxa/cart'
    },
    HOVER_STATE: {
        ACTIVE: 'show-minicart',
        INACTIVE: 'hide-minicart'
    },
    FAKE_CART_COUNT: 1
};

function CartHeadingViewModel() {


    /**
     * Keep the number of cart items
     */
    let cartCount;

    /**
     * Model constructor
     */
    (function constructor() {
        setDefaults();
        initCartCount();
    })();

    /**
     * Set default values and initialize the variables
     */
    function setDefaults() {
        isNormalMode = CXAApplication.RunningMode === RunningModes.Normal;
        cartCount = ko.observable(0);
    }

    /**
     * Initialize the cart items count
     */
    function initCartCount() {
        if (!isNormalMode) {
            updateCartCount(CARTHEADING.FAKE_CART_COUNT);
        } else if (CartContext.IsCartCountCached() && CartContext.IsCachedCartCountAvailable()) {
            updateCartCount(CartContext.GetCachedCartCount());
        } else {
            //If we don't have a cached cart count so we assume they are a new customer and thus their cart is empty
            updateCartCount(0);
        }
    }

    /**
     * Get the cart items count via HTTP request
     */
    function getCartCount() {
        AjaxService.Post('/api/calxa/Cart/GetCart', {}, function (data) {
            if (data && (typeof data.TotalQuantity === "number")) {
                CartContext.TriggerCartUpdateEvent(data);
                updateCartCount(data.TotalQuantity);
            }
        });
    }

    /**
     * Update the cart items count
     */
    function updateCartCount(count) {
        let value = parseInt(count);
        cartCount(value);
        CartContext.UpdateCachedCartCount(cartCount());
    }

    /**
     * Export the functions for external use
     */
    return {
        cartCount: cartCount,
        updateCartCount: updateCartCount,
        getCartCount: getCartCount,
        initCartCount: initCartCount
    };
}
function DeliveryOptionsViewModel(rootElement) {

	// Initialize values 
	var self = this;	
	self.rootElement = rootElement;

	//VM State
	self.sku = ko.observable("");
	self.skus = ko.observable([]);
	var isCartQuery = false;
	self.availability = ko.observable({});
	self.finalAvailability = ko.observable([]);
	self.finalCartAvailability = ko.observable([]);
	self.currentStoreId = ko.observable(null);
	self.currentStoreLat = ko.observable(null);
	self.currentStoreLong = ko.observable(null);
	self.isLatLongSearch = ko.observable(false);
	self.noLocationsInSearchArea = ko.observable(false);
	self.searchTerm = ko.observable("");
	self.isFetching = ko.observable(false);
	self.waitForCartQuery = ko.observable(false);
	self.itemsInCart = ko.observable(false);

	var deliveryOptions = document.querySelector('.delivery-options-form');
    var storeRadius = deliveryOptions !== null ? (deliveryOptions.dataset.deliveryOptionsFormStoreRadius || 0) : 0;
	storeRadius = Number(storeRadius);
	var coveoStoresArray;
	var coveoCartStoresArray;
	var searchInterface;
			
	function initSearchInterfaceFunctionality() {
		
			searchInterface = $(rootElement).closest(".CoveoSearchInterface")[0];
			if (!searchInterface) {
				console.warn('Coveo Search Interface not found for DeliveryOptionsViewModel', rootElement)
			}
		
			if (searchInterface) {

				//Working with the results from the query
				Coveo.$$(searchInterface).on('querySuccess', function(e, args) {
					//clean up any previous expressions
					args.queryBuilder.expression.parts.forEach(function(string) {
						args.queryBuilder.expression.remove(string);
					});

					if (isCartQuery) {
						coveoCartStoresArray = args.results.results;
						self.handleCartResultsFromCoveo();
						self.isFetching(false);
					} else {		
						coveoStoresArray = args.results.results;
						self.handleResultsFromCoveo();
						if (!self.itemsInCart()) {
						self.isFetching(false);
						}
					}

				});

				//Set up the query
				Coveo.$$(searchInterface).on('buildingQuery', function(e, args) {

					if (!self.currentStoreLat()) {
						return false; 
					}
			
					// Dynamic query 
					var qf = "$qf(function:'dist(@latitude, @longitude, " + self.currentStoreLat() + ", " + self.currentStoreLong() + ")', fieldName: 'distance')";
					args.queryBuilder.advancedExpression.add(qf);
					args.queryBuilder.sortCriteria = "@distance ascending";

					//convert mile radius to Coveo's unit (meters)
					var miles = storeRadius;
					var distance = miles * 1609.34;
					//Query results within distance limit
					var limit = "@distance<="+distance;
					args.queryBuilder.advancedExpression.add(limit);
				});
			}
		}

	if (window.hasCoveoSearchEndpointInitialized == true) {
		initSearchInterfaceFunctionality();
	} else {
		document.addEventListener("CoveoSearchEndpointInitialized", function() {
			setTimeout(function() {
				initSearchInterfaceFunctionality();
				self.pendingQueries.forEach(function(fn) {
					fn();
					Coveo.executeQuery( searchInterface);
				});
			}, 0);
		});
	}

	self.pendingQueries = [];
	self.queryCartAvailabilityFromCoveo = function(variantIdArray) {
		self.skus(variantIdArray);

		if (self.skus().length) {

			//Trigger Coveo to make a query
			if (window.hasCoveoSearchEndpointInitialized && searchInterface) {
				self.isFetching(true)
				isCartQuery = true;
				self.waitForCartQuery(true);
				Coveo.executeQuery( searchInterface );
			} else {
				self.pendingQueries.push(function() {
					self.isFetching(true)
					isCartQuery = true;
					self.waitForCartQuery(true);
				});
			}
		}
	} 

	self.queryAvailabilityFromCoveo = function(sku) {
		self.sku(sku);

		if (self.sku().length && self.currentStoreId() || self.sku().length && self.isLatLongSearch()) {
			//Trigger Coveo to make a query
			if (window.hasCoveoSearchEndpointInitialized && searchInterface) {
				self.isFetching(true)
				isCartQuery = false; 
				Coveo.executeQuery( searchInterface);
			} else {
				self.pendingQueries.push(function() {
					self.isFetching(true)
					isCartQuery = false; 
				});
			}
		}
	}


	self.handleCartResultsFromCoveo = function() {

		var newCartAvailability = [];
		var counter = 0;
		var isLatLong = false;

		if (self.isLatLongSearch()){
			isLatLong = true;
		}

		coveoCartStoresArray.forEach(function(result) {

			var storeHours = [];
			storeHours.push({day: "Sunday", hours: result.raw.sundayhours});
			storeHours.push({day: "Monday", hours: result.raw.mondayhours});
			storeHours.push({day: "Tuesday", hours: result.raw.tuesdayhours});
			storeHours.push({day: "Wednesday", hours: result.raw.wednesdayhours});
			storeHours.push({day: "Thursday", hours: result.raw.thursdayhours});
			storeHours.push({day: "Friday", hours: result.raw.fridayhours});
			storeHours.push({day: "Saturday", hours: result.raw.saturdayhours});

			var matches = [];
			self.skus().forEach(function(sku) {
				if (typeof result.raw.sku !== "undefined" && result.raw.sku.includes(sku)) {
					matches.push(sku);
				}
			});

			if (result.raw.isbopiseligible === "true" || result.raw.iscurbsideeligible === "true") {
				newCartAvailability[counter] = {storeid: result.raw.storeid, name: result.raw.title.toLowerCase(), city: result.raw.city.toLowerCase(), state: result.raw.state, storedetailurl: (result.raw.storedetailurl) ? result.raw.storedetailurl : "", skus: matches, isbopiseligible: result.raw.isbopiseligible, iscurbsideeligible: (result.raw.iscurbsideeligible) ? result.raw.iscurbsideeligible : "false", latitude: result.raw.latitude, longitude: result.raw.longitude, storehours: storeHours, distance: result.raw.distance, isPdp: false};
				counter++;
			}
		});

		if (coveoCartStoresArray.length === 0 && isLatLong) {
			self.noLocationsInSearchArea(true);
		} else {
			self.noLocationsInSearchArea(false);
		}

		self.isLatLongSearch(false);

		self.finalCartAvailability(newCartAvailability);
	};

	self.handleResultsFromCoveo = function() {
		var newAvailability = {};
		var isLatLong = false;

		if (self.isLatLongSearch()){
			isLatLong = true;
		}

		coveoStoresArray.forEach(function(result) {
			var storeHours = [];
			storeHours.push({day: "Sunday", hours: result.raw.sundayhours});
			storeHours.push({day: "Monday", hours: result.raw.mondayhours});
			storeHours.push({day: "Tuesday", hours: result.raw.tuesdayhours});
			storeHours.push({day: "Wednesday", hours: result.raw.wednesdayhours});
			storeHours.push({day: "Thursday", hours: result.raw.thursdayhours});
			storeHours.push({day: "Friday", hours: result.raw.fridayhours});
			storeHours.push({day: "Saturday", hours: result.raw.saturdayhours});

			if (result.raw.isbopiseligible === "true" || result.raw.iscurbsideeligible === "true") {
				var matches = (typeof result.raw.sku !== "undefined") ? result.raw.sku.filter(function(s){return s.indexOf(self.sku()) > -1}) : [];
				newAvailability[result.raw.storeid] = {storeid: result.raw.storeid, name: result.raw.title.toLowerCase(), city: result.raw.city.toLowerCase(), state: result.raw.state, storedetailurl: (result.raw.storedetailurl) ? result.raw.storedetailurl : "", skus: matches, isbopiseligible: result.raw.isbopiseligible, iscurbsideeligible: (result.raw.iscurbsideeligible) ? result.raw.iscurbsideeligible : "false", latitude: result.raw.latitude, longitude: result.raw.longitude, storehours: storeHours, distance: result.raw.distance, isPdp: true};
			}
		});

		if (coveoStoresArray.length === 0 && isLatLong) {
			self.noLocationsInSearchArea(true);
		} else {
			self.noLocationsInSearchArea(false)
		}

		self.availability(newAvailability);

		if (self.waitForCartQuery() === false ) {
			// self.isFetching(false);
			self.isLatLongSearch(false);
		
		}
		self.finalAvailability(self.getAvailability());
	};

	self.getAvailability = function() {
		return Object.keys(self.availability()).map(function(storeid) {
		return self.availability()[storeid];
		});
	};
	
}
function CaleresMinicartViewModel(rootElement) {
    
    
    var inventoryIndicator = document.querySelector('.low-inventory-indicator');
    let isInventoryIndicatorDisabled = inventoryIndicator.dataset.isLowInventoryIndicatorDisabled === "true";

    var minicartComponent = document.querySelector('.caleres-minicart-component');
    let minicartHoverTimerValue = minicartComponent.dataset.hoverTimer;

    let viewCartLinkValue = minicartComponent.dataset.viewCartLink;
    var isMinimalDisplay = minicartComponent.dataset.isMinimalDisplay;

    /* Copied from OOTB MINICART mock */
    var MINICART = {
        URL: {
            GET: '/api/cxa/cart'
        },
        HOVER_STATE: {
            ACTIVE: 'show-minicart',
            INACTIVE: 'hide-minicart'
        },
        FAKE_CART_COUNT: 5
    };

    let pathname = window.location.pathname;
    /**
     * Wether the fetch request is in progress
     */
    let isFetchInProgress;

    /**
     * Keep the cart information
     */
    let cart;

    /**
     * Keep the number of cart items
     */
    let cartCount;

    /**
     * Keep the current class name of minicart
     */
    let minicartClassName;

    /**
     * Wether the cart data is changed
     */
    let isCartItemsChanged = true;

    let isNormalMode = false;

    let hoverTimeout = false;
    // Default mini cart 5 seconds
    let hoverMiniCartTimer = 5000;
    let hoverMiniCartFunc = null;
    if (minicartHoverTimerValue !== undefined && minicartHoverTimerValue !== null && minicartHoverTimerValue !== "") {
        var val = parseInt(minicartHoverTimerValue);
        if (val !== undefined && val !== null && !Object.is(NaN, val)) {
            hoverMiniCartTimer = Number(minicartHoverTimerValue);
        }
    };
    let forcedOpen = false;

    let baseCartCount = -1;


    /**
     * Model constructor
     */
    (function constructor() {
        setDefaults();
        initCartCount();
    })();

    /**
     * Set default values and initialize the variables
     */
    function setDefaults() {
        isNormalMode = CXAApplication.RunningMode === RunningModes.Normal;
        isFetchInProgress = ko.observable(false);
        cart = ko.observable(new CartViewModel());
        cartCount = ko.observable(0);
        minicartClassName = ko.observable(MINICART.HOVER_STATE.INACTIVE);
    }

    /**
     * Initialize the cart items count
     */
    function initCartCount() {
        if (!isNormalMode) {
            updateCartCount(MINICART.FAKE_CART_COUNT);
        } else if (CartContext.IsCartCountCached() && CartContext.IsCachedCartCountAvailable()) {
            updateCartCount(CartContext.GetCachedCartCount());
        } else {
            //If we don't have a cached cart count so we assume they are a new customer and thus their cart is empty
            updateCartCount(0);
        }
    }

    /**
     * Get the cart items count via HTTP request
     */
    function getCartCount() {
        AjaxService.Post('/api/calxa/Cart/GetCart', {}, function (data) {
            if (data && (typeof data.TotalQuantity === "number")) {
                updateCartCount(data.TotalQuantity);
            }
        });
    }

    /**
     * Update the cart items count
     */
    function updateCartCount(count) {
        let value = parseInt(count);

        if (value !== baseCartCount) {
            isCartItemsChanged = true;
        }

        cartCount(value);
        CartContext.UpdateCachedCartCount(cartCount());
        baseCartCount = value;
    }

    /**
     * Fetch the cart data
     * It only runs when there is a new changes
     */
    function getCart() {
        if (shouldFetchCart()) {

            isFetchInProgress(true);

            var actionsLeft = [1, 2];
            let cartData;

            //Minimum wait time for silky smooth animation
            function completeOneAction() {
                actionsLeft.pop();
                if (actionsLeft.length === 0) {
                    refreshCartData(cartData);
                    isFetchInProgress(false);
                    isCartItemsChanged = false;
                }
            }

            //Execute both actions
            AjaxService.Post(MINICART.URL.GET + '/GetMinicart', {}, function (data) {
                if (data) {
                    cartData = data;
                    CaleresCartTracking.UpdateCart(data);

                    CartContext.TriggerMinicartUpdate(data);
                    CartContext.TriggerCartUpdateEvent(data);

                    // if there are no lines, reset cache
                    if (data.Lines.length <= 0) {
                        CartContext.UpdateCachedCartCount(0);
                    }

                }
                completeOneAction()
            });
            setTimeout(function () { completeOneAction() }, 150)
        }
    }


    /**
     * Get the fake cart data for EE mode
     */
    function getFakeCart() {
        let items = [];
        const mockProductImage = getMiniProductMockImage();

        if (shouldFetchCart()) {
            cart().total('0.00 USD');
            for (let i = 0; i < 1; i++) {
                items.push({
                    displayName: 'Lorem ipsum dolor sit amet, id dicant',
                    colorInformation: 'Soleat',
                    productUrl: 'javascript:vid(0)',
                    discountOfferNames: ['mediocritatem no mei(25%)'],
                    quantity: 1,
                    linePrice: '0.00 USD',
                    lineTotal: '0.00 USD',
                    lineItemDiscount: '0.00 USD',
                    externalCartLineId: i,
                    image: mockProductImage,
                    inventoryCount: 10,
                    hasLowInventory: true,
                    styleNumber: "12345",
                    promotionExcludedMessages: [],
                });
            }

            if (cart().cartLines().length == 0) {
                cart().cartLines(items);
            }
        }
    }

    function onCartPage() {
        if (viewCartLinkValue.toLowerCase() === pathname.toLowerCase()) {
            return true;
        }
        return false;
    }

    /**
     * Whether should http cart call happen
     */
    function shouldFetchCart() {
        if (onCartPage() || isMinimalDisplay) {
            return false;
        }
        return !isFetchInProgress() && isCartItemsChanged;
    }

    /**
     * Update the cart data
     * @param {*} data
     */
    function refreshCartData(data) {
        cart(new CartViewModel(data));

        if (isInventoryIndicatorDisabled || CXAApplication.RunningMode === RunningModes.ExperienceEditor || cart().cartLines().length === 0) {
            return;
        }

        var request = {
            Products: []
        };
        cart().cartLines().forEach(function (line) {
            var product = {
                "ProductId": line.productId,
                "VariantId": line.productVariantId
            };
            request.Products.push(product);
        });
    }

    /**
     * Remove a cart item
     * @param {*} item
     * @param {*} event
     */
    function removeItem(item, event) {
        const icon = $(event.currentTarget).find('.glyphicon');
        let lineItemId = item.externalCartLineId;
        let sender = event.currentTarget;
        isFetchInProgress(true);

        $(icon).removeClass('glyphicon-remove-circle');
        $(icon)
            .find('.glyphicon')
            .addClass('glyphicon-refresh');
        $(icon)
            .find('.glyphicon')
            .addClass('glyphicon-refresh-animate');
        AjaxService.Post(
            MINICART.URL.GET + '/RemoveMinicartLine',
            { lineNumber: lineItemId },
            function (data, success, sender) {
                isCartItemsChanged = true;

                if (data) {
                    // Updates components within Minicart that listen for OnCartUpdated event (ex. Free Shipping Tracker)
                    CartContext.TriggerCartUpdateEvent(data);

                    isFetchInProgress(false);
                    isNormalMode ? getCart() : getFakeCart();
                }
            },
            sender
        );
    }

    /**
     * Fires when mouse hover or touch start happen
     * It fetch the cart data
     */
    function hoverMinicart() {
        if (!isNormalMode && forcedOpen) {
            return;
        }

        if (onCartPage()) {
            return;
        }

        clearTimeout(hoverTimeout);
        if (!hoverTimeout) {
            minicartClassName(MINICART.HOVER_STATE.ACTIVE);
            isNormalMode ? getCart() : getFakeCart();

            // Close toggle container navigation
            closeToggleContainer();
            // Close searchbox 
            closeSearchBox();
        }

    }

    /**
     * @function closeToggleContainer - closes container toggle navigation
     */
    function closeToggleContainer() {
        // Check if toggle container navigation is open
        if ($('.container--will-toggle').hasClass('container-is-open')) {
            // remove classes indicating container is open
            $('.container--will-toggle').removeClass('container-is-open');
            $('.js-container-toggle').removeClass('container-is-open');
            $('body').removeClass('container-is-open');
            // remove overlay markup
            $('.container__overlay').remove();
        }
    }

    /**
    * @function closeSearchBox - If the searchbox is open when minicart is invoked, close the search box (mimics 'closeSearchbox' function in 'coveo-searchbox.ts')
    */
    function closeSearchBox() {
        var searchboxToggle = $('.js-searchbox-toggle');
        if (searchboxToggle.hasClass('searchbox-is-open')) {
            searchboxToggle.removeClass('searchbox-is-open');
            $('.container--searchbox-will-toggle').removeClass('searchbox-is-open');
            $('.searchbox__overlay').remove();
        }
    }

    function closeMiniCart() {

        if (isMinimalDisplay) {
            return;
        }

        if (isNormalMode) {
            forcedOpen = false;
            leaveMinicart();
        }
    }

    function leaveMinicart() {
        if (forcedOpen) {
            return
        }

        hoverTimeout = setTimeout(function () {
            handleCloseMinicart();
            hoverTimeout = false;
        }, 400); //increased from 200
    }

    function handleCloseMinicart() {
        minicartClassName(MINICART.HOVER_STATE.INACTIVE);
        clearTimeout(hoverMiniCartFunc);
    }

    function toggleMinicart() {
        MINICART.HOVER_STATE.INACTIVE === minicartClassName()
            ? hoverMinicart()
            : leaveMinicart();
    }


    function getMiniProductMockImage() {
        let imageSrc;
        let siteRootPath = $("input[name='_SiteRootPath'").val();
        let fallbackPath = '/sitecore/shell/-/media/Feature/Experience%20Accelerator/Commerce/Catalog/72x72.png?h=72&w=72';

        //metadata inputs aren't available on partial design exp editor pages
        if (!siteRootPath) {
            return fallbackPath;
        }

        const pageExtension = getCurrentPageExtension();
        const tenantAndSiteNames = getCurrentTenantAndSiteName();


        if (pageExtension === 'html') {
            return (
                '-/media/Project/' +
                tenantAndSiteNames.Tenant +
                '/' +
                tenantAndSiteNames.Site +
                '/Placeholder Images/72x72.png'
            );
        } else {
            return fallbackPath;
        }
    }


    function forceOpen() {


        if ($('.shopping-cart-page').length > 0) {
            return;
        }

        if (isMinimalDisplay) {
            //Minimal version opens a dedicated modal
            handleOpenConfirmation();
            return;
        }

        forcedOpen = true;

        //Scroll to the top of the screen
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });

        hoverMinicart();

        hoverMiniCartFunc = setTimeout(function () {
            // User isn't hovering inside mini cart, then close
            if (forcedOpen) {
                closeMiniCart();
            }
        }, hoverMiniCartTimer);
    }


    function onAddToCart() {
        forceOpen();
    }

    function removeForceLock() {
        if (isNormalMode) {
            forcedOpen = false;
        }
    }

    function lockIfEditMode() {
        if (!isNormalMode && !forcedOpen) {
            forcedOpen = true;
        } else if (!isNormalMode && forcedOpen) {
            forcedOpen = false;
        }
    }

    function removeZeroDecimal(value) {
        if ($("html").attr("lang") === "fr-CA") {
            return value.replace(",0", "");
        } else {
            return value.replace(".0", "");
        }
    }

    function sortProperties(properties) {
        var payload = properties.slice(0);
        return payload.map(function (a) {
            var member = Object.assign(a, {});
            member.order = 4;
            if (a.label.match(/^Size/i)) {
                member.order = 1;
            }
            if (a.label.match(/^Width/i)) {
                member.order = 2;
            }
            if (a.label.match(/^Color/i)) {
                member.order = 3;
            }
            return member;
        }).sort(function (a, b) {
            return a.order > b.order ? 1 : -1
        });
    }


    var isConfirmationOpen = ko.observable(false);
    var isAnimationClassPresent = ko.observable(false);
    function handleOpenConfirmation() {
        isConfirmationOpen(true);
        setTimeout(function () {
            isAnimationClassPresent(true)
        }, 10);
    }
    function handleCloseConfirmation() {
        isAnimationClassPresent(false);
        setTimeout(function () {
            isConfirmationOpen(false);
        }, 310);
    }
    function handleClickOverlay(vm, e) {
        //Only allow clicking of backdrop to close
        if (e.target.classList.contains("js-close-confirmation-modal")) {
            handleCloseConfirmation();
        } else {
            return true; //Allow default click to happen
        }
    }

    /**
     * Export the functions for external use
     */
    return {
        isAnimationClassPresent: isAnimationClassPresent,
        handleOpenConfirmation: handleOpenConfirmation,
        isConfirmationOpen: isConfirmationOpen,
        handleCloseConfirmation: handleCloseConfirmation,
        handleClickOverlay: handleClickOverlay,
        refreshCartData: refreshCartData,
        removeItem: removeItem,
        hoverMinicart: hoverMinicart,
        leaveMinicart: leaveMinicart,
        closeMiniCart: closeMiniCart,
        toggleMinicart: toggleMinicart,
        cart: cart,
        isFetchInProgress: isFetchInProgress,
        minicartClassName: minicartClassName,
        cartCount: cartCount,
        updateCartCount: updateCartCount,
        forceOpen: forceOpen,
        removeForceLock: removeForceLock,
        lockIfEditMode: lockIfEditMode,
        handleCloseMinicart: handleCloseMinicart,
        removeZeroDecimal: removeZeroDecimal,
        sortProperties: sortProperties,
        onAddToCart: onAddToCart,
        getCartCount: getCartCount,
        initCartCount: initCartCount
    };
}
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        define('Caleres/Feature/Minicart', ['exports'], factory);
    } else if (typeof exports === 'object') {
        factory(exports);
    }
    root.CaleresMinicart = factory;
    root.Minicart_ComponentClass = 'caleres-minicart-component';

}(this, function (element) {
    let component = new Component(element);
    component.Name = 'Caleres/Feature/Minicart';
    component.model = new CaleresMinicartViewModel(component.RootElement);

    component.InExperienceEditorMode = function () {
        ko.applyBindings(component.model, component.RootElement);
    };


    component.OnCartUpdated = function (data) {
        if (data && (typeof data.TotalQuantity === "number")) {
            component.model.updateCartCount(data.TotalQuantity);
        } else {
            component.model.getCartCount();
        }

        //Save total in session storage to calculate loyalty points
        if (data && (typeof data.SubtotalAmount) === "number") {
            if (typeof Storage !== "undefined") {
                sessionStorage.setItem("cxaSubtotal", data.SubtotalAmount);
                sessionStorage.setItem("cxaEstPoints", data.EstimatedRewardPoints)
            }
        }        
    };

    component.StartListening = function () {
        CartContext.SubscribeHandler(CartContext.CartEvents.CartUpdate, component.OnCartUpdated);
    };

    component.Init = function () {
        if (CXAApplication.RunningMode === RunningModes.Normal) {
            component.StartListening();
            ko.applyBindings(component.model, component.RootElement);

            // Check BorderFree
            if(typeof window.isBorderFree === "function" &&  window.isBorderFree()){
                // Toggle buttons for checkout
                $(".borderfree-minicart-checkout-button").show();
                $(".checkout-button").hide();
            }

            //Listen for Add to Cart
            CaleresAddToCartBroker.SubscribeHandler(function() {
                component.model.forceOpen();
            })
        }
    };

    MessageContext.SubscribeErrorHandler(function () {
        component.model.closeMiniCart();
    });

    return component;
}));

//handle taps outside of minicart
$(document).ready(function () {
    var $basket = $("." + Minicart_ComponentClass + " .basket");
    $(document).on("touchend", function (e) {
        $basket.each(function () {
            $this = $(this);
            if (!$this.is(e.target) && $this.has(e.target).length === 0) {
                var model = ko.dataFor(this);
                model.leaveMinicart();
            }
        });

    });
});
/* Caleres override of OOTB cart models */
function LineItemShippingMethod(id, description) {
    var self = this;

    self.id = id;
    self.description = description;
}

function ShipmentData(data) {
    self = this;

    self.partyId = data.PartyID;
    self.lineIds = data.LineIDs;
    self.shippingMethodId = data.ShippingMethodId;
    self.shippingMethodName = data.ShippingMethodName;
    self.estimatedDelivery = data.EstimatedDelivery;
}

function LineItemData(cartData, line, cart) {

    var self = this;

    var deliveryComponent = document.querySelector('.caleres-checkoutdelivery-component');

    self.cart = cart;
    // lines //
    self.image = line.Image;
    self.displayName = line.DisplayName;
    self.sublines = ko.observableArray();
    if (line != null) {
        $(line.SubLines).each(function () {
            var lineItem = new LineItemData(cartData, this, null);
            self.sublines.push(lineItem);
        });
    }

    // Badge
    self.badgeImageUrl = line.BadgeImageUrl;
    self.badgeImageAlternateText = line.BadgeImageAlternateText;

    // TODO: Schema specific
    self.styleNumber = line.StyleNumber;
    self.colorInformation = line.ColorInformation;
    self.sizeInformation = line.SizeInformation;
    self.styleInformation = line.StyleInformation;
    self.giftCardAmountInformation = line.GiftCardAmountInformation;
    self.properties = [];
    var props = line.Properties || {};
    Object.keys(props).forEach(function(key, index) {
        if (props[key]) {
            if (key.toLowerCase().indexOf("pointure") > -1) {
                props[key] = props[key].replace(".", ",");
            }
            self.properties.push({
                label: key,
                value: props[key]
            });
        }
    });

    self.lineItemDiscount = line.LineDiscount;
    self.quantity = line.Quantity;
    self.linePrice = line.LinePrice;
    self.lineTotal = line.LineTotal;
    self.TotalLinePrice = line.TotalLinePrice;
    self.externalCartLineId = line.ExternalCartLineId;
    self.productUrl = line.ProductUrl;
    self.discountOfferNames = line.DiscountOfferNames;
    self.bogoOfferNames = line.BogoOfferNames || [];
    self.loyaltyCertificateNames = line.LoyaltyCertificateNames || [];
    self.promoNamesToDisplayOnCartLine = self.discountOfferNames.concat(self.bogoOfferNames, self.loyaltyCertificateNames);
    self.promoNamesToDisplayOnCartLineTooltipHtml = self.promoNamesToDisplayOnCartLine.toString().replace(/,/g, "<br />");
    // IMPORTANT: Bootstrap tooltip script must be initialized every time above variable is reset
    if (self.promoNamesToDisplayOnCartLine.length > 1) {
        $('[data-toggle="tooltip"]').tooltip();
    }
    self.promotionExcludedMessages = line.PromotionExcludedMessages || [];
    self.showPromotionExcludedMessages = $(".displayPromoExclusionMessaging").val() === "true" && self.discountOfferNames.length === 0;
    self.shippingMethodName = line.ShippingMethodName;
    self.address = line.Address;
    self.productId = line.ProductId;
    self.productVariantId = line.ProductVariantId;
    self.shouldShowSavings = ko.observable(self.lineItemDiscount !== "$0.00" ? true : false);
    self.shouldShowDiscountOffers = ko.observable(self.discountOfferNames.length > 0 ? true : false);
    self.inventoryCount = line.InStockQuantity ? ko.observable(line.InStockQuantity) : ko.observable(0);
    self.hasLowInventory = line.HasLowInventory ? ko.observable(line.HasLowInventory) : ko.observable(false);
    self.isBogoExcluded = line.IsBogoExcluded;
    self.isFinalSale = line.IsFinalSale;
    self.isBogoFirstPairOnly = line.IsBogoFirstPairOnly;
    self.isCouponExcluded = line.IsCouponExcluded;
    self.isLoyaltyCertificateApplied = line.IsLoyaltyCertificateApplied ? ko.observable(line.IsLoyaltyCertificateApplied) : ko.observable(false);

    self.isMapPolicyCart = line.IsMapPolicyCart;
    self.isEGiftCard = line.IsEGiftCard ? ko.observable(line.IsEGiftCard) : ko.observable(false);
    self.isOnlineOnly = line.IsOnlineOnly ? ko.observable(line.IsOnlineOnly) : ko.observable(false);
    self.isPhysicalGiftCard = line.TypeOfGood === "GiftCards" && !line.IsEGiftCard ? ko.observable(true) : ko.observable(false);
    self.isStorePickup = line.IsStorePickup ? ko.observable(line.IsStorePickup) : ko.observable(false);
    self.isQuantityDisabled = ko.observable(self.isStorePickup() === true || self.isEGiftCard() === true ? true : false);
    self.isStorePickupOnly = line.IsStorePickupOnly ? ko.observable(line.IsStorePickupOnly) : ko.observable(false);

    self.recipient = line.Recipient || {};

    // shipping //
    self.selectedShippingOption = ko.observable('0');

    self.isLineShipAll = ko.observable(cartData.Shipments != null && cartData.Shipments.length > 1);
    self.isLineShipToEmail = ko.observable(false);
    self.showShipOptionContent = ko.observable(false);
    self.selectedShippingOptionName = ko.observable(deliveryComponent !== null ? deliveryComponent.dataset.deliverySelectDeliveryFirstMessage : undefined);
    self.toggleShipContent = function () {
        self.showShipOptionContent(!self.showShipOptionContent());
    };

    self.selectedShippingOption.subscribe(function (option) {
        self.isLineShipAll(option === 1);
        self.isLineShipToEmail(option === 3);
        self.showShipOptionContent(option !== 0);

        var match = ko.utils.arrayFirst(self.shippingOptions(), function (o) {
            return o.ShippingOptionType.Value === option;
        });

        if (match != null) {
            self.selectedShippingOptionName(match.Name);
        }
    }.bind(this));

    self.shippingMethods = ko.observableArray();
    self.shippingMethod = ko.validatedObservable().extend({ required: true });
    self.selectShippingMethod = function (shippingMethod) {
        if (shippingMethodsArray.indexOf(self.externalCartLineId) === -1) {
            shippingMethodsArray.push(self.externalCartLineId);
        }
    };

    self.shippingAddress = ko.validatedObservable(new AddressViewModel({ "ExternalId": self.externalCartLineId }));
    self.selectedShippingAddress = ko.observable("UseOther");
    self.selectedShippingAddress.subscribe(function (id) {
        var match = ko.utils.arrayFirst(self.cart.userAddresses(), function (a) {
            if (a.externalId() === id && id !== "UseOther") {
                return a;
            }

            return null;
        });

        self.shippingMethod("");
        self.shippingMethods.removeAll();
        if (match != null) {
            var newAddress = match.clone();
            var newId = self.cart.getUniqueAddressId().toString();
            newAddress.externalId(newId);
            newAddress.partyId(newId);
            self.shippingAddress(newAddress);
        } else {
            self.shippingAddress(new AddressViewModel({ "ExternalId": self.externalCartLineId }));
        }
    }.bind(this));
    self.shippingAddressFieldChanged = function () {
        var index = shippingMethodsArray.indexOf(self.externalCartLineId);
        if (index !== -1) {
            shippingMethodsArray.splice(index, 1);
        }
        self.shippingMethod("");
        self.shippingMethods.removeAll();
    };

    self.shippingEmail = ko.validatedObservable("").extend({ required: true, email: true });
    self.shippingEmail.subscribe(function (email) {
        var index = shippingMethodsArray.indexOf(self.externalCartLineId);
        if (email.trim().length > 0 && index === -1) {
            shippingMethodsArray.push(self.externalCartLineId);
        }
        else if (email.trim().length === 0 && index !== -1) {
            shippingMethodsArray.splice(index, 1);
        }

    }.bind(this));
    self.shippingEmailContent = ko.observable("");

    self.shippingOptions = ko.observableArray();
    if (line.ShippingOptions !== null) {
        $(line.ShippingOptions).each(function () {
            self.shippingOptions.push(this);
        });

        // Handle edit mode.
        if (line.ShippingOptions != null && line.ShippingOptions.length > 0) {
            var shippingOption = line.ShippingOptions[0];
            if (shippingOption != null) {
                if (shippingOption.ShippingOptionType != null) {
                    self.selectedShippingOption(shippingOption.ShippingOptionType.Value);
                }
            }
        }
    }

    self.handleEditMode = function (data) {
        if (data.Cart.Shipments != null && data.Cart.Shipments.length > 0) {
            selectedShippingOption = self.selectedShippingOption();

            $(data.Cart.Shipments).each(function () {
                var shipment = this;
                var foundShipment = null;
                if (shipment.LineIDs != null) {

                    foundLineId = ko.utils.arrayFirst(shipment.LineIDs, function (a) {
                        if (a === self.externalCartLineId) {
                            return a;
                        }

                        return null;
                    });

                    if (foundLineId != null) {

                        // ShipToAddress
                        if (selectedShippingOption == "1") {
                            if (shipment.ShipmentEditModel != null) {
                                var methods = "";
                                self.shippingMethods.removeAll();
                                $.each(shipment.ShipmentEditModel.ShippingMethods, function (i, v) {
                                    self.shippingMethods.push(new method(v.Description, v.ExternalId, v.Name, v.Price, v.EstimatedDelivery));
                                });

                                var sm = ko.utils.arrayFirst(self.shippingMethods(), function (a) {
                                    if (a.description === shipment.ShippingMethodName) {
                                        return a;
                                    }

                                    return null;
                                });

                                if (sm != null) {
                                    self.shippingMethod(sm);
                                }
                            }
                        }

                        // Email
                        if (selectedShippingOption == '3') {
                            self.shippingEmail(shipment.Email);
                            self.shippingEmailContent(shipment.EmailContent);
                        }
                    }
                }
            });

            if (selectedShippingOption == "1") {
                self.isLineShipAll(true);
                self.isLineShipToEmail(false);
            }

            if (selectedShippingOption == '3') {
                self.isLineShipToEmail(true);
                self.isLineShipAll(false);
            }

            self.showShipOptionContent(true);
        }
    }

    // Delivery Options observables for cart line
    self.bopisEligible = ko.computed(function() {
        if (self.isEGiftCard() || self.isOnlineOnly() || self.isPhysicalGiftCard() || self.quantity > 1) {
            return false;
        } else {
            return true;
        }
    }, this);
    self.isPDP = false;
    self.sku = ko.observable(line.ProductVariantId);
    self.currentStoreId = ko.observable(line.StoreId);
    self.currentStoreName = ko.observable("");
    self.deliveryOptionCheckedValue = line.IsStorePickup ?  ko.observable("pickup_at_store") : ko.observable("ship_to_address");
    self.variantId = ko.observable("");
    self.storesNotInRadiusOfSetStore = ko.observable(false);
    self.storesInRadiusOfSetStore = ko.observable(false);
    self.availableAtSetStore = ko.observable(false);
    self.isStoreBopisEligible = ko.observable(false);
    self.isStoreCurbsideEligible = ko.observable(false);
    self.filteredAvailability = ko.observable([]);
    self.selectedProductAvailabilityImageUrl = ko.observable("");
    self.cartVariantImages = ko.observable({});
    self.cartLineProducts = ko.observable([]);
    self.getCartAvailabilityFromDO = ko.observable([]);
    self.getAvailabilityFromDO = ko.observable([]);
    self.storeHasChanged = ko.observable(false);

    /**
     * @function filterAvailability - Filter Coveo results for each line to determine which radio buttons to display
     */
    self.filterAvailability = function(queryResults, line) {
        // Reset key observables to update DOM
        line.storesNotInRadiusOfSetStore(false);
        line.storesInRadiusOfSetStore(false);
        line.availableAtSetStore(false);

        // Is this product sku available at a nearby store?
        var isAvailableAtNearbyStore = queryResults.filter(function(result) {
            return (result.skus.indexOf(line.sku()) >= 0);
        });

        // Is this product sku available at my set store?
        var isAvailableAtSetStore = isAvailableAtNearbyStore.filter(function(result) {
            return result.storeid === line.currentStoreId();
        });

        // Display appropriate delivery option
        if (isAvailableAtSetStore.length > 0) {
            line.isStoreBopisEligible(isAvailableAtSetStore[0].isbopiseligible === "true");
            line.isStoreCurbsideEligible(isAvailableAtSetStore[0].iscurbsideeligible === "true");
            line.availableAtSetStore(true);
        } else if (isAvailableAtNearbyStore.length > 0) {
            line.storesInRadiusOfSetStore(true);
        } else {
            line.storesNotInRadiusOfSetStore(true);
        }

        if (line.availableAtSetStore() === true && line.storeHasChanged() === true) {
            // auto-select pickup radio button
            line.deliveryOptionCheckedValue("pickup_at_store");
        }
        // reset observable
        line.storeHasChanged(false);

    };

    /**
     * @function setAvailabilityModalData - wire up data to send to availability modal
     */
    self.setAvailabilityModalData = function(queryResults, line, cartLinesData) {

        var skus = [];
        var productVariantImages = [];

        cartLinesData.forEach(function(cartLine) {
            skus.push(cartLine.ProductVariantId);
            if (!productVariantImages.includes(cartLine.Image)) {
                productVariantImages.push(cartLine.Image);
            }
        });

        // Sets observable params for availability modal
        line.cartLineProducts(cartLinesData);
        line.cartVariantImages(productVariantImages);
        line.getCartAvailabilityFromDO(queryResults);

    }

    /**
     * @function subscribe - subscribe to changes to delivery options radio value and reset quantity disabled accordingly
     */
    self.deliveryOptionCheckedValue.subscribe(function(newValue) {
        // if store changed, then let subscribe event handle delivery update
        if(self.storeHasChanged() === false) {
            cart.updateDeliverySelection(self.currentStoreId());
        } else {
            self.storeHasChanged(false);
        }

        // disable quantity drop down based on selection type
        if (newValue === "ship_to_address") {
            self.isQuantityDisabled(false);
        } else if (newValue === "pickup_at_store") {
            self.isQuantityDisabled(true);
        }
    });


    /**
     * @function - subscribe to changes to global store number and update observables accordingly
     */
    if (window.globalStoresState) {
        window.globalStoresState.currentStoreNumber.subscribe(function (newValue) {
            var currentStore = window.globalStoresState.getCurrentStore();
            // update store observables with new data
            self.currentStoreId(currentStore.storeNumber);
            self.currentStoreName(currentStore.storeName);
        });
    }
// ! Delivery Options 

}

function CartViewModel(data, userAddresses) {
    var self = this;
    self.cartLines = ko.observableArray();
    self.userAddresses = ko.observableArray();
    if (userAddresses) {
        self.userAddresses(userAddresses);
    }

    self.getUniqueAddressId = function () {
        var newId = 10;
        for (let i = 10; i < 1000; i++) {
            var match = ko.utils.arrayFirst(self.cartLines(), function (a) {
                if (a.shippingAddress() && a.shippingAddress().externalId() === i.toString()) {
                    return a;
                }

                return null;
            });

            if (match === null) {
                newId = i;
                break;
            }
        }

        return newId;
    };

    self.appliedLoyaltyCertificates = ko.observableArray(data && data.LoyaltyCertificatesApplied ? data.LoyaltyCertificatesApplied : []);
    self.appliedLoyaltyOfferNames = ko.observableArray();
    self.appliedLoyaltyOffers = ko.observableArray(data && data.LoyaltyOffersApplied ? data.LoyaltyOffersApplied : []);
    self.activePromoCount = ko.observable(0);
    self.certificateAmount = ko.computed(function(){
        var amount =  data ? "-" + data.LoyaltyCertificatesAmountFormatted : "-$0.00";
        return amount;
    });

    // existing promo codes
    self.promoCodes = ko.observableArray();
    if (data && data.PromoCodes) {
        $(data.PromoCodes).each(function () {
            self.promoCodes.push(this);
        });
    }

    self.appliedPromoCodes = ko.observableArray();
    if (data && data.AppliedPromoCodes) {
        $(data.AppliedPromoCodes).each(function (index, val) {
            if(this.PromotionType !== "LoyaltyCertificate" && this.PromotionType !== "LoyaltyCoupon"){
                self.appliedPromoCodes.push(this);
            }
            else {
                self.appliedLoyaltyOfferNames().push(this.PromotionDisplayCartText);
            }
        });
    }

    // renders promos to be listed in order summary
    self.getOrderSummaryPromos = function (data) {
        if (Object.keys(data).length === 0 && data.constructor === Object) {
            return [];
        }

        data.AppliedPromoCodes = data.AppliedPromoCodes || [];
        data.LoyaltyCertificatesApplied = data.LoyaltyCertificatesApplied || [];

        var promosToDisplay = data.AppliedPromoCodes.filter(function (promo) {
            return promo.ShouldDisplayInOrderSummary === true;
        });

        var promoCount = data.AppliedPromoCodes.length - data.LoyaltyCertificatesApplied.length;
        //Do not count offers for 2X, 3X, or 2X Birthday in Promo line
        (data.LoyaltyOffersApplied || []).forEach(function (offer) {
            if (offer.CouponCode.match(/^PPD/)) {
                promoCount -= 1;
            }
        });

        //Do count BOGO promos that only exist in BogoOfferNames array in each cart line (unique)
        var bogoOfferNamesUnique = [];
        if (data.Lines) {
            data.Lines.forEach(function(lineItem) {
                (lineItem.BogoOfferNames || []).forEach(function(offer) {
                    if (bogoOfferNamesUnique.indexOf(offer) === -1) {
                        bogoOfferNamesUnique.push(offer);
                    }
                });
            });
        }
        promoCount += bogoOfferNamesUnique.length;
        self.activePromoCount(promoCount);

        var promotionNames = data.LoyaltyCertificatesApplied.map(function(promo) {
            return promo.PromotionName;
        });

        if (data.LoyaltyCertificatesApplied.length > 0) {
            var nonLoyaltyPromos = [];
            // if promotion is included in LoyaltyCertificatesApplied, do not display
            promosToDisplay.forEach(function(promo) {
                if(promotionNames.indexOf(promo.PromotionName) === -1) {
                    nonLoyaltyPromos.push(promo);
                }
            })
            return nonLoyaltyPromos;
        } else {
            return promosToDisplay;
        }
    }

// renders promos to be displayed under promo code input
    self.getDisplayPromos = function (data) {
        // check if data is an empty object
        if (Object.keys(data).length === 0 && data.constructor === Object) {
            return [];
        }

        var promosToDisplay = data.AppliedPromoCodes.filter(function (promo) {
            // Do not display PLCC promo codes to end user
            if (promo.CouponCode === "PLCCAPPL" || promo.CouponCode === "PLCCCARD") {
                return false;
            } else {
                return promo.ShouldDisplayInOrderSummary === false;
            }
        });

        var promotionNames = data.LoyaltyCertificatesApplied.map(function(promo) {
            return promo.PromotionName;
        });

        if (data.LoyaltyCertificatesApplied.length > 0) {
            var nonLoyaltyPromos = [];
            // if promotion is included in LoyaltyCertificatesApplied, do not display
            promosToDisplay.forEach(function(promo) {

                if(promotionNames.indexOf(promo.PromotionName) === -1) {
                    nonLoyaltyPromos.push(promo);
                }
            })
            return nonLoyaltyPromos;
        } else {
            return promosToDisplay;
        }
    }

    self.notYetAppliedPromoCodes = ko.observableArray();
    if (data && data.NotYetAppliedPromoCodes) {
        $(data.NotYetAppliedPromoCodes).each(function () {
            if(this.PromotionType !== "LoyaltyCertificate" && !this.ShouldDisplayInOrderSummary) {

                // Do not display PLCC promo codes to end user
                if (this.CouponCode === "PLCCAPPL" || this.CouponCode === "PLCCCARD") {
                    this.CouponCode = "Credit Card Offer";
                }

                self.notYetAppliedPromoCodes.push(this);
            }
        });
    }

    // promo code input
    self.promoCode = ko.observable();
    self.hasPromoCode = ko.computed(function () {
        return self.promoCode();
    });

    self.subtotal = ko.observable(data ? data.Subtotal : 0);
    self.subtotalAmount = ko.observable(data ? data.SubtotalAmount : 0);
    self.taxTotal = ko.observable(data ? data.TaxTotal : 0);
    self.total = ko.observable(data ? data.AmountDue : 0);
    self.totalAmount = ko.observable(data ? data.TotalAmount : 0);
    self.discount = ko.observable(data ? ("-" + data.Discount) : 0);
    self.NonLoyaltyDiscountAmount = ko.observable(data ? ("-" + data.NonLoyaltyDiscountAmount) : 0);
    self.discountAmount = ko.observable(data ? data.DiscountAmount : 0);
    self.shippingTotal = ko.observable(data ? data.ShippingTotal : 0);
    self.isLineShipAll = data && data.Shipments && data.Shipments.length > 1;
    self.amountDueFormatted = ko.observable(data ? data.AmountDueFormatted : "$0.00");
    self.amountDueNumerical = ko.observable(data ? data.AmountDue : "0.00");
    self.promotionApplied = data ? data.PromotionApplied : false;
    self.orderSummaryPromos = ko.observableArray(data ? self.getOrderSummaryPromos(data) : []);
    self.displayPromos = ko.observableArray(data ? self.getDisplayPromos(data) : []);
    self.isInitialPlccTransaction = ko.observable(data && data.TemporaryCreditCard != null ? true : false);

    self.showDonation = ko.observable(data && data.Donation && data.Donation.Amount !== 0);
    self.donationAmount = ko.observable(function() {
        if (data && data.Donation) {
            return data.Donation.AmountFormatted;
        }
        return null;
    }());


    self.showDiscountLine = function() {
        if(self.discount() == '-0,00 $' || self.discount() == '-$0.00') {
            return false;
        } else {
            return true;
        }
    }

    self.shipments = [];
    if (data && data.Shipments) {
        $(data.Shipments).each(function () {
            self.shipments.push(new ShipmentData(this));
        });
    }

    self.parties = [];
    if (data && data.Parties) {
        $(data.Parties).each(function () {
            self.parties.push(new AddressViewModel(this));
        });
    }

    var storePickupLabel = $('.caleres-shoppingcartlines-component').data("store-pickup-label");
    var shipToAddressLabel = $('.caleres-shoppingcartlines-component').data("ship-to-address-label");
    var emailDeliveryLabel = $('.caleres-shoppingcartlines-component').data("email-delivery-label");
    var itemLabel = $('.caleres-shoppingcartlines-component').data("item-label");

    self.groupedLines = ko.observableArray([
        {deliveryType: storePickupLabel,
            lineItems: ko.observableArray()},
        {deliveryType: shipToAddressLabel,
            lineItems: ko.observableArray()},
        {deliveryType: emailDeliveryLabel,
            lineItems: ko.observableArray()}
    ]);

    self.formatTypeHeading = function(type, quantity) {
        return type + ' (' + quantity.toString() + ' ' + (quantity == 1 ? itemLabel : itemLabel + 's') + ')';
    }

    if (data && data.Lines) {
        $(data.Lines).each(function () {
            var lineItem = new LineItemData(data, this, self);

            if (lineItem.isEGiftCard()) {
                // find the eDelivery object, then push the lineItem on to it's array
                self.groupedLines().filter(function(item) {
                    return item.deliveryType == emailDeliveryLabel;
                })[0].lineItems().push(lineItem);
            } else if (lineItem.isStorePickup()) {
                // find the inStorePickup object, then push the lineItem on to it's array
                self.groupedLines().filter(function(item) {
                    return item.deliveryType == storePickupLabel;
                })[0].lineItems().push(lineItem);
            } else {
                // find the shipToAddress object, then push the lineItem on to it's array
                self.groupedLines().filter(function(item) {
                    return item.deliveryType == shipToAddressLabel;
                })[0].lineItems().push(lineItem);
            }

            if (self.isLineShipAll) {
                var shipment = ko.utils.arrayFirst(self.shipments, function (a) {
                    if (a.lineIds && a.lineIds.length > 0) {
                        var found = ko.utils.arrayFirst(a.lineIds, function (l) {
                            return l === lineItem.externalCartLineId ? l : null;
                        });

                        if (found) {
                            return this;
                        }

                        return null;
                    }

                    return null;
                });

                if (shipment) {
                    lineItem.shippingMethod(new LineItemShippingMethod(shipment.shippingMethodId, shipment.shippingMethodName));

                    var party = ko.utils.arrayFirst(self.parties, function (a) {
                        if (a.externalId() === shipment.partyId) {
                            return a;
                        }

                        return null;
                    });

                    if (party) {
                        lineItem.shippingAddress(party);
                    }
                }
            }

            self.cartLines.push(lineItem);
        });
    }

    /**
     * @function updateDeliverySelection - Passes updated storeId and cart line id to API
     */
    self.selectionUpdating = ko.observable(false || (CXAApplication.RunningMode === RunningModes.ExperienceEditor));
    self.updateDeliverySelection = function(storeId) {

        if (CXAApplication.RunningMode === RunningModes.Normal) {
            self.selectionUpdating(true);
            var model = self;
            var cartLinesArray = [];

            self.cartLines().forEach(function(line) {
                var product = {
                    storeId: line.deliveryOptionCheckedValue() === "pickup_at_store" ? storeId : null,
                    lineItemId: line.externalCartLineId
                };

                cartLinesArray.push(product);

            });
            var dataPayload = {
                CartLines: cartLinesArray
            };

            AjaxService.Post("/api/calxa/cart/UpdateCartLinesPickup", dataPayload, function (data, success, self) {
                if (success && data && data.Success) {
                    CartContext.TriggerCartUpdateEvent(data);
                } else {
                    CartContext.TriggerCartUpdateEvent();
                }
                model.selectionUpdating(false);
            });
        }
    }


}
function ShoppableContentPromoModel(rootElement) {
    var shoppableContent = document.querySelector('.cxa-shoppablecontentpromo-component');
    var self = this;
    self.rootElement = rootElement;

    var pageName = shoppableContent.dataset.pageName;

    self.currentProductId = null;
    self.currentProductName = null;
    self.productName = ko.observable();
    self.priceNow = ko.observable();
    self.priceBefore = ko.observable();
    self.isOnSale = ko.observable(false);
    self.productUrl = ko.observable();
    self.productId = ko.observable();
    self.isLoading = ko.observable(false);
    self.variants = ko.observable();
    self.selectedSize = ko.observable();
    self.selectedWidth = ko.observable();
    self.sizeOptions = ko.observable();
    self.widthOptions = ko.observable();
    self.sizeLabel = ko.observable();
    self.sizeSelectLabel = ko.observable();
    self.widthLabel = ko.observable();
    self.widthSelectLabel = ko.observable();
    self.hasSizeOptions = ko.observable(false);
    self.hasWidthOptions = ko.observable(false);
    
    self.combinedSelected = ko.pureComputed(function() {
        return {
            size: self.selectedSize() ? self.selectedSize() : "",
            width: self.selectedWidth() ? self.selectedWidth() : ""
        }
    });

    var productData = {

    };
    
    self.variantErrorText = function(variantName) {
        var language = $("html").attr("lang");
        var variantErrorRequest = language === "fr-CA" ? "Veuillez sélectionner une " : "Please select a ";

        if (variantName === "width") {
            variantName = language === "fr-CA" ? "Largeur" : "Width";
        } else if (variantName === "size") {
            variantName = language === "fr-CA" ? "Pointure" : "Size";
        }
        return variantErrorRequest + variantName;
    }

    self.addToCart = function() {
        $validationErrors = $('.active-crosshair > .tooltip-content [class^="validation-label"].field-validation-error');
        if ($validationErrors.length) {
            // Show errors 
            $validationErrors.addClass('visible');
            // Don't try to add to cart
            return false;
        } else {
            var dataLayer = window.data;
            var currentSku = self.getSku();
            var analyticsCartAddObject = {
                cartAddMethod: 'shoppablecontent',
                productID: self.productId().split("_")[1],
                productName: self.productName(),
                size: self.combinedSelected().size,
                width: self.combinedSelected().width,
                quantity: 1,
                price: self.priceNow().substring(1),
                sku: currentSku
            };

            var addCartEndpoint = "/api/calxa/Cart/AddCartLine";
            var catalogName = document.getElementById("shoppable-content-catalog-name").value;
            var cartLineData = {
                CatalogName: catalogName,
                ProductId: self.productId(),
                VariantId: self.getVariantId(),
                Quantity: 1
            }
    
            self.isLoading(true);
            AjaxService.Post(addCartEndpoint, cartLineData, function (data, success, sender) {
                if (data && data.Success && success) {
                    data.Lines.forEach(function(cartLine) {
                        if(cartLine.Upc == currentSku) {
                            analyticsCartAddObject.cart = data;
                            analyticsCartAddObject.ageGroup = ""; // data not available at this time
                            analyticsCartAddObject.color = cartLine.PrimaryColor;
                            analyticsCartAddObject.manufacturer = cartLine.BrandName;
                            analyticsCartAddObject.seePriceInCart = cartLine.IsMapPolicyCart;
                            analyticsCartAddObject.isNewCart = ((data.TotalQuantity - 1) <= 0) ? true : false,
                            analyticsCartAddObject.isPromoExcluded = cartLine.IsPromoExcluded;
                            analyticsCartAddObject.cartID = data.FriendlyId;
                            analyticsCartAddObject.oldQuantity = (data.TotalQuantity - 1);
                            analyticsCartAddObject.newQuantity = data.TotalQuantity;
                            analyticsCartAddObject.primaryCategory = cartLine.WebDepartment;
                            analyticsCartAddObject.subCategory1 = cartLine.WebGender;
                            analyticsCartAddObject.subCategory2 = cartLine.SecondaryCategory;
                            analyticsCartAddObject.subCategory3 = cartLine.TertiaryCategory;
                            analyticsCartAddObject.lowStock = cartLine.HasLowInventory;
                        }
                    });
                    dataLayer.event('cartAdd', analyticsCartAddObject);
                    CartContext.TriggerCartUpdateEvent(data);
                    
                    if (CaleresAddToCartBroker) {
                        CaleresAddToCartBroker.ItemAddedToCart();
                    }
                }
                self.isLoading(false);    
            }, $(this)); 
        }
    }

    self.isOptionDisabled = function(key, value) {
        
        var allProducts = self.variants();
        var selections = self.combinedSelected();
        var productsIndex;

        var exists = allProducts.find(function(product, index) {
            productsIndex = index;
            return product[key] === value;
        });

        if (!exists) {           
            return true;
        }

        var stockCheck = ["Filler Item"];

        if(allProducts[productsIndex].stockCount <= 0){
            stockCheck = allProducts.filter(function(product, index) {
                return product.stockCount > 0 && product[key] == allProducts[productsIndex][key];
            })
        }

        if(stockCheck.length <= 0){
            return true;
        }
        
        var selectedValues = Object.keys(selections).filter(function(selectedKey) {
            return selections[selectedKey]
        });

        if (!selectedValues.length || selections[key] === value) {
            return false;
        }

        var matches = allProducts.filter(function(product) {
            if ( product[key] !== value ) {
                return false
            }

            // check stock
            if (product[key] === value && product.stockCount === 0) {
                return false
            }

            var valid = true;
            Object.keys(selections).forEach(function(selectionKey) {
                if (selections[selectionKey] && key !== selectionKey && product[selectionKey] && product[selectionKey] !== selections[selectionKey]) {
                    valid = false;
                }
            });
            return valid;
        });
        return matches.length === 0
    };

    self.setOptionDisable = function(option, item) {
        if(!item) {
            return;
        }

        ko.applyBindingsToNode(option, { disable: ko.computed(function() { return self.isOptionDisabled(item.name, item.value)}) }, item);
    }

    self.getUniqueArray = function(arr, property) {
        var uniques = [];
        var itemsFound = {};

        arr.forEach(function(item) {
            if(!itemsFound[item[property]]) {
                uniques.push(item);
                itemsFound[item[property]] = true;
            }

        });

        return uniques;
    }

    self.getVariantId = function() {
        var size = self.combinedSelected().size;
        var width = self.combinedSelected().width;
        var id = "";

        ko.utils.arrayFirst(self.variants(), function(item) {
            if(size != null && width != null) {
                if(item.size === size && item.width === width) {
                    id = item.id;
                }
            }
        });
        return id;
    }

    self.getSku = function() {
        var size = self.combinedSelected().size;
        var width = self.combinedSelected().width;
        var sku = "";

        ko.utils.arrayFirst(self.variants(), function(item) {
            if(size != null && width != null) {
                if(item.size === size && item.width === width) {
                    sku = item.sku;
                }
            }
        });
        return sku;
    }

    self.buildSizeString = function(variant) {
        if(variant.ageGroup != null || variant.sizeString.includes("/")) {
            return variant.sizeString;
        }

        if(variant.sizeSubtext != null) {
            return variant.size + " " + variant.sizeSubtext;
        }
        return variant.size;
    }

    self.buildOptions = function(options, labels) {
        var variants = options.map(function(product) {
            return {
                id: product.VariantId,
                size: product.Size,
                sizeString: product.SizeString,
                sizeSubtext: product.SizeSubtext,
                stockCount: product.StockCount,
                width: product.Width,
                ageGroup: product.AgeGroup,
                sortOrder: product.SizeSortOrder,
                sku: product.Upc
            }
        });

        var sizes = variants.map(function(item) {
            return {
                value: item.size,
                sizeString: self.buildSizeString(item),
                ageGroup: item.ageGroup,
                sortOrder: item.sortOrder,
                name: "size"
            }
        });

        sizes = sizes.sort(function(a, b) {
            return a.sortOrder - b.sortOrder;
        });

        var widths = variants.map(function(item) {
            return {
                value: item.width,
                name: "width"
            }
        });            

        labels.forEach(function(item) {
            if(item.PropertyName == "Size") {
                self.sizeLabel(item.Label);
                self.sizeSelectLabel(item.SelectLabel);
            }

            if(item.PropertyName == "WidthDescription") {
                self.widthLabel(item.Label);
                self.widthSelectLabel(item.SelectLabel);
            }
        });

        self.variants(variants);

        self.sizeOptions(self.getUniqueArray(sizes, 'value'));
        self.widthOptions(self.getUniqueArray(widths, 'value'));

        if(self.sizeOptions().length >= 1 && self.sizeOptions()[0].value != "") {
            self.hasSizeOptions(true);
        } else {
            self.hasSizeOptions(false);
        }

        if(self.widthOptions().length >= 1 && self.widthOptions()[0].value != "") {
            self.hasWidthOptions(true);
        } else {
            self.hasWidthOptions(false);
        }

        if (productData[self.currentProductId]) {
            self.selectedSize(productData[self.currentProductId].selectedSize || "");
            self.selectedWidth(productData[self.currentProductId].selectedWidth || "");
        }
        
    }

    self.validationCheck = function(el) {
        var selection = self.combinedSelected();
        var $labelElement = $(el.nextElementSibling);

        if($labelElement.is("[class*='size']")) {
            if(selection.size != '') {
                $labelElement.removeClass('field-validation-error visible');
            } else {
                $labelElement.addClass('field-validation-error');
            }
        }

        if($labelElement.is("[class*='width']")) {
            if(selection.width != '') {
                $labelElement.removeClass('field-validation-error visible');
            } else {
                $labelElement.addClass('field-validation-error');
            }
        }
    }

    self.setProductUrlWithTracking = function(product) {
        product.Uri = product.Uri + "?icid=" + encodeURI("ShoppableContent_" + pageName.replaceAll(" ", "") + "_" + product.Name.replaceAll(" ", "") + "_" + product.ProductId);
    }

    self.fireOpenedAnalyticsEvent = function(id, name) {
        if(window.data) {
            window.data.event("shoppable-content-tooltip-opened", {
                productId: id,
                productName: name
            })
        }
    }

    self.getProductData = function(id) {
        var productEndpoint = "/api/calxa/catalog/GetProductInformation";
        var params = {ProductId: id};
        self.currentProductId = id;

        if(productData[id]) {
            self.currentProductName = productData[id].Name;
            self.productName(productData[id].Name);
            self.priceNow(productData[id].AdjustedPrice);
            self.priceBefore(productData[id].ListPrice);
            self.isOnSale(productData[id].IsOnSale);
            self.productUrl(productData[id].Uri);
            self.productId(productData[id].ProductId);
            self.buildOptions(productData[id].Variants, productData[id].VariantOptions);
        } else {
            AjaxService.Post(productEndpoint, params, function (data, success) {
                if (success && data.Success) {
                    productData[id] = data.Product;
                    self.currentProductName = data.Product.Name;
                    self.setProductUrlWithTracking(productData[id]);
                    self.productName(productData[id].Name);
                    self.priceNow(productData[id].AdjustedPrice);
                    self.priceBefore(productData[id].ListPrice);
                    self.isOnSale(productData[id].IsOnSale);
                    self.productUrl(productData[id].Uri);
                    self.productId(productData[id].ProductId);
                    self.buildOptions(productData[id].Variants, productData[id].VariantOptions);          
                }
            });
        }
    }

    self.selectedSize.subscribe(function(newValue) {
        productData[self.currentProductId].selectedSize = newValue;
    });

    self.selectedWidth.subscribe(function(newValue) {
        productData[self.currentProductId].selectedWidth = newValue;
    });

    self.adjustModalPosition = function(el) {
        var position = el[0].getBoundingClientRect();

        if(position.left <=0) {
            var leftNudge = Math.abs(Math.round(position.left)) + 3;
            el[0].style.left = leftNudge + 'px';
            el.find(".tooltip-arrow")[0].style.transform = 'translateX(' + -leftNudge + 'px)';
        }

        if(position.right >= window.innerWidth) {
            //beyond right edge
            var rightNudge = Math.abs(Math.round(position.right - window.innerWidth)) + 3;
            el[0].style.right = rightNudge + 'px';
            el.find(".tooltip-arrow")[0].style.transform = 'translateX(' + rightNudge + 'px)';
        }
    }
    
    
    self.initialize = function () {
        var shoppableContent = rootElement.querySelectorAll(".shoppable-content-crosshair");
        var tooltipTimers = {};

        for (var i = 0; i < shoppableContent.length; i++) { 
            shoppableContent[i].addEventListener("mouseleave", function (e) {
                var target = e.target;
                
                if(target.matches(".shoppable-content-crosshair")) {
                    var tooltipId = target.dataset.productid;
                    
                    if(tooltipTimers[tooltipId]) {
                        clearTimeout(tooltipTimers[tooltipId]);
                        tooltipTimers[tooltipId] = null;
                    }
                    tooltipTimers[tooltipId] = setTimeout(function() {
                        target.classList.remove("active-crosshair");
                        $(target).parents(".shoppable-content-product").removeClass("active");
                        $(target).find(".tooltip-content").fadeOut(200);
                    }, 300);
                }
            });
        }

        rootElement.addEventListener("click", function (e) {
            var target = e.target;

            if(target.matches(".shoppable-content-crosshair") || target.matches(".tooltip-icon")) {                
                var $crosshair = target.matches(".shoppable-content-crosshair") ? $(target) : $(target).parent(".shoppable-content-crosshair");

                if(!$crosshair.hasClass("active-crosshair")) {
                    self.getProductData($crosshair.data("productid"));
                    $crosshair.addClass("active-crosshair");
                    $crosshair.parents(".shoppable-content-product").addClass("active");
                    $crosshair.find(".tooltip-content").fadeIn(200);
                    setTimeout(function() {
                        self.fireOpenedAnalyticsEvent(self.currentProductId, self.currentProductName);
                    }, 200);
                    self.adjustModalPosition($crosshair.find(".tooltip-content"));
                } else {
                    $crosshair.removeClass("active-crosshair");
                    $crosshair.parents(".shoppable-content-product").removeClass("active");
                    $crosshair.find(".tooltip-content").fadeOut(200);
                }
            }
        });

        rootElement.addEventListener("mouseover", function (e) {
            var target = e.target;
            
            if (target.matches(".shoppable-content-crosshair")) {
                clearTimeout(tooltipTimers[target.dataset.productid]);
                if (!target.classList.contains("active-crosshair")) {
                    self.getProductData(target.dataset.productid);
                    target.classList.add("active-crosshair");
                    $(target).parents(".shoppable-content-product").addClass("active");
                    $(target).find(".tooltip-content").fadeIn(200);
                    setTimeout(function() {
                        self.fireOpenedAnalyticsEvent(self.currentProductId, self.currentProductName);
                    }, 200);
                    self.adjustModalPosition($(target).find(".tooltip-content"));
                } 
            }
        });
    }
}
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);
    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    root.CaleresShoppableContentPromo = factory;
    root.CaleresShoppableContentPromo_ClassName = "cxa-shoppablecontentpromo-component";
}(this, function (element) {
    'use strict';
    var component = new Component(element);
    component.Name = "Caleres/Feature/CaleresShoppableContentPromo";
    component.model = new ShoppableContentPromoModel(component.RootElement);

    component.Init = function () {
        if($(component.RootElement).length) {
            ko.applyBindings(component.model, component.RootElement);
            component.model.initialize();
        }
    }
}));
/**
 * @description Initializes the Knockout view model and registers broker events for the Rules Based Snippet Rendering
 */
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);

    }

    // browser global variable
    root.CaleresRulesBasedSnippet = factory;
    root.CaleresRulesBasedSnippet_ComponentClass = "caleres-rulesbasedsnippet-component";

}(this, function (element) {
    'use strict';
    var component = new Component(element);
    component.Name = "Caleres/Feature/RulesBasedSnippet";
    component.UniqueId = $(element).data('setting-uniqueid');
    component.IsDynamicContentEnabled = $(element).hasClass('rules-based-snippet__dynamic');
    component.ShowLoadingIndicator = $(element).data('setting-showloadingindicator');

    //RulesBasedSnippet Handlers
    /**
    * @function ProductChangedHandler - updates snippet html when the broker raises an update event
    * @param source - the source of the event
    * @param data - updated snippet dom objects
    */
    component.SnippetsUpdatedHandler = function (source, data) {
        if(!component.IsDynamicContentEnabled) {
            return;
        }

        if(!data || !data.snippets || (data.pathname != window.location.pathname)) {
            return;
        }

        $(component.RootElement).children('.component-content').remove();
        var newSnippet = data.snippets.filter(function(snippetData) {
            return snippetData.uniqueId === component.UniqueId;
        });

        if(newSnippet.length > 0) {
            var componentContent = $(newSnippet[0].outerHTML).children('.component-content');
            $(component.RootElement).append(componentContent);

            //initialize components in the snippet
            CXAApplication.CreateComponentInstance($(component.RootElement).find("[data-cxa-component-class]"), true);
        }
    };

    /**
    * @function SnippetsRefreshBeginHandler - shows the loading indicator when the broker raises a refresh begin event
    * @param source - the source of the event
    * @param data - event data
    */
    component.SnippetsRefreshBeginHandler = function (source, data) {
        if(!component.IsDynamicContentEnabled || !component.ShowLoadingIndicator) {
            return;
        }

        //show loading indicator
        $(component.RootElement).find('.spinner-overlay').show();
    };

    /**
    * @function SnippetsRefreshBeginHandler - hides the loading indicator when the broker raises a refresh end event
    * @param source - the source of the event
    * @param data - event data
    */
    component.SnippetsRefreshEndHandler = function (source, data) {
        if(!component.IsDynamicContentEnabled || !component.ShowLoadingIndicator) {
            return;
        }

        //hide loading indicator
        $(component.RootElement).find('.spinner-overlay').hide();
    };

    /**
    * @function InExperienceEditorMode - overrides behavior when page is in experience editor mode
    */
    component.InExperienceEditorMode = function () {
        component.IsDynamicContentEnabled = false;
        component.Visual.Disable();
    };

    /**
    * @function StartListening - subscribe broker event handlers
    */
    component.StartListening = function () {
        component.SnippetsUpdatedHandlerId = CaleresRulesBasedSnippetsContext.SubscribeHandler(CaleresRulesBasedSnippetsContext.Events.SnippetsUpdated, component.SnippetsUpdatedHandler);
        component.SnippetsRefreshBeginHandlerId = CaleresRulesBasedSnippetsContext.SubscribeHandler(CaleresRulesBasedSnippetsContext.Events.SnippetsRefreshBegin, component.SnippetsRefreshBeginHandler);
        component.SnippetsRefreshEndHandlerId = CaleresRulesBasedSnippetsContext.SubscribeHandler(CaleresRulesBasedSnippetsContext.Events.SnippetsRefreshEnd, component.SnippetsRefreshEndHandler);
    };

    /**
    * @function StopListening - unsubscribe broker event handlers
    */
    component.StopListening = function () {
        if (component.ProductChangedHandlerId) {
            CaleresRulesBasedSnippetsContext.UnSubscribeHandler(component.SnippetsUpdatedHandlerId);
            CaleresRulesBasedSnippetsContext.UnSubscribeHandler(component.SnippetsRefreshBeginHandlerId);
            CaleresRulesBasedSnippetsContext.UnSubscribeHandler(component.SnippetsRefreshEndHandlerId);
        }
    };

    /**
    * @function Init - initializes the knockout view model and registers events
    */
    component.Init = function () {
        component.StartListening();
    };

    return component;
}));
//Create Certificate reusable component
ko.components.register("confirmation-modal", {
    template: '<div class="confirmation-modal" data-bind="visible: isVisible">' +
            '<div class="confirmation-modal__content">' +
                '<span class="icon-close confirmation-modal__close" data-bind="click: onCancel"></span>' +
                '<h3 class="confirmation-modal__heading" data-bind="text: heading"></h3>' +
                '<p class="confirmation-modal__description" data-bind="text: description"></p>' +
                '<button class="confirmation-modal__confirm" data-bind="click: onConfirm, text: confirmText"></button>' +
                '<a class="confirmation-modal__cancel" data-bind="click: onCancel, text: cancelText"></a>' +
            '</div>' +
        '</div>',
    viewModel: function(params) {
        var self = this;
        self.heading = ko.observable(params.heading ? params.heading : "");
        self.description = ko.observable(params.description  ? params.description : "");
        self.confirmText = ko.observable(params.confirmText ? params.confirmText : "Ok");
        self.cancelText = ko.observable(params.cancelText ? params.cancelText : "cancel");
        self.isVisible = params.isVisible ? params.isVisible : ko.observable(false);
        self.onConfirm = function(){
            params.onConfirm();
            self.hideModal();
        };
        self.onCancel = function(){
            if(params.onCancel){
                params.onCancel();
            }
            self.hideModal();
        }
        //self.currencySign = params.rewardCurrencyText;

        self.cancelDefault = function(){
            self.hideModal();
        }
        self.hideModal = function(){
            self.isVisible(false);
        }
       

    }
});
// Copyright 2017-2018 Sitecore Corporation A/S
// Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file
// except in compliance with the License. You may obtain a copy of the License at
//       http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software distributed under the
// License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
// either express or implied. See the License for the specific language governing permissions
// and limitations under the License.
// -------------------------------------------------------------------------------------------

(function (root, factory) {
  'use strict';
  if (typeof define === 'function' && define.amd) {
    // use AMD define funtion to support AMD modules if in use
    define(['exports'], factory);
  } else if (typeof exports === 'object') {
    // to support CommonJS
    factory(exports);
  }

  // browser global variable
  root.CaleresLanguageSelection = factory;
}(this, function (element) {
  'use strict';
  var component = new Component(element);
  component.Name = "CXA/Feature/CaleresLanguageSelection";

  component.SwitchLangauge = function (selected, current) {
    AjaxService.Post(
      "api/calcxa/calereslanguageselection/setcurrentlanguage",
      {},
      function (data, success, sender) {
        var currentLanguageUrlSegment = '/' + current;
        var selectedLanguageUrlSegment = '/' + selected;
        var url = new Uri(window.location.href);
        var urlPathSegments = url.path().replace('/', '')
          .split('/');
        var regex = new RegExp(currentLanguageUrlSegment, 'i');

        if (urlPathSegments[0].toLowerCase() === current.toLowerCase()) {
          var pathName = url.path().replace(regex, selectedLanguageUrlSegment);
          url.setPath(pathName);
        } else {
          url.setPath(selectedLanguageUrlSegment + url.path());
        }
        url.deleteQueryParam("sc_lang");
        window.location.href = url.toString();
      }
    );
  };

  component.Init = function () {
    $(component.RootElement).find(".language-item")
      .each(function () {
        var selected = $(this).data("itemLanguage");
        var current = $(this).data("currentLanguage");
        $(this).click(function () {
          component.SwitchLangauge(selected, current);
        });
      });

    component.Visual.Enable();
  };

  return component;
}));
$(document).ready(function () {
  let $component = $('.cxa-calereslanguageselection-component');
  let $availableLanguages = $component.find('.available-languages');
  let $languageIcon = $component.find('.component-content');
  let hoverTimeout;

  function showContent() {
    clearTimeout(hoverTimeout);
    $availableLanguages
      .stop()
      .fadeTo('fast', 1)
      .show();
  }

  function hideContent() {
    hoverTimeout = setTimeout(function () {
      $availableLanguages.fadeTo('slow', 0).hide();
    }, 200);
  }

  if (isMobile()) {
    let targetExitedBoundary = function (target) {
      const isLanguageIcon = $languageIcon.is($(target));
      const isLanguageIconDescendant = $component.toArray().some(function (component) {
        return $.contains(component, target);
      });
      return !(isLanguageIcon || isLanguageIconDescendant);
    };

    $(window)
      .off('touchend.languageSelector')
      .on('touchend.languageSelector', function (e) {
        if (targetExitedBoundary(e.target)) { 
          $availableLanguages.hide();
        }
      });

    var touchmoved;
    $languageIcon.off('touchend').on('touchend', function () {
    if(touchmoved != true){
      if ($availableLanguages.css('display') === 'none') {
        showContent();
      } else {
        hideContent();
      }
    } 
    }).on('touchmove', function(e){
      touchmoved = true;
    }).on('touchstart', function(){
      touchmoved = false;
    });
  } else {
    $languageIcon.hover(showContent, hideContent);
  }

  $availableLanguages.hide();
});
var Message = function (message, data) {
    return {
        message: message,
        data: data
    }
}

var CaleresMessageSummaryViewModel = function () {

    var self = this;

    self.isAnimating = false;
    self.successMessages = ko.observableArray();
    self.defaultMessages = ko.observableArray();
    self.errorMessages = ko.observableArray();
    self.infoMessages = ko.observableArray();
    self.warningMessages = ko.observableArray();

    self.showSuccess = ko.computed(function () { return self.successMessages().length > 0 });
    self.showDefault = ko.computed(function () { return self.defaultMessages().length > 0 });
    self.showError = ko.computed(function () { return self.errorMessages().length > 0 });
    self.showWarning = ko.computed(function () { return self.warningMessages().length > 0 });
    self.showInfo = ko.computed(function () { return self.infoMessages().length > 0 });

    self.showComponent = ko.computed(function () {
        bShow = (self.showError() || self.showWarning() || self.showInfo() || self.showSuccess() || self.showDefault());
        return bShow;
    })

    self.clear = function () {
        self.successMessages.removeAll();
        self.defaultMessages.removeAll();
        self.errorMessages.removeAll();
        self.infoMessages.removeAll();
        self.warningMessages.removeAll();
    };

    self.clearMessage = function(messages, index) {
        var messagesArray = messages();
        messagesArray.splice(index, 1);
        messages(messagesArray);
    };

    self.removeSuccessMessage = function(index) {
        self.clearMessage(self.successMessages, index);
    };

    self.removeDefaultMessage = function(index) {
        self.clearMessage(self.defaultMessages, index);
    };

    self.removeErrorMessage = function(index) {
        self.clearMessage(self.errorMessages, index);
    };

    self.removeInfoMessage = function(index) {
        self.clearMessage(self.infoMessages, index);
    };

    self.removeWarningMessage = function(index) {
        self.clearMessage(self.warningMessages, index);
    };

    /**
     * @function scrollToMessage - scroll to errors out of view at the top of the page
     * @return undefined
     */
    self.scrollToMessage = function() {
        if(self.isAnimating) {
            return;
        }

        self.isAnimating = true;
        var docElem = $("body, html");
        var scrollTime = 1000;
        if (window.innerWidth <= 767) { // For mobile add more scroll time
            scrollTime = 1500;
        }
        docElem.animate({ scrollTop: 0 }, scrollTime, "swing", function() {
            self.isAnimating = false;
        });
    }
};
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define('Caleres/Feature/MessageSummary', ['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);

    }
    // browser global variable
    root.CaleresMessageSummary = factory;

}(this, function (element, model) {
    'use strict';

    var component = new Component(element, model);
    component.Name = "Caleres/Feature/MessageSummary";
    component.InExperienceEditorMode = function () {
        model.defaultMessages.push(new Message("default: Lorem ipsum dolor sit amet, consectetur adipiscing.", null));
        model.successMessages.push(new Message("success: Lorem ipsum dolor sit amet, consectetur adipiscing.", null));
        model.errorMessages.push(new Message("error: Lorem ipsum dolor sit amet, consectetur adipiscing.", null));
        model.infoMessages.push(new Message("info: Lorem ipsum dolor sit amet, consectetur adipiscing.", null));
        model.warningMessages.push(new Message("warning: Lorem ipsum dolor sit amet, consectetur adipiscing.", null));
    }
    //Message Handlers
    component.SuccessMessageHandler = function (source, message, data) {
        message = message.split("Success: ")[1] || message;
        var item = new Message(message, data);
        if (item.message) {
            model.successMessages.push(item);
            model.scrollToMessage();
        }
    }

    component.DefaultMessageHandler = function (source, message, data) {
        message = message.split("Default: ")[1] || message;
        var item = new Message(message, data);
        if (item.message) {
            model.defaultMessages.push(item);
            model.scrollToMessage();
        }
    }

    component.ErrorMessageHandler = function (source, message, data) {
        message = message.split("Error: ")[1] || message;
        var item = new Message(message, data);
        if (item.message) {
            model.errorMessages.push(item);
            model.scrollToMessage();
        }
    }

    component.WarningMessageHandler = function (source, message, data) {
        message = message.split("Warning: ")[1] || message;
        var item = new Message(message, data);
        if (item.message) {
            model.warningMessages.push(item);
            model.scrollToMessage();
        }
    }

    component.InfoMessageHandler = function (source, message, data) {
        message = message.split("Info: ")[1] || message;
        var item = new Message(message, data);
        if (item.message) {
            model.infoMessages.push(item);
            model.scrollToMessage();
        }
    }

    component.CommandMessageHandler = function (source, command, data) {
        if (command == MessageContext.StandardCommands.ClearAll) {
            component.Model.clear();
        }
    }

    component.StartListening = function () {
        component.SuccessHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Success, component.SuccessMessageHandler);
        component.DefaultHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Default, component.DefaultMessageHandler);
        component.ErrorHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Error, component.ErrorMessageHandler);
        component.WarningHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Warning, component.WarningMessageHandler);
        component.InfoHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Info, component.InfoMessageHandler);
        component.CommandHandlerId = MessageContext.SubscribeMessageHandler(MessageContext.StandardChannels.Command, component.CommandMessageHandler);
    }
    component.StopListening = function () {
        if (component.ErrorHandlerId)
            MessageContext.UnSubscribeHandler(component.ErrorHandlerId);
        if (component.WarningHandlerId)
            MessageContext.UnSubscribeHandler(component.WarningHandlerId);
        if (component.InfoHandlerId)
            MessageContext.UnSubscribeHandler(component.InfoHandlerId);
        if (component.SuccessHandlerId)
            MessageContext.UnSubscribeHandler(component.SuccessHandlerId);
        if (component.DefaultHandlerId)
            MessageContext.UnSubscribeHandler(component.DefaultHandlerId);
    }

    component.Init = function () {
        component.StartListening();
    };

    return component;
}));
function OverlayLightboxModel(rootElement) {
    var self = this;
    var inXEMode = false;

    self.rootElement = rootElement;

    self.daysCount = ko.observable(''); //Days LB launches again
    self.secondsDelayed = ko.observable(); // Seconds after pageload that LB fires
    self.contentPath = ko.observable(); // Path to rendering to get loaded in
    self.lightboxData = ko.observable(); // Lightbox html content
    self.isVisible = ko.observable(false);

    self.initialize = function (daysCount, millisecondsCount, lightboxContent, inExperienceEditorMode) {

        if(inExperienceEditorMode){
            inXEMode = true;
        }

        // Set variables
        self.daysCount(daysCount);
        self.secondsDelayed(millisecondsCount);
        self.contentPath(lightboxContent);
        
        if(!inXEMode){
            self.fetchContent();
            if(!checkCookieSet('lightboxTriggered')){
                setTimeout(function(){
                    self.isVisible(true);
                    setLightboxCookie("lightboxTriggered", 1, self.daysCount());
                    if(window.data) {
                        window.data.event('overlay-lightbox-displayed', {
                            lightboxContent: lightboxContent
                        });
                    }
                }, self.secondsDelayed());
            }
        }
    };

    self.closeLightbox = function (){
        self.isVisible(false);
    }

    self.fetchContent = function () {
        try {
            AjaxService.Get(self.contentPath(),  {}, function (data, success, sender) {
                if(success){
                    self.lightboxData(data);

                    // Reapply styles after ajax has loaded
                    var units = $(data).data("percent") === "1" ? "%" : "px";
                    var width = $(data).data("width") + units;
                    var height = $(data).data("height") + units;
                    var styles = {
                        width: width !== "px" && width !== "%" ? width : "auto",
                        height: height !== "px" && height !== "%" ? height : "auto"
                    };

                    $(".overlay-data").css( styles );

                    //Rerun knockout binding for any incoming knockout powered renderings:
                    CXAApplication.CreateComponentInstance("[data-cxa-component-class]", true);
                }
            }) 
        }
        catch(e){
            console.log(e);
        }
    }

    function setLightboxCookie(name, val, days){
        var date, expires;
        if(days){
            date = new Date();
            date.setTime(date.getTime()+(days*24*60*60*1000));
            expires = "; expires="+date.toGMTString();
        } else {
            expires = "";
        }
        console.log("cookie set")
        document.cookie = name+"="+val+expires+"; path=/";
    }

    function checkCookieSet(cName){
        if(document.cookie.indexOf(cName) === -1){
            return false;
        } else {
            return true;
        }
    }
}
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    root.CaleresOverlayLightbox = factory;
    root.CaleresOverlayLightbox_ComponentClass = "overlay-source";

}(this, function (element) {
    'use strict';
    var component = new Component(element);
    component.Name = "Caleres/Feature/Overlay/CaleresOverlayLightbox";
    component.model = new OverlayLightboxModel(component.RootElement);

    component.InExperienceEditorMode = function () {
       
    }

    component.Init = function () {
        
        if ($(component.RootElement).length) {

            let daysCount = component.RootElement.getAttribute("data-days-count");
            let millisecondsCount = component.RootElement.getAttribute("data-millisecondsCount");
            let lightboxContent = component.RootElement.getAttribute("data-lightboxContent");
            let inExperienceEditorMode = CXAApplication.IsExperienceEditorMode() ;

            console.log(daysCount, millisecondsCount, lightboxContent); 
            // Start listening before component model is initialized
            // because there is an api call in the initialize method
            component.model.initialize(daysCount, millisecondsCount, lightboxContent, inExperienceEditorMode);
            ko.applyBindings(component.model, component.RootElement);
        }
    }
    return component;
}));
(function (root, $, factory) {
  factory($)
}(this, window.jQuery, function ($) {
  var parent = $('.quantity-input')
  if (parent.length > 0) {
    var increaseButton = parent.find('.increase')[0]
    var decreaseButton = parent.find('.decrease')[0]
    var quantityInput = parent.find('.add-to-cart-qty-input')[0]
    var max = parseInt($(quantityInput).attr('max'))
    var min = parseInt($(quantityInput).attr('min'))
    var currentValue = parseInt(quantityInput.value)

    $(quantityInput).on('change keyup paste keypress set input', function () {
      var currentValue = parseInt(quantityInput.value)
      $(increaseButton).removeAttr('disabled')
      $(decreaseButton).removeAttr('disabled')
      if (currentValue === max) {
        $(increaseButton).attr('disabled', 'disabled')
      }
      if (currentValue === min) {
        $(decreaseButton).attr('disabled', 'disabled')
      }
    });

    $(increaseButton).on('click', function (e) {
      e.preventDefault()
      var currentValue = parseInt(quantityInput.value)
      if (currentValue < max) {
        currentValue = currentValue + 1
        $(quantityInput).attr('value', currentValue)
        $(increaseButton).removeAttr('disabled')
        $(decreaseButton).removeAttr('disabled')
        if (currentValue === max) {
          $(increaseButton).attr('disabled', 'disabled')
        }
        if (currentValue === min) {
          $(decreaseButton).attr('disabled', 'disabled')
        }
      }
    });

    $(decreaseButton).on('click', function (e) {
      e.preventDefault()
      var currentValue = parseInt(quantityInput.value)
      if (currentValue > min) {
        currentValue = currentValue - 1
        $(quantityInput).attr('value', currentValue)
        $(increaseButton).removeAttr('disabled')
        $(decreaseButton).removeAttr('disabled')
        if (currentValue === max) {
          $(increaseButton).attr('disabled', 'disabled')
        }
        if (currentValue === min) {
          $(decreaseButton).attr('disabled', 'disabled')
        }
      }
    });
    $(document).ready(function () {
      $(increaseButton).removeAttr('disabled')
      $(decreaseButton).removeAttr('disabled')
      if (currentValue === max) {
        $(increaseButton).attr('disabled', 'disabled')
      }
      if (currentValue === min) {
        $(decreaseButton).attr('disabled', 'disabled')
      }
    })
  }
}));

jQuery(document).ready(function() {
    jQuery('.toggle-nav').click(function(e) {
        jQuery(this).toggleClass('active');
        jQuery('.category-navigation-list').toggleClass('active');
 
        e.preventDefault();
    });
});

$(document).ready(function () {
    (function loadFirstSlide() {
        var url = window.location.href.toString();
        var isIndexZero = url.includes('carousel=0');
        isIndexZero ? showFirstSlide() : false;
    })();

    function showFirstSlide() {
        setTimeout(function() {
            $('.slides').find('li').first().show();
        }, 1000);
    }
});
/** 
 * @function parseList - iterates over a list of items and performs a callback function
 * @param {Object} list - A list to be iterated over
 * @param {function} callback - A callback function performed on each item in list
 **/
function parseList(list, callback) {
    for (var i = 0; i < list.length; i++) {
        var item = list[i];
        callback(item);
    }
}

/**
* @function toggleClass - toggles a class on and off of an element
* @param {Object} el - the element object the class is toggled on
* @param {string} className - a class name in string format that is toggled on/off the element
**/
function toggleClass(el, className) {
    if (el.classList) {
        el.classList.toggle(className);
    } else {
        var classes = el.className.split(' ');
        var existingIndex = classes.indexOf(className);

        if (existingIndex >= 0) {
            classes.splice(existingIndex, 1);
        } else {
            classes.push(className);
        }
        el.className = classes.join(' ');
    }
}

/**
* @function resizeEvent - debounces resize event with a timeout delay for performance purposes
* @param {number} delay - a number (in ms) to delay running the resizeFunction after resize event
* @param {function} resizeFunction - a function to be run when the window is resized
**/
function resizeEvent(delay, resizeFunction) {
    // Setup a timer
    var timeout;

    // Listen for resize events
    window.addEventListener('resize', function ( event ) {

        // If timer is null, reset it and run your functions.
        // Otherwise, wait until timer is cleared
        if ( !timeout ) {
            timeout = setTimeout(function() {

                // Reset timeout
                timeout = null;

                // Run our resize functions
                resizeFunction();

            }, delay);
        }
    }, false);
}


$(document).ready(function () {
    var component = $('.cxa-languageselector-component');
    var availableLanguages = $(component).find('.available-languages');
    var languageIcon = $(component).find('.component-content');

    $(languageIcon).mousemove(function () {
        if (!isMobile()) {
            show();
        }
    });

    $(languageIcon).mouseleave(function () {
        hide();
    });

    $(languageIcon).click(function () {
        if ($(availableLanguages).css('display') === 'none') {
            show();
        } else {
            hide();
        }
    });

    function show() {
        availableLanguages.fadeTo("fast", 1);
        availableLanguages.show();
    }

    function hide() {
        availableLanguages.fadeTo("fast", 0);
        availableLanguages.hide();
    }
});
(function() {

    //Bind Mega Menu lazy images to load only on hover
    //`lazy-src` must be present on the image
    var tabs = $('.megamenu-tabs__list').find("li");
    tabs.on("mouseenter", function() {
        if (!$(this).hasClass("caleres-mm-images-loaded")) {
            $(this).addClass("caleres-mm-images-loaded").find("img[lazy-src]").each(function () {
                var src = $(this).attr("lazy-src");
                $(this).removeAttr("lazy-src").attr("src", src);
            });
        }
    });


    if (!$('body').hasClass("product-listing-page")) { //PLPs already have lazy loading

        var contentPromoImages = $('main').find('.promo').find("img[lazy-src]");

        function throttle(fn, wait) {
            var time = Date.now();
            return function () {
                if ((time + wait - Date.now()) < 0) {
                    fn();
                    time = Date.now();
                }
            }
        }

        var scrollCallback = throttle(function (e) {
            var winPos = $(window).scrollTop() + window.innerHeight + 100;
            // Store and remove the lazy-src attrbute, use as src
            contentPromoImages.each(function () {
                if ($(this).offset().top <= winPos && $(this)[0].hasAttribute("lazy-src")) {
                    var src = $(this).attr("lazy-src");
                    $(this).removeAttr("lazy-src").attr("src", src);
                }
            });
        }, 200);

        window.addEventListener('scroll', scrollCallback, {passive: true});
    }


}());
/**
 * @description add, remove, toggle dropdown-active class
 *              capable on desktop and mobile
 */
$(document).ready(function() {
    $(".link-list--dropdown").on("mouseenter", function(event) {
        $(this).addClass("dropdown-active");
    });
    
    $(".link-list--dropdown").on("mouseleave", function(event) {
        $(this).removeClass("dropdown-active");
    });
    
    $(".link-list--dropdown").on("touchstart", function(event) {
        if(!$(event.target).is("li")){
            $(this).toggleClass("dropdown-active");
        }
    });
});
/**
 * @description Behavior specific for mega menu rendering
 *         
 */
$(document).ready(function() {

    var $body = $('body');
    var $megaMenu = $('.megamenu');
    var $megaMenuToggle = $('.js-megamenu-toggle');

    var getHeaderHeight = function() {    
        if ($('#header').find('.ps-header--sticky-medium').is(':visible')) {
            var headerHeight = document.querySelector('.ps-header--sticky-medium').offsetHeight;
        } else if ($('#header').find('.ps-header--sticky-low').is(':visible')) {
            var headerHeight = document.querySelector('.ps-header--sticky-low').offsetHeight;
        } else {
            var headerHeight = document.getElementById('header').offsetHeight;
        }

        return headerHeight;
    }

    /**
    * @function positionMegaMenu - sets the top position of .megamenu-tabs equal to the height of #header element
    *
    **/
    var positionMegaMenu = function() {
        var megaMenuTabs = document.querySelectorAll('.megamenu-tabs');
        var headerHeight = getHeaderHeight();

        window.parseList(megaMenuTabs, function(megaMenuTab) {
            megaMenuTab.style.top = headerHeight + 'px';
        });    
    }

    /**
     * @function setOverlayHeight - dynamically position the top value for .megamenu-overlay based on header height 
     */
    var setOverlayHeight = function() {
        
        var headerHeight = getHeaderHeight();
        var megaMenuOverlays = document.querySelectorAll('.megamenu-overlay');
		megaMenuOverlays.forEach(function(overlay) {
		    overlay.style.top = headerHeight + 'px';
			overlay.classList.add('megamenu-overlay--show');
		});
    }

    /**
     * @function setMegamenuContainerHeight - dynamically position the top value for .megamenu-container elements based on header height
     */
    var setMegamenuContainerHeight = function() {
        var headerHeight = getHeaderHeight();
        var containerElements = document.querySelectorAll('.megamenu-container');
        for(var i = 0; i < containerElements.length; i++) {
            containerElements[i].style.top = headerHeight + "px";
        }
    }

    /**
     * @function removeOpenClasses - removes any open classes that may cause undesired behavior when screen size changes
     */
    var removeOpenClasses = function() {
        $body.removeClass('megamenu-is-open');
        $('.megamenu-heading').parent().removeClass('tab-is-open');
        $('.megamenu-container').removeAttr('style');
    }    

    /**
     * @function addEmptyContentClasses - finds any tabs without content and adds a class for styling purposes
     */
    var addEmptyContentClasses = function() {
        $('.megamenu-container').each(function() {
            var $this = $(this);
            var megaMenuInnerText = $this.find('.megamenu-inner-container > div').text().trim();
            // If there is no text present, only empty child nodes, assume it's empty 
            if (megaMenuInnerText.length === 0) {
                $this.parent().addClass('content-is-empty');
            }
        });
    }

    /**
     * @function applyFlexOrderClasses - inspect each ".megamenu-heading .component.content" element for any classes starting with "order-" (these are applied by content author). copy each flex order class to the closest li element to rearrange tab flex order.
     */
    var applyFlexOrderClasses = function() {
        $('.megamenu-heading .component.content').each(function() {
            var $this = $(this);
            var classList = this.className.split(/\s+/);
            classList.filter(function(item) {
                return item.includes('order-');
            }).map(function(item) {
                $this.closest('li').addClass(item);
            });
        });
    }

    /**
     * @function setupMegaMenu - sets up the mega menu for mobile or desktop functionality
     */
    var setupMegaMenu = function() {
        if ($megaMenuToggle.is(':visible')) {
            $megaMenu.addClass('js-mobile-megamenu');
            positionMegaMenu();
            // Remove static positioning on mobile/tablet
            $megaMenu.parents('[class*="col-"]').removeClass('megamenu-parent--static');
        } else {
            $megaMenu.removeClass('js-mobile-megamenu');
            removeOpenClasses();
            setOverlayHeight();
            // HOTFIX: clean up later
            // Only run this for Naturalizer
            try {
                if (window.data && (window.data.get("page.attributes.webstoreId") == "90051")) {
                    setMegamenuContainerHeight();
                }
            } catch (err) {
                console.log(err);
            }

            // Travel up the DOM tree and find any parent .col-* classes. Apply position:static; to any that are found. This allows .megamenu-container to span full width when open
            $megaMenu.parents('[class*="col-"]').addClass('megamenu-parent--static');
        }
        // This should run on desktop and mobile to identify empty MM tabs (i.e. <li> tabs containing links)
        addEmptyContentClasses();
        applyFlexOrderClasses();
    }

    /**
     * @function closeSearchBoxFromMegaMenu - If the searchbox is open when mega menu is invoked, close the search box (mimics 'closeSearchbox' function in 'coveo-searchbox.ts')
     */
    function closeSearchBoxFromMegaMenu() {
        var searchboxToggle = $('.js-searchbox-toggle');
        if ($body.hasClass('megamenu-is-open') && searchboxToggle.hasClass('searchbox-is-open')) {
            searchboxToggle.removeClass('searchbox-is-open');
            $('.container--searchbox-will-toggle').removeClass('searchbox-is-open');
            $('.searchbox__overlay').remove();
            // IMPORTANT: The code below fixes the iOS Safari bug where the Search and MM icons do not render (disappear) when the above action is taken. Removes and re-inserts '.icon-search' HTML
            var iconSearch = $('.icon-search');
            var iconSearchParent = iconSearch.parent();
            var iconSearchHTML = iconSearchParent.html();
            iconSearch.remove();
            iconSearchParent.append(iconSearchHTML);            
        }
    }

    // mega menu bindings (tablet/mobile only) 
    $body.on('click', '.js-megamenu-toggle', function(e) {
        e.preventDefault();
        // toggle megamenu-is-open class
        $body.toggleClass('megamenu-is-open');
        closeSearchBoxFromMegaMenu();
    });

    $body.on('click', '.js-mobile-megamenu .megamenu-heading', function(e) {
        var $this = $(this);

        // Only do the toggling if the parent <li> is not empty  
        if (!$this.parent().hasClass('content-is-empty')) {
            // Cancel default event, such as if a link is present  
            e.preventDefault();

            // toggle dynamic-bottom-border class, immediately on expand, delay on collapse to match slideToggle below
            if ($this.parent().hasClass('dynamic-bottom-border')) {
                setTimeout(function() {
                    $this.parent().removeClass('dynamic-bottom-border');
                }, 600); // Timing should match slideToggle 'slow' below
            } else {
                $this.parent().addClass('dynamic-bottom-border');
            }

            // toggle slide open/close
            $this.siblings('.megamenu-container').slideToggle('slow', function() {
                // toggle tab-is-open class
                $this.parent().toggleClass('tab-is-open');
    
                // define offsets after the slideToggle animation completes
                var thisOffset = $this.offset().top;
                var parentOffset = $this.parents('.megamenu-tabs__list').offset().top;
    
                // animate scroll top of scrollable element to top of header that's opened (subtract parentOffset to take into account any scrolling that has occured)
                $this.parents('.megamenu-tabs').animate({
                    scrollTop: thisOffset - parentOffset
                }, 500);
            });
        }

    });

    //Update height when entering tab in case more content has changed the size of the header and add classes to display megamenu and overlay
    var megaMenuOpenTimer;
    $(".megamenu-tabs__list").on("mouseenter", function() {
        megaMenuOpenTimer = setTimeout(function(){
            $(".megamenu-container").addClass('hover-safe')
            $(".megamenu-overlay").addClass('show-overlay')
            setOverlayHeight();
        }, 150);
    }).mouseleave(function(){
            $(".megamenu-container").removeClass('hover-safe')
            $(".megamenu-overlay").removeClass('show-overlay')
            clearTimeout(megaMenuOpenTimer);
    });

    // check if a mega menu is on the page
    if ($megaMenu.length > 0) {
        // initialize mega menu set up and kicks it off again when screen size has changed
        setupMegaMenu();
        window.resizeEvent(250, setupMegaMenu);
    }
});



/**
 * @description Overrides the window.open function 
 *              and throws custom 'popupopened' event 
 *              with the created window object
 */
(function (root, factory) {
  factory()
}(window, function () {
  var windowOpenOriginal = window.open
	window.open = function() {
		var win = windowOpenOriginal.apply(this, arguments);
		var details = {
			caller: this,
			popup: win
		};
		document.dispatchEvent(new CustomEvent('popupopened', { detail: details } ));
		
		return win;
	};
}));

$(function(){
    var categoryFacet = $('.cxa-productfacets-component');
    categoryFacet.find(".facet-title").click(
        function(){
            var clicks = $(this).data('clicks');
            var $obj = $(this);
            var $list = $obj.next().filter("div[class$=-list]");
            if (!clicks)
            {
                $list.fadeTo("fast", 0);
                $list.hide();
                $(this).data('clicks',1);
            }
            else{
                $list.show();
                $list.fadeTo("fast", 1);
                $(this).removeData();
            }
        }
    );    
});
$(function(){
    var list = $('.product-images li');
    list.first().addClass('active');

    list.click(function(e){
        $('.product-images li').removeClass('active');
        e.preventDefault();
        $(this).addClass('active');
        
        if(list.length > 1){
            var imageSrc = $(this).find('a').attr('href');
            var isCreativeExchangeVersion = (getCurrentPageExtension() === 'html');

            if(isCreativeExchangeVersion){
                var linkChunks = imageSrc.split('/');
                var imageNameWithPrefix = linkChunks.pop().split('.')[0];
                if(imageNameWithPrefix){
                    var imageNameParts = imageNameWithPrefix.split('-');
                    if(imageNameParts.length >=2){
                        var imageName = imageNameWithPrefix.split('-')[0];
                        imageSrc = imageSrc.replace(imageNameWithPrefix,imageName);
                    }
                }
            }

            $(".product-image").find("img").attr('src', imageSrc);
        }
        
        function getCurrentPageExtension() {
            var pageExtensiponWithQueryString = window.location.href.split(".").pop();
            if (pageExtensiponWithQueryString && pageExtensiponWithQueryString.length >= 4) {
                var pageExtension = pageExtensiponWithQueryString.substr(0, 4);
                return pageExtension;
            }
            return "";
        }
    });
});

/**
 * @description Behavior specific for Product Images Rendering
 *         
 */
$(function() {
    // For the Default Rendering Variant, calls MagicZoom.zoomOut API method to close zoomed image on desktop when user mouses off main image
    $('#product-image--main').on('mouseout', function() {
        MagicZoom.zoomOut('product-image--main');
    });
});

// MagicZoom Callbacks. IMPORTANT: Must be placed outside of a document.ready() or 'DOMContentLoaded' handler 
var mzOptions = {};
var mzMobileOptions = {};
mzOptions = {
    onExpandClose: function() {
        // Hides customized half-size zoom modal background on tablet when closed 
        document.querySelector(".mz-bg--tablet").style.display = "none";
    }
};

if ($("html").attr("lang") === "fr-CA") {
    mzMobileOptions = {
        textClickZoomHint: "Double pression pour zoomer",
        textExpandHint: "Cliquez pour agrandir"
    };
}
$(document).ready(function () {
    var searchForm = $('#SearchForm');
    var toggleSearch = $('.toggle-search-bar');

    $(toggleSearch).mouseleave(function (e) {
        hideSearchForm(e);
    });

    $(searchForm).mouseleave(function (e) {
        hideSearchForm(e);
    });

    function hideSearchForm(target) {
        var eleClassName = target.relatedTarget.className;

        if (eleClassName != 'search-textbox') {
            $(searchForm).removeClass('active');
        } else {
            target.preventDefault();
        }
    }

    $(toggleSearch).click(function (e) {
        $(searchForm).toggleClass('active');
    });

    $(searchForm).find(':submit').click(function (event) {
        event.preventDefault();
        $(this).attr('disabled', 'disabled');
        $(searchForm).submit();
    });
});
/*
$(function(){
    var categoryNav = $('.component.cxa-subcategorynavigation-component');
    var categoryNavList = categoryNav.find("ul");

    categoryNav.find(".subcategories-title").click(
        function(){
            var clicks = $(this).data('clicks');
            if(!clicks)
            {
                categoryNavList.fadeTo("fast", 0);
                categoryNavList.hide();
                $(this).data('clicks',1);
            }
            else{
                categoryNavList.show();
                categoryNavList.fadeTo("fast", 1);
                $(this).removeData();
            }
        }
    );
});
*/
/*
$(document).ready(function () {
    var toolbar = $('.cxa-topbarlinks-component')
    var toolbarItems = $(toolbar).find('ul');
    var toolbarContent = $(toolbar).find('.component-content');

    $(toolbarContent).mousemove(function () {
        if (!isMobile()) {
            show();
        }
    });

    $(toolbarContent).mouseleave(function () {
        hide();
    });

    $(toolbarContent).click(function () {
        if ($(toolbarItems).css('display') === 'none') {
            show();
        } else {
            hide();
        }
    });

    function show() {
        $(toolbarItems).fadeTo('fast', 1);
        $(toolbarItems).show();
    }

    function hide() {
        $(toolbarItems).fadeTo('fast', 0);
        $(toolbarItems).hide();
    }
});
*/
/**
 * @description enables the bootstrap tooltip
 *              capable on desktop and mobile
 */
$(document).ready(function() {
    $('[data-toggle="tooltip"]').tooltip();
});
/**
 * @description Initializes tracking around products
 */
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    var caleresCartTracking = {};

    // browser global variable
    root.CaleresCartTracking = caleresCartTracking;
    factory(caleresCartTracking);
}(this, function (cartTracking) {
    'use strict';

    cartTracking.oldCart = {};
    cartTracking.currentCart = {};

    cartTracking.UpdateCart = function (cart) {
        if (!cart) {
            return;
        }

        try {
            cartTracking.currentCart = cart;
            cartTracking.UpdateDataLayer(cart);
        } catch (err) {
            console.log('Error occurred when attempting to set the cart Data Layer: ', err);
        }
        
    };

    cartTracking.CartUpdatedHandler = function () {
        console.log("Cart Updated");
    };

    cartTracking.StartListening = function () {
        cartTracking.CartUpdatedHandlerId = CartContext.SubscribeHandler(CartContext.CartEvents.CartUpdate, cartTracking.CartUpdatedHandler);
    };

    cartTracking.StopListening = function () {
        if (cartTracking.CartUpdatedHandlerId) {
            CaleresProductImagesContext.UnSubscribeHandler(cartTracking.CartUpdatedHandler);
        }
    };

    cartTracking.UpdateDataLayer = function (cart) {
        if (!cart || !window.data) {
            return;
        }
        var dataLayer = window.data;
        cartTracking.oldCart = dataLayer.get('cart') || {};
        dataLayer.clearVar('cart');

        dataLayer.set('cart.cartID', cart.FriendlyId);
        dataLayer.set('cart.price.basePrice', cart.SubtotalAmount);
        dataLayer.set('cart.price.currency', cart.CurrencyCode);
        dataLayer.set('cart.price.shipping', cart.ShippingTotalAmount);
        dataLayer.set('cart.price.priceWithTax', cart.TotalAmount);
        dataLayer.set('cart.price.cartTotal', cart.TotalAmount);
        dataLayer.set('cart.price.taxRate', cart.TaxTotalAmount);
        dataLayer.set('cart.price.voucherDiscount', cart.DiscountPercent);
        dataLayer.set('cart.price.voucherCode', cart.AllPromoCodes ? cart.AllPromoCodes.join(';') : '');
        dataLayer.set('cart.price.voucherName', cart.AllPromoNames ? cart.AllPromoNames.join(';') : '');
        dataLayer.set('cart.attributes.voucherAmount', cart.DiscountAmount);
        dataLayer.set('cart.attributes.voucherType', cart.PromotionType.toLowerCase());
        dataLayer.set('cart.attributes.voucherApplied', cart.PromotionApplied);

        var pageType = dataLayer.get('page.category.pageType');
        if (pageType.toLowerCase() != 'cart')
        {
            dataLayer.set('checkout.attributes.checkoutType', cartTracking.getCheckoutType());
        }

        cartTracking.SetShippingMethod(cart);

        for (var i = 0; i < cart.Lines.length; i++) {
            var cartLine = cart.Lines[i];
            var oldCartItemAccessor = 'item[' + i + ']';
            var oldCartLine = cartTracking.oldCart[oldCartItemAccessor] || {};

            dataLayer.set('cart.item[' + i + '].productInfo.productID', cartLine.StyleNumber);
            dataLayer.set('cart.item[' + i + '].productInfo.productName', cartLine.DisplayName ? cartLine.DisplayName.toLowerCase() : '');
            dataLayer.set('cart.item[' + i + '].productInfo.manufacturer', cartLine.Brand ? cartLine.Brand.toLowerCase() : '');
            dataLayer.set('cart.item[' + i + '].productInfo.sku', cartLine.Upc);
            dataLayer.set('cart.item[' + i + '].productInfo.color', cartLine.PrimaryColor);
            dataLayer.set('cart.item[' + i + '].productInfo.size', cartLine.Size);
            dataLayer.set('cart.item[' + i + '].productInfo.width', cartLine.WidthDescription ? cartLine.WidthDescription.toLowerCase() : '');
            dataLayer.set('cart.item[' + i + '].quantity', Number(cartLine.Quantity));
            dataLayer.set('cart.item[' + i + '].price.voucherDiscount', cartLine.LineDiscountPercent);
            dataLayer.set('cart.item[' + i + '].price.voucherName', cartLine.AllPromoNames ? cartLine.AllPromoNames.join(';').toLowerCase() : '');
            dataLayer.set('cart.item[' + i + '].price.voucherCode', cartLine.AllPromoCodes ? cartLine.AllPromoCodes.join(';').toLowerCase() : '');
            dataLayer.set('cart.item[' + i + '].attributes.voucherType', cartLine.PromotionType ? cartLine.PromotionType.toLowerCase() : '');
            dataLayer.set('cart.item[' + i + '].attributes.voucherApplied', cartLine.PromotionApplied);
            dataLayer.set('cart.item[' + i + '].attributes.voucherAmount', cartLine.LineDiscountAmount);
            dataLayer.set('cart.item[' + i + '].attributes.productGroup', cartLine.ProductGroupId);
            dataLayer.set('cart.item[' + i + '].attributes.outOfStock', cartLine.IsOutOfStock);
            dataLayer.set('cart.item[' + i + '].attributes.lowStock', cartLine.HasLowInventory);
            dataLayer.set('cart.item[' + i + '].attributes.newArrival', cartLine.IsNewArrival);
            dataLayer.set('cart.item[' + i + '].attributes.onSale', cartLine.IsOnSale);
            dataLayer.set('cart.item[' + i + '].attributes.onlineOnly', cartLine.IsOnlineOnly);
            dataLayer.set('cart.item[' + i + '].attributes.clearance', cartLine.IsClearance);
            dataLayer.set('cart.item[' + i + '].attributes.isBOPISEligible', cartLine.IsStorePickupEligible);
            dataLayer.set('cart.item[' + i + '].category.isPromoExcluded', cartLine.IsPromoExcluded);
            dataLayer.set('cart.item[' + i + '].attributes.preOrder', cartLine.IsPreorder);
            dataLayer.set('cart.item[' + i + '].attributes.backOrder', cartLine.IsBackorder);
            dataLayer.set('cart.item[' + i + '].attributes.isFinalSale', cartLine.IsFinalSale);

            if(!cartLine.WebGender) {
                dataLayer.set('cart.item[' + i + '].category.primaryCategory', cartLine.TypeOfGood ? cartLine.TypeOfGood.toLowerCase() : '');
                dataLayer.set('cart.item[' + i + '].category.subCategory1', cartLine.WebDepartment ? cartLine.WebDepartment.toLowerCase() : '');
            }
            else {
                dataLayer.set('cart.item[' + i + '].category.primaryCategory', cartLine.WebDepartment.toLowerCase());
                dataLayer.set('cart.item[' + i + '].category.subCategory1', cartLine.WebGender.toLowerCase());
            }
            dataLayer.set('cart.item[' + i + '].category.subCategory2', cartLine.SecondaryCategory);
            dataLayer.set('cart.item[' + i + '].category.subCategory3', cartLine.TertiaryCategory);
            dataLayer.set('cart.item[' + i + '].price.basePrice', cartLine.TotalLinePriceAmount);
            dataLayer.set('cart.item[' + i + '].price.currency', cartLine.CurrencyCode);
            dataLayer.set('cart.item[' + i + '].price.taxRate', cartLine.TaxTotalAmount);
            dataLayer.set('cart.item[' + i + '].price.priceWithTax', cartLine.LineTotalWithTaxAmount);

            if(cartLine.IsEGiftCard){
                dataLayer.set('cart.item[' + i + '].price.shippingMethod','printandemail');
            }
            else if(cartLine.IsStorePickup){
                dataLayer.set('cart.item[' + i + '].price.shippingMethod','StorePickup');
                dataLayer.set('cart.item[' + i + '].attributes.bopisAltPickup', cart.StorePickupData && cart.StorePickupData.StorePickup ? cart.StorePickupData.StorePickup.HasSecondaryPerson : false);
            }
            else{
                var cartShippingMethod = dataLayer.get('cart.price.shippingMethod');
                if(cartShippingMethod){
                    dataLayer.set('cart.item[' + i + '].price.shippingMethod', cartShippingMethod);
                }
                else{
                    dataLayer.set('cart.item[' + i + '].price.shippingMethod', cartLine.ShippingMethodName ? cartShippingMethod.ShippingMethodName : '');
                }
                dataLayer.set('cart.item[' + i + '].attributes.bopisAltPickup', false);
            }

            dataLayer.set('cart.item[' + i + '].price.shipping', cartLine.ShippingAmount);

            if (!oldCartLine.attributes || !oldCartLine.attributes.cartAddMethod) {
                dataLayer.set('cart.item[' + i + '].attributes.cartAddMethod', "productdetail");
            }
        }

        // compare cartTracking.oldCart to dataLayer.get('cart')
        // if quantities are different then determine if add or remove

        var differences = window.deepDiffMapper.map(cartTracking.oldCart, dataLayer.get('cart'));

        var differencesKeys = Object.keys(differences);
        var itemKeys = differencesKeys.filter(function (key) {
            // regex: find similar strings to "item[1]"
            var regex = /item\[.*\]/gm;
            return regex.exec(key);
        });

        // determine if we raise the add or remove event
        for (var i = 0; i < itemKeys.length; i++) {
            var itemKey = itemKeys[i];
            if (differences[itemKey]) {

                var itemNumber = cartTracking.getItemNumber(itemKey);
                var oldCartItemAccessor = 'item[' + itemNumber + ']';
                var oldCartLine = cartTracking.oldCart[oldCartItemAccessor] || null;

                if (!oldCartLine) {
                    continue;
                }
                
                var cartLineItem = dataLayer.get('cart.item[' + itemNumber + ']');
                var itemOldQuantity = Number(oldCartLine.quantity);
                var itemNewQuantity = 0;

                if (cartLineItem) {
                    itemNewQuantity = Number(cartLineItem.quantity);
                }

                if (differences[itemKey].quantity && cartLineItem) {
                    if (differences[itemKey].quantity.type == 'updated') {

                        if (
                            oldCartLine.productInfo.sku == cartLineItem.productInfo.sku &&
                            itemOldQuantity > itemNewQuantity
                        ) {

                            // Raise cartRemove event

                            try {
                                var analyticsCartRemoveObject = {
                                    cart: cart,
                                    productID: cartLineItem.productInfo.productID,
                                    productName: cartLineItem.productInfo.productName,
                                    size: cartLineItem.productInfo.size,
                                    width: cartLineItem.productInfo.width,
                                    color: cartLineItem.productInfo.color,
                                    manufacturer: cartLineItem.productInfo.manufacturer,
                                    quantity: cartLineItem.quantity,
                                    price: cartLineItem.price.basePrice,
                                    cartID: dataLayer.get('cart.cartID'),
                                    oldQuantity: itemOldQuantity,
                                    newQuantity: itemNewQuantity,
                                    primaryCategory: cartLineItem.category.primaryCategory,
                                    subCategory1: cartLineItem.category.subCategory1,
                                    subCategory2: cartLineItem.category.subCategory2,
                                    subCategory3: cartLineItem.category.subCategory3,
                                    sku: cartLineItem.productInfo.sku
                                };

                                dataLayer.event('cartRemove', analyticsCartRemoveObject);

                            } catch (err) {
                                console.log('Error occurred when attempting to raise cartRemove event: ', err);
                            }

                        } else if (
                            oldCartLine.productInfo.sku == cartLineItem.productInfo.sku &&
                            itemOldQuantity < itemNewQuantity && !($('body').hasClass('product-details-page'))
                        ) {

                            // Raise cartAdd event

                            try {
                                var currentCartLine = cart.Lines.filter(function(line) {
                                    return line.StyleNumber == cartLineItem.productInfo.productID;
                                });

                                // pull Map pricing status from cart since it's not available
                                // for line items in the dataLayer
                                var seePriceInCart = currentCartLine[0].IsMapPolicyCart;

                                var analyticsCartAddObject = {
                                    cart: cart,
                                    cartAddMethod: 'Cart Page',
                                    productID: cartLineItem.productInfo.productID,
                                    productStatus: cartLineItem.productInfo.productStatus,
                                    productName: cartLineItem.productInfo.productName,
                                    size: cartLineItem.productInfo.size,
                                    width: cartLineItem.productInfo.width,
                                    color: cartLineItem.productInfo.color,
                                    manufacturer: cartLineItem.productInfo.manufacturer,
                                    quantity: cartLineItem.quantity,
                                    price: cartLineItem.price.basePrice,
                                    seePriceInCart: seePriceInCart,
                                    isNewCart: 'false',
                                    isPromoExcluded: cartLineItem.attributes.isPromoExcluded,
                                    cartID: dataLayer.get('cart.cartID'),
                                    oldQuantity: itemOldQuantity,
                                    newQuantity: itemNewQuantity,
                                    primaryCategory: cartLineItem.category.primaryCategory,
                                    subCategory1: cartLineItem.category.subCategory1,
                                    subCategory2: cartLineItem.category.subCategory2,
                                    subCategory3: cartLineItem.category.subCategory3,
                                    sku: cartLineItem.productInfo.sku
                                };

                                dataLayer.event('cartAdd', analyticsCartAddObject);

                            } catch (err) {
                                console.log('Error occurred when attempting to raise cartAdd event: ', err);
                            }

                        }

                    }
                } else if (differences[itemKey].type == 'deleted') {

                    // Raise cartRemove event

                    try {
                        var analyticsCartRemoveObject = {
                            cart: cart,
                            productID: oldCartLine.productInfo.productID,
                            productName: oldCartLine.productInfo.productName,
                            size: oldCartLine.productInfo.size,
                            width: oldCartLine.productInfo.width,
                            color: oldCartLine.productInfo.color,
                            manufacturer: oldCartLine.productInfo.manufacturer,
                            quantity: oldCartLine.quantity,
                            price: oldCartLine.price.basePrice,
                            cartID: dataLayer.get('cart.cartID'),
                            oldQuantity: itemOldQuantity,
                            newQuantity: 0,
                            primaryCategory: oldCartLine.category.primaryCategory,
                            subCategory1: oldCartLine.category.subCategory1,
                            subCategory2: oldCartLine.category.subCategory2,
                            subCategory3: oldCartLine.category.subCategory3,
                            sku: oldCartLine.productInfo.sku
                        };

                        dataLayer.event('cartRemove', analyticsCartRemoveObject);

                    } catch (err) {
                        console.log('Error occurred when attempting to raise cartRemove event: ', err);
                    }

                }
            }
        };

        // analytics
        // send cart view events
        try {

            // only initialize this once per page load
            window.ANALYTICS_cartLoaded = window.ANALYTICS_cartLoaded || false;

            if (!window.ANALYTICS_cartLoaded) {

                var $cartLineComponent = $('.caleres-shoppingcartlines-component');
                var $deliveryComponent = $('.caleres-checkoutdelivery-component');
                var $billingComponent = $('.caleres-checkoutbilling-component');
                var $overviewComponent = $('.caleres-checkoutconfirm-component');

                if ($cartLineComponent.length && !$overviewComponent.length) {
                    // cart page
                    dataLayer.event('cartView');
                } else if ($deliveryComponent.length) {
                    // delivery page
                    dataLayer.event('cartViewShipping');
                } else if ($billingComponent.length) {
                    // billing page
                    dataLayer.event('cartViewBilling');
                } else if ($overviewComponent.length) {
                    // overview page
                    dataLayer.event('cartViewOverview');
                }

                window.ANALYTICS_cartLoaded = true;

            }

        } catch (err) {
            console.log('Error raising analytics event: ', err);
        }
    };

    cartTracking.SetShippingMethod = function (cart) {
        var dataLayer = window.data;

        if (!cart.Shipments || cart.Shipments.length == 0) {
            dataLayer.set('cart.price.shippingMethod', '');
            return;
        };

        var shipment = cart.Shipments[0];
        var parties = cart.Parties;

        dataLayer.set('cart.price.shippingMethod', shipment.ShippingMethodName);
        var shippingParty = parties.find(function (party) {
            return party.ExternalId == shipment.PartyID;
        });

        if (shippingParty) {
            dataLayer.set('cart.attributes.zip', shippingParty.ZipPostalCode);
        }
    };

    cartTracking.getItemNumber = function (itemKey) {
        var regex = /item\[(.*)\]/gm;
        var m;
        var itemNumber = null;

        while ((m = regex.exec(itemKey)) !== null) {
            // This is necessary to avoid infinite loops with zero-width matches
            if (m.index === regex.lastIndex) {
                regex.lastIndex++;
            }

            // The result can be accessed through the `m`-variable.
            m.forEach(function (match, groupIndex) {
                if (groupIndex == 1) {
                    itemNumber = match;
                }
            });

        }

        return itemNumber;

    };

    cartTracking.setCheckoutType = function (checkoutType) {
        sessionStorage.setItem("CheckoutType", checkoutType);
    };

    cartTracking.getCheckoutType = function () {
        var checkoutType = sessionStorage.getItem("CheckoutType");
        if (checkoutType) {
            return checkoutType;
        }

        return "Standard";
    };

    cartTracking.Init = function () {
        cartTracking.StartListening();
    };

    cartTracking.setCartAddMethod = function (method, lineItem) {
        var dataLayer = window.data;
        dataLayer.set('cart.item[' + lineItem + '].attributes.cartAddMethod', method);
    };
}));

CaleresCartTracking.Init();
/**
 * @description Initializes tracking around products
 */
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    var CaleresProductTracking = {};

    // browser global variable
    root.CaleresProductTracking = CaleresProductTracking;
    factory(CaleresProductTracking);
}(this, function (productTracking) {
    'use strict';
    productTracking.ProductGroupId = "";
    productTracking.ProductId = "";
    productTracking.VariantId = "";
    productTracking.FindingMethods = {
        Browse: 'browse',
        OnsiteSearch: 'onsitesearch',
        InternalCampaign: 'internalcampaigns',
        ExternalCampaign: 'externalcampaigns',
        CrossSell: 'crosssell'
    };

    productTracking.ProductImagesSetImagesHandler = function (source, productImages, data) {
        console.log("Product Images Changed");
        productTracking.imageTracking(productImages);
    };

    productTracking.ProductSelectionChangedHandler = function (source, catalogName, productId, variantId, data) {
        var setVariantDataFromStorage = true;
        
        if(!data || !window.data) {
            return;
        }

        if(variantId && variantId != productTracking.VariantId) {
            productTracking.SetVariantData(data.selectedVariant);
            setVariantDataFromStorage = false;
        }

        if(productTracking.ProductId === productId || !data.selectedProduct) {
            return;
        }

        var product = data.selectedProduct;
        var dataLayer = window.data;
        productTracking.ProductGroupId = product.fullProductGroupId;
        productTracking.ProductId = productId;

        dataLayer.set('product.productInfo.productID', product.itemNumber);
        dataLayer.set('product.productInfo.productName', product.productName.toLowerCase());
        dataLayer.set('product.productInfo.manufacturer', product.brand.toLowerCase());
        dataLayer.set('product.productInfo.color', product.primaryColor().toLowerCase());
        dataLayer.set('product.attributes.productGroup', product.productGroupId);
        dataLayer.set('product.attributes.originalPrice', product.listPriceNumeric);
        dataLayer.set('product.attributes.currentPrice', product.adjustedPriceNumeric);
        dataLayer.set('product.attributes.onSale', product.isOnSale);
        dataLayer.set('product.attributes.heelHeight', product.heelHeight);
        dataLayer.set('product.attributes.findingMethod', productTracking.getFindingMethod());
        dataLayer.set('product.attributes.rating', product.customerRating);
        dataLayer.set('product.attributes.reviewsAvailable', product.hasCustomerRating);
        dataLayer.set('product.attributes.ratingsAvailable', product.hasCustomerRating);
        if(!product.webGender) {
            dataLayer.set('product.category.primaryCategory', product.typeOfGood ? product.typeOfGood.toLowerCase() : '');
            dataLayer.set('product.category.subCategory1', product.webDepartment ? product.webDepartment.toLowerCase() : '');
        }
        else {
            dataLayer.set('product.category.primaryCategory', product.webDepartment ? product.webDepartment.toLowerCase() : '');
            dataLayer.set('product.category.subCategory1', product.webGender ? product.webGender.toLowerCase() : '');
        }
        dataLayer.set('product.category.subCategory2', product.secondaryCategory);
        dataLayer.set('product.category.subCategory3', product.tertiaryCategory);
        dataLayer.set('product.attributes.isPromoExcluded', product.isPromoExcluded);
        dataLayer.set('product.attributes.seePriceInCart', product.seePriceInCart);
        dataLayer.set('product.attributes.clearance', productTracking.productHasBadge(product, "Clearance"));
        dataLayer.set('product.attributes.newArrival', productTracking.productHasBadge(product, "New"));
        dataLayer.set('product.attributes.onlineOnly', productTracking.productHasBadge(product, "OnlineOnly") || product.isOnlineOnly);
        dataLayer.set('product.attributes.isBOPISEligible', product.isBopisEligible);
        dataLayer.set('product.attributes.isFinalSale', product.isFinalSale);

        if(!variantId) {
            dataLayer.set('product.attributes.inStock', product.isInStock);
            dataLayer.set('product.attributes.outOfStock', !product.isInStock);
            dataLayer.set('product.attributes.preOrder', product.isPreorderable);
            dataLayer.set('product.attributes.backOrder', product.isBackorderable);
        }  

        if(setVariantDataFromStorage) {
            productTracking.SetVariantDataFromStorage(product);
        }
        
        productTracking.imageTracking(product.productImages);
        dataLayer.event('pageview');
        dataLayer.event('product-selection-changed', {
            productGroupId: product.fullProductGroupId,
            productId: productId
        });

    };

    productTracking.RaiseImagePositionUpdateEvent = function(position) {
        var dataLayer = window.data;
        if(!dataLayer) {
            return;
        }

        var productData = dataLayer.get('product');
        dataLayer.event('prodImgUpdated', { 
            productID: productData.productInfo.productID, 
            productName: productData.productInfo.productName, 
            size: productData.productInfo.size, 
            width: productData.productInfo.width, 
            color: productData.productInfo.color, 
            manufacturer: productData.productInfo.manufacturer, 
            price: productData.attributes.currentPrice, 
            prodImgPosition: position 
        });

        productTracking.SetImagePosition(position);
    };

    productTracking.SetImagePosition = function(postion) {
        var dataLayer = window.data;
        if(!dataLayer) {
            return;
        }
        
        dataLayer.set('product.attributes.prodImgPosition', postion);
    };

    productTracking.StartListening = function () {
        productTracking.ProductSelectionChangeHandlerId = CaleresProductSelectionContext.SubscribeHandler(CaleresProductSelectionContext.Events.SelectedProduct, productTracking.ProductSelectionChangedHandler);
        productTracking.ProductImagesSetHandlerId = CaleresProductImagesContext.SubscribeHandler(productTracking.ProductImagesSetImagesHandler);
    };

    productTracking.StopListening = function () {
        if (productTracking.ProductImagesSetHandlerId) {
            CaleresProductImagesContext.UnSubscribeHandler(productTracking.ProductImagesSetHandlerId);
        }
        if (productTracking.ProductSelectionChangeHandlerId) {
            CaleresProductImagesContext.UnSubscribeHandler(productTracking.ProductSelectionChangeHandlerId);
        }
    };

    productTracking.Init = function () {
        productTracking.StartListening();
    };

    productTracking.SetVariantDataFromStorage = function(product) {
        if (window.localStorage) {
            var rememberedSize = JSON.parse(window.localStorage.getItem("rememberMySize") || "{}")
        }

        if(!rememberedSize) {
            return;
        }

        var variants = product.productVariants;
        var variantMatch = variants.find(function(product) {
            return product.variantValues.every(function(variantValue) {
                return rememberedSize[variantValue.propertyName] === variantValue.propertyValue
            })
        });

        productTracking.SetVariantData(variantMatch);
    };

    productTracking.SetVariantData = function(variant) {
        if(variant) {
            var dataLayer = window.data;
            productTracking.VariantId = variant.variantId;
            var size = productTracking.GetVariantProperty(variant, 'Size');
            if(size) {
                dataLayer.set('product.productInfo.size', size);
            }
            var width = productTracking.GetVariantProperty(variant, 'WidthDescription');
            if(width) {
                dataLayer.set('product.productInfo.width', width);
            }
            var ageGroup = productTracking.GetVariantProperty(variant, 'AgeGroup');
            if(ageGroup) {
                dataLayer.set('product.productInfo.ageGroup', ageGroup);
            }
            dataLayer.set('product.productInfo.sku', variant.upc);
            dataLayer.set('product.attributes.originalPrice', variant.listPriceNumeric);
            dataLayer.set('product.attributes.currentPrice', variant.adjustedPriceNumeric);
            dataLayer.set('product.attributes.onSale', variant.isOnSale);
            dataLayer.set('product.attributes.inStock', variant.stockCount > 0);
            dataLayer.set('product.attributes.lowStock', variant.hasLowInventory || variant.stockCount <= 0);
            dataLayer.set('product.attributes.outOfStock', variant.stockCount <= 0);
            dataLayer.set('product.attributes.preOrder', variant.isPreorderable);
            dataLayer.set('product.attributes.backOrder', variant.isBackorderable);
        }
    };

    productTracking.GetVariantProperty = function(variant, key) {
        var property = variant.variantValues.find(function(value) {
            return value.propertyName == key;
        });

        if(property) {
            return property.propertyValue;
        }

        return '';
    };

    productTracking.setFindingMethod = function(checkoutType) {
        sessionStorage.setItem("FindingMethod", checkoutType);
    };

    productTracking.getFindingMethod = function() {
        var findingMethod = sessionStorage.getItem("FindingMethod");
        var internalCampaign = productTracking.getQueryVariable("icid");
        var externalCampaign = productTracking.getQueryVariable("utm_source");
        if(internalCampaign) {
            productTracking.setFindingMethod(productTracking.FindingMethods.InternalCampaign);
            return productTracking.FindingMethods.InternalCampaign;
        }
        else if(externalCampaign) {
            productTracking.setFindingMethod(productTracking.FindingMethods.ExternalCampaign);
            return productTracking.FindingMethods.ExternalCampaign;
        }
        else if(findingMethod) {
            return findingMethod;
        }

        productTracking.setFindingMethod(productTracking.FindingMethods.Browse);
        return productTracking.FindingMethods.Browse;
    };

    productTracking.getQueryVariable = function(variable) 
    {
           var query = window.location.search.substring(1);
           var vars = query.split("&");
           for (var i=0;i<vars.length;i++) {
                var pair = vars[i].split("=");
                if(pair[0] == variable){
                    return pair[1];
                }
           }
           return(false);
    };

    productTracking.productHasBadge = function(product, badgeName) {
        if(!product || !product.productBadges) {
            return false;
        }

        var matchingBadges = product.productBadges.filter(function (badge) {
            return badge.badgeName === badgeName;
        });

        return matchingBadges.length > 0;
    };

    productTracking.imageTracking = function(productImages) {
        if(!window.data) {
            return;
        }

        var dataLayer = window.data,
            videoAvailable = false;
        
        if(productImages && productImages.length > 0) {
            var videos = productImages.filter(function(productImage) {
                return productImage.isVideo();
            });
            videoAvailable = videos.length > 0;
        }

        dataLayer.set('product.attributes.videoAvailable', videoAvailable);
    };

    productTracking.setFullfillmentType = function(deliveryOption) {
        if(!window.data) {
            return;
        }

        var dataLayer = window.data;
        var fulfillmentType = "ship to address";
        if(deliveryOption === "pickup_at_store")
        {
            fulfillmentType = "bopis";
        }

        dataLayer.set('product.attributes.fullfillmentType', fulfillmentType);
    };
}));

CaleresProductTracking.Init();
/**
 * @description Initializes tracking around products
 */
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    var CaleresProductSearchTracking = {};

    // browser global variable
    root.CaleresProductSearchTracking = CaleresProductSearchTracking;
    factory(CaleresProductSearchTracking);
}(this, function (searchTracking) {
    'use strict';
    searchTracking.searchInterfaces;
    searchTracking.searchBoxes;
    searchTracking.lastSelectedFacets = [];
    
    searchTracking.initSearchInterfaceTracking = function (searchInterface) {
        var dataLayer = window.data;

        if(!dataLayer) {
            return;
        }

        Coveo.$$(searchInterface).on("doneBuildingQuery", function (e, data) {
            var state = Coveo.state(searchInterface);
            var invalidRegex = /[^a-zA-Z0-9_\-.\s]/;
            var resultsList = Coveo.$$(searchInterface).find('.CoveoResultList');
            var layout = "";

            if(resultsList && resultsList.CoveoResultList) {
                layout = resultsList.CoveoResultList.options.layout;

                switch(layout) {
                    case "card":
                        layout = "grid";
                        break;
                }
            }
            
            dataLayer.set('page.attributes.listGridView', layout.toLowerCase());
            dataLayer.set('page.attributes.sorting', state.attributes.sort.replace(invalidRegex, "").toLowerCase());
            searchTracking.setSearchRefinements(searchInterface);
            searchTracking.updateCategories(searchInterface);
        });

        Coveo.$$(searchInterface).on("querySuccess", function (e, data) {            
            dataLayer.event('coveo-search-data-loaded', {
                q: data.query.q,
                searchUid: data.results.searchUid,
                count: data.results.totalCount
            });
        });

        Coveo.$$(searchInterface).on("analyticsEventReady", function (e, data) {
            var searchData = data;
            if ((searchData.event == "CoveoSearchEvent") || (searchData.event == "CoveoCustomEvent" && searchData.coveoAnalyticsEventData.actionType == "getMoreResults")) {
                if (searchData.coveoAnalyticsEventData.actionType != "getMoreResults") {
                    var state = Coveo.state(searchInterface);
                    var keywords = state.attributes.q.toLowerCase();
                    dataLayer.set('page.pageInfo.onsiteSearchTerm', keywords);
                    dataLayer.set('page.pageInfo.onsiteSearchResults', searchData.coveoAnalyticsEventData.numberOfResults);
                    dataLayer.set('page.pageInfo.searchEventcause', searchData.coveoAnalyticsEventData.actionCause);
                    if(keywords) {
                        CaleresProductTracking.setFindingMethod(CaleresProductTracking.FindingMethods.OnsiteSearch);
                    }
                    else {
                        CaleresProductTracking.setFindingMethod(CaleresProductTracking.FindingMethods.Browse);
                    }
                }
                if(window.data) {
                    window.data.event('searchoccurred', {
                        searchData: searchData
                    });
                }
            }
        });
    };

    searchTracking.initSearchBoxTracking = function (searchBox) {
        var dataLayer = window.data;

        if(!dataLayer) {
            return;
        }

        Coveo.$$(searchBox).on("beforeRedirect", function (e, data) {
            var state = Coveo.state(searchBox);
            var keywords = state.attributes.q.toLowerCase();
            
            dataLayer.set('page.pageInfo.onsiteSearchTerm', keywords); 

            if(keywords) {
                CaleresProductTracking.setFindingMethod(CaleresProductTracking.FindingMethods.OnsiteSearch);
            }
            else {
                CaleresProductTracking.setFindingMethod(CaleresProductTracking.FindingMethods.Browse);
            }
        });
    };

    searchTracking.setSearchRefinements = function(searchInterface) {
        var state = Coveo.state(searchInterface);
        var selectedFacets = [];
        var dataLayer = window.data;

        for (var i = 0; i < searchTracking.lastSelectedFacets.length; i++) {
            dataLayer.clearVar('page.attributes.internalSearchRefinement[' + i + '].refinementName');
            dataLayer.clearVar('page.attributes.internalSearchRefinement[' + i + '].refinementValue');
        }

        for (var prop in state.attributes) {
            if (state.attributes.hasOwnProperty(prop) && prop.startsWith("f:")) {
                if(state.attributes[prop].length > 0) {
                    selectedFacets.push(prop);
                }
            }
        }

        searchTracking.lastSelectedFacets = selectedFacets;

        for (var i = 0; i < selectedFacets.length; i++) {
            var facet = selectedFacets[i];
            var values = state.attributes[facet];
            dataLayer.set('page.attributes.internalSearchRefinement[' + i + '].refinementName', facet.replace("f:", "").toLowerCase());
            dataLayer.set('page.attributes.internalSearchRefinement[' + i + '].refinementValue', values.join(',').toLowerCase());
        }

        return selectedFacets;
    };

    searchTracking.updateCategories = function(searchInterface) {
        var dataLayer = window.data;
        var state = Coveo.state(searchInterface);
        var categoryFacets = Coveo.$$(searchInterface).findAll(".CoveoCategoryFacet");
        var categoryFacetId = categoryFacets && categoryFacets.length > 0 ? categoryFacets[0].dataset.id : "Category";
        var categories = state.attributes["f:" + categoryFacetId];
        function cleanCategory(category) {
            if(!category) {
                return "";
            }

            return category.toLowerCase().replace(new RegExp(' ', 'g'), '');
        }

        if(categories) {
            var authoredSubCat2 = data.get('page.category.authored.subCategory2');
            var authoredSubCat3 = data.get('page.category.authored.subCategory3');
            if (categories.length <= 0) {
                dataLayer.set('page.category.subCategory2', authoredSubCat2);
                dataLayer.set('page.category.subCategory3', authoredSubCat3);
            } else {
                if (authoredSubCat2 === '') {
                    dataLayer.set('page.category.subCategory2', categories[0]);
                } else if (authoredSubCat3 === '' && (cleanCategory(authoredSubCat2) !== cleanCategory(categories[0]))) {
                    // don't add subCat3 if it matches subCat2
                    dataLayer.set('page.category.subCategory3', categories[0]);
                }
                
                if (categories.length > 1) {
                    if (authoredSubCat2 === '' && authoredSubCat3 === '') {
                        dataLayer.set('page.category.subCategory3', categories[1]);
                    }
                }
                // drop applied subCategory3 if:
                // there is an applied subCategory2
                // AND there is at least one authored subCategory
            }
        }
    };

    document.addEventListener("DOMContentLoaded", function (event) {
        var searchInterfaces = document.querySelectorAll(".CoveoSearchInterface");
        var searchBoxes = document.querySelectorAll(".coveo-globalsearchbox div[id$='_container']");

        for(var i = 0; i < searchBoxes.length; i++) {
            searchTracking.initSearchBoxTracking(searchBoxes[i]);
        } 
    
        for(var i = 0; i < searchInterfaces.length; i++) {
            searchTracking.initSearchInterfaceTracking(searchInterfaces[i]);
        }  
    });
}));
/**
 * @description Initializes tracking around products
 */
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    var CaleresGlobalTracking = {};

    // browser global variable
    root.CaleresGlobalTracking = CaleresGlobalTracking;
    factory(CaleresGlobalTracking);
}(this, function (globalTracking) {
    'use strict';

    globalTracking.setFormLoaded = function () {
        var dataLayer = window.data;

        if (!dataLayer) {
            return;
        }

        dataLayer.set('page.attributes.formLoaded', true);
    };

    globalTracking.setCustomerNumber = function(customerNumber) {
        if(window.data && localStorage && customerNumber) {
            var dataLayer = window.data
            customerNumber = customerNumber.toString();
            localStorage.setItem("customerNumber", customerNumber);
            dataLayer.set("user.attributes.customerNumber", customerNumber);
        }
    };

    globalTracking.clearCustomerNumber = function() {
        if(window.data && localStorage) {
            var dataLayer = window.data
            localStorage.removeItem("customerNumber");
            dataLayer.clearVar("user.attributes.customerNumber");
        }
    };

    //Track click events on Language Selector options
    $('body').on('click', '.language-item', function() {
        window.data.event('clickEvent', {
            linkName: 'Set Language Click',
            language: $(this).attr("data-item-language")
        });
    });

    //Track recommendations click events
    $("body").on("touchstart click", ".CoveoRecommendation .coveo-recommendation-body .coveo-result-frame.coveoforsitecore-template", function() {
        var value = JSON.parse($(this).find(".coveo-result__indexed-result")[0].value)[0];
        var product = {
            productID: value.productid[0],
            productName: value.name,
            size: value.size,
            color: value.primarycolor[0],
            brand: value.brand[0],
            price: value.currentprice
        };
        data.event('prodImpressionClickthrough', product);      
    });
}));
/**
 * @description Initializes tracking around products
 */
(function (root, factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // use AMD define funtion to support AMD modules if in use
        define(['exports'], factory);

    } else if (typeof exports === 'object') {
        // to support CommonJS
        factory(exports);
    }

    var CaleresNavigationTracking = {};

    // browser global variable
    root.CaleresNavigationTracking = CaleresNavigationTracking;
    factory(CaleresNavigationTracking);
}(this, function (navTracking) {
    'use strict';
    navTracking.promotions = [];

    navTracking.setAdImpressions = function() {
        var datalayer = window.data;

        if(!datalayer) {
            return;
        }

        for(var i = 0; i < navTracking.promotions.length; i++) {
            var promo = navTracking.promotions[i];
            datalayer.set('page.attributes.adImpression[' + i + '].promoID', promo.id); 
            datalayer.set('page.attributes.adImpression[' + i + '].promoName', promo.name);  
        }
    };

    navTracking.getQueryString = function ( field, url ) {
        var href = url;
        var reg = new RegExp( '[?&]' + field + '=([^&#]*)', 'i' );
        var string = reg.exec(href);
        return string ? string[1] : null;
    };

    document.addEventListener("DOMContentLoaded", function (event) {
        var anchors = document.querySelectorAll("a");
        for(var x = 0; x < anchors.length; x++) {
            var href = anchors[x].href;
            var icid = navTracking.getQueryString("icid", href);
            if(icid) {
                icid = icid.toLowerCase()
                var promoImage = $(anchors[x]).closest('.promo').find('img');
                var existingPromotions = navTracking.promotions.filter(function(promo) {
                    return promo.id === icid;
                });
                if(existingPromotions.length == 0) {
                    navTracking.promotions.push({
                        id: icid,
                        name: promoImage && promoImage.length > 0 && promoImage.attr("alt") ? promoImage.attr("alt").toLowerCase() : ""
                    });
                }
                else if(!existingPromotions[0].name){
                    existingPromotions[0].name = promoImage && promoImage.length && promoImage.attr("alt") > 0 ? promoImage.attr("alt").toLowerCase() : "";
                }
            }
        }

        navTracking.setAdImpressions();
    });
}));
(function () {
    'use strict';

    /**
     * @function coveoInitLazyLoad
     * @param
     * @description Utilizes Lazy Component Loading if it is enabled, otherwise Eager
     */
    function coveoInitLazyLoad() {
        if (Coveo.LazyInitialization) {
            Coveo.load('Facet').then(function () {
                // TODO: Need type definition for 'FacetManager' - Casting as <any> for now
                Coveo.FacetManager.initializeFacetManager();
            });
        }
        else {
            Coveo.FacetManager.initializeFacetManager();
        }
    }

    /**
     * @function coveoFacetCustomizations
     * @param searchInterface Coveo.Dom
     * @description Coveo Facet functions
     */
    function coveoFacetCustomizations(searchInterface) {
        var root = document.body;
        var mdUpperPx = 991; // Max breakpoint for tablet/mobile 
        var facets = Coveo.$$(root).findAll('.CoveoFacet,.CoveoFacetRange'); // Get all the facets
        // If user is at or below tablet/mobile breakpoint...
        if (window.innerWidth <= mdUpperPx) {
            // Find the color facet and set the number of really high to show all, i.e. no See More/Less 
            var colorFacet = Coveo.$$(root).find('.CoveoFacet[data-facet-color="true"]');
            if (colorFacet) {
                var numberOfValues = '99';
                colorFacet.setAttribute('data-number-of-values', numberOfValues);
            }
        }
        // If a facet has data-enable-expand-collapse set to true, add .coveo-facet-copllapsed class
        for (var i = 0; i < facets.length; i++) {
            if (facets[i].getAttribute('data-enable-collapse') == "true") {
                facets[i].classList.add('coveo-facet-collapsed');
            }
        }
    }

    function createFacetContainer($facetContainer) {
        var facetTitle = $facetContainer.find('.data--facet-container__title').val();
        var facetClearText = $facetContainer.find('.data--facet-container__clear-text').val();
        var facetCloseText = $facetContainer.find('.data--facet-container__close-text').val();
        var headerTemplate = "<div class=\"facet-container__title\">\n                            <div class=\"component rich-text modal-title__text\">\n                                <div class=\"component-content\"><h5 class='position-center'>" + facetTitle + "</h5></div>\n                            </div>\n                            <div class=\"component icon modal-title__button\">\n                                <div class=\"component-content\"><span class=\"icon-close\"></span></div>\n                            </div>\n                        </div>";
        var footerTemplate = "<div class='mobile-query-summary row'>\n        <div class='component link footer-button footer-button--clear-all-link'>\n            <div class='component-content'>\n                <a class='clear-all-link' data-variantfieldname='Link'>" + facetClearText + "</a>\n            </div>\n        </div>\n        <div class='component link footer-button footer-button--view-results-link position-right no-padding'>\n            <div class='component-content'>\n                <a class=\"view-results-link\" title=\"View Results\" data-variantfieldname=\"Link\">" + facetCloseText + "</a>\n            </div>\n        </div>\n    </div>";
        // is the header template already there?
        if (!$facetContainer.children().hasClass('facet-container__title')) {
            // if not, add it
            $facetContainer.prepend(headerTemplate);
        }
        // is the footer template already there?
        if (!$facetContainer.children().hasClass('mobile-query-summary')) {
            // if not, add it
            $facetContainer.append(footerTemplate);
        }
        toggleClearAllButton();
        updateMobileQuerySummary();
    }
    function toggleFacetContainer() {
        var $body = $("body");
        var $html = $("html");
        $body.toggleClass("ps-mobile-modal--open");
        $html.toggleClass("ps-mobile-modal--open");
    }
    function toggleCoveoCategoryFacet(target) {
        if (window.innerWidth < 992 || $('.CoveoSearchInterface').hasClass('show-modal--all-screens')) { // Mobile and tablet
            var $target = $(target);
            $target.toggleClass('expand');
            $target.siblings('.coveo-category-facet-values').toggle();
        }
    }
    function initDynamicHierarchicalFacet() {
        $('.CoveoDynamicHierarchicalFacet').attr({
            'data-enable-collapse': 'true',
            'data-collapsed-by-default': 'true'
        }).coveo('collapse');
    }
    function toggleDynamicHierarchicalFacet(target) {
        if (window.innerWidth < 992 || $('.CoveoSearchInterface').hasClass('show-modal--all-screens')) { // Mobile and tablet
            var $target = $(target);
            $target.parents('.CoveoDynamicHierarchicalFacet').coveo('toggleCollapse');
        }
    }
    function initFacetContainer() {
        var $facetContainers = $(".ps-mobile-modal, .show-modal--all-screens .facet-container");
        $facetContainers.each(function (i, facetContainer) {
            var $facetContainer = $(facetContainer);
            createFacetContainer($facetContainer);
        });
    }
    function collapseFacets() {
        $('.facet-container .link-list h6').addClass('expand');
        $('.facet-container .link-list ul').css('display', 'none');
        $('.CoveoFacet').addClass('coveo-facet-collapsed');
        // Removes max-height if added to this facet to improve Google Core Web Vitals Cumulative Shift Layout score
        $('.CoveoFacet[data-id="storename"]').css('max-height', 'none');
        $('.CoveoFacetRange').addClass('coveo-facet-collapsed');
    }
    function resetCoveoFacets() {
        initFacetContainer();
        if (window.innerWidth > 991 && !$('.CoveoSearchInterface').hasClass('show-modal--all-screens')) { // Desktop only 
            $('.facet-container__title').remove();
            $('.mobile-query-summary').remove();
            toggleClearAllButton();
        }
    }
    function toggleClearAllButton() {
        var dynamicHierarchicalSelectedLength = typeof $('.CoveoDynamicHierarchicalFacet').coveo() !== "undefined" ? $('.CoveoDynamicHierarchicalFacet').coveo().values.selectedPath.length : 0;
        var selectedFilters = $('.coveo-facet-value.coveo-selected').length + $('.CoveoCategoryFacet .coveo-category-facet-collapse-children').length + dynamicHierarchicalSelectedLength;
        if (selectedFilters > 0) {
            $('.clear-all-link').show();
        }
        else {
            $('.clear-all-link').hide();
        }
    }
    function updateMobileQuerySummary() {
        var facetClearText = $('.facet-container').find('.data--facet-container__clear-text').val();
        var facetCloseText = $('.facet-container').find('.data--facet-container__close-text').val();
        var dynamicHierarchicalSelectedLength = typeof $('.CoveoDynamicHierarchicalFacet').coveo() !== "undefined" ? $('.CoveoDynamicHierarchicalFacet').coveo().values.selectedPath.length : 0;
        var selectedFilters = $('.coveo-facet-value.coveo-selected').length + $('.CoveoCategoryFacet .coveo-category-facet-collapse-children').length + dynamicHierarchicalSelectedLength;
        $('.mobile-query-summary a.clear-all-link').text(facetClearText + " (" + selectedFilters + ")");
        var querySummaryElement = $(".CoveoQuerySummary > span").first();
        var resultCount = querySummaryElement.find(".coveo-highlight:last-of-type").text();
        // If the word 'for' is found in '.CoveoQuerySummary', the search box was used. Grab the 2nd to last of this type instead 
        if (querySummaryElement.text().indexOf("for") > -1) {
            resultCount = querySummaryElement.find(".coveo-highlight:nth-last-of-type(2)").text();
        }
        $('.mobile-query-summary a.view-results-link').text(facetCloseText + " (" + resultCount + ")");
    }
    function initClearFilter(searchInterface) {
        var clearLinkElement;
        clearLinkElement = document.querySelector('.CoveoQuerySummary');
        if (clearLinkElement) {
            var clearAllLabel = ($('html').attr('lang') === 'fr-CA') ? 'Effacer les filtres' : 'Clear All Refinements';
            clearLinkElement.innerHTML += "<div class='clear-all-link__container'><a><span class='clear-all-link'>" + clearAllLabel + "</span></a></div>";
        }
        window.addEventListener('load', function () {
            toggleClearAllButton();
            if (window.innerWidth < 992 || $('.CoveoSearchInterface').hasClass('show-modal--all-screens')) { // Mobile and tablet
                collapseFacets();
                $('.coveo-category-facet-values').hide();
            }
        });
        Coveo.$$(searchInterface).on('newResultsDisplayed', function () {
            toggleClearAllButton();
            updateMobileQuerySummary();
        });
        document.addEventListener('click', function (e) {
            var target = e.target;
            if (target.matches('.clear-all-link')) {
                var coveoFacets = $('.CoveoFacet');
                var searchInterface = coveoFacets[0].CoveoFacet.searchInterface;
                if (coveoFacets && coveoFacets.length > 0) {
                    coveoFacets.coveo('reset');
                }
                var CoveoFacetRanges = $('.CoveoFacetRange');
                if (CoveoFacetRanges && CoveoFacetRanges.length > 0) {
                    CoveoFacetRanges.coveo('reset');
                }
                var coveoBreadcrumbs = $('.CoveoBreadcrumb');
                if (coveoBreadcrumbs && coveoBreadcrumbs.length > 0) {
                    coveoBreadcrumbs.coveo('clearBreadcrumbs');
                }
                var coveoDynamicHierarchical = $('.CoveoDynamicHierarchicalFacet');
                if (coveoDynamicHierarchical && coveoDynamicHierarchical.length > 0) {
                    coveoDynamicHierarchical.coveo('reset');
                }
                var coveoCategories = $('.CoveoCategoryFacet');
                if (coveoCategories && coveoCategories.length > 0) {
                    coveoCategories.coveo('reset');
                }
                else {
                    var searchInterface = $(target).closest('.CoveoSearchInterface');
                    if (searchInterface && searchInterface.length > 0) {
                        //There's something that triggers a requery if the Category facet changes. Since there isn't one here, we need to trigger it manually.
                        Coveo.executeQuery(searchInterface[0]);
                    }
                }
                $('.clear-all-link').hide();
            }
            if (target.matches('.coveo-category-facet-header') || target.matches('.coveo-category-facet-title')) {
                toggleCoveoCategoryFacet(target);
            }
            if (target.matches('.coveo-dynamic-facet-header')) {
                toggleDynamicHierarchicalFacet(target);
            }
            if (target.matches('.view-results-link') || target.matches('.facet-container__title .icon-close') || target.matches('.ps-mobile-modal--open')) {
                // close the modal
                toggleFacetContainer();
                // display mobile app nav when filter is closed
                if (window.MobileApp) {
                    window.MobileApp.showNav();
                }
                // fire off analytics event
                try {
                    if (window.MOBILE_FILTER_WAS_ADJUSTED) {
                        window.MOBILE_FILTER_WAS_ADJUSTED = false;
                        window.data.event('pageview');
                    }
                }
                catch (err) {
                    console.log('Error raising analytics event: ', err);
                }
            }
            if (target.matches('.js-modal-toggle a') || target.matches('.js-modal-toggle')) {
                e.preventDefault();
                toggleFacetContainer();
                initFacetContainer();
                initDynamicHierarchicalFacet();
                // hide mobile app nav when filter is open
                if (window.MobileApp) {
                    window.MobileApp.hideNav();
                }
            }
        });
        window.resizeEvent(100, resetCoveoFacets);
    }

    function initUrlWriter(searchInterface) {
        window.URL_WRITER_QUERY_PARAMETERS_HAVE_BEEN_COLLECTED = window.URL_WRITER_QUERY_PARAMETERS_HAVE_BEEN_COLLECTED || false;
        if (typeof fieldValuesToFetch == "undefined") {
            console.log("Coveo URL Writer: fieldValuesToFetch is undefined. Url Writer will be disabled.");
            return;
        }
        if (typeof facetSelectionBasePath == "undefined") {
            console.log("Coveo URL Writer: facetSelectionBasePath is undefined. Canonical will be used.");
            facetSelectionBasePath = $("link[rel='canonical']").attr("href");
        }
        var facetField = [];
        var hasOnlyDisabledField = fieldValuesToFetch.length === 1 && fieldValuesToFetch[0].field == "disabled";
        var searchHistoryEnabled = $(searchInterface).data("enable-history");
        var isExperienceEditor = $('body.on-page-editor').length > 0;
        if (!searchHistoryEnabled && hasOnlyDisabledField) {
            console.log("Coveo URL Writer: Coveo Search History is disabled and only found the disabled field. The Url Writer will be disabled.");
            return;
        }
        else if (searchHistoryEnabled) {
            console.log("Coveo URL Writer: Coveo Search History is enabled. The Url Writer will be disabled.");
            return;
        }
        else if (isExperienceEditor) {
            console.log("Coveo URL Writer: The page is in experience editor mode. The Url Writer will be disabled.");
            return;
        }
        for (var i = 0; i < fieldValuesToFetch.length; i++) {
            if (fieldValuesToFetch[i].field != "") {
                facetField.push(fieldValuesToFetch[i].field);
            }
        }
        Coveo.$$(searchInterface).on("deferredQuerySuccess", function (e, data) {
            var currentInterface = searchInterface;
            if (currentInterface.disableUrlWriter) {
                currentInterface.disableUrlWriter = false;
                return;
            }
            var facetElements = facetField.map(function (id) { return document.querySelector('[data-field="@' + id + '"]'); });
            var baseUrl = facetSelectionBasePath;
            var canonicalUrl = facetElements.map(extractFacetValues).join("");
            var pageAndSortHash = getPageAndSort(data.query.firstResult, data.query.sortCriteria);
            var queryString = "";
            if (!window.URL_WRITER_QUERY_PARAMETERS_HAVE_BEEN_COLLECTED) {
                queryString = window.location.search;
                window.URL_WRITER_QUERY_PARAMETERS_HAVE_BEEN_COLLECTED = true;
            }
            history.pushState("", "", baseUrl + canonicalUrl + queryString + pageAndSortHash || "/");
            dispatchCustomEvent('urlchanged');
        });
        function extractFacetValues(facet) {
            if (!facet)
                return;
            var facetValues = [];
            if (facet.CoveoCategoryFacet || facet.CoveoDynamicHierarchicalFacet) {
                return getCategoryUrl(facet);
            }
            else if (facet.CoveoFacet) {
                facetValues = sortFacetValues(facet.CoveoFacet);
            }
            else if (facet.CoveoFacetRange) {
                facetValues = getRangeValues(facet.CoveoFacetRange);
            }
            else if (facet.CoveoFacetSlider) {
                facetValues = getSliderValues(facet.CoveoFacetSlider);
            }
            if (facetValues.length === 0)
                return "";
            return "/" + facetValues.map(facetValueToFriendlyUrl).join("+");
        }
        function sortFacetValues(coveoFacet) {
            var values = coveoFacet.getSelectedValues();
            if (values && coveoFacet.facetSort.activeSort.name == "custom") {
                var customSortOrder = coveoFacet.options.customSort;
                values.sort(function (a, b) {
                    return customSortOrder.indexOf(a) - customSortOrder.indexOf(b);
                });
            }
            return values;
        }
        function getSliderValues(coveoFacetSlider) {
            var facetValues = coveoFacetSlider.getSelectedValues();
            var values = [];
            if (facetValues.length == 0 || (coveoFacetSlider.options.start === facetValues[0] && coveoFacetSlider.options.end === facetValues[1])) {
                return values;
            }
            var field = coveoFacetSlider.options.field;
            var rangeFormatted = facetValues.map(function (value) {
                return value.toFixed(2);
            }).join('-to-');
            if (field == '@currentprice') {
                rangeFormatted = 'price-' + rangeFormatted;
            }
            else if (field == '@percentageoff') {
                rangeFormatted = 'percent-off-' + rangeFormatted;
            }
            values.push(rangeFormatted);
            return values;
        }
        function getRangeValues(coveoFacetRange) {
            var facetValues = coveoFacetRange.getSelectedValues();
            if (facetValues.length == 0) {
                return [];
            }
            var field = coveoFacetRange.options.field;
            var formattedValues = facetValues.map(function (value) {
                var range = value.split('..');
                var rangeFormatted = Number(range[0]).toFixed(2) + '-to-' + Number(range[1]).toFixed(2);
                if (field == '@currentprice') {
                    return 'price-' + rangeFormatted;
                }
                else if (field == '@percentageoff') {
                    return 'percent-off-' + rangeFormatted;
                }
                else {
                    return rangeFormatted;
                }
            });
            return formattedValues;
        }
        function getCategoryUrl(facet) {
            var categoryPath = [];
            if (facet.CoveoDynamicHierarchicalFacet) {
                categoryPath = facet.CoveoDynamicHierarchicalFacet.values.selectedPath;
            }
            else if (facet.CoveoCategoryFacet && facet.CoveoCategoryFacet.activeCategoryValue) {
                categoryPath = facet.CoveoCategoryFacet.activeCategoryValue.path;
            }
            else {
                return "";
            }
            var baseUrl = facetSelectionBasePath;
            var categories = categoryPath.filter(function (category) {
                return !isFacetInUrl(category, baseUrl);
            });
            if (categories.length > 0) {
                var path = "/" + categories.map(facetValueToFriendlyUrl).join("/");
                return path;
            }
            return "";
        }
        function isFacetInUrl(facet, url) {
            var urlParts = url.split("/").map(facetValueToFriendlyUrl);
            var facetClean = facetValueToFriendlyUrl(facet);
            var matches = urlParts.filter(function (urlPart) {
                return urlPart === facetClean;
            });
            return matches.length > 0;
        }
        function facetValueToFriendlyUrl(facetValue) {
            if (!facetValue) {
                return "";
            }
            var invalidRegex = /[^a-zA-Z0-9_\-.+]/;
            facetValue = facetValue.toLowerCase().replace(/\s&\s/, " and ");
            facetValue = facetValue.split(" ").join("-");
            facetValue = facetValue.replace(invalidRegex, "");
            return facetValue;
        }
        function getPageAndSort(page, sort) {
            if (sort.indexOf("@") === -1) {
                var pageAndSortHash = "#sort=" + sort;
            }
            else {
                // if sort contains "@" char replace with "%40"
                var split = sort.split("");
                var replaceCharInHash = split.map(function (char) {
                    if (char === "@") {
                        return "%40";
                    }
                    else {
                        return char;
                    }
                }).join("");
                var pageAndSortHash = "#sort=" + replaceCharInHash;
            }
            if (Number(page) > 0) {
                pageAndSortHash = "#first=" + page + "&sort=" + sort;
            }
            return pageAndSortHash;
        }
        function dispatchCustomEvent(customEvent) {
            var event;
            if (typeof (Event) === 'function') {
                event = new Event(customEvent);
            }
            else {
                event = document.createEvent('Event');
                event.initEvent(customEvent, true, true);
            }
            document.dispatchEvent(event);
        }
    }

    function placePlpAdvertisements(searchInterface) {
        var isInitialized = false;
        var defaultResultsPerPage = 12;
        var adPlacements = document.querySelectorAll(".ResultsAdPlacement--unplaced");
        Coveo.$$(searchInterface).on("newResultsDisplayed", function () {
            var placements = adPlacements;
            for (var i = 0; i < placements.length; ++i) {
                var placement = placements[i];
                var placeAfterPosition = placement.getAttribute("data-listing-position") !== "" ? Number(placement.getAttribute("data-listing-position")) : null;
                var target = document.querySelectorAll(".CoveoResult")[placeAfterPosition];
                if (target) {
                    //Move node to correct place
                    target.parentNode.insertBefore(placement, target.nextSibling);
                    placement.classList.remove("ResultsAdPlacement--unplaced");
                }
            }
        });
        Coveo.$$(searchInterface).on("afterInitialization", function () {
            var spotsCount = 0;
            var currentInterface = searchInterface;
            if (!isInitialized) {
                isInitialized = true;
                defaultResultsPerPage = currentInterface.CoveoSearchInterface.resultsPerPage;
            }
            for (var i = 0; i < adPlacements.length; ++i) {
                var adPlacement = adPlacements[i];
                var isPlacementActive = adPlacement.getAttribute("data-listing-position") !== "" ? true : false;
                if (isPlacementActive) {
                    if (Coveo.$$(adPlacement).hasClass('plpAdContainer--doubleWide')) {
                        spotsCount += 2;
                    }
                    else {
                        spotsCount++;
                    }
                }
            }
            var spotsAdjustment = spotsCount % 12;
            currentInterface.CoveoSearchInterface.resultsPerPage = spotsCount % 12 == 0 ? defaultResultsPerPage : defaultResultsPerPage - spotsAdjustment;
        });
    }

    function initCoveoAnalyticsEvents(searchInterface) {
        try {
            // raise analytics pageview event whenever deferredQuerySuccess event occurs
            Coveo.$$(searchInterface).on("deferredQuerySuccess", function (e, data) {
                // on mobile, don't raise the event until the user closes the filter modal
                if ($('.ps-mobile-modal--open').length < 1) {
                    if (window.data) {
                        window.data.event('pageview');
                    }
                }
                else {
                    window.MOBILE_FILTER_WAS_ADJUSTED = true;
                }
            });
        }
        catch (err) {
            console.log('Error raising analytics event: ', err);
        }
    }

    function initClearSearchValues(searchInterface) {
        var previousSearchTerm = "";
        var initialSearch = true;
        Coveo.$$(searchInterface).on("doneBuildingQuery", function (e, args) {
            var state = Coveo.state(this);
            var currentSearchTerm = state.attributes["q"];
            if (!initialSearch && previousSearchTerm !== currentSearchTerm) {
                console.log(currentSearchTerm != previousSearchTerm);
                previousSearchTerm = currentSearchTerm;
                var resetableFacets = Coveo.$$(searchInterface).findAll('.CoveoFacet,.CoveoFacetRange,.CoveoCategoryFacet,.CoveoDynamicHierarchicalFacet');
                resetableFacets.forEach(function (facet) {
                    var facetId = resetFacet(facet);
                    updateQueryBuilder(facetId, args.queryBuilder);
                });
            }
            previousSearchTerm = currentSearchTerm;
            initialSearch = false;
        });
        function resetFacet(facet) {
            if (!facet)
                return;
            var facetField = "";
            if (facet.CoveoCategoryFacet) {
                facet.CoveoCategoryFacet.reset();
                facetField = facet.CoveoCategoryFacet.options.field;
            }
            else if (facet.CoveoFacet) {
                facet.CoveoFacet.reset();
                facetField = facet.CoveoFacet.options.field;
            }
            else if (facet.CoveoFacetRange) {
                facet.CoveoFacetRange.reset();
                facetField = facet.CoveoFacetRange.options.field;
            }
            else if (facet.CoveoDynamicHierarchicalFacet) {
                facet.CoveoDynamicHierarchicalFacet.reset();
                facetField = facet.CoveoDynamicHierarchicalFacet.options.field;
            }
            return facetField;
        }
        function updateQueryBuilder(facetId, queryBuilder) {
            if (!facetId)
                return;
            var expressionToClear = "";
            queryBuilder.advancedExpression.parts.forEach(function (part) {
                if (part.indexOf(facetId) > -1) {
                    expressionToClear = part;
                }
            });
            if (expressionToClear) {
                queryBuilder.advancedExpression.remove(expressionToClear);
            }
        }
    }

    function coveoProductGroupRollup(searchInterface) {
        var $body = $('body');
        // Prevents mass clicking on results links before PDP loads 
        $body.on("click", ".CoveoResultLink", function (e) {
            $(this).css("pointer-events", "none");
        });
        Coveo.$$(searchInterface).on('newResultsDisplayed', function () {
            var $swatches = $('.swatches');
            $swatches.each(function () {
                if (!$(this).hasClass("productDetailsLink")) {
                    $(this).on('click touchstart', function (e) {
                        selectColor(e.target);
                    });
                    $(this).on('touchend', function (e) {
                        clearInactive(e.target);
                    });
                    $(this).on('focus', function (e) {
                        selectColor(e.target);
                    });
                    $(this).on('mouseover', function (e) {
                        $(e.target).addClass("hover");
                        previewColor(e.target);
                    });
                    $(this).on('mouseout touchmove', function (e) {
                        $(e.target).removeClass("hover");
                        revertColor(e.target);
                    });
                }
            });
            function previewColor(swatch) {
                var raw = $(swatch).parents(".coveo-result-frame").find(".coveo-result__indexed-result").val().toString();
                var rawJson = JSON.parse(raw);
                var swatchIndex = $(swatch).attr('data-swatchIndex');
                changeColorView(swatch, rawJson, swatchIndex);
            }
            function revertColor(swatch) {
                var targetSwatch = $(swatch).hasClass("active");
                if (!targetSwatch) {
                    var raw = $(swatch).parents(".coveo-result-frame").find(".coveo-result__indexed-result").val().toString();
                    var rawJson = JSON.parse(raw);
                    var swatchIndex = $(swatch).parents(".grouped-result__color-swatch-wrapper").find(".active").attr('data-swatchIndex');
                    changeColorView(swatch, rawJson, swatchIndex);
                }
            }
            function clearInactive(swatch) {
                $(swatch).siblings().removeClass("active");
            }
            function selectColor(swatch) {
                var raw = $(swatch).parents(".coveo-result-frame").find(".coveo-result__indexed-result").val().toString();
                var rawJson = JSON.parse(raw);
                var swatchIndex = $(swatch).attr('data-swatchIndex');
                $(swatch).siblings().removeClass("active");
                changeColorView(swatch, rawJson, swatchIndex);
                $(swatch).addClass("active");
            }
            function changeColorView(swatch, swatchData, i) {
                /* Result Links */
                $(swatch).parents(".coveo-result-frame").find(".CoveoResultLink").attr("href", swatchData[i].producturi);
                if (swatchData.length > 3) {
                    $(swatch).parents(".coveo-result-frame").find(".productDetailsLink").attr("href", swatchData[i].producturi);
                }
                /* Result Thumbnails */
                var pagethumbnails = $(swatch).parents(".results-template");
                var primarythumbnail;
                if (pagethumbnails.data("primaryimage") != null && swatchData[i].dataset.primaryimage) {
                    primarythumbnail = swatchData[i].dataset.primaryimage;
                }
                else if (swatchData[i].imagerightmedium != null) {
                    primarythumbnail = swatchData[i].imagerightmedium;
                }
                else {
                    primarythumbnail = "http://fpoimg.com/300x300";
                }
                $(swatch).parents(".coveo-result-frame").find(".item-result__image--primary").attr("src", primarythumbnail);
                //Swap video
                if ($(swatch).parents(".coveo-result-frame").find(".item-result_video").length) {
                    var $videoParent = $(swatch).parents(".coveo-result-frame");
                    if (primarythumbnail.includes(".mp4")) {
                        //Show video
                        $videoParent.find(".item-result_img-with-video").hide();
                        $videoParent.find(".item-result_video").show();
                    }
                    else {
                        //Show primary image
                        $videoParent.find(".item-result_img-with-video").show();
                        $videoParent.find(".item-result_video").hide();
                    }
                }
                var secondarythumbnail;
                if (pagethumbnails.data("secondaryimage") != null && swatchData[i].dataset.secondaryimage) {
                    secondarythumbnail = swatchData[i].dataset.secondaryimage;
                }
                else if (swatchData[i].imagepairmedium != null) {
                    secondarythumbnail = swatchData[i].imagepairmedium;
                }
                else {
                    secondarythumbnail = "http://fpoimg.com/300x300";
                }
                $(swatch).parents(".coveo-result-frame").find(".item-result__image--secondary").attr("src", secondarythumbnail);
                /* Result Badge */
                var resultBadge;
                if (swatchData[i].badgeurl) {
                    resultBadge = '<img src=' + swatchData[i].badgeurl + ' alt=' + swatchData[i].badges[0] + ' />';
                }
                else {
                    resultBadge = '';
                }
                $(swatch).parents(".coveo-result-frame").find(".item-result__badge").html(resultBadge);
                /* Result Name */
                var resultName = '<a class="item-result__product-name" href=' + swatchData[i].producturi + '>' + swatchData[i].name + '</a>';
                $(swatch).parents(".coveo-result-frame").find(".item-result__product-name").replaceWith(resultName);
                /* Result Price */
                var resultPrice;
                var lang = swatchData[i].language[0];
                var isOnSale = (swatchData[i].currentprice < swatchData[i].originalprice);
                var isMapEligible = swatchData[i].ismapeligible == "true" && swatchData[i].ismappolicycart == "true" ? true : false;
                var currentprice = lang === "fr-CA" ? swatchData[i].currentprice.toFixed(2).replace(".", ",") + "&nbsp;$" : "$" + swatchData[i].currentprice.toFixed(2);
                var originalprice = lang === "fr-CA" ? swatchData[i].originalprice.toFixed(2).replace(".", ",") + "&nbsp;$" : "$" + swatchData[i].originalprice.toFixed(2);
                if (isMapEligible) {
                    resultPrice = '<a class="item-result__price bfx-price">See Price in Cart</a>';
                }
                else if (isOnSale) {
                    resultPrice = '<a class="item-result__price bfx-price" href=' + swatchData[i].producturi + '>' + currentprice + '<span class="item-result__price--strikethrough bfx-price bfx-original-price">' + originalprice + '</span></a>';
                }
                else {
                    resultPrice = '<a class="item-result__price bfx-price"  href=' + swatchData[i].producturi + '>' + currentprice + '</a>';
                }
                $(swatch).parents(".coveo-result-frame").find(".item-result__price").replaceWith(resultPrice);
                /* Result Star Rating */
                var roundedRating = Math.round(swatchData[i].starrating * 2) / 2;
                var starMarkup = "";
                if (roundedRating > 3) {
                    starMarkup = [1, 2, 3, 4, 5].map(function (number) {
                        var star = "<span class='icon-star-empty'></span>";
                        if (roundedRating >= number - 0.5) {
                            star = "<span class='icon-star-half'></span>";
                        }
                        if (roundedRating >= number) {
                            star = "<span class='icon-star-full'></span>";
                        }
                        return star;
                    }).join('');
                }
                $(swatch).parents(".coveo-result-frame").find(".item-result__rating").html(starMarkup);
                /* Promotion Exclusion Messaging */
                var exclusionMessaging = "";
                var isBogoExcluded = (swatchData[i].isbogoexcluded == 'true' && swatchData[i].isbogofirstpaironly == 'false')
                    || (swatchData[i].isbogofirstpaironly == 'true' && swatchData[i].isbogoexcluded == 'true') ? true : false;
                var isFirstPairOnly = swatchData[i].isbogofirstpaironly == 'true' && swatchData[i].isbogoexcluded == 'false' ? true : false;
                var isPromoExcluded = swatchData[i].iscouponexcluded == 'true' ? true : false;
                if (isBogoExcluded) {
                    exclusionMessaging = "<div class=\"item-result__exclusion-messaging>" + window.bogoExclusionText + "</div>";
                }
                if (isFirstPairOnly) {
                    exclusionMessaging = "<div class=\"item-result__exclusion-messaging>" + window.firstPairOnlyText + "</div>";
                }
                if (isPromoExcluded) {
                    exclusionMessaging = "<div class=\"item-result__exclusion-messaging>" + window.promoExclusionText + "</div>";
                }
                if (isBogoExcluded && isPromoExcluded) {
                    exclusionMessaging = "<div class=\"item-result__exclusion-messaging>" + window.bogoExclusionText + "<br>" + window.promoExclusionText + "</div>";
                }
                $(swatch).parents(".coveo-result-frame").find(".item-result__exclusion-messaging").replaceWith(exclusionMessaging);
            }
        });
        Coveo.SearchEndpoint.endpoints['default'].setRequestModifier(function (params) {
            if (!!params.requestData && !!params.requestData.groupBy) {
                params.requestData.groupBy.forEach(function (groupBy) {
                    if (groupBy.field === "@primarycolor") {
                        groupBy.filterFacetCount = false;
                    }
                });
            }
            return params;
        });
    }

    function coveoProductImageLazyLoad(searchInterface) {
        window.addEventListener('scroll', function (e) {
            lazyLoadImages();
        });
        Coveo.$$(searchInterface).on('newResultsDisplayed', function () {
            lazyLoadImages();
        });
    }
    function lazyLoadImages() {
        // Get position of bottom of window minus 100px
        var winPos = $(window).scrollTop() + window.innerHeight + 100;
        var resultImages = $(".item-result__image")
            //Filter out images that have already loaded, and images below winPos
            .filter(function () {
            var attr = $(this).attr("lazy-src");
            return $(this).offset().top <= winPos &&
                $(this)[0].hasAttribute("lazy-src");
        });
        // Store and remove the lazy-src attrbute, substitute for src
        resultImages.each(function () {
            var src = $(this).attr("lazy-src");
            $(this).removeAttr("lazy-src").attr("src", src);
        });
        // Find all the Product Group Rollup swatches with background images
        var resultSwatches = $("button.swatches.hasImage")
            // Filter out background images that have already loaded, and background images below winPos
            .filter(function () {
            return $(this).offset().top <= winPos &&
                $(this)[0].hasAttribute("lazy-style");
        });
        // Store and remove the lazy-style attrbute, substitute for style
        resultSwatches.each(function () {
            var style = $(this).attr("lazy-style");
            $(this).removeAttr("lazy-style").attr("style", style);
        });
    }

    function initCoveoSearchboxCustomizations(searchInterface) {
        Coveo.$$(searchInterface).on("newQuery", function (e, args) {
            var searchboxToggle = $('.js-searchbox-toggle');
            if (searchboxToggle.hasClass('searchbox-is-open')) {
                searchboxToggle.removeClass('searchbox-is-open');
                $('.container--searchbox-will-toggle').removeClass('searchbox-is-open');
                $('.searchbox__overlay').remove();
            }
        });
    }

    function coveoPaginationCustomizations(searchInterface) {
        Coveo.$$(searchInterface).on('newResultsDisplayed', function () {
            $(".coveo-pager-list li").each(function () {
                $(this).click(function () {
                    window.scrollTo(0, 0);
                });
            });
        });
    }

    function initSearchScrollPosition(searchInterface) {
        var initialSearch = true;
        Coveo.$$(searchInterface).on("newResultsDisplayed", function (event, args) {
            if (initialSearch) {
                initialSearch = false;
                var isPLP = $("body").hasClass("product-listing-page");
                if (isPLP) {
                    setLastScrollPosition();
                }
            }
        });
        $(window).on("unload", function () {
            var isPLP = $("body").hasClass("product-listing-page");
            if (isPLP) {
                saveLastScrollPostion();
            }
        });
        function saveLastScrollPostion() {
            if (!history) {
                return;
            }
            var scrollPosition = $(document).scrollTop();
            var stateObj = { scrollPosition: scrollPosition };
            history.replaceState(stateObj, "");
        }
        function setLastScrollPosition() {
            if (history && history.state && history.state.scrollPosition) {
                var verticalPos = history.state.scrollPosition;
                $(document).scrollTop(verticalPos);
                // Fallback in case of timing issue (mobile)
                if (window.innerWidth < 992) {
                    var interval = setInterval(function () {
                        if (document.readyState === "complete") {
                            clearInterval(interval);
                            $(document).scrollTop(verticalPos);
                        }
                    }, 1000);
                }
            }
        }
    }

    function toggleMarketingContent(searchInterface) {
        var isFilterPresent = false;
        var dynamicHierarchyFacetHasValue = false;
        Coveo.$$(searchInterface).on("deferredQuerySuccess", function (e, args) {
            //Check Hierarchy Facet for any value that isn't idle
            if ($(".CoveoDynamicHierarchicalFacet").length > 0) {
                (args.results.facets || []).forEach(function (facet) {
                    if (facet.facetId === "categories") {
                        //Check each category value for a selected value
                        dynamicHierarchyFacetHasValue = false;
                        (facet.values || []).forEach(function (value) {
                            if (value.state === "selected" || (value.children || []).length > 0) {
                                dynamicHierarchyFacetHasValue = true;
                            }
                        });
                    }
                });
            }
            var hideOnFilterElements = $(searchInterface).find(".ps-coveo--hide-on-filter");
            isFilterPresent = hideOnFilterElements.length > 0;
            if (isFilterPresent) {
                toggleContent(hideOnFilterElements);
            }
        });
        function toggleContent(el) {
            var checkedFacets = $(searchInterface)
                .find(".facet-container .coveo-facet-selectable.coveo-selected")
                .filter(function (i, element) {
                var isFacetHideEnabled = $($(element).parents(".CoveoFacet")[0]).attr("data-trigger-hide-on-filter");
                return isFacetHideEnabled === "false" || isFacetHideEnabled === "False" ? false : true;
            });
            var checkCatagories = $(searchInterface).find(".coveo-active-category-facet-parent");
            if (checkedFacets.length > 0 || checkCatagories.length > 0 || dynamicHierarchyFacetHasValue) {
                el.each(function (i) {
                    $(el[i]).hide();
                });
            }
            else {
                el.each(function (i) {
                    $(el[i]).show();
                });
            }
        }
    }

    function coveoFacetValueSearch(searchInterface) {
        function hideOptionsByTerm(term, elements) {
            elements.each(function () {
                var value = $(this).attr("data-value") || "";
                var isSelected = $(this).hasClass("coveo-selected");
                if (isSelected || value.length > 0 && value.toLowerCase().indexOf((term || "").toLowerCase()) > -1) {
                    $(this).show();
                }
                else {
                    $(this).hide();
                }
            });
        }
        function initFilterValuesInput(facets) {
            facets.each(function () {
                var facet = $(this);
                var markup = $("<div class='caleres-option-value-filter-input-container' data-has-value='false'><input class='caleres-option-value-filter-input' /><span class='icon-search'></span><span class='icon-remove'></span></div>");
                facet.find(".coveo-facet-header").after(markup);
                function getElements() {
                    return facet.find('.coveo-facet-value');
                }
                var input = facet.find(".caleres-option-value-filter-input");
                //Bind the <input /> to update visible options as its value changes
                input.on("input", function () {
                    hideOptionsByTerm(input.val(), getElements());
                    facet.find(".caleres-option-value-filter-input-container").attr("data-has-value", String(input.val() !== ""));
                });
                //Bind clearing click to remove button
                facet.find(".icon-remove").on("click", function () {
                    input.val("");
                    hideOptionsByTerm("", getElements());
                    facet.find(".caleres-option-value-filter-input-container").attr("data-has-value", "false");
                });
                //When Coveo loads in new options, reapply correct visibility of the options
                Coveo.$$(searchInterface).on("newResultDisplayed", function (e, args) {
                    setTimeout(function () {
                        var input = facet.find(".caleres-option-value-filter-input");
                        hideOptionsByTerm(input.val(), getElements());
                    }, 100);
                });
            });
        }
        //On page loads, look for Facets that have opted in to Value Search feature
        var facets = $(searchInterface).find('[data-caleres-facet-value-search="true"]');
        //Init this functionality exactly one time when Coveo results are ready
        var isInitialized = false;
        Coveo.$$(searchInterface).on("newResultsDisplayed", function (event, args) {
            if (!isInitialized) {
                isInitialized = true;
                initFilterValuesInput(facets);
            }
        });
    }

    function coveoErrorListener(searchInterface) {
        Coveo.$$(searchInterface).on("queryError", function (error, args) {
            if (window.NREUM && args && args.error) {
                var err = new Error("Coveo queryError: " + args.error.message);
                window.NREUM.noticeError(err, {
                    codeBlock: 'Coveo queryError',
                    urlWithParams: window.location.href
                });
            }
        });
    }

    function coveoCommonCustomizations(searchInterface) {
        // Coveo.$$(searchInterface).on("buildingQuery", function (e, args) {
        //     var root = document.body as HTMLElement;
        //     var facet = Coveo.$$(root).find('.CoveoFacet[data-field="@color"]');
        //     var facetInstance = Coveo.get(facet) as Coveo.Facet;
        // });
        /**
         * @description Globally expose the search interface
         */
        window.CALERES_COVEO_SEARCH_INTERFACE = searchInterface;
        /**
         * @function coveoInitLazyLoad
         * @description Initializes Lazy Component Loading if available, falls back to Eager. NOTE: Must be first function called here!
         */
        coveoInitLazyLoad();
        /**
         * @function initUrlWriter
         * @description Hooks into Coveo deferredQuerySuccess to re-write the url for category facets
         * @param searchInterface: Coveo.Dom
         */
        initUrlWriter(searchInterface);
        /**
         * @function initClearFilter
         * @description Sets up the click event for clearing all filter refinements.
         */
        initClearFilter(searchInterface);
        /**
         * @function coveoFacetCustomizations
         * @description: adds customizations to the Coveo Facet Rendering
         */
        coveoFacetCustomizations(searchInterface);
        /**
         * @function placePlpAdvertisements
         * @description: places unplaced plp ads based on data attrs
         */
        placePlpAdvertisements(searchInterface);
        /**
         * @function initAnalyticsEvents
         * @description Hooks into Coveo deferredQuerySuccess to raise pageview analytics events
         * @param searchInterface: Coveo.Dom
         */
        initCoveoAnalyticsEvents(searchInterface);
        /**
         * @function initClearSearchValues
         * @description Resets the search facets if the search term has changed
         * @param searchInterface: Coveo.Dom
         */
        initClearSearchValues(searchInterface);
        /**
         * @function coveoProductGroupRollup
         * @description Groups product colors for ProductGroupRollup
         */
        coveoProductGroupRollup(searchInterface);
        /* @function initCoveoSearchboxCustomizations
        * @description Closes the mobile search box when an item is picked
        * @param searchInterface: Coveo.Dom
        */
        initCoveoSearchboxCustomizations(searchInterface);
        /**
         * @function initSearchScrollPosition
         * @description Resets the last scroll position of the plp page
         * @param searchInterface: Coveo.Dom
         */
        initSearchScrollPosition(searchInterface);
        /**
         * @function coveoProductImageLazyLoad
         * @description Loads images on scroll instead of all at once.
         */
        coveoProductImageLazyLoad(searchInterface);
        /**
        * @function coveoPaginationCustomizations
        * @description Custom functionality for pagination.
        */
        coveoPaginationCustomizations(searchInterface);
        /**
         * @function toggleMarketingContent
         * @description Hides containers marked with Hide On Filter presentation style if present.
         */
        toggleMarketingContent(searchInterface);
        /**
         * @function coveoFacetValueSearch
         * @description Adds an <input> element that shows/hides options based on search term.
         */
        coveoFacetValueSearch(searchInterface);
        /**
         * @function coveoErrorListener
         * @description Adds logging when Coveo throws `queryError` event
         */
        coveoErrorListener(searchInterface);
    }

    /**
     * @function coveoSearchboxInteractions
     * @description Listens for Coveo global searchbox interaction events from any page and toggles classes for UI behavior
     */
    function coveoSearchboxInteractions() {
        var $body = $('body');
        var $searchboxToggle = $('.js-searchbox-toggle');
        var $searchboxContainer = $('.container--searchbox-will-toggle');
        /**
         * Adds an input event listener for Coveo Searchbox, then executes a callback function
         *
         * @param {String} input - Event type to listen for
         * @param {Function} function - Listener function
         */
        document.addEventListener('input', 
        /**
         *
         * @function Called when input event occurs, checks if event target is a child of .CoveoSearchbox and toggles a class if target value is not empty
         * @param {Event} e - Describes the event that just occurred
         * @returns targetParent adds a class or removes a class
         */
        function (e) {
            var target = e.target;
            var targetParent = $(target).parents('.CoveoSearchbox');
            if (targetParent && target.value) {
                targetParent.addClass('CoveoSearchbox--magic-box-notEmpty');
            }
            else {
                targetParent.removeClass('CoveoSearchbox--magic-box-notEmpty');
            }
            /**
             * @function closeSearchboxOnEnter - closes searchbox when enter key is pressed, removes event listener
             * @param e - KeyboardEvent
             */
            var closeSearchboxOnEnter = function (e) {
                var key = e.which || e.keyCode;
                if (key === 13) { // 13 is enter
                    closeSearchbox();
                    target.removeEventListener('keydown', closeSearchboxOnEnter, false);
                }
            };
            // listen for keyboard events on mobile search
            if (target.matches('.searchbox-is-open .CoveoSearchbox input')) {
                target.addEventListener('keydown', closeSearchboxOnEnter, false);
            }
        });
        /**
         * Adds a click event listener for Coveo Searchbox, then executes a callback function
         *
         * @param {String} click - Event type to listen for
         * @param {Function} function - Listener function
         */
        document.addEventListener('click', 
        /**
         *
         * @function Called when click event occurs, performs actions based on event target
         * @param {Event} e - Describes the event that just occurred
         */
        function (e) {
            var target = e.target;
            // clears icon when clear button is clicked
            if (target.matches('.magic-box-icon')) {
                $('.CoveoSearchbox').removeClass('CoveoSearchbox--magic-box-notEmpty');
            }
            // Contracts Expanding Searchbox (if present)
            if (target.matches('.ps-mobile-expand-searchbox')) {
                contractSearchBox(target);
            }
        });
        function contractSearchBox(targetElement) {
            // Execute if contract is necessary. Resets Searchbox width to 100% of parent  
            var searchBox = $(targetElement).find('.CoveoSearchbox');
            var searchBoxContainer = $(targetElement).find('.coveo-for-sitecore-search-box-container');
            if (searchBox.length && searchBoxContainer.length) {
                // If .CoveoSearchbox is wider than its parent container 
                if (searchBox.width() > searchBoxContainer.width()) {
                    // Animate width change
                    searchBox.animate({
                        width: "100%"
                    }, 400, "swing", function () {
                        // Make minicart icon, if present, visible again after Searchbox contracts
                        var minicartIcon = targetElement.nextElementSibling;
                        if (minicartIcon && minicartIcon.matches('.caleres-minicart-component')) {
                            minicartIcon.style.visibility = "";
                        }
                        // Hide Searchbox contract button 
                        targetElement.classList.remove("show-expand-searchbox-close-btn");
                    });
                }
            }
        }
        /**
         * Adds a focusin event listener for Coveo Searchbox, then executes a callback function
         *
         * @param {String} focusin - Event type to listen for
         * @param {Function} function - Listener function
         */
        document.addEventListener('focusin', 
        /**
         *
         * @function Called when focusin event occurs, performs actions based on event target
         * @param {Event} e - Describes the event that just occurred
         */
        function (e) {
            var target = e.target;
            // Check to see whether the focused element is a child of the expanding searchbox presentation style 
            var expandCol = $(target).parents('.ps-mobile-expand-searchbox');
            if (!expandCol.length) {
                return;
            }
            var expandColWidth = 0;
            var targetTagName = target.tagName; // .nodeName
            var targetType = target.attributes["type"];
            // If it is also our Searchbox input that is focused...  
            if (targetTagName === "INPUT" && targetType && targetType.value === "text") {
                // Get the width of the parent '.ps-mobile-expand-searchbox' element
                expandColWidth = expandCol.width();
            }
            if (expandColWidth) {
                // Expand the immediate parent .CoveoSearchbox relative to width of elements in this header 
                var searchBox = $(target).parents('.CoveoSearchbox');
                // Use .CoveoSearchbox container for constant starting width
                var searchBoxContainer = $(target).parents('.coveo-for-sitecore-search-box-container');
                if (searchBox.length && searchBoxContainer.length) {
                    var expandWidth = searchBoxContainer.width();
                    var adjustWidth = Math.round((expandColWidth - expandWidth) / 2);
                    if (adjustWidth > 0) {
                        expandWidth += adjustWidth;
                    }
                    $('.ps-mobile-hide-on-searchbox-expand').each(function () {
                        var column = $(this);
                        if (column.length) {
                            expandWidth += column.outerWidth(true);
                        }
                    });
                    // Animate width change
                    searchBox.animate({
                        width: expandWidth + "px"
                    }, 400, "swing", function () {
                        // Make minicart icon, if present, visible again after Searchbox contracts
                        var minicartIcon = expandCol.next();
                        if (minicartIcon.length && minicartIcon.hasClass("caleres-minicart-component")) {
                            minicartIcon.css("visibility", "hidden");
                        }
                        // Show Searchbox contract button 
                        expandCol.addClass('show-expand-searchbox-close-btn');
                    });
                }
            }
        });
        $body.on('click', '.js-searchbox-toggle', function (e) {
            e.preventDefault();
            // toggles searchbox open when icon is clicked
            if ($searchboxToggle.hasClass('searchbox-is-open')) {
                closeSearchbox();
            }
            else {
                closeMegaMenu();
                closeToggleContainer();
                openSearchbox();
            }
        });
        /**
         * @function closeSearchbox - DOM modifications to close mobile searchbox
         */
        var closeSearchbox = function () {
            $searchboxToggle.removeClass('searchbox-is-open');
            $searchboxContainer.removeClass('searchbox-is-open');
            $('.searchbox__overlay').remove();
        };
        /**
         * @function closeSearchbox - DOM modifications to open mobile searchbox
         */
        var openSearchbox = function () {
            $searchboxToggle.addClass('searchbox-is-open');
            $searchboxContainer.addClass('searchbox-is-open');
            $searchboxContainer.find('input').focus();
            $("<div class='searchbox__overlay'>")
                .appendTo($searchboxContainer)
                .click(function () {
                closeSearchbox();
            });
        };
        /**
         * @function closeMegaMenu - If mega menu is open when searchbox is opened, mega menu is closed (tablet/mobile only)
         */
        function closeMegaMenu() {
            if ($body.hasClass('megamenu-is-open')) {
                $body.removeClass('megamenu-is-open');
            }
        }
        /**
         * @function closeToggleContainer - If a toggled container exists and is open when searchbox is opened, toggled container is closed
         *                                  Ex. Via Spiga, where a toggled container replaces mega menu
         */
        function closeToggleContainer() {
            var $toggledContainer = $('.container--will-toggle');
            var $containerToggle = $('.js-container-toggle');
            if ($toggledContainer.length > 0 && $containerToggle.length > 0) {
                if ($toggledContainer.hasClass('container-is-open')) {
                    $toggledContainer.removeClass('container-is-open');
                }
                if ($containerToggle.hasClass('container-is-open')) {
                    $containerToggle.removeClass('container-is-open');
                }
                $body.removeClass('container-is-open');
                $('.container__overlay').remove();
            }
        }
    }

    function getQueryVariable(variable) 
    {
           var query = window.location.search.substring(1);
           var vars = query.split("&");
           for (var i=0;i<vars.length;i++) {
                   var pair = vars[i].split("=");
                   if(pair[0] == variable){return pair[1];}
           }
           return(false);
    }

    /**
     * @function setStickyHeaderPageCss
     * @description Gets height of sticky header, then adjusts the padding of the main container accordingly.
     */
    function setStickyHeaderPageCss() {
        var headerHeight;
        if ($('.ps-header--sticky-low').length) {
            headerHeight = $('.ps-header--sticky-low').height();
            $('#content').css('padding-top', headerHeight + 'px');
        }
        else if ($('.ps-header--sticky-medium').length) {
            headerHeight = $('.ps-header--sticky-medium').height();
            $('#content').css('padding-top', headerHeight + 'px');
        }
        var windowWidth = window.innerWidth;
        if (getQueryVariable('sc_mode') !== 'edit' && $('.ps-common--fixed-top').length && windowWidth >= 992) {
            var top = headerHeight + 'px';
            var width = $('.ps-common--fixed-top').width() + 'px';
            $('.ps-common--fixed-top').css({
                'position': 'fixed',
                'top': top,
                'width': width
            });
        }
    }

    function initCaleresAnalyticsEvents() {
        try {
            // raise events when error message is invoked the the message context broker
            MessageContext.SubscribeErrorHandler(function () {
                if (!window.data) {
                    return;
                }
                if (arguments.length >= 2) {
                    window.data.event('errorEvent', {
                        errorLocation: getLocationString(arguments[0]),
                        errorMessage: getMessageString(arguments[1])
                    });
                }
            });
            /**
             * @description payment type events
             */
            // raise event when paypal button is clicked in cart
            $('body').on('click touchstart', '.caleres-paypalcart-component .PayPalButton', function () {
                if (!window.data) {
                    return;
                }
                window.data.event('checkoutPaypalExpress');
            });
            // Google Pay: MiniCart
            $('body').on('click touchstart', '.caleres-minicart-component .google-pay-button button', function () {
                if (!window.data) {
                    return;
                }
                window.data.event('miniCartGooglePay');
            });
            // Google Pay: Cart
            $('body.shopping-cart-page').on('click touchstart', '.google-pay-button button', function () {
                if (!window.data) {
                    return;
                }
                window.data.event('cartGooglePay');
            });
            // Google Pay: Checkout Billing Page
            $('body.checkout.checkout-delivery-page').on('click touchstart', '.google-pay-button button', function () {
                if (!window.data) {
                    return;
                }
                window.data.event('checkoutGooglePay');
            });
            // Apple Pay: MiniCart
            $('body').on('click touchstart', '.caleres-minicart-component .caleres-applepay-component .apple-pay-button', function () {
                if (!window.data) {
                    return;
                }
                window.data.event('miniCartApplePay');
            });
            // Apple Pay: Cart
            $('body.shopping-cart-page').on('click touchstart', '.caleres-applepay-component .apple-pay-button', function () {
                if (!window.data) {
                    return;
                }
                window.data.event('cartApplePay');
            });
            // Apple Pay: Checkout Billing Page
            $('body.checkout.checkout-delivery-page').on('click touchstart', '.caleres-applepay-component .apple-pay-button', function () {
                if (!window.data) {
                    return;
                }
                window.data.event('checkoutApplePay');
            });
            /**
             * @description raise events for the search box
             */
            // keep track of the value in the search box
            var searchBoxValue = '';
            $(document).on('change paste keyup', '.magic-box-input input', function (event) {
                searchBoxValue = event.target.value;
            });
            // raise event when suggestion is clicked/touched
            $(document).on('click touchstart', '.magic-box-suggestion.coveo-omnibox-selectable', function (event) {
                if (!window.data) {
                    return;
                }
                window.data.event('searchSuggestionClicked', { userTyped: searchBoxValue, suggestionUsed: event.currentTarget.innerText });
            });
            // ToDo: raise event if arrow controls were used to use suggestion, then enter key was pressed
            /**
             * @description Raise events for PDP Zoom
             */
            $('.mz-ready').on('click touchstart', function () {
                if (!window.data) {
                    return;
                }
                if ($(this).hasClass('mz-active')) {
                    var productData = window.data.get('product');
                    window.data.event('zoomProdImg', {
                        productID: productData.productInfo.productID,
                        productName: productData.productInfo.productName,
                        size: productData.productInfo.size,
                        width: productData.productInfo.width,
                        color: productData.productInfo.color,
                        manufacturer: productData.productInfo.manufacturer,
                        price: productData.attributes.currentPrice,
                        prodImgPosition: productData.attributes.prodImgPosition
                    });
                }
            });
            /**
             * @description raise View Promo Details event from cart (when info icon next to promo is clicked on)
             */
            $('body').on('click touchstart', '.icon-info.pc-details-modal__invoke', function () {
                if (!window.data) {
                    return;
                }
                var promoValue = $(this).siblings('.added-promotion-code').text();
                var eventString = 'View ' + promoValue + ' Details';
                window.data.event('clickEvent', {
                    linkName: eventString
                });
            });
            /**
             * @description: process started for True Fit
             */
            $('body').on('click touchstart', '.tfc-cfg-basic-button', function () {
                if (!window.data) {
                    return;
                }
                window.data.event('processevent', {
                    processAction: 'start',
                    processName: 'true fit'
                });
            });
        }
        catch (err) {
            console.log('Error raising analytics event: ', err);
        }
    }
    /**
     * @description Reads objects passed into MessageContext.PublishError to the decide location of the error
     */
    function getLocationString(locationArgument) {
        if (typeof locationArgument === 'undefined' || locationArgument === null) {
            var locationString = 'Unknown Location';
            if (window.data) {
                locationString = window.data.get('page.category.primaryCategory') || 'Unknown Location';
            }
            return locationString;
        }
        if (typeof locationArgument === 'string') {
            return locationArgument;
        }
        var locationString = 'Unknown Location';
        if (typeof locationArgument.type !== 'undefined' && locationArgument.type === 'ajaxError') {
            locationString = 'AjaxService';
        }
        else if (typeof locationArgument.Name !== 'undefined') {
            locationString = locationArgument.Name;
        }
        else if (typeof locationArgument.LoadedComponents !== 'undefined') {
            locationString = 'CXAApplication';
        }
        else if (window.data) {
            locationString = window.data.get('page.category.primaryCategory') || 'Unknown Location';
        }
        return locationString;
    }
    /**
     * @description Eliminates objects passed into the message parameter
     */
    function getMessageString(messageArgument) {
        if (typeof messageArgument === 'undefined' || messageArgument === null) {
            return 'Unknown Error';
        }
        if (typeof messageArgument === 'string') {
            return messageArgument;
        }
        else {
            return "Unknown Error";
        }
    }

    /**
     * Implement an exposed version of MemoryStorage for Cognito
     * Referenced from https://github.com/aws-amplify/amplify-js/blob/master/packages/amazon-cognito-identity-js/src/StorageHelper.js
     */
    var dataMemory = {};
    /** @class */
    var MemoryStorage = /** @class */ (function () {
        function MemoryStorage() {
        }
        /**
         * This is used to set a specific item in storage
         * @param {string} key - the key for the item
         * @param {object} value - the value
         * @returns {string} value that was set
         */
        MemoryStorage.setItem = function (key, value) {
            dataMemory[key] = value;
            return dataMemory[key];
        };
        /**
         * This is used to get a specific key from storage
         * @param {string} key - the key for the item
         * This is used to clear the storage
         * @returns {string} the data item
         */
        MemoryStorage.getItem = function (key) {
            return Object.prototype.hasOwnProperty.call(dataMemory, key)
                ? dataMemory[key]
                : undefined;
        };
        /**
         * This is used to remove an item from storage
         * @param {string} key - the key being set
         * @returns {string} value - value that was deleted
         */
        MemoryStorage.removeItem = function (key) {
            return delete dataMemory[key];
        };
        /**
         * This is used to clear the storage
         * @returns {string} nothing
         */
        MemoryStorage.clear = function () {
            dataMemory = {};
            return dataMemory;
        };
        return MemoryStorage;
    }());

    function initUrlPromoCodes() {
        /**
         * Get the URL parameters
         * source: https://css-tricks.com/snippets/javascript/get-url-variables/
         * @param  {String} url The URL
         * @return {Object}     The URL parameters
         */
        function getParams(url) {
            var params = {};
            var parser = document.createElement('a');
            parser.href = url;
            var query = parser.search.substring(1);
            var vars = query.split('&');
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split('=');
                params[pair[0]] = decodeURIComponent(pair[1]);
            }
            return params;
        }
        var url = window.location;
        var urlParameters = getParams(url);
        if ("promoCode" in urlParameters) {
            applyPromoCode(urlParameters["promoCode"]);
        }
        if ("rewardsCode" in urlParameters) {
            applyRewardsCode(urlParameters["rewardsCode"]);
        }
        function applyPromoCode(promoCode) {
            AjaxService.Post("/api/cxa/cart/ApplyDiscount", {
                promotionCode: promoCode
            }, function (data, success) {
                if (success && data.Success) {
                    try {
                        if (window.data) {
                            // analytics
                            var dataLayer = window.data;
                            dataLayer.event('processevent', {
                                processName: 'apply promo code from app',
                                processAction: 'complete'
                            });
                        }
                    }
                    catch (err) {
                        console.log('Error raising analytics event: ', err);
                    }
                    MessageContext.ClearAllMessages();
                    MessageContext.PublishSuccess("urlapplypromo", "Promo successfully applied");
                    CartContext.TriggerCartUpdateEvent(data);
                }
                if (data.Errors.length > 0) {
                    data.Errors.forEach(function (error, i) {
                    });
                }
            });
        }
        function applyRewardsCode(rewardsCode) {
            AjaxService.Post("/api/calxa/Cart/ApplyPromotionCodes", {
                promotionCodesToAdd: [rewardsCode],
                promotionCodesToRemove: []
            }, function (data, success) {
                if (success && data.Success) {
                    try {
                        if (window.data) {
                            // analytics
                            var dataLayer = window.data;
                            dataLayer.event('processevent', {
                                processName: 'apply reward code from app',
                                processAction: 'complete'
                            });
                        }
                    }
                    catch (err) {
                        console.log('Error raising analytics event: ', err);
                    }
                    MessageContext.ClearAllMessages();
                    MessageContext.PublishSuccess("urlapplyreward", "Reward successfully applied");
                    CartContext.TriggerCartUpdateEvent(data);
                }
                if (data.Errors && data.Errors.length > 0) {
                    console.log(data.Errors);
                    data.Errors.forEach(function (error, i) {
                    });
                }
            });
        }
    }

    function initBazaarVoiceCallbacks() {
        if (!window.$BV) {
            return;
        }
        window.$BV.configure('global', {
            events: {
                submissionSubmitted: function (data) {
                    var customerNumber = localStorage.getItem('customerNumber');
                    if (!customerNumber) {
                        return;
                    }
                    if (data && data.contentType === 'review') {
                        addReviewedProduct(customerNumber, data.Id);
                    }
                }
            }
        });
        function addReviewedProduct(customerNumber, productId) {
            var reviewedProducts = getReviewedProducts();
            reviewedProducts.push({
                "customerNumber": customerNumber,
                "productId": productId
            });
            var reviewedProductsCookie = '';
            reviewedProducts.forEach(function (product, index) {
                reviewedProductsCookie += product.customerNumber + ',' + product.productId;
                if (index != reviewedProducts.length - 1) {
                    reviewedProductsCookie += '|';
                }
            });
            Cookies.set('RecentlyReviewedProducts', reviewedProductsCookie, { expires: 7, path: '' });
        }
        function getReviewedProducts() {
            var reviewedProductsCookie = Cookies.get('RecentlyReviewedProducts');
            var reviewedProducts = [];
            if (!reviewedProductsCookie) {
                return reviewedProducts;
            }
            var products = reviewedProductsCookie.split('|');
            products.forEach(function (product) {
                var productParts = product.split(',');
                reviewedProducts.push({
                    "customerNumber": productParts[0],
                    "productId": productParts[1]
                });
            });
            return reviewedProducts;
        }
    }

    // https://tc39.github.io/ecma262/#sec-array.prototype.find
    //Support Array.find in IE11
    if (!Array.prototype.find) {
        Object.defineProperty(Array.prototype, 'find', {
            value: function(predicate) {
                // 1. Let O be ? ToObject(this value).
                if (this == null) {
                    throw new TypeError('"this" is null or not defined');
                }

                var o = Object(this);

                // 2. Let len be ? ToLength(? Get(O, "length")).
                var len = o.length >>> 0;

                // 3. If IsCallable(predicate) is false, throw a TypeError exception.
                if (typeof predicate !== 'function') {
                    throw new TypeError('predicate must be a function');
                }

                // 4. If thisArg was supplied, let T be thisArg; else let T be undefined.
                var thisArg = arguments[1];

                // 5. Let k be 0.
                var k = 0;

                // 6. Repeat, while k < len
                while (k < len) {
                    // a. Let Pk be ! ToString(k).
                    // b. Let kValue be ? Get(O, Pk).
                    // c. Let testResult be ToBoolean(? Call(predicate, T, « kValue, k, O »)).
                    // d. If testResult is true, return kValue.
                    var kValue = o[k];
                    if (predicate.call(thisArg, kValue, k, o)) {
                        return kValue;
                    }
                    // e. Increase k by 1.
                    k++;
                }

                // 7. Return undefined.
                return undefined;
            },
            configurable: true,
            writable: true
        });
    }

    /*! js-cookie v3.0.0-rc.0 | MIT */
    !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self,function(){var r=e.Cookies,n=e.Cookies=t();n.noConflict=function(){return e.Cookies=r,n};}());}(undefined,function(){function e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n];}return e}var t={read:function(e){return e.replace(/%3B/g,";")},write:function(e){return e.replace(/;/g,"%3B")}};return function r(n,i){function o(r,o,u){if("undefined"!=typeof document){"number"==typeof(u=e({},i,u)).expires&&(u.expires=new Date(Date.now()+864e5*u.expires)),u.expires&&(u.expires=u.expires.toUTCString()),r=t.write(r).replace(/=/g,"%3D"),o=n.write(String(o),r);var c="";for(var f in u)u[f]&&(c+="; "+f,!0!==u[f]&&(c+="="+u[f].split(";")[0]));return document.cookie=r+"="+o+c}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],i={},o=0;o<r.length;o++){var u=r[o].split("="),c=u.slice(1).join("="),f=t.read(u[0]).replace(/%3D/g,"=");if(i[f]=n.read(c,f),e===f)break}return e?i[e]:i}},remove:function(t,r){o(t,"",e({},r,{expires:-1}));},withAttributes:function(t){return r(this.converter,e({},this.attributes,t))},withConverter:function(t){return r(e({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(n)}})}(t,{path:"/"})});

    /**
     * @description Toggle password visibility on click
     *
     */
    /**
    * @function maskPhoneInputs - looks for type="tel" inputs and handles phone number formatting
    *
    **/
    (function () {
        $(".toggle-password").click(function () {
            var input = $(this).siblings("input");
            if (input.attr("type") == "password")
                input.attr("type", "text");
            else
                input.attr("type", "password");
            $(this).hide();
            $(this).siblings(".toggle-password").show();
        });
    })();

    /**
     * @description Reusable Regex patterns for validation
     *
     */
    window["VALIDATION_PATTERNS"] = {
        NAME: "^(?:[\\s\\w\\d'.,-]|[^\\u0000-\\u0080])+$",
        PHONE: "^(\\(?\\d{3}\\)|\\d{3}[-,\\s,\\.]?)?\\s?\\d{3}[-,\\s\\.]?\\d{4}(\\s{0,}x\\d{1,8})?$",
        PO_BOX: "^((?!\\b(?:p\\.?\\s*o(?:(?=\\.)\\.\\s*|(?!\\.)\\s*)|post\\s+office\\s+)box\\d*?\\b).)*$",
        NONCONTIGUOUS_STATE: "^(?![Aa][Kk]|[Hh][Ii])",
        ZIP_POSTALCODE: "(?:^\\d{5}([\\-]\\d{4})?$)|(?:^[ABCEGHJKLMNPRSTVXY]{1}\\d{1}[A-Z]{1} *\\d{1}[A-Z]{1}\\d{1}$)",
        POSTALCODE: "^[ABCEGHJKLMNPRSTVXY][0-9][ABCEGHJKLMNPRSTVWXYZ][\\s\\-]?[0-9][ABCEGHJKLMNPRSTVWXYZ][0-9]$",
        ZIPCODE: "^[0-9]{5}([\s\-]?[0-9]{4})?$",
        PASSWORD: "^[\S]{6,}$",
        EMAIL: "^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$",
        TRANSACTION_DATE: "^([0-2][0-9]|(3)[0-1])(\/)(((0)[0-9])|((1)[0-2]))(\/)\d{4}$",
        ORDER_NUMBER: "^[a-zA-Z0-9]+$",
        ORDER_TRACKING_NUMBER: "^[-a-zA-Z0-9]+$",
        AT_LEAST_ONE_NUMBER: ".*[0-9].*",
        CURRENCY: "^[0-9]*\.[0-9]{2}$",
        ASCII: "^[\\x20-\\x7Eàâçéèêëîíïôûùüÿñæœ]*$"
    };

    /**
     * @description Extensions to knockoutjs
     *
     */
    /**
    * @function stopBinding - used to ignore binding sections of markup. Used for nesting knockout components
    *
    **/
    ko.bindingHandlers.stopBinding = {
        init: function () {
            return { controlsDescendantBindings: true };
        }
    };
    /**
    * @function phoneNumber - applies formatting to phone numbers as it is bound
    *
    **/
    ko.bindingHandlers.phoneNumber = {
        init: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
            ko.bindingHandlers.value.init(element, valueAccessor, allBindings, viewModel, bindingContext);
            $(element).on('input', function () {
                var elementValue = element.value;
                if (elementValue) {
                    var newValue = valueAccessor();
                    var x = elementValue.replace(/\D/g, '').match(/(\d{0,3})(\d{0,3})(\d{0,4})?(\d{0,8})/);
                    var formattedNumber = !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '') + (x[4] ? ' x' + x[4] : '');
                    newValue(formattedNumber);
                }
            });
        },
        update: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
            var value = valueAccessor();
            if (value()) {
                var x = value().replace(/\D/g, '').match(/(\d{0,3})(\d{0,3})(\d{0,4})?(\d{0,8})/);
                var formattedNumber = !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '') + (x[4] ? ' x' + x[4] : '');
                value(formattedNumber);
            }
        }
    };
    /**
    * @function enterkey - used to fire an event when the enter key is pressed
    *
    **/
    ko.bindingHandlers.enterkey = {
        init: function (element, valueAccessor, allBindings, viewModel) {
            var callback = valueAccessor();
            $(element).keypress(function (event) {
                var keyCode = (event.which ? event.which : event.keyCode);
                if (keyCode === 13) {
                    element.blur();
                    callback.call(viewModel);
                    return false;
                }
                return true;
            });
        }
    };
    /**
    * @function class - new binding to dynamically bind a class name
    *
    **/
    ko.bindingHandlers.class = {
        'update': function (element, valueAccessor) {
            var value = ko.utils.unwrapObservable(valueAccessor());
            ko.utils.toggleDomNodeCssClass(element, element['__ko__cssValue'], false);
            element['__ko__cssValue'] = value;
            ko.utils.toggleDomNodeCssClass(element, value, true);
        }
    };
    /**
    * @function loading - changes the text when button is loading
    *
    **/
    ko.bindingHandlers.loading = {
        init: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
            ko.bindingHandlers.value.init(element, valueAccessor, allBindings, viewModel, bindingContext);
            var textData = {
                originalText: $(element).html()
            };
            ko.utils.domData.set(element, "loadingbinding", textData);
        },
        update: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
            var value = valueAccessor();
            var valueUnwrapped = ko.unwrap(value);
            var loadingText = !allBindings.get('loadingText') ? "loading..." : allBindings.get('loadingText');
            var textData = ko.utils.domData.get(element, "loadingbinding");
            if (valueUnwrapped) {
                $(element).html(loadingText);
                $(element).prop("disabled", true);
            }
            else {
                $(element).html(textData.originalText);
                $(element).prop("disabled", false);
            }
        }
    };
    /* eslint-disable max-params */
    /* Cannot reduce the number of params as the init and update callback method definitions are defined by knockout.js */
    /* Originally in ootb cart-checkout-delivery-model */
    ko.bindingHandlers.checkMe = {
        init: function (element, valueAccessor, all, vm, bindingContext) {
            ko.utils.registerEventHandler(element, "click", function () {
                var checkedValue = valueAccessor(), meValue = bindingContext.$data, checked = element.checked;
                if (checked && ko.isObservable(checkedValue)) {
                    checkedValue(meValue);
                }
            });
        },
        update: function (element, valueAccessor, all, vm, bindingContext) {
            var checkedValue = ko.utils.unwrapObservable(valueAccessor()), meValue = bindingContext.$data;
            element.checked = checkedValue === meValue;
        }
    };

    /**
     * @description Custom validation rules for knockout
     *
     */
    ko.validation.init({
        errorElementClass: 'input-validation-error',
        decorateInputElement: true,
    });
    /**
    * @function postalcode - validates that an input is a valid CA postal code
    *
    **/
    ko.validation.rules['postalcode'] = {
        validator: function (val) {
            var regex = new RegExp(window["VALIDATION_PATTERNS"].POSTALCODE, "i");
            return regex.test(val);
        },
        message: 'Please enter a valid Postal code'
    };
    /**
    * @function zipcode - validates that an input is a valid US zip code
    *
    **/
    ko.validation.rules['zipcode'] = {
        validator: function (val) {
            var regex = new RegExp(window["VALIDATION_PATTERNS"].ZIP_POSTALCODE);
            return regex.test(val);
        },
        message: 'Please enter a valid ZIP code'
    };
    /**
    * @function zippostalcode - validates that an input is a valid US zip or Canadian postal code
    *
    **/
    ko.validation.rules['zipPostalcode'] = {
        validator: function (val) {
            var zipRegex = new RegExp(window["VALIDATION_PATTERNS"].ZIPCODE);
            var postalRegex = new RegExp(window["VALIDATION_PATTERNS"].POSTALCODE, "i");
            return zipRegex.test(val) || postalRegex.test(val);
        },
        message: 'Please enter a valid ZIP or postal code'
    };
    /**
    * @function phone - validates that an input is a valid phone number
    *
    **/
    ko.validation.rules['phone'] = {
        validator: function (val) {
            var regex = new RegExp(window["VALIDATION_PATTERNS"].PHONE);
            return regex.test(val);
        },
        message: 'Please enter your phone number'
    };
    /**
    * @function poBox - validates that an input is not a PO Box
    *
    **/
    ko.validation.rules['poBox'] = {
        validator: function (val) {
            var regex = new RegExp(window["VALIDATION_PATTERNS"].PO_BOX, "i");
            return regex.test(val);
        },
        message: 'We cannot ship to P.O. Box addresses'
    };
    /**
    * @function name - validates that an input is a valid name
    *
    **/
    ko.validation.rules['name'] = {
        validator: function (val) {
            var regex = new RegExp(window["VALIDATION_PATTERNS"].NAME);
            return regex.test(val);
        },
        message: 'Please enter a valid name'
    };
    ko.validation.registerExtenders();
    /**
    * @function password - validates that an input is a valid password.
    *
    **/
    ko.validation.rules['password'] = {
        validator: function (val) {
            var regex = new RegExp(window["VALIDATION_PATTERNS"].PASSWORD);
            return !regex.test(val);
        },
        message: 'The password does not meet the requirements'
    };
    /**
    * @function Email - validates that an input is a valid email
    *
    **/
    ko.validation.rules['email'] = {
        validator: function (val) {
            var regex = new RegExp(window["VALIDATION_PATTERNS"].EMAIL);
            return regex.test(val);
        },
        message: 'Please enter a valid email'
    };
    /**
    * @function Order - validates that an input is a valid email or order number
    *
    **/
    ko.validation.rules['orderNumberEmail'] = {
        validator: function (val) {
            var emailRegex = new RegExp(window["VALIDATION_PATTERNS"].EMAIL);
            var orderNumberRegex = new RegExp(window["VALIDATION_PATTERNS"].ORDER_TRACKING_NUMBER);
            return emailRegex.test(val) || orderNumberRegex.test(val);
        },
        message: 'Please enter a valid email or order number'
    };
    /**
    * @function TransactionDate - validates that an input is a valid transaction date
    *
    **/
    ko.validation.rules['transactionDate'] = {
        validator: function (val) {
            var dateRegex = new RegExp(window["VALIDATION_PATTERNS"].TRANSACTION_DATE);
            return dateRegex.test(val);
        },
        message: 'Please enter a valid transaction date'
    };
    ko.validation.rules['storeNumber'] = {
        validator: function (val) {
            var dateRegex = new RegExp(window["VALIDATION_PATTERNS"].AT_LEAST_ONE_NUMBER);
            return dateRegex.test(val);
        },
        message: 'Please enter a valid store number'
    };
    ko.validation.rules['transactionNumber'] = {
        validator: function (val) {
            var dateRegex = new RegExp(window["VALIDATION_PATTERNS"].AT_LEAST_ONE_NUMBER);
            return dateRegex.test(val);
        },
        message: 'Please enter a valid transaction number'
    };
    ko.validation.rules['registerNumber'] = {
        validator: function (val) {
            var dateRegex = new RegExp(window["VALIDATION_PATTERNS"].AT_LEAST_ONE_NUMBER);
            return dateRegex.test(val);
        },
        message: 'Please enter a valid register number'
    };
    ko.validation.rules['orderSubtotal'] = {
        validator: function (val) {
            var dateRegex = new RegExp(window["VALIDATION_PATTERNS"].CURRENCY);
            return dateRegex.test(val);
        },
        message: 'Please enter a valid subtotal'
    };
    ko.validation.rules['orderNumber'] = {
        validator: function (val) {
            var dateRegex = new RegExp(window["VALIDATION_PATTERNS"].ORDER_NUMBER);
            return dateRegex.test(val);
        },
        message: 'Please enter a valid order number'
    };
    ko.validation.rules['mustBeAscii'] = {
        validator: function (val) {
            var asciiRegex = new RegExp(window["VALIDATION_PATTERNS"].ASCII);
            return asciiRegex.test(val);
        },
        message: 'The value is in an invalid format'
    };
    ko.validation.registerExtenders();

    var autocomplete;
    /**
     * @function loadGoogleAPIScript
     * @param {function} callback - A callback function that will fire after Google API script has loaded
     * @description Loads Google API script for address autocomplete functionality. Example usage: Checkout AddressForm
     */
    function loadGoogleAPIScript(callback) {
        var key, scriptsHaveLoaded = false, callbacks = [], loading = false;
        var loadScript = function (key, callback) {
            //save each callback and call them all when script will be loaded - protection for loading maps twice
            callbacks.push(callback);
            if (!loading) {
                loading = true;
                var script = document.createElement("script"), src = "//maps.googleapis.com/maps/api/js?v=3.exp";
                script.type = "text/javascript";
                if (typeof key !== "undefined" && key !== "") {
                    src += "&key=" + key;
                }
                else {
                    console.log("API key is missing. This needs to be set in Content Editor.");
                }
                src += "&libraries=places&callback=loadGoogleAPIScript.scriptsLoaded";
                script.src = src;
                script.onload = function () {
                    console.log("Google loader has been loaded, waiting for maps api");
                };
                document.body.appendChild(script);
            }
        };
        var scriptsLoaded = function () {
            var i, length = callbacks.length;
            for (i = 0; i < length; i++) {
                callbacks[i].call();
            }
            loading = false;
            scriptsHaveLoaded = true;
        };
        var i, elem = $(".js-google-autocomplete"), count = elem.length;
        if (count > 0) {
            for (i = 0; i < count; i++) {
                var $elem = $(elem[i]);
                key = $elem.data("key");
            }
            if (!scriptsHaveLoaded) {
                loadScript(key, callback);
            }
            else {
                console.log('scripts have not loaded');
            }
        }
        // set scriptsLoaded to window level variable, so it can be referenced as a callback param in script reference
        window.loadGoogleAPIScript.scriptsLoaded = scriptsLoaded;
    }
    /**
        * @function googleAutoComplete
        * @description Used as a callback function in cart-checkout-delivery.js after loadGoogleAPIScript loads. Sets up Google autocomplete object and listens for place_changed event.
        */
    function googleAutoComplete(autocompleteCallback) {
        var addressElement = document.getElementById('address-form__field--address1');
        addressElement = addressElement ? addressElement : document.getElementsByClassName('address-form__field--address1')[0];
        if (addressElement) {
            autocomplete = new google.maps.places.Autocomplete(addressElement, { types: ['geocode'] });
            autocomplete.setComponentRestrictions({ 'country': location.host.substr(-3) == '.ca' ? 'ca' : 'us' });
            // Remove all place_changed listeners from autocomplete instance
            google.maps.event.clearListeners(autocomplete, 'place_changed');
            // when place has changed, trigger fillInAddress
            autocomplete.addListener('place_changed', autocompleteCallback);
            // prevents form from being submitted only when selecting autocomplete suggestion
            google.maps.event.addDomListener(addressElement, 'keydown', function (event) {
                if (event.keyCode === 13 && $('.pac-container:visible').length) {
                    event.preventDefault();
                }
            });
        }
    }
    /**
     * @function googleGetPlaceDetails
     * @description Used as a callback function in googleAutoComplete when place_changed event occurs. Gets place details and
     */
    function googleGetPlaceDetails() {
        // Get the place details from the autocomplete object.
        var place = autocomplete.getPlace();
        var addressForm = {
            addressLine1: '',
            addressLine2: '',
            streetNumber: '',
            street: '',
            city: '',
            state: '',
            zip: ''
        };
        // Get each component of the address from the place details and set to addressForm object
        for (var i = 0; i < place.address_components.length; i++) {
            var addressType = place.address_components[i].types[0];
            switch (addressType) {
                case 'street_number':
                    addressForm.streetNumber = place.address_components[i].short_name;
                    break;
                case 'route':
                    addressForm.street = place.address_components[i].short_name;
                    break;
                case 'locality':
                case 'sublocality_level_1':
                    addressForm.city = place.address_components[i].long_name;
                    break;
                case 'administrative_area_level_1':
                    addressForm.state = place.address_components[i].short_name;
                    break;
                case 'postal_code':
                    addressForm.zip = place.address_components[i].short_name;
                    break;
            }
        }
        // Massaging the details for a few fields
        addressForm.addressLine1 = addressForm.streetNumber + ' ' + addressForm.street;
        // Fix address line 1.
        if (addressForm.addressLine1.length > 30) {
            var index = addressForm.addressLine1.substring(0, 30).lastIndexOf(' ');
            addressForm.addressLine2 = addressForm.addressLine1.substring(index + 1);
            addressForm.addressLine1 = addressForm.addressLine1.substring(0, index);
        }
        // autofill input fields with addressForm
        googleAutoFillInputs(addressForm);
        // returns addressForm for updating view models 
        return addressForm;
    }
    /**
     * @function googleAutoFillInputs
     * @param {object} addressForm - updated address form values from autocomplete object
     * @description Updates form input fields with autocomplete values
     */
    function googleAutoFillInputs(addressForm) {
        if ($(".address-form__field--address1").length !== 0) {
            $('.address-form__field--address1')
                .each(function () {
                $(this).val(addressForm.addressLine1);
            });
            $('.address-form__field--address2')
                .each(function () {
                $(this).val(addressForm.addressLine2);
            });
            $('.address-form__field--city')
                .each(function () {
                $(this).val(addressForm.city);
            });
            $('.address-form__field--state')
                .each(function () {
                $(this).val(addressForm.state);
            }).change();
            $('.address-form__field--zip')
                .each(function () {
                $(this).val(addressForm.zip);
            });
        }
    }
    /**
     * @description sets functions to window variable, so they are acessible elsewhere (ex: commerce base themes)
     */
    window.loadGoogleAPIScript = loadGoogleAPIScript;
    window.googleAutoComplete = googleAutoComplete;
    window.googleGetPlaceDetails = googleGetPlaceDetails;

    /**
     * @description Invokes custom half screen modal on PDP page when Magic Zoom Product Images rendering variant is used.
     *
     */
    var mzBgTabletElement = document.querySelector(".mz-bg--tablet");
    document.addEventListener('DOMContentLoaded', function () {
        // TESTING, REMOVE WHEN PRESENTATION STYLES ARE ADDED 
        //var scComponent = document.querySelector(".cxa-productimages-component");
        //scComponent.classList.add("cxa-productimages-component--below");
        if (window.innerWidth == 768) { // Only need this for tablet
            document.body.addEventListener("DOMNodeInserted", function (event) {
                var eventTarget = event.target;
                if (eventTarget.classList != undefined && eventTarget.classList.value == "mz-expand") {
                    mzBgTabletElement.style.display = "block";
                }
            }, false);
        }
    });

    /**
     * @description Invokes promotion codes details modal
     *
     */
    var pcDetailsModal = document.querySelector('.pc-details-modal');
    document.addEventListener('DOMContentLoaded', function () {
        document.addEventListener('click', function (e) {
            var target = e.target;
            if (target.matches('.pc-details-modal__invoke')) {
                var content = target.dataset.content;
                var defaultContent = pcDetailsModal.querySelector('.pc-details-modal--body.default');
                var dynamicContent = pcDetailsModal.querySelector('.pc-details-modal--body.dynamic');
                if (content) {
                    dynamicContent.innerHTML = content;
                    dynamicContent.style.display = "block";
                    defaultContent.style.display = "none";
                }
                else {
                    dynamicContent.innerHTML = '';
                    dynamicContent.style.display = "none";
                    defaultContent.style.display = "block";
                }
                pcDetailsModal.style.display = "block";
            }
            if (target.matches('.pc-details-modal') || target.matches('.pc-details-modal__close')) {
                pcDetailsModal.style.display = "none";
            }
        });
    });

    /**
     * @description Invokes the Select Shipping Speed Details modal
     *
     */
    var ssDetailsModal = document.querySelector('.ss-details-modal');
    document.addEventListener('DOMContentLoaded', function () {
        document.addEventListener('click', function (e) {
            var target = e.target;
            if (target.matches('.ss-details-modal__invoke')) {
                ssDetailsModal.style.display = "block";
            }
            if (target.matches('.ss-details-modal') || target.matches('.ss-details-modal__close')) {
                ssDetailsModal.style.display = "none";
            }
        });
    });

    /**
     * @description Add Coveo-like expand/collapse functionality to link list if it's placed within
     * a '.component.facet-container' element. For mobile/tablet only
     */
    // If user is at or below tablet/mobile breakpoint...
    var mdUpperPx = 991; // Max breakpoint tablet/mobile 
    var headerSelector = document.querySelector('.component.facet-container .link-list .component-content > div');
    if (headerSelector != null) {
        headerSelector.classList.add('link-list-header');
    }
    if (window.innerWidth <= mdUpperPx) {
        var linkList = document.querySelector('.component.facet-container .link-list .component-content');
        // And the .link-list component exists inside .component.facet-container
        if (linkList != null) {
            document.addEventListener('DOMContentLoaded', function () {
                var linkListHeader = linkList.querySelector('.link-list-header');
                // And the .link-list header is present 
                if (linkListHeader != null) {
                    linkListHeader.addEventListener('click', function (e) {
                        var linkListContent = linkList.querySelector('ul');
                        if (linkListContent != null) {
                            $(linkListContent).toggle();
                            if (linkListContent.style.display != "none") {
                                linkListHeader.classList.add('expand');
                            }
                            else {
                                linkListHeader.classList.remove('expand');
                            }
                        }
                    });
                }
            });
        }
    }

    /**
     * @description Toggle a container open/closed by clicking an icon
     */
    $(document).ready(function () {
        var $body = $('body');
        var $toggledContainer = $('.container--will-toggle');
        var $containerToggle = $('.js-container-toggle');
        var mdUpperPx = 991; // Max breakpoint tablet/mobile 
        /**
         * @function openContainer - adds classes to indicate container is open. adds overlay markup
         */
        function openContainer() {
            // add classes to indicate container is open
            $toggledContainer.addClass('container-is-open');
            $containerToggle.addClass('container-is-open');
            $body.addClass('container-is-open');
            // create container overlay
            $("<div class='container__overlay'>")
                .insertAfter($toggledContainer)
                .click(function () {
                // close the container when overlay is clicked
                closeContainer();
            });
            // set the top values
            setTopValues();
        }
        /**
         * @function closeContainer - removes classes indicating container is open. removes overlay markup
         */
        function closeContainer() {
            // remove classes indicating container is open
            $toggledContainer.removeClass('container-is-open');
            $containerToggle.removeClass('container-is-open');
            setTimeout(function () {
                $toggledContainer.removeAttr('style');
            }, 650);
            $body.removeClass('container-is-open');
            // remove overlay markup
            $('.container__overlay').remove();
        }
        /**
         * @function setTopValues - dynamically position the top value for overlay and container based on header height
         */
        function setTopValues() {
            // if a sticky header class is visible in the header
            if ($('#header').find('.ps-header--sticky-medium').is(':visible')) {
                // set the headerHeight based on that element
                var headerHeight = $('.ps-header--sticky-medium').outerHeight();
            }
            else if ($('#header').find('.ps-header--sticky-low').is(':visible')) {
                // set the headerHeight based on that element
                var headerHeight = $('.ps-header--sticky-low').outerHeight();
            }
            else {
                // set the headerHeight based on the header
                var headerHeight = $('#header').outerHeight();
            }
            // set the top value for container overlay and toggled container to headerHeight
            $('.container__overlay').css('top', headerHeight + 'px');
            $toggledContainer.css('top', headerHeight + 'px');
        }
        /**
         * @function initMegamenu - if container contains megamenu, apply class to initialize megamenu mobile behavior
         */
        function initMegaMenu() {
            // check if we're at a mobile/tablet screen size
            if (window.innerWidth <= mdUpperPx) {
                // if the toggled container contains a megamenu 
                if ($toggledContainer.find('.megamenu')) {
                    // add the js-mobile-megamenu class
                    $toggledContainer.find('.megamenu').addClass('js-mobile-megamenu');
                }
            }
        }
        /**
         * @function closeSearchBox - If the searchbox is open when toggle container is invoked, close the search box (mimics 'closeSearchbox' function in 'coveo-searchbox.ts')
         */
        function closeSearchBox() {
            var searchboxToggle = $('.js-searchbox-toggle');
            if (searchboxToggle.hasClass('searchbox-is-open')) {
                searchboxToggle.removeClass('searchbox-is-open');
                $('.container--searchbox-will-toggle').removeClass('searchbox-is-open');
                $('.searchbox__overlay').remove();
            }
        }
        /**
         * @function - when toggle icon is clicked, perform open/close functions
         */
        // container toggle is clicked
        $('body').on('click', '.js-container-toggle > .component-content', function (e) {
            e.preventDefault();
            // if container is already open
            if ($toggledContainer.hasClass('container-is-open')) {
                // close the container
                closeContainer();
            }
            else {
                // otherwise open the container and initialize mega menu
                closeSearchBox();
                openContainer();
                initMegaMenu();
            }
        });
    });

    window.onload = function () {
        setTimeout(function () {
            if (typeof sr_$ !== 'undefined') {
                var isSignedIn = sr_$.model.member.signedIn;
                var srCartComponent = $('.caleres-shoprunner-cart-component');
                if (isSignedIn && srCartComponent.length > 0) {
                    srCartComponent.show();
                }
                else {
                    srCartComponent.hide();
                }
            }
        }, 300);
    };

    $(document).ready(function () {
        function closeOverlay() {
            // remove the on class and remove overlay-background
            $('.promo-offerbanner__overlay').removeClass('overlay--is-visible');
            $('.promo-offerbanner__overlay-background').remove();
            $('.promo-offerbanner__overlay-close').remove();
        }
        $('.promo-offerbanner .js-overlay-trigger').click(function (e) {
            // find sibling overlay
            var $offerBannerOverlay = $(this).parents('.promo-offerbanner').find('.promo-offerbanner__overlay');
            // if the on class is not present
            if (!$offerBannerOverlay.hasClass('overlay--is-visible')) {
                // apply the on class and append overlay-background
                $offerBannerOverlay.addClass('overlay--is-visible').append($('<div class="overlay-close promo-offerbanner__overlay-close" role="button" aria-label="Close dialog"></div>'));
                $('<div class="promo-offerbanner__overlay-background"></div>').insertAfter($offerBannerOverlay);
            }
            else {
                closeOverlay();
            }
        });
        $('body').on('click', '.promo-offerbanner__overlay-close, .promo-offerbanner__overlay-background', function () {
            closeOverlay();
        });
    });

    /**
     * @description Invokes the Availability modal in Delivery Options
     *
     */
    var bodyElement = document.querySelector('body');
    document.addEventListener('DOMContentLoaded', function () {
        document.addEventListener('click', function (e) {
            var target = e.target;
            if (target.matches('.delivery-options-availability-modal__invoke')) {
                document.querySelector('.delivery-options-availability-modal').style.display = "block";
                bodyElement.style.overflowY = "hidden";
                setTimeout(function () {
                    $(".delivery-options-availability-modal").find(".StoreList_search-input").focus();
                }, 10);
            }
            if (target.matches('.delivery-options-availability-modal') || target.matches('.delivery-options-availability-modal__close') || target.matches('.location-avail-select-button')) {
                if (getSelection().toString() == "") {
                    document.querySelector('.delivery-options-availability-modal').style.display = "none";
                }
                bodyElement.style.overflowY = "auto";
            }
        });
    });

    /**
     * @description Invokes the generic Caleres modal from a variety of sources
     *
     */
    var bodyElement$1 = document.querySelector('body');
    var caleresModal = document.querySelector('.caleres-modal');
    document.addEventListener('DOMContentLoaded', function () {
        document.addEventListener('click', function (e) {
            var target = e.target;
            // Add specifically-targeted modals through presentation styles here 
            // Store locator
            if (target.matches('.store-locator-modal__invoke') || target.matches('.location-icon-no-store')) {
                if (window.globalStoresState) {
                    //If link has this extra class, tell the Modal that we want a new search and watch for store changes
                    if (target.matches('.store-locator_set-store-after-change')) {
                        window.globalStoresState.isNewSearch = true;
                        $("body").addClass("check-store-after-change");
                    }
                    window.globalStoresState.isStoreModalOpen(true);
                }
            }
            // Closes all instances of '.caleres-modal'
            if (target.parentElement && target.parentElement.matches('.caleres-modal') || target.matches('.caleres-modal__close')) {
                caleresModal.style.display = "none";
                bodyElement$1.style.overflowY = "auto";
                if (window.globalStoresState) {
                    window.globalStoresState.isStoreModalOpen(false);
                    $("body").removeClass("check-store-after-change");
                }
            }
        });
    });

    var caslTerms = $(".casl__loyalty-terms-and-conditions--text");
    var caslOptIn = $(".casl__loyalty-opt-in--text");
    var caslOptInLabelElement = $("label[for='casl__loyalty-opt-in--text']");
    var requiredLabel = $("span.casl__label--required");
    if (caslTerms.find(requiredLabel).length == 0) {
        caslTerms.css("margin-top", 0);
    }
    if (caslOptIn.find(requiredLabel).length == 0) {
        caslOptInLabelElement.css("margin-top", "-50px");
        caslOptIn.css("margin-top", "70px");
    }

    /**
     * @description CSR Impersonation banner markup and associated logic
     *
     */
    var bannerMarkup = "<div class=\"impersonation-banner privacy-warning\" style=\"background: sandybrown; color: white; font-size: 15px; opacity: 0.95\">\n                        <div>Impersonation Mode Active<a class=\"close-impersonation secondary-button-line\" style=\"position: absolute; right: 25%; color: white;\">Stop</a></div>\n                    </div>";
    window.onload = function () {
        if (document.cookie.indexOf("CsrAccount") !== -1) {
            $('#wrapper').append(bannerMarkup);
        }
        document.addEventListener('click', function (e) {
            var target = e.target;
            if (target.matches('.close-impersonation')) {
                document.cookie = "CsrAccount=false; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                window.location.href = "/api/calxa/account/logoff";
            }
        });
    };

    var progressBars = document.querySelectorAll('.circular-progress__fill');
    function setProgress(percent, circle, circumference) {
        var offset = circumference - (percent / 100) * circumference;
        circle.style.strokeDashoffset = offset;
    }
    if (progressBars.length > 0) {
        for (var i = 0; i < progressBars.length; i++) {
            var radius = progressBars[i].r.baseVal.value;
            var circumference = radius * 2 * Math.PI;
            var percentage = progressBars[i].parentElement.getAttribute("data-progress");
            progressBars[i].style.strokeDasharray = circumference + " " + circumference;
            progressBars[i].style.strokeDashoffset = "" + circumference;
            if (percentage == 0) {
                // This will fudge 0% to display 0.5% progress, so customer always has some visual indicator
                setProgress(0.5, progressBars[i], circumference);
            }
            else if (percentage < 101 && percentage > -1) {
                setProgress(percentage, progressBars[i], circumference);
            }
        }
    }

    function closeBorderFreeModal() {
        $('.bfx-cc-menu')[window.isMobile() ? 1 : 0].click();
    }
    $(function () {
        setTimeout(function () {
            var borderFreeModalElement = document.querySelector('.bfx-cc-content');
            if (borderFreeModalElement) {
                $(borderFreeModalElement).prepend('<span class="lightbox__close"></span>');
            }
        }, 400);
    });
    document.addEventListener('click', function (e) {
        var target = e.target;
        if (target.matches('.bfx-cc-content .lightbox__close') || target.matches('#bfx-cc-wrapper-expanded')) {
            closeBorderFreeModal();
        }
    });

    /**
     * @description setStickyHeaderPageCss - Listens for page load; logic triggered if Sticky Header is found.
     */
    setStickyHeaderPageCss();
    /**
     * @description coveoSearchboxInteractions - Listens for Coveo global searchbox interaction events from any page and toggles classes for UI behavior
     */
    coveoSearchboxInteractions();
    /**
     * @description sets coveoCommonCustomizations to window variable, so it's accessible from initCustom.cshtml
     */
    window.coveoCommonCustomizations = coveoCommonCustomizations;
    /**
     * @description sets MemoryStorage to window variable, so it's accessible from account-login-modeel.js
     */
    window.MemoryStorage = MemoryStorage;
    /**
     * @description initialize url reader for promo and rewards codes
     */
    initUrlPromoCodes();
    /**
     * @description document ready block
     */
    $(document).ready(function () {
        /**
         * @description initialize calares analytics events: raise events to adobe launch
         */
        initCaleresAnalyticsEvents();
        /**
         * @description initialize BazaarVoice review callbacks
         */
        initBazaarVoiceCallbacks();
    });

}());
